/*

 This is a generated file. DO NOT EDIT.

 Copyright (C) 2010-2015 KO GmbH <copyright@kogmbh.com>

 @licstart
 This file is the compiled version of the WebODF library.

 WebODF is free software: you can redistribute it and/or modify it
 under the terms of the GNU Affero General Public License (GNU AGPL)
 as published by the Free Software Foundation, either version 3 of
 the License, or (at your option) any later version.

 WebODF is distributed in the hope that it will be useful, but
 WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU Affero General Public License for more details.

 You should have received a copy of the GNU Affero General Public License
 along with WebODF.  If not, see <http://www.gnu.org/licenses/>.
 @licend

 @source: http://www.webodf.org/
 @source: https://github.com/kogmbh/WebODF/
*/
var webodf_version="0.5.7-33-g812e324-dirty";function Runtime(){}Runtime.prototype.getVariable=function(g){};Runtime.prototype.toJson=function(g){};Runtime.prototype.fromJson=function(g){};Runtime.prototype.byteArrayFromString=function(g,k){};Runtime.prototype.byteArrayToString=function(g,k){};Runtime.prototype.read=function(g,k,d,b){};Runtime.prototype.readFile=function(g,k,d){};Runtime.prototype.readFileSync=function(g,k){};Runtime.prototype.loadXML=function(g,k){};Runtime.prototype.writeFile=function(g,k,d){};
Runtime.prototype.deleteFile=function(g,k){};Runtime.prototype.log=function(g,k){};Runtime.prototype.setTimeout=function(g,k){};Runtime.prototype.clearTimeout=function(g){};Runtime.prototype.libraryPaths=function(){};Runtime.prototype.currentDirectory=function(){};Runtime.prototype.setCurrentDirectory=function(g){};Runtime.prototype.type=function(){};Runtime.prototype.getDOMImplementation=function(){};Runtime.prototype.parseXML=function(g){};Runtime.prototype.exit=function(g){};
Runtime.prototype.getWindow=function(){};Runtime.prototype.requestAnimationFrame=function(g){};Runtime.prototype.cancelAnimationFrame=function(g){};Runtime.prototype.assert=function(g,k){};var IS_COMPILED_CODE=!0;
Runtime.byteArrayToString=function(g,k){function d(b){var d="",c,q=b.length;for(c=0;c<q;c+=1)d+=String.fromCharCode(b[c]&255);return d}function b(b){var d="",c,q=b.length,f=[],h,a,e,r;for(c=3<=q&&239===b[0]&&187===b[1]&&191===b[2]?3:0;c<q;c+=1)h=b[c],128>h?f.push(h):(c+=1,a=b[c],194<=h&&224>h?f.push((h&31)<<6|a&63):(c+=1,e=b[c],224<=h&&240>h?f.push((h&15)<<12|(a&63)<<6|e&63):(c+=1,r=b[c],240<=h&&245>h&&(h=(h&7)<<18|(a&63)<<12|(e&63)<<6|r&63,h-=65536,f.push((h>>10)+55296,(h&1023)+56320))))),1E3<=f.length&&
(d+=String.fromCharCode.apply(null,f),f.length=0);return d+String.fromCharCode.apply(null,f)}var c;"utf8"===k?c=b(g):("binary"!==k&&this.log("Unsupported encoding: "+k),c=d(g));return c};Runtime.getVariable=function(g){try{return eval(g)}catch(k){}};Runtime.toJson=function(g){return JSON.stringify(g)};Runtime.fromJson=function(g){return JSON.parse(g)};Runtime.getFunctionName=function(g){return void 0===g.name?(g=/function\s+(\w+)/.exec(g))&&g[1]:g.name};
Runtime.assert=function(g,k){if(!g)throw this.log("alert","ASSERTION FAILED:\n"+k),Error(k);};
function BrowserRuntime(){function g(b){var f=b.length,h,a,e=0;for(h=0;h<f;h+=1)a=b.charCodeAt(h),e+=1+(128<a)+(2048<a),55040<a&&57344>a&&(e+=1,h+=1);return e}function k(b,f,h){var a=b.length,e,r;f=new Uint8Array(new ArrayBuffer(f));h?(f[0]=239,f[1]=187,f[2]=191,r=3):r=0;for(h=0;h<a;h+=1)e=b.charCodeAt(h),128>e?(f[r]=e,r+=1):2048>e?(f[r]=192|e>>>6,f[r+1]=128|e&63,r+=2):55040>=e||57344<=e?(f[r]=224|e>>>12&15,f[r+1]=128|e>>>6&63,f[r+2]=128|e&63,r+=3):(h+=1,e=(e-55296<<10|b.charCodeAt(h)-56320)+65536,
f[r]=240|e>>>18&7,f[r+1]=128|e>>>12&63,f[r+2]=128|e>>>6&63,f[r+3]=128|e&63,r+=4);return f}function d(b){var f=b.length,h=new Uint8Array(new ArrayBuffer(f)),a;for(a=0;a<f;a+=1)h[a]=b.charCodeAt(a)&255;return h}function b(b,f){var h;void 0!==f?h=b:f=b;console.log(f);p.enableAlerts&&"alert"===h&&alert(f)}function c(b,f,h){if(0!==h.status||h.responseText)if(200===h.status||0===h.status){if(h.response&&"string"!==typeof h.response)"binary"===f?(h=h.response,h=new Uint8Array(h)):h=String(h.response);else if("binary"===
f)if(null!==h.responseBody&&"undefined"!==String(typeof VBArray)){h=(new VBArray(h.responseBody)).toArray();var a=h.length;f=new Uint8Array(new ArrayBuffer(a));for(b=0;b<a;b+=1)f[b]=h[b];h=f}else{(b=h.getResponseHeader("Content-Length"))&&(b=parseInt(b,10));if(b&&b!==h.responseText.length)a:{a=h.responseText;f=!1;var e=g(a);if("number"===typeof b){if(b!==e&&b!==e+3){a=void 0;break a}f=e+3===b;e=b}a=k(a,e,f)}void 0===a&&(a=d(h.responseText));h=a}else h=h.responseText;h={err:null,data:h}}else h={err:h.responseText||
h.statusText,data:null};else h={err:"File "+b+" is empty.",data:null};return h}function l(b,f,h){var a=new XMLHttpRequest;a.open("GET",b,h);a.overrideMimeType&&("binary"!==f?a.overrideMimeType("text/plain; charset="+f):a.overrideMimeType("text/plain; charset=x-user-defined"));return a}function n(b,f,h){var a=l(b,f,!0);a.onreadystatechange=function(){var e;4===a.readyState&&(e=c(b,f,a),h(e.err,e.data))};try{a.send(null)}catch(e){h(e.message,null)}}var p=this;this.byteArrayFromString=function(b,f){var h;
"utf8"===f?h=k(b,g(b),!1):("binary"!==f&&p.log("unknown encoding: "+f),h=d(b));return h};this.byteArrayToString=Runtime.byteArrayToString;this.getVariable=Runtime.getVariable;this.fromJson=Runtime.fromJson;this.toJson=Runtime.toJson;this.readFile=n;this.read=function(b,f,h,a){n(b,"binary",function(e,r){var m=null;if(r){if("string"===typeof r)throw"This should not happen.";m=r.subarray(f,f+h)}a(e,m)})};this.readFileSync=function(b,f){var h=l(b,f,!1),a;try{h.send(null);a=c(b,f,h);if(a.err)throw a.err;
if(null===a.data)throw"No data read from "+b+".";}catch(e){throw e;}return a.data};this.writeFile=function(b,f,h){var a=new XMLHttpRequest,e;a.open("PUT",b,!0);a.onreadystatechange=function(){4===a.readyState&&(0!==a.status||a.responseText?200<=a.status&&300>a.status||0===a.status?h(null):h("Status "+String(a.status)+": "+a.responseText||a.statusText):h("File "+b+" is empty."))};e=f.buffer&&!a.sendAsBinary?f.buffer:p.byteArrayToString(f,"binary");try{a.sendAsBinary?a.sendAsBinary(e):a.send(e)}catch(r){p.log("HUH? "+
r+" "+f),h(r.message)}};this.deleteFile=function(b,f){var h=new XMLHttpRequest;h.open("DELETE",b,!0);h.onreadystatechange=function(){4===h.readyState&&(200>h.status&&300<=h.status?f(h.responseText):f(null))};h.send(null)};this.loadXML=function(b,f){var h=new XMLHttpRequest;h.open("GET",b,!0);h.overrideMimeType&&h.overrideMimeType("text/xml");h.onreadystatechange=function(){4===h.readyState&&(0!==h.status||h.responseText?200===h.status||0===h.status?f(null,h.responseXML):f(h.responseText,null):f("File "+
b+" is empty.",null))};try{h.send(null)}catch(a){f(a.message,null)}};this.log=b;this.enableAlerts=!0;this.assert=Runtime.assert;this.setTimeout=function(b,f){return setTimeout(function(){b()},f)};this.clearTimeout=function(b){clearTimeout(b)};this.libraryPaths=function(){return["lib"]};this.setCurrentDirectory=function(){};this.currentDirectory=function(){return""};this.type=function(){return"BrowserRuntime"};this.getDOMImplementation=function(){return window.document.implementation};this.parseXML=
function(b){return(new DOMParser).parseFromString(b,"text/xml")};this.exit=function(c){b("Calling exit with code "+String(c)+", but exit() is not implemented.")};this.getWindow=function(){return window};this.requestAnimationFrame=function(b){var f=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,h=0;if(f)f.bind(window),h=f(b);else return setTimeout(b,15);return h};this.cancelAnimationFrame=function(b){var f=window.cancelAnimationFrame||
window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame;f?(f.bind(window),f(b)):clearTimeout(b)}}
function NodeJSRuntime(){function g(b){var f=b.length,h,a=new Uint8Array(new ArrayBuffer(f));for(h=0;h<f;h+=1)a[h]=b[h];return a}function k(d,f,h){function a(a,r){if(a)return h(a,null);if(!r)return h("No data for "+d+".",null);if("string"===typeof r)return h(a,r);h(a,g(r))}d=c.resolve(l,d);"binary"!==f?b.readFile(d,f,a):b.readFile(d,null,a)}var d=this,b=require("fs"),c=require("path"),l="",n,p;this.byteArrayFromString=function(b,f){var h=new Buffer(b,f),a,e=h.length,r=new Uint8Array(new ArrayBuffer(e));
for(a=0;a<e;a+=1)r[a]=h[a];return r};this.byteArrayToString=Runtime.byteArrayToString;this.getVariable=Runtime.getVariable;this.fromJson=Runtime.fromJson;this.toJson=Runtime.toJson;this.readFile=k;this.loadXML=function(b,f){k(b,"utf-8",function(h,a){if(h)return f(h,null);if(!a)return f("No data for "+b+".",null);f(null,d.parseXML(a))})};this.writeFile=function(d,f,h){f=new Buffer(f);d=c.resolve(l,d);b.writeFile(d,f,"binary",function(a){h(a||null)})};this.deleteFile=function(d,f){d=c.resolve(l,d);
b.unlink(d,f)};this.read=function(d,f,h,a){d=c.resolve(l,d);b.open(d,"r+",666,function(e,r){if(e)a(e,null);else{var m=new Buffer(h);b.read(r,m,0,h,f,function(e){b.close(r);a(e,g(m))})}})};this.readFileSync=function(d,f){var h;h=b.readFileSync(d,"binary"===f?null:f);if(null===h)throw"File "+d+" could not be read.";"binary"===f&&(h=g(h));return h};this.log=function(b,d){var h;void 0!==d?h=b:d=b;"alert"===h&&process.stderr.write("\n!!!!! ALERT !!!!!\n");process.stderr.write(d+"\n");"alert"===h&&process.stderr.write("!!!!! ALERT !!!!!\n")};
this.assert=Runtime.assert;this.setTimeout=function(b,d){return setTimeout(function(){b()},d)};this.clearTimeout=function(b){clearTimeout(b)};this.libraryPaths=function(){return[__dirname]};this.setCurrentDirectory=function(b){l=b};this.currentDirectory=function(){return l};this.type=function(){return"NodeJSRuntime"};this.getDOMImplementation=function(){return p};this.parseXML=function(b){return n.parseFromString(b,"text/xml")};this.exit=process.exit;this.getWindow=function(){return null};this.requestAnimationFrame=
function(b){return setTimeout(b,15)};this.cancelAnimationFrame=function(b){clearTimeout(b)};n=new (require("xmldom").DOMParser);p=d.parseXML("<a/>").implementation}
function RhinoRuntime(){var g=this,k={},d=k.javax.xml.parsers.DocumentBuilderFactory.newInstance(),b,c,l="";d.setValidating(!1);d.setNamespaceAware(!0);d.setExpandEntityReferences(!1);d.setSchema(null);c=k.org.xml.sax.EntityResolver({resolveEntity:function(b,d){var c=new k.java.io.FileReader(d);return new k.org.xml.sax.InputSource(c)}});b=d.newDocumentBuilder();b.setEntityResolver(c);this.byteArrayFromString=function(b,d){var c,f=b.length,h=new Uint8Array(new ArrayBuffer(f));for(c=0;c<f;c+=1)h[c]=
b.charCodeAt(c)&255;return h};this.byteArrayToString=Runtime.byteArrayToString;this.getVariable=Runtime.getVariable;this.fromJson=Runtime.fromJson;this.toJson=Runtime.toJson;this.loadXML=function(d,c){var l=new k.java.io.File(d),f=null;try{f=b.parse(l)}catch(h){return print(h),c(h,null)}c(null,f)};this.readFile=function(b,d,c){l&&(b=l+"/"+b);var f=new k.java.io.File(b),h="binary"===d?"latin1":d;f.isFile()?((b=readFile(b,h))&&"binary"===d&&(b=g.byteArrayFromString(b,"binary")),c(null,b)):c(b+" is not a file.",
null)};this.writeFile=function(b,d,c){l&&(b=l+"/"+b);b=new k.java.io.FileOutputStream(b);var f,h=d.length;for(f=0;f<h;f+=1)b.write(d[f]);b.close();c(null)};this.deleteFile=function(b,d){l&&(b=l+"/"+b);var c=new k.java.io.File(b),f=b+Math.random(),f=new k.java.io.File(f);c.rename(f)?(f.deleteOnExit(),d(null)):d("Could not delete "+b)};this.read=function(b,d,c,f){l&&(b=l+"/"+b);var h;h=b;var a="binary";(new k.java.io.File(h)).isFile()?("binary"===a&&(a="latin1"),h=readFile(h,a)):h=null;h?f(null,this.byteArrayFromString(h.substring(d,
d+c),"binary")):f("Cannot read "+b,null)};this.readFileSync=function(b,d){if(!d)return"";var c=readFile(b,d);if(null===c)throw"File could not be read.";return c};this.log=function(b,d){var c;void 0!==d?c=b:d=b;"alert"===c&&print("\n!!!!! ALERT !!!!!");print(d);"alert"===c&&print("!!!!! ALERT !!!!!")};this.assert=Runtime.assert;this.setTimeout=function(b){b();return 0};this.clearTimeout=function(){};this.libraryPaths=function(){return["lib"]};this.setCurrentDirectory=function(b){l=b};this.currentDirectory=
function(){return l};this.type=function(){return"RhinoRuntime"};this.getDOMImplementation=function(){return b.getDOMImplementation()};this.parseXML=function(d){d=new k.java.io.StringReader(d);d=new k.org.xml.sax.InputSource(d);return b.parse(d)};this.exit=quit;this.getWindow=function(){return null};this.requestAnimationFrame=function(b){b();return 0};this.cancelAnimationFrame=function(){}}
Runtime.create=function(){return"undefined"!==String(typeof window)?new BrowserRuntime:"undefined"!==String(typeof require)?new NodeJSRuntime:new RhinoRuntime};var runtime=Runtime.create(),core={},gui={},xmldom={},odf={},ops={},webodf={};(function(){webodf.Version="undefined"!==String(typeof webodf_version)?webodf_version:"From Source"})();
(function(){function g(b,d,c){var h=b+"/manifest.json",a,e;runtime.log("Loading manifest: "+h);try{a=runtime.readFileSync(h,"utf-8")}catch(r){if(c)runtime.log("No loadable manifest found.");else throw console.log(String(r)),r;return}c=JSON.parse(a);for(e in c)c.hasOwnProperty(e)&&(d[e]={dir:b,deps:c[e]})}function k(b,d,c){function h(m){if(!r[m]&&!c(m)){if(e[m])throw"Circular dependency detected for "+m+".";e[m]=!0;if(!d[m])throw"Missing dependency information for class "+m+".";var b=d[m],l=b.deps,
p,n=l.length;for(p=0;p<n;p+=1)h(l[p]);e[m]=!1;r[m]=!0;a.push(b.dir+"/"+m.replace(".","/")+".js")}}var a=[],e={},r={};b.forEach(h);return a}function d(b,d){return d+("\n//# sourceURL="+b)}function b(b){var c,f;for(c=0;c<b.length;c+=1)f=runtime.readFileSync(b[c],"utf-8"),f=d(b[c],f),eval(f)}function c(b){b=b.split(".");var d,c=n,h=b.length;for(d=0;d<h;d+=1){if(!c.hasOwnProperty(b[d]))return!1;c=c[b[d]]}return!0}var l,n={core:core,gui:gui,xmldom:xmldom,odf:odf,ops:ops};runtime.loadClasses=function(d,
n){if(IS_COMPILED_CODE||0===d.length)return n&&n();var f;if(!(f=l)){f=[];var h=runtime.libraryPaths(),a;runtime.currentDirectory()&&-1===h.indexOf(runtime.currentDirectory())&&g(runtime.currentDirectory(),f,!0);for(a=0;a<h.length;a+=1)g(h[a],f)}l=f;d=k(d,l,c);if(0===d.length)return n&&n();if("BrowserRuntime"===runtime.type()&&n){f=d;h=document.currentScript||document.documentElement.lastChild;a=document.createDocumentFragment();var e,r;for(r=0;r<f.length;r+=1)e=document.createElement("script"),e.type=
"text/javascript",e.charset="utf-8",e.async=!1,e.setAttribute("src",f[r]),a.appendChild(e);n&&(e.onload=n);h.parentNode.insertBefore(a,h)}else b(d),n&&n()};runtime.loadClass=function(b,d){runtime.loadClasses([b],d)}})();(function(){var g=function(g){return g};runtime.getTranslator=function(){return g};runtime.setTranslator=function(k){g=k};runtime.tr=function(k){var d=g(k);return d&&"string"===String(typeof d)?d:k}})();
(function(g){function k(d){if(d.length){var b=d[0];runtime.readFile(b,"utf8",function(c,l){function n(){var b;(b=eval(g))&&runtime.exit(b)}var p="",p=b.lastIndexOf("/"),g=l,p=-1!==p?b.substring(0,p):".";runtime.setCurrentDirectory(p);c?(runtime.log(c),runtime.exit(1)):null===g?(runtime.log("No code found for "+b),runtime.exit(1)):n.apply(null,d)})}}g=g?Array.prototype.slice.call(g):[];"NodeJSRuntime"===runtime.type()?k(process.argv.slice(2)):"RhinoRuntime"===runtime.type()?k(g):k(g.slice(1))})("undefined"!==
String(typeof arguments)&&arguments);(function(){core.Async=function(){return{forEach:function(g,k,d){function b(b){n!==l&&(b?(n=l,d(b)):(n+=1,n===l&&d(null)))}var c,l=g.length,n=0;for(c=0;c<l;c+=1)k(g[c],b)},destroyAll:function(g,k){function d(b,c){if(c)k(c);else if(b<g.length)g[b](function(c){d(b+1,c)});else k()}d(0,void 0)}}}()})();function makeBase64(){function g(a){var e,m=a.length,r=new Uint8Array(new ArrayBuffer(m));for(e=0;e<m;e+=1)r[e]=a.charCodeAt(e)&255;return r}function k(a){var e,m="",r,b=a.length-2;for(r=0;r<b;r+=3)e=a[r]<<16|a[r+1]<<8|a[r+2],m+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e>>>18],m+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e>>>12&63],m+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e>>>6&63],m+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e&
63];r===b+1?(e=a[r]<<4,m+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e>>>6],m+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e&63],m+="=="):r===b&&(e=a[r]<<10|a[r+1]<<2,m+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e>>>12],m+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e>>>6&63],m+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e&63],m+="=");return m}function d(a){a=a.replace(/[^A-Za-z0-9+\/]+/g,
"");var e=a.length,r=new Uint8Array(new ArrayBuffer(3*e)),b=a.length%4,d=0,c,h;for(c=0;c<e;c+=4)h=(m[a.charAt(c)]||0)<<18|(m[a.charAt(c+1)]||0)<<12|(m[a.charAt(c+2)]||0)<<6|(m[a.charAt(c+3)]||0),r[d]=h>>16,r[d+1]=h>>8&255,r[d+2]=h&255,d+=3;e=3*e-[0,0,2,1][b];return r.subarray(0,e)}function b(a){var e,m,r=a.length,b=0,d=new Uint8Array(new ArrayBuffer(3*r));for(e=0;e<r;e+=1)m=a[e],128>m?d[b++]=m:(2048>m?d[b++]=192|m>>>6:(d[b++]=224|m>>>12&15,d[b++]=128|m>>>6&63),d[b++]=128|m&63);return d.subarray(0,
b)}function c(a){var e,m,r,b,d=a.length,c=new Uint8Array(new ArrayBuffer(d)),h=0;for(e=0;e<d;e+=1)m=a[e],128>m?c[h++]=m:(e+=1,r=a[e],224>m?c[h++]=(m&31)<<6|r&63:(e+=1,b=a[e],c[h++]=(m&15)<<12|(r&63)<<6|b&63));return c.subarray(0,h)}function l(a){return k(g(a))}function n(a){return String.fromCharCode.apply(String,d(a))}function p(a){return c(g(a))}function q(a){a=c(a);for(var e="",m=0;m<a.length;)e+=String.fromCharCode.apply(String,a.subarray(m,m+45E3)),m+=45E3;return e}function f(a,e,m){var r,b,
d,c="";for(d=e;d<m;d+=1)e=a.charCodeAt(d)&255,128>e?c+=String.fromCharCode(e):(d+=1,r=a.charCodeAt(d)&255,224>e?c+=String.fromCharCode((e&31)<<6|r&63):(d+=1,b=a.charCodeAt(d)&255,c+=String.fromCharCode((e&15)<<12|(r&63)<<6|b&63)));return c}function h(a,e){function m(){var d=b+1E5;d>a.length&&(d=a.length);r+=f(a,b,d);b=d;d=b===a.length;e(r,d)&&!d&&runtime.setTimeout(m,0)}var r="",b=0;1E5>a.length?e(f(a,0,a.length),!0):("string"!==typeof a&&(a=a.slice()),m())}function a(a){return b(g(a))}function e(a){return String.fromCharCode.apply(String,
b(a))}function r(a){return String.fromCharCode.apply(String,b(g(a)))}var m=function(a){var e={},m,r;m=0;for(r=a.length;m<r;m+=1)e[a.charAt(m)]=m;return e}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),y,u,z=runtime.getWindow(),t,s;z&&z.btoa?(t=z.btoa,y=function(a){return t(r(a))}):(t=l,y=function(e){return k(a(e))});z&&z.atob?(s=z.atob,u=function(a){a=s(a);return f(a,0,a.length)}):(s=n,u=function(a){return q(d(a))});core.Base64=function(){this.convertByteArrayToBase64=this.convertUTF8ArrayToBase64=
k;this.convertBase64ToByteArray=this.convertBase64ToUTF8Array=d;this.convertUTF16ArrayToByteArray=this.convertUTF16ArrayToUTF8Array=b;this.convertByteArrayToUTF16Array=this.convertUTF8ArrayToUTF16Array=c;this.convertUTF8StringToBase64=l;this.convertBase64ToUTF8String=n;this.convertUTF8StringToUTF16Array=p;this.convertByteArrayToUTF16String=this.convertUTF8ArrayToUTF16String=q;this.convertUTF8StringToUTF16String=h;this.convertUTF16StringToByteArray=this.convertUTF16StringToUTF8Array=a;this.convertUTF16ArrayToUTF8String=
e;this.convertUTF16StringToUTF8String=r;this.convertUTF16StringToBase64=y;this.convertBase64ToUTF16String=u;this.fromBase64=n;this.toBase64=l;this.atob=s;this.btoa=t;this.utob=r;this.btou=h;this.encode=y;this.encodeURI=function(a){return y(a).replace(/[+\/]/g,function(a){return"+"===a?"-":"_"}).replace(/\\=+$/,"")};this.decode=function(a){return u(a.replace(/[\-_]/g,function(a){return"-"===a?"+":"/"}))};return this};return core.Base64}core.Base64=makeBase64();core.ByteArray=function(g){this.pos=0;this.data=g;this.readUInt32LE=function(){this.pos+=4;var g=this.data,d=this.pos;return g[--d]<<24|g[--d]<<16|g[--d]<<8|g[--d]};this.readUInt16LE=function(){this.pos+=2;var g=this.data,d=this.pos;return g[--d]<<8|g[--d]}};core.ByteArrayWriter=function(g){function k(d){d>c-b&&(c=Math.max(2*c,b+d),d=new Uint8Array(new ArrayBuffer(c)),d.set(l),l=d)}var d=this,b=0,c=1024,l=new Uint8Array(new ArrayBuffer(c));this.appendByteArrayWriter=function(b){d.appendByteArray(b.getByteArray())};this.appendByteArray=function(d){var c=d.length;k(c);l.set(d,b);b+=c};this.appendArray=function(d){var c=d.length;k(c);l.set(d,b);b+=c};this.appendUInt16LE=function(b){d.appendArray([b&255,b>>8&255])};this.appendUInt32LE=function(b){d.appendArray([b&
255,b>>8&255,b>>16&255,b>>24&255])};this.appendString=function(b){d.appendByteArray(runtime.byteArrayFromString(b,g))};this.getLength=function(){return b};this.getByteArray=function(){var d=new Uint8Array(new ArrayBuffer(b));d.set(l.subarray(0,b));return d}};core.CSSUnits=function(){var g=this,k={"in":1,cm:2.54,mm:25.4,pt:72,pc:12,px:96};this.convert=function(d,b,c){return d*k[c]/k[b]};this.convertMeasure=function(d,b){var c,l;d&&b&&(c=parseFloat(d),l=d.replace(c.toString(),""),c=g.convert(c,l,b));return c};this.getUnits=function(d){return d.substr(d.length-2,d.length)}};(function(){function g(){var b,c,l,g,p,k,f,h,a;void 0===d&&(c=(b=runtime.getWindow())&&b.document,k=c.documentElement,f=c.body,d={rangeBCRIgnoresElementBCR:!1,unscaledRangeClientRects:!1,elementBCRIgnoresBodyScroll:!1},c&&(g=c.createElement("div"),g.style.position="absolute",g.style.left="-99999px",g.style.transform="scale(2)",g.style["-webkit-transform"]="scale(2)",p=c.createElement("div"),g.appendChild(p),f.appendChild(g),b=c.createRange(),b.selectNode(p),d.rangeBCRIgnoresElementBCR=0===b.getClientRects().length,
p.appendChild(c.createTextNode("Rect transform test")),c=p.getBoundingClientRect(),l=b.getBoundingClientRect(),d.unscaledRangeClientRects=2<Math.abs(c.height-l.height),g.style.transform="",g.style["-webkit-transform"]="",c=k.style.overflow,l=f.style.overflow,h=f.style.height,a=f.scrollTop,k.style.overflow="visible",f.style.overflow="visible",f.style.height="200%",f.scrollTop=f.scrollHeight,d.elementBCRIgnoresBodyScroll=b.getBoundingClientRect().top!==p.getBoundingClientRect().top,f.scrollTop=a,f.style.height=
h,f.style.overflow=l,k.style.overflow=c,b.detach(),f.removeChild(g),b=Object.keys(d).map(function(a){return a+":"+String(d[a])}).join(", "),runtime.log("Detected browser quirks - "+b)));return d}function k(b,d,l){for(b=b?b.firstElementChild:null;b;){if(b.localName===l&&b.namespaceURI===d)return b;b=b.nextElementSibling}return null}var d;core.DomUtilsImpl=function(){function b(a,e){for(var b=0,d;a.parentNode!==e;)runtime.assert(null!==a.parentNode,"parent is null"),a=a.parentNode;for(d=e.firstChild;d!==
a;)b+=1,d=d.nextSibling;return b}function d(a,e){return 0>=a.compareBoundaryPoints(Range.START_TO_START,e)&&0<=a.compareBoundaryPoints(Range.END_TO_END,e)}function l(a,e){return 0>=a.compareBoundaryPoints(Range.END_TO_START,e)&&0<=a.compareBoundaryPoints(Range.START_TO_END,e)}function n(a,e){var b=null;a.nodeType===Node.TEXT_NODE&&(0===a.length?(a.parentNode.removeChild(a),e.nodeType===Node.TEXT_NODE&&(b=e)):(e.nodeType===Node.TEXT_NODE&&(a.appendData(e.data),e.parentNode.removeChild(e)),b=a));return b}
function p(a){for(var e=a.parentNode;a.firstChild;)e.insertBefore(a.firstChild,a);e.removeChild(a);return e}function q(a,e){var b=a.parentNode,d=a.firstChild,c=e(a),h;if(c===NodeFilter.FILTER_SKIP)return b;for(;d;)h=d.nextSibling,q(d,e),d=h;b&&c===NodeFilter.FILTER_REJECT&&p(a);return b}function f(a,e){return a===e||Boolean(a.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)}function h(a,e){return g().unscaledRangeClientRects?a:a/e}function a(e,m,b){Object.keys(m).forEach(function(d){var c=
d.split(":"),h=c[1],f=b(c[0]),c=m[d],l=typeof c;"object"===l?Object.keys(c).length&&(d=f?e.getElementsByTagNameNS(f,h)[0]||e.ownerDocument.createElementNS(f,d):e.getElementsByTagName(h)[0]||e.ownerDocument.createElement(d),e.appendChild(d),a(d,c,b)):f&&(runtime.assert("number"===l||"string"===l,"attempting to map unsupported type '"+l+"' (key: "+d+")"),e.setAttributeNS(f,d,String(c)))})}var e=null;this.splitBoundaries=function(a){var e,d=[],c,h,f;if(a.startContainer.nodeType===Node.TEXT_NODE||a.endContainer.nodeType===
Node.TEXT_NODE){c=a.endContainer;h=a.endContainer.nodeType!==Node.TEXT_NODE?a.endOffset===a.endContainer.childNodes.length:!1;f=a.endOffset;e=a.endContainer;if(f<e.childNodes.length)for(e=e.childNodes.item(f),f=0;e.firstChild;)e=e.firstChild;else for(;e.lastChild;)e=e.lastChild,f=e.nodeType===Node.TEXT_NODE?e.textContent.length:e.childNodes.length;e===c&&(c=null);a.setEnd(e,f);f=a.endContainer;0!==a.endOffset&&f.nodeType===Node.TEXT_NODE&&(e=f,a.endOffset!==e.length&&(d.push(e.splitText(a.endOffset)),
d.push(e)));f=a.startContainer;0!==a.startOffset&&f.nodeType===Node.TEXT_NODE&&(e=f,a.startOffset!==e.length&&(f=e.splitText(a.startOffset),d.push(e),d.push(f),a.setStart(f,0)));if(null!==c){for(f=a.endContainer;f.parentNode&&f.parentNode!==c;)f=f.parentNode;h=h?c.childNodes.length:b(f,c);a.setEnd(c,h)}}return d};this.containsRange=d;this.rangesIntersect=l;this.rangeIntersection=function(a,e){var b;l(a,e)&&(b=a.cloneRange(),-1===a.compareBoundaryPoints(Range.START_TO_START,e)&&b.setStart(e.startContainer,
e.startOffset),1===a.compareBoundaryPoints(Range.END_TO_END,e)&&b.setEnd(e.endContainer,e.endOffset));return b};this.getNodesInRange=function(a,e,b){var d=[],c=a.commonAncestorContainer,c=c.nodeType===Node.TEXT_NODE?c.parentNode:c;b=a.startContainer.ownerDocument.createTreeWalker(c,b,e,!1);var h,f;a.endContainer.childNodes[a.endOffset-1]?(h=a.endContainer.childNodes[a.endOffset-1],f=Node.DOCUMENT_POSITION_PRECEDING|Node.DOCUMENT_POSITION_CONTAINED_BY):(h=a.endContainer,f=Node.DOCUMENT_POSITION_PRECEDING);
a.startContainer.childNodes[a.startOffset]?(a=a.startContainer.childNodes[a.startOffset],b.currentNode=a):a.startOffset===(a.startContainer.nodeType===Node.TEXT_NODE?a.startContainer.length:a.startContainer.childNodes.length)?(a=a.startContainer,b.currentNode=a,b.lastChild(),a=b.nextNode()):(a=a.startContainer,b.currentNode=a);if(a){a=b.currentNode;if(a!==c)for(a=a.parentNode;a&&a!==c;)e(a)===NodeFilter.FILTER_REJECT&&(b.currentNode=a),a=a.parentNode;a=b.currentNode;switch(e(a)){case NodeFilter.FILTER_REJECT:for(a=
b.nextSibling();!a&&b.parentNode();)a=b.nextSibling();break;case NodeFilter.FILTER_SKIP:a=b.nextNode()}for(;a;){e=h.compareDocumentPosition(a);if(0!==e&&0===(e&f))break;d.push(a);a=b.nextNode()}}return d};this.normalizeTextNodes=function(a){a&&a.nextSibling&&(a=n(a,a.nextSibling));a&&a.previousSibling&&n(a.previousSibling,a)};this.rangeContainsNode=function(a,e){var b=e.ownerDocument.createRange(),h=e.ownerDocument.createRange(),f;b.setStart(a.startContainer,a.startOffset);b.setEnd(a.endContainer,
a.endOffset);h.selectNodeContents(e);f=d(b,h);b.detach();h.detach();return f};this.mergeIntoParent=p;this.removeUnwantedNodes=q;this.removeAllChildNodes=function(a){for(;a.firstChild;)a.removeChild(a.firstChild)};this.getElementsByTagNameNS=function(a,e,b){var d=[];a=a.getElementsByTagNameNS(e,b);d.length=b=a.length;for(e=0;e<b;e+=1)d[e]=a.item(e);return d};this.getElementsByTagName=function(a,e){var b=[],d,c,h;d=a.getElementsByTagName(e);b.length=h=d.length;for(c=0;c<h;c+=1)b[c]=d.item(c);return b};
this.containsNode=function(a,e){return a===e||a.contains(e)};this.comparePoints=function(a,e,d,c){if(a===d)return c-e;var h=a.compareDocumentPosition(d);2===h?h=-1:4===h?h=1:10===h?(e=b(a,d),h=e<c?1:-1):(c=b(d,a),h=c<e?-1:1);return h};this.adaptRangeDifferenceToZoomLevel=h;this.translateRect=function(a,e,b){return{top:h(a.top-e.top,b),left:h(a.left-e.left,b),bottom:h(a.bottom-e.top,b),right:h(a.right-e.left,b),width:h(a.width,b),height:h(a.height,b)}};this.getBoundingClientRect=function(a){var b=
a.ownerDocument,d=g(),c=b.body;if((!1===d.unscaledRangeClientRects||d.rangeBCRIgnoresElementBCR)&&a.nodeType===Node.ELEMENT_NODE)return a=a.getBoundingClientRect(),d.elementBCRIgnoresBodyScroll?{left:a.left+c.scrollLeft,right:a.right+c.scrollLeft,top:a.top+c.scrollTop,bottom:a.bottom+c.scrollTop,width:a.width,height:a.height}:a;var h;e?h=e:e=h=b.createRange();d=h;d.selectNode(a);return d.getBoundingClientRect()};this.mapKeyValObjOntoNode=function(a,e,b){Object.keys(e).forEach(function(d){var c=d.split(":"),
h=c[1],c=b(c[0]),f=e[d];c?(h=a.getElementsByTagNameNS(c,h)[0],h||(h=a.ownerDocument.createElementNS(c,d),a.appendChild(h)),h.textContent=f):runtime.log("Key ignored: "+d)})};this.removeKeyElementsFromNode=function(a,e,b){e.forEach(function(e){var d=e.split(":"),m=d[1];(d=b(d[0]))?(m=a.getElementsByTagNameNS(d,m)[0])?m.parentNode.removeChild(m):runtime.log("Element for "+e+" not found."):runtime.log("Property Name ignored: "+e)})};this.getKeyValRepresentationOfNode=function(a,e){for(var b={},d=a.firstElementChild,
c;d;){if(c=e(d.namespaceURI))b[c+":"+d.localName]=d.textContent;d=d.nextElementSibling}return b};this.mapObjOntoNode=a;this.cloneEvent=function(a){var e=Object.create(null);Object.keys(a).forEach(function(b){e[b]=a[b]});e.prototype=a.constructor.prototype;return e};this.getDirectChild=k;(function(a){var e,b;b=runtime.getWindow();null!==b&&(e=b.navigator.appVersion.toLowerCase(),b=-1===e.indexOf("chrome")&&(-1!==e.indexOf("applewebkit")||-1!==e.indexOf("safari")),e=-1!==e.indexOf("msie")||-1!==e.indexOf("trident"),
b||e)&&(a.containsNode=f)})(this)};core.DomUtils=new core.DomUtilsImpl})();core.Cursor=function(g,k){function d(a){a.parentNode&&(p.push(a.previousSibling),p.push(a.nextSibling),a.parentNode.removeChild(a))}function b(a,e,b){if(e.nodeType===Node.TEXT_NODE){runtime.assert(Boolean(e),"putCursorIntoTextNode: invalid container");var d=e.parentNode;runtime.assert(Boolean(d),"putCursorIntoTextNode: container without parent");runtime.assert(0<=b&&b<=e.length,"putCursorIntoTextNode: offset is out of bounds");0===b?d.insertBefore(a,e):(b!==e.length&&e.splitText(b),d.insertBefore(a,
e.nextSibling))}else e.nodeType===Node.ELEMENT_NODE&&e.insertBefore(a,e.childNodes.item(b));p.push(a.previousSibling);p.push(a.nextSibling)}var c=g.createElementNS("urn:webodf:names:cursor","cursor"),l=g.createElementNS("urn:webodf:names:cursor","anchor"),n,p=[],q=g.createRange(),f,h=core.DomUtils;this.getNode=function(){return c};this.getAnchorNode=function(){return l.parentNode?l:c};this.getSelectedRange=function(){f?(q.setStartBefore(c),q.collapse(!0)):(q.setStartAfter(n?l:c),q.setEndBefore(n?
c:l));return q};this.setSelectedRange=function(a,e){q&&q!==a&&q.detach();q=a;n=!1!==e;(f=a.collapsed)?(d(l),d(c),b(c,a.startContainer,a.startOffset)):(d(l),d(c),b(n?c:l,a.endContainer,a.endOffset),b(n?l:c,a.startContainer,a.startOffset));p.forEach(h.normalizeTextNodes);p.length=0};this.hasForwardSelection=function(){return n};this.remove=function(){d(c);p.forEach(h.normalizeTextNodes);p.length=0};c.setAttributeNS("urn:webodf:names:cursor","memberId",k);l.setAttributeNS("urn:webodf:names:cursor","memberId",
k)};core.Destroyable=function(){};core.Destroyable.prototype.destroy=function(g){};core.EventSource=function(){};core.EventSource.prototype.subscribe=function(g,k){};core.EventSource.prototype.unsubscribe=function(g,k){};core.EventNotifier=function(g){function k(b){runtime.assert(!d.hasOwnProperty(b),'Duplicated event ids: "'+b+'" registered more than once.');d[b]=[]}var d={};this.emit=function(b,c){var l,g;runtime.assert(d.hasOwnProperty(b),'unknown event fired "'+b+'"');g=d[b];for(l=0;l<g.length;l+=1)g[l](c)};this.subscribe=function(b,c){runtime.assert(d.hasOwnProperty(b),'tried to subscribe to unknown event "'+b+'"');d[b].push(c)};this.unsubscribe=function(b,c){var l;runtime.assert(d.hasOwnProperty(b),'tried to unsubscribe from unknown event "'+
b+'"');l=d[b].indexOf(c);runtime.assert(-1!==l,'tried to unsubscribe unknown callback from event "'+b+'"');-1!==l&&d[b].splice(l,1)};this.register=k;g&&g.forEach(k)};core.ScheduledTask=function(g,k,d){function b(){n&&(d(l),n=!1)}function c(){b();g.apply(void 0,p);p=null}var l,n=!1,p=[],q=!1;this.trigger=function(){runtime.assert(!1===q,"Can't trigger destroyed ScheduledTask instance");p=Array.prototype.slice.call(arguments);n||(n=!0,l=k(c))};this.triggerImmediate=function(){runtime.assert(!1===q,"Can't trigger destroyed ScheduledTask instance");p=Array.prototype.slice.call(arguments);c()};this.processRequests=function(){n&&c()};this.cancel=b;this.restart=function(){runtime.assert(!1===
q,"Can't trigger destroyed ScheduledTask instance");b();n=!0;l=k(c)};this.destroy=function(d){b();q=!0;d()}};(function(){var g;core.Task={};core.Task.SUPPRESS_MANUAL_PROCESSING=!1;core.Task.processTasks=function(){core.Task.SUPPRESS_MANUAL_PROCESSING||g.performRedraw()};core.Task.createRedrawTask=function(k){return new core.ScheduledTask(k,g.requestRedrawTask,g.cancelRedrawTask)};core.Task.createTimeoutTask=function(g,d){return new core.ScheduledTask(g,function(b){return runtime.setTimeout(b,d)},runtime.clearTimeout)};g=new function(){var g={};this.requestRedrawTask=function(d){var b=runtime.requestAnimationFrame(function(){d();
delete g[b]});g[b]=d;return b};this.performRedraw=function(){Object.keys(g).forEach(function(d){g[d]();runtime.cancelAnimationFrame(parseInt(d,10))});g={}};this.cancelRedrawTask=function(d){runtime.cancelAnimationFrame(d);delete g[d]}}})();core.EventSubscriptions=function(){function g(b,c,l){b.subscribe(c,l);d.push({eventSource:b,eventid:c,callback:l})}function k(){var l=[];d.forEach(function(b){b.eventSource.unsubscribe(b.eventid,b.callback)});d.length=0;Object.keys(c).forEach(function(b){c[b].forEach(function(b){l.push(b.task.destroy)});delete c[b]});core.Async.destroyAll(l,function(){});b=new core.EventNotifier}var d=[],b=new core.EventNotifier,c={},l=0;this.addSubscription=g;this.addFrameSubscription=function(d,p,k){var f,h,a,e;
c.hasOwnProperty(p)||(c[p]=[]);a=c[p];for(e=0;e<a.length;e+=1)if(a[e].eventSource===d){f=a[e];break}f||(h="s"+l,l+=1,b.register(h),f={frameEventId:h,eventSource:d,task:core.Task.createRedrawTask(function(){b.emit(h,void 0)})},a.push(f),g(d,p,f.task.trigger));b.subscribe(f.frameEventId,k)};this.unsubscribeAll=k;this.destroy=function(b){k();b()}};core.LazyProperty=function(g){var k,d=!1;this.value=function(){d||(k=g(),d=!0);return k};this.reset=function(){d=!1}};core.LoopWatchDog=function(g,k){var d=Date.now(),b=0;this.check=function(){var c;if(g&&(c=Date.now(),c-d>g))throw runtime.log("alert","watchdog timeout"),"timeout!";if(0<k&&(b+=1,b>k))throw runtime.log("alert","watchdog loop overflow"),"loop overflow";}};core.NodeFilterChain=function(g){var k=NodeFilter.FILTER_REJECT,d=NodeFilter.FILTER_ACCEPT;this.acceptNode=function(b){var c;for(c=0;c<g.length;c+=1)if(g[c].acceptNode(b)===k)return k;return d}};core.PositionIterator=function(g,k,d,b){function c(){this.acceptNode=function(a){return!a||a.nodeType===r&&0===a.length?u:y}}function l(a){this.acceptNode=function(e){return!e||e.nodeType===r&&0===e.length?u:a.acceptNode(e)}}function n(){var e=h.currentNode,b=e.nodeType;a=b===r?e.length-1:b===m?1:0}function p(){if(null===h.previousSibling()){if(!h.parentNode()||h.currentNode===g)return h.firstChild(),!1;a=0}else n();return!0}function q(){var b=h.currentNode,d;d=e(b);if(b!==g)for(b=b.parentNode;b&&
b!==g;)e(b)===u&&(h.currentNode=b,d=u),b=b.parentNode;d===u?(a=h.currentNode.nodeType===r?b.length:1,b=f.nextPosition()):b=d===y?!0:f.nextPosition();b&&runtime.assert(e(h.currentNode)===y,"moveToAcceptedNode did not result in walker being on an accepted node");return b}var f=this,h,a,e,r=Node.TEXT_NODE,m=Node.ELEMENT_NODE,y=NodeFilter.FILTER_ACCEPT,u=NodeFilter.FILTER_REJECT;this.nextPosition=function(){var e=h.currentNode,b=e.nodeType;if(e===g)return!1;if(0===a&&b===m)null===h.firstChild()&&(a=1);
else if(b===r&&a+1<e.length)a+=1;else if(null!==h.nextSibling())a=0;else if(h.parentNode())a=1;else return!1;return!0};this.previousPosition=function(){var e=!0,b=h.currentNode;0===a?e=p():b.nodeType===r?a-=1:null!==h.lastChild()?n():b===g?e=!1:a=0;return e};this.previousNode=p;this.container=function(){var e=h.currentNode,b=e.nodeType;0===a&&b!==r&&(e=e.parentNode);return e};this.rightNode=function(){var b=h.currentNode,d=b.nodeType;if(d===r&&a===b.length)for(b=b.nextSibling;b&&e(b)!==y;)b=b.nextSibling;
else d===m&&1===a&&(b=null);return b};this.leftNode=function(){var b=h.currentNode;if(0===a)for(b=b.previousSibling;b&&e(b)!==y;)b=b.previousSibling;else if(b.nodeType===m)for(b=b.lastChild;b&&e(b)!==y;)b=b.previousSibling;return b};this.getCurrentNode=function(){return h.currentNode};this.unfilteredDomOffset=function(){if(h.currentNode.nodeType===r)return a;for(var e=0,b=h.currentNode,b=1===a?b.lastChild:b.previousSibling;b;)e+=1,b=b.previousSibling;return e};this.getPreviousSibling=function(){var a=
h.currentNode,e=h.previousSibling();h.currentNode=a;return e};this.getNextSibling=function(){var a=h.currentNode,e=h.nextSibling();h.currentNode=a;return e};this.setPositionBeforeElement=function(e){runtime.assert(Boolean(e),"setPositionBeforeElement called without element");h.currentNode=e;a=0;return q()};this.setUnfilteredPosition=function(e,b){runtime.assert(Boolean(e),"PositionIterator.setUnfilteredPosition called without container");h.currentNode=e;e.nodeType===r?(a=b,runtime.assert(b<=e.length,
"Error in setPosition: "+b+" > "+e.length),runtime.assert(0<=b,"Error in setPosition: "+b+" < 0"),b===e.length&&(h.nextSibling()?a=0:h.parentNode()?a=1:runtime.assert(!1,"Error in setUnfilteredPosition: position not valid."))):b<e.childNodes.length?(h.currentNode=e.childNodes.item(b),a=0):a=1;return q()};this.moveToEnd=function(){h.currentNode=g;a=1};this.moveToEndOfNode=function(e){e.nodeType===r?f.setUnfilteredPosition(e,e.length):(h.currentNode=e,a=1)};this.isBeforeNode=function(){return 0===a};
this.getNodeFilter=function(){return e};e=(d?new l(d):new c).acceptNode;e.acceptNode=e;k=k||NodeFilter.SHOW_ALL;runtime.assert(g.nodeType!==Node.TEXT_NODE,"Internet Explorer doesn't allow tree walker roots to be text nodes");h=g.ownerDocument.createTreeWalker(g,k,e,b);a=0;null===h.firstChild()&&(a=1)};core.PositionFilter=function(){};core.PositionFilter.FilterResult={FILTER_ACCEPT:1,FILTER_REJECT:2,FILTER_SKIP:3};core.PositionFilter.prototype.acceptPosition=function(g){};core.PositionFilterChain=function(){var g=[],k=core.PositionFilter.FilterResult.FILTER_ACCEPT,d=core.PositionFilter.FilterResult.FILTER_REJECT;this.acceptPosition=function(b){var c;for(c=0;c<g.length;c+=1)if(g[c].acceptPosition(b)===d)return d;return k};this.addFilter=function(b){g.push(b)}};(function(){core.RawInflate=function(){var g;(function(k){g=k()})(function(){return function d(b,c,l){function g(p,f){if(!c[p]){if(!b[p])throw Error("Cannot find module '"+p+"'");var h=c[p]={exports:{}};b[p][0].call(h.exports,function(a){var e=b[p][1][a];return g(e?e:a)},h,h.exports,d,b,c,l)}return c[p].exports}for(var p=0;p<l.length;p++)g(l[p]);return g}({1:[function(d,b,c){function l(a,e){var b=new r(e);b.push(a,!0);if(b.err)throw b.msg;return b.result}var g=d("./zlib/inflate.js"),p=d("./utils/common"),
q=d("./utils/strings"),f=d("./zlib/constants"),h=d("./zlib/messages"),a=d("./zlib/zstream"),e=d("./zlib/gzheader"),r=function(b){var d=this.options=p.assign({chunkSize:16384,windowBits:0,to:""},b||{});d.raw&&0<=d.windowBits&&16>d.windowBits&&(d.windowBits=-d.windowBits,0===d.windowBits&&(d.windowBits=-15));!(0<=d.windowBits&&16>d.windowBits)||b&&b.windowBits||(d.windowBits+=32);15<d.windowBits&&48>d.windowBits&&0===(d.windowBits&15)&&(d.windowBits|=15);this.err=0;this.msg="";this.ended=!1;this.chunks=
[];this.strm=new a;this.strm.avail_out=0;b=g.inflateInit2(this.strm,d.windowBits);if(b!==f.Z_OK)throw Error(h[b]);this.header=new e;g.inflateGetHeader(this.strm,this.header)};r.prototype.push=function(a,e){var b=this.strm,d=this.options.chunkSize,c,h,r,l,C;if(this.ended)return!1;h=e===~~e?e:!0===e?f.Z_FINISH:f.Z_NO_FLUSH;b.input="string"===typeof a?q.binstring2buf(a):a;b.next_in=0;b.avail_in=b.input.length;do{0===b.avail_out&&(b.output=new p.Buf8(d),b.next_out=0,b.avail_out=d);c=g.inflate(b,f.Z_NO_FLUSH);
if(c!==f.Z_STREAM_END&&c!==f.Z_OK)return this.onEnd(c),this.ended=!0,!1;if(b.next_out&&(0===b.avail_out||c===f.Z_STREAM_END||0===b.avail_in&&h===f.Z_FINISH))if("string"===this.options.to)r=q.utf8border(b.output,b.next_out),l=b.next_out-r,C=q.buf2string(b.output,r),b.next_out=l,b.avail_out=d-l,l&&p.arraySet(b.output,b.output,r,l,0),this.onData(C);else this.onData(p.shrinkBuf(b.output,b.next_out))}while((0<b.avail_in||0===b.avail_out)&&c!==f.Z_STREAM_END);c===f.Z_STREAM_END&&(h=f.Z_FINISH);return h===
f.Z_FINISH?(c=g.inflateEnd(this.strm),this.onEnd(c),this.ended=!0,c===f.Z_OK):!0};r.prototype.onData=function(a){this.chunks.push(a)};r.prototype.onEnd=function(a){a===f.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):p.flattenChunks(this.chunks));this.chunks=[];this.err=a;this.msg=this.strm.msg};c.Inflate=r;c.inflate=l;c.inflateRaw=function(a,e){e=e||{};e.raw=!0;return l(a,e)};c.ungzip=l},{"./utils/common":2,"./utils/strings":3,"./zlib/constants":5,"./zlib/gzheader":7,"./zlib/inflate.js":9,
"./zlib/messages":11,"./zlib/zstream":12}],2:[function(d,b,c){d="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Int32Array;c.assign=function(b){for(var d=Array.prototype.slice.call(arguments,1);d.length;){var c=d.shift();if(c){if("object"!==typeof c)throw new TypeError(c+"must be non-object");for(var h in c)c.hasOwnProperty(h)&&(b[h]=c[h])}}return b};c.shrinkBuf=function(b,d){if(b.length===d)return b;if(b.subarray)return b.subarray(0,d);b.length=d;return b};
var l={arraySet:function(b,d,c,h,a){if(d.subarray&&b.subarray)b.set(d.subarray(c,c+h),a);else for(var e=0;e<h;e++)b[a+e]=d[c+e]},flattenChunks:function(b){var d,c,h,a,e;d=h=0;for(c=b.length;d<c;d++)h+=b[d].length;e=new Uint8Array(h);d=h=0;for(c=b.length;d<c;d++)a=b[d],e.set(a,h),h+=a.length;return e}},g={arraySet:function(b,d,c,h,a){for(var e=0;e<h;e++)b[a+e]=d[c+e]},flattenChunks:function(b){return[].concat.apply([],b)}};c.setTyped=function(b){b?(c.Buf8=Uint8Array,c.Buf16=Uint16Array,c.Buf32=Int32Array,
c.assign(c,l)):(c.Buf8=Array,c.Buf16=Array,c.Buf32=Array,c.assign(c,g))};c.setTyped(d)},{}],3:[function(d,b,c){function l(a,b){if(65537>b&&(a.subarray&&q||!a.subarray&&p))return String.fromCharCode.apply(null,g.shrinkBuf(a,b));for(var d="",c=0;c<b;c++)d+=String.fromCharCode(a[c]);return d}var g=d("./common"),p=!0,q=!0;try{String.fromCharCode.apply(null,[0])}catch(f){p=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(h){q=!1}var a=new g.Buf8(256);for(d=0;256>d;d++)a[d]=252<=d?6:248<=
d?5:240<=d?4:224<=d?3:192<=d?2:1;a[254]=a[254]=1;c.string2buf=function(a){var b,d,c,h,f,l=a.length,p=0;for(h=0;h<l;h++)d=a.charCodeAt(h),55296===(d&64512)&&h+1<l&&(c=a.charCodeAt(h+1),56320===(c&64512)&&(d=65536+(d-55296<<10)+(c-56320),h++)),p+=128>d?1:2048>d?2:65536>d?3:4;b=new g.Buf8(p);for(h=f=0;f<p;h++)d=a.charCodeAt(h),55296===(d&64512)&&h+1<l&&(c=a.charCodeAt(h+1),56320===(c&64512)&&(d=65536+(d-55296<<10)+(c-56320),h++)),128>d?b[f++]=d:(2048>d?b[f++]=192|d>>>6:(65536>d?b[f++]=224|d>>>12:(b[f++]=
240|d>>>18,b[f++]=128|d>>>12&63),b[f++]=128|d>>>6&63),b[f++]=128|d&63);return b};c.buf2binstring=function(a){return l(a,a.length)};c.binstring2buf=function(a){for(var b=new g.Buf8(a.length),d=0,c=b.length;d<c;d++)b[d]=a.charCodeAt(d);return b};c.buf2string=function(e,b){var d,c,h,f,g=b||e.length,p=Array(2*g);for(d=c=0;d<g;)if(h=e[d++],128>h)p[c++]=h;else if(f=a[h],4<f)p[c++]=65533,d+=f-1;else{for(h&=2===f?31:3===f?15:7;1<f&&d<g;)h=h<<6|e[d++]&63,f--;1<f?p[c++]=65533:65536>h?p[c++]=h:(h-=65536,p[c++]=
55296|h>>10&1023,p[c++]=56320|h&1023)}return l(p,c)};c.utf8border=function(e,b){var d;b=b||e.length;b>e.length&&(b=e.length);for(d=b-1;0<=d&&128===(e[d]&192);)d--;return 0>d||0===d?b:d+a[e[d]]>b?d:b}},{"./common":2}],4:[function(d,b,c){b.exports=function(b,d,c,g){var f=b&65535|0;b=b>>>16&65535|0;for(var h=0;0!==c;){h=2E3<c?2E3:c;c-=h;do f=f+d[g++]|0,b=b+f|0;while(--h);f%=65521;b%=65521}return f|b<<16|0}},{}],5:[function(d,b,c){b.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,
Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],6:[function(d,b,c){var l=function(){for(var b,d=[],c=0;256>c;c++){b=c;for(var f=0;8>f;f++)b=b&1?3988292384^b>>>1:b>>>1;d[c]=b}return d}();b.exports=function(b,d,c,f){c=f+c;for(b^=
-1;f<c;f++)b=b>>>8^l[(b^d[f])&255];return b^-1}},{}],7:[function(d,b,c){b.exports=function(){this.os=this.xflags=this.time=this.text=0;this.extra=null;this.extra_len=0;this.comment=this.name="";this.hcrc=0;this.done=!1}},{}],8:[function(d,b,c){b.exports=function(b,d){var c,g,f,h,a,e,r,m,y,u,z,t,s,x,w,C,G,B,E,J,I,U,Q,A;c=b.state;g=b.next_in;Q=b.input;f=g+(b.avail_in-5);h=b.next_out;A=b.output;a=h-(d-b.avail_out);e=h+(b.avail_out-257);r=c.dmax;m=c.wsize;y=c.whave;u=c.wnext;z=c.window;t=c.hold;s=c.bits;
x=c.lencode;w=c.distcode;C=(1<<c.lenbits)-1;G=(1<<c.distbits)-1;a:do b:for(15>s&&(t+=Q[g++]<<s,s+=8,t+=Q[g++]<<s,s+=8),B=x[t&C];;){E=B>>>24;t>>>=E;s-=E;E=B>>>16&255;if(0===E)A[h++]=B&65535;else if(E&16){J=B&65535;if(E&=15)s<E&&(t+=Q[g++]<<s,s+=8),J+=t&(1<<E)-1,t>>>=E,s-=E;15>s&&(t+=Q[g++]<<s,s+=8,t+=Q[g++]<<s,s+=8);B=w[t&G];c:for(;;){E=B>>>24;t>>>=E;s-=E;E=B>>>16&255;if(E&16){B&=65535;E&=15;s<E&&(t+=Q[g++]<<s,s+=8,s<E&&(t+=Q[g++]<<s,s+=8));B+=t&(1<<E)-1;if(B>r){b.msg="invalid distance too far back";
c.mode=30;break a}t>>>=E;s-=E;E=h-a;if(B>E){E=B-E;if(E>y&&c.sane){b.msg="invalid distance too far back";c.mode=30;break a}I=0;U=z;if(0===u){if(I+=m-E,E<J){J-=E;do A[h++]=z[I++];while(--E);I=h-B;U=A}}else if(u<E){if(I+=m+u-E,E-=u,E<J){J-=E;do A[h++]=z[I++];while(--E);I=0;if(u<J){E=u;J-=E;do A[h++]=z[I++];while(--E);I=h-B;U=A}}}else if(I+=u-E,E<J){J-=E;do A[h++]=z[I++];while(--E);I=h-B;U=A}for(;2<J;)A[h++]=U[I++],A[h++]=U[I++],A[h++]=U[I++],J-=3;J&&(A[h++]=U[I++],1<J&&(A[h++]=U[I++]))}else{I=h-B;do A[h++]=
A[I++],A[h++]=A[I++],A[h++]=A[I++],J-=3;while(2<J);J&&(A[h++]=A[I++],1<J&&(A[h++]=A[I++]))}}else if(0===(E&64)){B=w[(B&65535)+(t&(1<<E)-1)];continue c}else{b.msg="invalid distance code";c.mode=30;break a}break}}else if(0===(E&64)){B=x[(B&65535)+(t&(1<<E)-1)];continue b}else{E&32?c.mode=12:(b.msg="invalid literal/length code",c.mode=30);break a}break}while(g<f&&h<e);J=s>>3;g-=J;s-=J<<3;b.next_in=g;b.next_out=h;b.avail_in=g<f?5+(f-g):5-(g-f);b.avail_out=h<e?257+(e-h):257-(h-e);c.hold=t&(1<<s)-1;c.bits=
s}},{}],9:[function(d,b,c){function g(a){return(a>>>24&255)+(a>>>8&65280)+((a&65280)<<8)+((a&255)<<24)}function n(){this.mode=0;this.last=!1;this.wrap=0;this.havedict=!1;this.total=this.check=this.dmax=this.flags=0;this.head=null;this.wnext=this.whave=this.wsize=this.wbits=0;this.window=null;this.extra=this.offset=this.length=this.bits=this.hold=0;this.distcode=this.lencode=null;this.have=this.ndist=this.nlen=this.ncode=this.distbits=this.lenbits=0;this.next=null;this.lens=new a.Buf16(320);this.work=
new a.Buf16(288);this.distdyn=this.lendyn=null;this.was=this.back=this.sane=0}function p(e){var b;if(!e||!e.state)return z;b=e.state;e.total_in=e.total_out=b.total=0;e.msg="";b.wrap&&(e.adler=b.wrap&1);b.mode=t;b.last=0;b.havedict=0;b.dmax=32768;b.head=null;b.hold=0;b.bits=0;b.lencode=b.lendyn=new a.Buf32(s);b.distcode=b.distdyn=new a.Buf32(x);b.sane=1;b.back=-1;return u}function q(a){var e;if(!a||!a.state)return z;e=a.state;e.wsize=0;e.whave=0;e.wnext=0;return p(a)}function f(a,e){var b,d;if(!a||
!a.state)return z;d=a.state;0>e?(b=0,e=-e):(b=(e>>4)+1,48>e&&(e&=15));if(e&&(8>e||15<e))return z;null!==d.window&&d.wbits!==e&&(d.window=null);d.wrap=b;d.wbits=e;return q(a)}function h(a,e){var b;if(!a)return z;b=new n;a.state=b;b.window=null;b=f(a,e);b!==u&&(a.state=null);return b}var a=d("../utils/common"),e=d("./adler32"),r=d("./crc32"),m=d("./inffast"),y=d("./inftrees"),u=0,z=-2,t=1,s=852,x=592,w=!0,C,G;c.inflateReset=q;c.inflateReset2=f;c.inflateResetKeep=p;c.inflateInit=function(a){return h(a,
15)};c.inflateInit2=h;c.inflate=function(b,d){var c,h,f,p,A,n,q,v,s,x,P,F,N,$;F=0;var D,V,aa,ca,T,W=new a.Buf8(4),O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!b||!b.state||!b.output||!b.input&&0!==b.avail_in)return z;c=b.state;12===c.mode&&(c.mode=13);A=b.next_out;f=b.output;q=b.avail_out;p=b.next_in;h=b.input;n=b.avail_in;v=c.hold;s=c.bits;x=n;P=q;T=u;a:for(;;)switch(c.mode){case t:if(0===c.wrap){c.mode=13;break}for(;16>s;){if(0===n)break a;n--;v+=h[p++]<<s;s+=8}if(c.wrap&2&&35615===v){c.check=
0;W[0]=v&255;W[1]=v>>>8&255;c.check=r(c.check,W,2,0);s=v=0;c.mode=2;break}c.flags=0;c.head&&(c.head.done=!1);if(!(c.wrap&1)||(((v&255)<<8)+(v>>8))%31){b.msg="incorrect header check";c.mode=30;break}if(8!==(v&15)){b.msg="unknown compression method";c.mode=30;break}v>>>=4;s-=4;N=(v&15)+8;if(0===c.wbits)c.wbits=N;else if(N>c.wbits){b.msg="invalid window size";c.mode=30;break}c.dmax=1<<N;b.adler=c.check=1;c.mode=v&512?10:12;s=v=0;break;case 2:for(;16>s;){if(0===n)break a;n--;v+=h[p++]<<s;s+=8}c.flags=
v;if(8!==(c.flags&255)){b.msg="unknown compression method";c.mode=30;break}if(c.flags&57344){b.msg="unknown header flags set";c.mode=30;break}c.head&&(c.head.text=v>>8&1);c.flags&512&&(W[0]=v&255,W[1]=v>>>8&255,c.check=r(c.check,W,2,0));s=v=0;c.mode=3;case 3:for(;32>s;){if(0===n)break a;n--;v+=h[p++]<<s;s+=8}c.head&&(c.head.time=v);c.flags&512&&(W[0]=v&255,W[1]=v>>>8&255,W[2]=v>>>16&255,W[3]=v>>>24&255,c.check=r(c.check,W,4,0));s=v=0;c.mode=4;case 4:for(;16>s;){if(0===n)break a;n--;v+=h[p++]<<s;s+=
8}c.head&&(c.head.xflags=v&255,c.head.os=v>>8);c.flags&512&&(W[0]=v&255,W[1]=v>>>8&255,c.check=r(c.check,W,2,0));s=v=0;c.mode=5;case 5:if(c.flags&1024){for(;16>s;){if(0===n)break a;n--;v+=h[p++]<<s;s+=8}c.length=v;c.head&&(c.head.extra_len=v);c.flags&512&&(W[0]=v&255,W[1]=v>>>8&255,c.check=r(c.check,W,2,0));s=v=0}else c.head&&(c.head.extra=null);c.mode=6;case 6:if(c.flags&1024&&(F=c.length,F>n&&(F=n),F&&(c.head&&(N=c.head.extra_len-c.length,c.head.extra||(c.head.extra=Array(c.head.extra_len)),a.arraySet(c.head.extra,
h,p,F,N)),c.flags&512&&(c.check=r(c.check,h,F,p)),n-=F,p+=F,c.length-=F),c.length))break a;c.length=0;c.mode=7;case 7:if(c.flags&2048){if(0===n)break a;F=0;do N=h[p+F++],c.head&&N&&65536>c.length&&(c.head.name+=String.fromCharCode(N));while(N&&F<n);c.flags&512&&(c.check=r(c.check,h,F,p));n-=F;p+=F;if(N)break a}else c.head&&(c.head.name=null);c.length=0;c.mode=8;case 8:if(c.flags&4096){if(0===n)break a;F=0;do N=h[p+F++],c.head&&N&&65536>c.length&&(c.head.comment+=String.fromCharCode(N));while(N&&F<
n);c.flags&512&&(c.check=r(c.check,h,F,p));n-=F;p+=F;if(N)break a}else c.head&&(c.head.comment=null);c.mode=9;case 9:if(c.flags&512){for(;16>s;){if(0===n)break a;n--;v+=h[p++]<<s;s+=8}if(v!==(c.check&65535)){b.msg="header crc mismatch";c.mode=30;break}s=v=0}c.head&&(c.head.hcrc=c.flags>>9&1,c.head.done=!0);b.adler=c.check=0;c.mode=12;break;case 10:for(;32>s;){if(0===n)break a;n--;v+=h[p++]<<s;s+=8}b.adler=c.check=g(v);s=v=0;c.mode=11;case 11:if(0===c.havedict)return b.next_out=A,b.avail_out=q,b.next_in=
p,b.avail_in=n,c.hold=v,c.bits=s,2;b.adler=c.check=1;c.mode=12;case 12:if(5===d||6===d)break a;case 13:if(c.last){v>>>=s&7;s-=s&7;c.mode=27;break}for(;3>s;){if(0===n)break a;n--;v+=h[p++]<<s;s+=8}c.last=v&1;v>>>=1;s-=1;switch(v&3){case 0:c.mode=14;break;case 1:F=c;if(w){N=void 0;C=new a.Buf32(512);G=new a.Buf32(32);for(N=0;144>N;)F.lens[N++]=8;for(;256>N;)F.lens[N++]=9;for(;280>N;)F.lens[N++]=7;for(;288>N;)F.lens[N++]=8;y(1,F.lens,0,288,C,0,F.work,{bits:9});for(N=0;32>N;)F.lens[N++]=5;y(2,F.lens,
0,32,G,0,F.work,{bits:5});w=!1}F.lencode=C;F.lenbits=9;F.distcode=G;F.distbits=5;c.mode=20;if(6===d){v>>>=2;s-=2;break a}break;case 2:c.mode=17;break;case 3:b.msg="invalid block type",c.mode=30}v>>>=2;s-=2;break;case 14:v>>>=s&7;for(s-=s&7;32>s;){if(0===n)break a;n--;v+=h[p++]<<s;s+=8}if((v&65535)!==(v>>>16^65535)){b.msg="invalid stored block lengths";c.mode=30;break}c.length=v&65535;s=v=0;c.mode=15;if(6===d)break a;case 15:c.mode=16;case 16:if(F=c.length){F>n&&(F=n);F>q&&(F=q);if(0===F)break a;a.arraySet(f,
h,p,F,A);n-=F;p+=F;q-=F;A+=F;c.length-=F;break}c.mode=12;break;case 17:for(;14>s;){if(0===n)break a;n--;v+=h[p++]<<s;s+=8}c.nlen=(v&31)+257;v>>>=5;s-=5;c.ndist=(v&31)+1;v>>>=5;s-=5;c.ncode=(v&15)+4;v>>>=4;s-=4;if(286<c.nlen||30<c.ndist){b.msg="too many length or distance symbols";c.mode=30;break}c.have=0;c.mode=18;case 18:for(;c.have<c.ncode;){for(;3>s;){if(0===n)break a;n--;v+=h[p++]<<s;s+=8}c.lens[O[c.have++]]=v&7;v>>>=3;s-=3}for(;19>c.have;)c.lens[O[c.have++]]=0;c.lencode=c.lendyn;c.lenbits=7;
F={bits:c.lenbits};T=y(0,c.lens,0,19,c.lencode,0,c.work,F);c.lenbits=F.bits;if(T){b.msg="invalid code lengths set";c.mode=30;break}c.have=0;c.mode=19;case 19:for(;c.have<c.nlen+c.ndist;){for(;;){F=c.lencode[v&(1<<c.lenbits)-1];D=F>>>24;V=F>>>16&255;aa=F&65535;if(D<=s)break;if(0===n)break a;n--;v+=h[p++]<<s;s+=8}if(16>aa)v>>>=D,s-=D,c.lens[c.have++]=aa;else{if(16===aa){for(F=D+2;s<F;){if(0===n)break a;n--;v+=h[p++]<<s;s+=8}v>>>=D;s-=D;if(0===c.have){b.msg="invalid bit length repeat";c.mode=30;break}N=
c.lens[c.have-1];F=3+(v&3);v>>>=2;s-=2}else if(17===aa){for(F=D+3;s<F;){if(0===n)break a;n--;v+=h[p++]<<s;s+=8}v>>>=D;s-=D;N=0;F=3+(v&7);v>>>=3;s-=3}else{for(F=D+7;s<F;){if(0===n)break a;n--;v+=h[p++]<<s;s+=8}v>>>=D;s-=D;N=0;F=11+(v&127);v>>>=7;s-=7}if(c.have+F>c.nlen+c.ndist){b.msg="invalid bit length repeat";c.mode=30;break}for(;F--;)c.lens[c.have++]=N}}if(30===c.mode)break;if(0===c.lens[256]){b.msg="invalid code -- missing end-of-block";c.mode=30;break}c.lenbits=9;F={bits:c.lenbits};T=y(1,c.lens,
0,c.nlen,c.lencode,0,c.work,F);c.lenbits=F.bits;if(T){b.msg="invalid literal/lengths set";c.mode=30;break}c.distbits=6;c.distcode=c.distdyn;F={bits:c.distbits};T=y(2,c.lens,c.nlen,c.ndist,c.distcode,0,c.work,F);c.distbits=F.bits;if(T){b.msg="invalid distances set";c.mode=30;break}c.mode=20;if(6===d)break a;case 20:c.mode=21;case 21:if(6<=n&&258<=q){b.next_out=A;b.avail_out=q;b.next_in=p;b.avail_in=n;c.hold=v;c.bits=s;m(b,P);A=b.next_out;f=b.output;q=b.avail_out;p=b.next_in;h=b.input;n=b.avail_in;
v=c.hold;s=c.bits;12===c.mode&&(c.back=-1);break}for(c.back=0;;){F=c.lencode[v&(1<<c.lenbits)-1];D=F>>>24;V=F>>>16&255;aa=F&65535;if(D<=s)break;if(0===n)break a;n--;v+=h[p++]<<s;s+=8}if(V&&0===(V&240)){N=D;$=V;for(ca=aa;;){F=c.lencode[ca+((v&(1<<N+$)-1)>>N)];D=F>>>24;V=F>>>16&255;aa=F&65535;if(N+D<=s)break;if(0===n)break a;n--;v+=h[p++]<<s;s+=8}v>>>=N;s-=N;c.back+=N}v>>>=D;s-=D;c.back+=D;c.length=aa;if(0===V){c.mode=26;break}if(V&32){c.back=-1;c.mode=12;break}if(V&64){b.msg="invalid literal/length code";
c.mode=30;break}c.extra=V&15;c.mode=22;case 22:if(c.extra){for(F=c.extra;s<F;){if(0===n)break a;n--;v+=h[p++]<<s;s+=8}c.length+=v&(1<<c.extra)-1;v>>>=c.extra;s-=c.extra;c.back+=c.extra}c.was=c.length;c.mode=23;case 23:for(;;){F=c.distcode[v&(1<<c.distbits)-1];D=F>>>24;V=F>>>16&255;aa=F&65535;if(D<=s)break;if(0===n)break a;n--;v+=h[p++]<<s;s+=8}if(0===(V&240)){N=D;$=V;for(ca=aa;;){F=c.distcode[ca+((v&(1<<N+$)-1)>>N)];D=F>>>24;V=F>>>16&255;aa=F&65535;if(N+D<=s)break;if(0===n)break a;n--;v+=h[p++]<<
s;s+=8}v>>>=N;s-=N;c.back+=N}v>>>=D;s-=D;c.back+=D;if(V&64){b.msg="invalid distance code";c.mode=30;break}c.offset=aa;c.extra=V&15;c.mode=24;case 24:if(c.extra){for(F=c.extra;s<F;){if(0===n)break a;n--;v+=h[p++]<<s;s+=8}c.offset+=v&(1<<c.extra)-1;v>>>=c.extra;s-=c.extra;c.back+=c.extra}if(c.offset>c.dmax){b.msg="invalid distance too far back";c.mode=30;break}c.mode=25;case 25:if(0===q)break a;F=P-q;if(c.offset>F){F=c.offset-F;if(F>c.whave&&c.sane){b.msg="invalid distance too far back";c.mode=30;break}F>
c.wnext?(F-=c.wnext,N=c.wsize-F):N=c.wnext-F;F>c.length&&(F=c.length);$=c.window}else $=f,N=A-c.offset,F=c.length;F>q&&(F=q);q-=F;c.length-=F;do f[A++]=$[N++];while(--F);0===c.length&&(c.mode=21);break;case 26:if(0===q)break a;f[A++]=c.length;q--;c.mode=21;break;case 27:if(c.wrap){for(;32>s;){if(0===n)break a;n--;v|=h[p++]<<s;s+=8}P-=q;b.total_out+=P;c.total+=P;P&&(b.adler=c.check=c.flags?r(c.check,f,P,A-P):e(c.check,f,P,A-P));P=q;if((c.flags?v:g(v))!==c.check){b.msg="incorrect data check";c.mode=
30;break}s=v=0}c.mode=28;case 28:if(c.wrap&&c.flags){for(;32>s;){if(0===n)break a;n--;v+=h[p++]<<s;s+=8}if(v!==(c.total&4294967295)){b.msg="incorrect length check";c.mode=30;break}s=v=0}c.mode=29;case 29:T=1;break a;case 30:T=-3;break a;case 31:return-4;default:return z}b.next_out=A;b.avail_out=q;b.next_in=p;b.avail_in=n;c.hold=v;c.bits=s;if(c.wsize||P!==b.avail_out&&30>c.mode&&(27>c.mode||4!==d))h=b.output,p=b.next_out,A=P-b.avail_out,q=b.state,null===q.window&&(q.wsize=1<<q.wbits,q.wnext=0,q.whave=
0,q.window=new a.Buf8(q.wsize)),A>=q.wsize?(a.arraySet(q.window,h,p-q.wsize,q.wsize,0),q.wnext=0,q.whave=q.wsize):(n=q.wsize-q.wnext,n>A&&(n=A),a.arraySet(q.window,h,p-A,n,q.wnext),(A-=n)?(a.arraySet(q.window,h,p-A,A,0),q.wnext=A,q.whave=q.wsize):(q.wnext+=n,q.wnext===q.wsize&&(q.wnext=0),q.whave<q.wsize&&(q.whave+=n)));x-=b.avail_in;P-=b.avail_out;b.total_in+=x;b.total_out+=P;c.total+=P;c.wrap&&P&&(b.adler=c.check=c.flags?r(c.check,f,P,b.next_out-P):e(c.check,f,P,b.next_out-P));b.data_type=c.bits+
(c.last?64:0)+(12===c.mode?128:0)+(20===c.mode||15===c.mode?256:0);(0===x&&0===P||4===d)&&T===u&&(T=-5);return T};c.inflateEnd=function(a){if(!a||!a.state)return z;var e=a.state;e.window&&(e.window=null);a.state=null;return u};c.inflateGetHeader=function(a,e){var b;if(!a||!a.state)return z;b=a.state;if(0===(b.wrap&2))return z;b.head=e;e.done=!1;return u};c.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":2,"./adler32":4,"./crc32":6,"./inffast":8,"./inftrees":10}],10:[function(d,
b,c){var g=d("../utils/common"),n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],p=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],q=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],f=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];b.exports=function(b,a,e,c,d,y,u,z){for(var t=z.bits,s=0,x=
0,w=0,C=0,G=0,B=0,E=0,J=0,I=0,U=0,Q,A,Z=null,S=0,v,H=new g.Buf16(16),B=new g.Buf16(16),ba=null,P=0,F,N,$,s=0;15>=s;s++)H[s]=0;for(x=0;x<c;x++)H[a[e+x]]++;G=t;for(C=15;1<=C&&0===H[C];C--);G>C&&(G=C);if(0===C)return d[y++]=20971520,d[y++]=20971520,z.bits=1,0;for(w=1;w<C&&0===H[w];w++);G<w&&(G=w);for(s=J=1;15>=s;s++)if(J<<=1,J-=H[s],0>J)return-1;if(0<J&&(0===b||1!==C))return-1;B[1]=0;for(s=1;15>s;s++)B[s+1]=B[s]+H[s];for(x=0;x<c;x++)0!==a[e+x]&&(u[B[a[e+x]]++]=x);switch(b){case 0:Z=ba=u;v=19;break;case 1:Z=
n;S-=257;ba=p;P-=257;v=256;break;default:Z=q,ba=f,v=-1}x=U=0;s=w;t=y;B=G;E=0;A=-1;I=1<<G;c=I-1;if(1===b&&852<I||2===b&&592<I)return 1;for(var D=0;;){D++;F=s-E;u[x]<v?(N=0,$=u[x]):u[x]>v?(N=ba[P+u[x]],$=Z[S+u[x]]):(N=96,$=0);J=1<<s-E;w=Q=1<<B;do Q-=J,d[t+(U>>E)+Q]=F<<24|N<<16|$|0;while(0!==Q);for(J=1<<s-1;U&J;)J>>=1;0!==J?(U&=J-1,U+=J):U=0;x++;if(0===--H[s]){if(s===C)break;s=a[e+u[x]]}if(s>G&&(U&c)!==A){0===E&&(E=G);t+=w;B=s-E;for(J=1<<B;B+E<C;){J-=H[B+E];if(0>=J)break;B++;J<<=1}I+=1<<B;if(1===b&&
852<I||2===b&&592<I)return 1;A=U&c;d[A]=G<<24|B<<16|t-y|0}}0!==U&&(d[t+U]=s-E<<24|4194304);z.bits=G;return 0}},{"../utils/common":2}],11:[function(d,b,c){b.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],12:[function(d,b,c){b.exports=function(){this.input=null;this.total_in=this.avail_in=this.next_in=0;this.output=null;this.total_out=this.avail_out=this.next_out=
0;this.msg="";this.state=null;this.data_type=2;this.adler=0}},{}]},{},[1])(1)});return{inflate:function(k,d){return g.inflateRaw(k)}}}()})();core.StepDirection={PREVIOUS:1,NEXT:2};core.StepIterator=function(g,k){function d(){a=null;r=e=void 0}function b(){void 0===r&&(r=g.acceptPosition(k)===f);return r}function c(a,e){d();return k.setUnfilteredPosition(a,e)}function l(){a||(a=k.container());return a}function n(){void 0===e&&(e=k.unfilteredDomOffset());return e}function p(){for(d();k.nextPosition();)if(d(),b())return!0;return!1}function q(){for(d();k.previousPosition();)if(d(),b())return!0;return!1}var f=core.PositionFilter.FilterResult.FILTER_ACCEPT,h=core.StepDirection.NEXT,
a,e,r;this.isStep=b;this.setPosition=c;this.container=l;this.offset=n;this.nextStep=p;this.previousStep=q;this.advanceStep=function(a){return a===h?p():q()};this.roundToClosestStep=function(){var a,e,d=b();d||(a=l(),e=n(),d=q(),d||(c(a,e),d=p()));return d};this.roundToPreviousStep=function(){var a=b();a||(a=q());return a};this.roundToNextStep=function(){var a=b();a||(a=p());return a};this.leftNode=function(){return k.leftNode()};this.snapshot=function(){return new core.StepIterator.StepSnapshot(l(),
n())};this.restore=function(a){c(a.container,a.offset)}};core.StepIterator.StepSnapshot=function(g,k){this.container=g;this.offset=k};core.Utils=function(){function g(k,d){if(d&&Array.isArray(d)){k=k||[];if(!Array.isArray(k))throw"Destination is not an array.";k=k.concat(d.map(function(b){return g(null,b)}))}else if(d&&"object"===typeof d){k=k||{};if("object"!==typeof k)throw"Destination is not an object.";Object.keys(d).forEach(function(b){k[b]=g(k[b],d[b])})}else k=d;return k}this.hashString=function(g){var d=0,b,c;b=0;for(c=g.length;b<c;b+=1)d=(d<<5)-d+g.charCodeAt(b),d|=0;return d};this.mergeObjects=function(k,d){Object.keys(d).forEach(function(b){k[b]=
g(k[b],d[b])});return k}};core.Zip=function(g,k){function d(a,e,b){y?b(null,y.subarray(a,a+e)):b("File data not loaded",null)}function b(a){var e=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,
1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,
1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,
1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,
628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,
3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918E3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],b,c,d=a.length,h=0,h=0;b=-1;for(c=0;c<d;c+=1)h=(b^a[c])&255,h=e[h],b=b>>>8^h;return b^-1}function c(a){return new Date((a>>25&127)+1980,(a>>21&15)-1,a>>16&31,a>>11&15,
a>>5&63,(a&31)<<1)}function l(a){var e=a.getFullYear();return 1980>e?0:e-1980<<25|a.getMonth()+1<<21|a.getDate()<<16|a.getHours()<<11|a.getMinutes()<<5|a.getSeconds()>>1}function n(a,e){var b,h,m,f,r,g,l,n=this;this.load=function(e){if(null!==n.data)e(null,n.data);else{var b=r+34+h+m+256;b+l>u&&(b=u-l);d(l,b,function(b,c){if(b||null===c)e(b,c);else a:{var d=c,h=new core.ByteArray(d),m=h.readUInt32LE(),l;if(67324752!==m)e("File entry signature is wrong."+m.toString()+" "+d.length.toString(),null);
else{h.pos+=22;m=h.readUInt16LE();l=h.readUInt16LE();h.pos+=m+l;if(f){d=d.subarray(h.pos,h.pos+r);if(r!==d.length){e("The amount of compressed bytes read was "+d.length.toString()+" instead of "+r.toString()+" for "+n.filename+" in "+a+".",null);break a}d=t(d,g)}else d=d.subarray(h.pos,h.pos+g);g!==d.length?e("The amount of bytes read was "+d.length.toString()+" instead of "+g.toString()+" for "+n.filename+" in "+a+".",null):(n.data=d,e(null,d))}}})}};this.set=function(a,e,b,c){n.filename=a;n.data=
e;n.compressed=b;n.date=c};this.error=null;e&&(b=e.readUInt32LE(),33639248!==b?this.error="Central directory entry has wrong signature at position "+(e.pos-4).toString()+' for file "'+a+'": '+e.data.length.toString():(e.pos+=6,f=e.readUInt16LE(),this.date=c(e.readUInt32LE()),e.readUInt32LE(),r=e.readUInt32LE(),g=e.readUInt32LE(),h=e.readUInt16LE(),m=e.readUInt16LE(),b=e.readUInt16LE(),e.pos+=8,l=e.readUInt32LE(),this.filename=runtime.byteArrayToString(e.data.subarray(e.pos,e.pos+h),"utf8"),this.data=
null,e.pos+=h+m+b))}function p(a,e){if(22!==a.length)e("Central directory length should be 22.",s);else{var b=new core.ByteArray(a),c;c=b.readUInt32LE();101010256!==c?e("Central directory signature is wrong: "+c.toString(),s):(c=b.readUInt16LE(),0!==c?e("Zip files with non-zero disk numbers are not supported.",s):(c=b.readUInt16LE(),0!==c?e("Zip files with non-zero disk numbers are not supported.",s):(c=b.readUInt16LE(),z=b.readUInt16LE(),c!==z?e("Number of entries is inconsistent.",s):(c=b.readUInt32LE(),
b=b.readUInt16LE(),b=u-22-c,d(b,u-b,function(a,b){if(a||null===b)e(a,s);else a:{var c=new core.ByteArray(b),d,h;m=[];for(d=0;d<z;d+=1){h=new n(g,c);if(h.error){e(h.error,s);break a}m[m.length]=h}e(null,s)}})))))}}function q(a,e){var b=null,c,d;for(d=0;d<m.length;d+=1)if(c=m[d],c.filename===a){b=c;break}b?b.data?e(null,b.data):b.load(e):e(a+" not found.",null)}function f(a){var e=new core.ByteArrayWriter("utf8"),c=0;e.appendArray([80,75,3,4,20,0,0,0,0,0]);a.data&&(c=a.data.length);e.appendUInt32LE(l(a.date));
e.appendUInt32LE(a.data?b(a.data):0);e.appendUInt32LE(c);e.appendUInt32LE(c);e.appendUInt16LE(a.filename.length);e.appendUInt16LE(0);e.appendString(a.filename);a.data&&e.appendByteArray(a.data);return e}function h(a,e){var c=new core.ByteArrayWriter("utf8"),d=0;c.appendArray([80,75,1,2,20,0,20,0,0,0,0,0]);a.data&&(d=a.data.length);c.appendUInt32LE(l(a.date));c.appendUInt32LE(a.data?b(a.data):0);c.appendUInt32LE(d);c.appendUInt32LE(d);c.appendUInt16LE(a.filename.length);c.appendArray([0,0,0,0,0,0,
0,0,0,0,0,0]);c.appendUInt32LE(e);c.appendString(a.filename);return c}function a(e,b){if(e===m.length)b(null);else{var c=m[e];null!==c.data?a(e+1,b):c.load(function(c){c?b(c):a(e+1,b)})}}function e(e,b){a(0,function(a){if(a)b(a);else{var c,d,r=new core.ByteArrayWriter("utf8"),g=[0];for(c=0;c<m.length;c+=1)r.appendByteArrayWriter(f(m[c])),g.push(r.getLength());a=r.getLength();for(c=0;c<m.length;c+=1)d=m[c],r.appendByteArrayWriter(h(d,g[c]));c=r.getLength()-a;r.appendArray([80,75,5,6,0,0,0,0]);r.appendUInt16LE(m.length);
r.appendUInt16LE(m.length);r.appendUInt32LE(c);r.appendUInt32LE(a);r.appendArray([0,0]);e(r.getByteArray())}})}function r(a,b){e(function(e){runtime.writeFile(a,e,function(a){a||(y=e,u=y.length);b(a)})},b)}var m,y,u,z,t=core.RawInflate.inflate,s=this,x=new core.Base64;this.load=q;this.save=function(a,e,b,c){var d,h;for(d=0;d<m.length;d+=1)if(h=m[d],h.filename===a){h.set(a,e,b,c);return}h=new n(g);h.set(a,e,b,c);m.push(h)};this.remove=function(a){var e,b;for(e=0;e<m.length;e+=1)if(b=m[e],b.filename===
a)return m.splice(e,1),!0;return!1};this.write=function(a){r(g,a)};this.writeAs=r;this.createByteArray=e;this.loadContentXmlAsFragments=function(a,e){s.loadAsString(a,function(a,b){if(a)return e.rootElementReady(a);e.rootElementReady(null,b,!0)})};this.loadAsString=function(a,e){q(a,function(a,b){if(a||null===b)return e(a,null);var c=runtime.byteArrayToString(b,"utf8");e(null,c)})};this.loadAsDOM=function(a,e){s.loadAsString(a,function(a,b){if(a||null===b)e(a,null);else{var c=(new DOMParser).parseFromString(b,
"text/xml");e(null,c)}})};this.loadAsDataURL=function(a,e,b){q(a,function(a,c){if(a||!c)return b(a,null);var d=0,h;e||(e=80===c[1]&&78===c[2]&&71===c[3]?"image/png":255===c[0]&&216===c[1]&&255===c[2]?"image/jpeg":71===c[0]&&73===c[1]&&70===c[2]?"image/gif":"");for(h="data:"+e+";base64,";d<c.length;)h+=x.convertUTF8ArrayToBase64(c.subarray(d,Math.min(d+45E3,c.length))),d+=45E3;b(null,h)})};this.getEntries=function(){return m.slice()};u=-1;null===k?m=[]:runtime.readFile(g,"binary",function(a,e){"string"===
typeof e&&(a="file was read as a string. Should be Uint8Array.");a||!e||0===e.length?k("File '"+g+"' cannot be read. Err: "+(a||"[none]"),s):(y=e,u=y.length,d(u-22,22,function(a,e){a||null===e?k(a,s):p(e,k)}))})};core.SimpleClientRect=null;gui.CommonConstraints={EDIT:{ANNOTATIONS:{ONLY_DELETE_OWN:"onlyDeleteOwn"},REVIEW_MODE:"reviewMode"}};gui.SessionConstraints=function(){function g(b){k.hasOwnProperty(b)||(k[b]=!1,d.register(b))}var k={},d=new core.EventNotifier;this.registerConstraint=g;this.subscribe=function(b,c){g(b);d.subscribe(b,c)};this.unsubscribe=function(b,c){d.unsubscribe(b,c)};this.setState=function(b,c){runtime.assert(!0===k.hasOwnProperty(b),"No such constraint");k[b]!==c&&(k[b]=c,d.emit(b,c))};this.getState=function(b){runtime.assert(!0===k.hasOwnProperty(b),"No such constraint");return k[b]}};gui.BlacklistNamespaceNodeFilter=function(g){var k={},d=NodeFilter.FILTER_REJECT,b=NodeFilter.FILTER_ACCEPT;this.acceptNode=function(c){return!c||k.hasOwnProperty(c.namespaceURI)?d:b};(function(){g.forEach(function(b){k[b]=!0})})()};odf.Namespaces={namespaceMap:{config:"urn:oasis:names:tc:opendocument:xmlns:config:1.0",db:"urn:oasis:names:tc:opendocument:xmlns:database:1.0",dc:"http://purl.org/dc/elements/1.1/",dr3d:"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0",draw:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",chart:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",fo:"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0",form:"urn:oasis:names:tc:opendocument:xmlns:form:1.0",math:"http://www.w3.org/1998/Math/MathML",
meta:"urn:oasis:names:tc:opendocument:xmlns:meta:1.0",number:"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0",office:"urn:oasis:names:tc:opendocument:xmlns:office:1.0",presentation:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",style:"urn:oasis:names:tc:opendocument:xmlns:style:1.0",svg:"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0",table:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",text:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",xforms:"http://www.w3.org/2002/xforms",
xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"},prefixMap:{},configns:"urn:oasis:names:tc:opendocument:xmlns:config:1.0",dbns:"urn:oasis:names:tc:opendocument:xmlns:database:1.0",dcns:"http://purl.org/dc/elements/1.1/",dr3dns:"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0",drawns:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",chartns:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",fons:"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0",formns:"urn:oasis:names:tc:opendocument:xmlns:form:1.0",
mathns:"http://www.w3.org/1998/Math/MathML",metans:"urn:oasis:names:tc:opendocument:xmlns:meta:1.0",numberns:"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0",officens:"urn:oasis:names:tc:opendocument:xmlns:office:1.0",presentationns:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",stylens:"urn:oasis:names:tc:opendocument:xmlns:style:1.0",svgns:"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0",tablens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",textns:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",
xformsns:"http://www.w3.org/2002/xforms",xlinkns:"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/XML/1998/namespace"};(function(){var g=odf.Namespaces.namespaceMap,k=odf.Namespaces.prefixMap,d;for(d in g)g.hasOwnProperty(d)&&(k[g[d]]=d)})();odf.Namespaces.forEachPrefix=function(g){var k=odf.Namespaces.namespaceMap,d;for(d in k)k.hasOwnProperty(d)&&g(d,k[d])};
odf.Namespaces.lookupNamespaceURI=function(g){var k=null;odf.Namespaces.namespaceMap.hasOwnProperty(g)&&(k=odf.Namespaces.namespaceMap[g]);return k};odf.Namespaces.lookupPrefix=function(g){var k=odf.Namespaces.prefixMap;return k.hasOwnProperty(g)?k[g]:null};odf.Namespaces.lookupNamespaceURI.lookupNamespaceURI=odf.Namespaces.lookupNamespaceURI;(function(){odf.OdfSchemaImpl=function(){var g=[["config:config-item","uncategorized"],["form:item","object"],["form:option","uncategorized"],["math:math","field"],["meta:user-defined","uncategorized"],["number:currency-symbol","uncategorized"],["number:embedded-text","uncategorized"],["number:text","uncategorized"],["presentation:date-time-decl","uncategorized"],["presentation:footer-decl","uncategorized"],["presentation:header-decl","uncategorized"],["svg:desc","text"],["svg:title","text"],["table:desc",
"uncategorized"],["table:title","uncategorized"],["text:a","text"],["text:author-initials","field"],["text:author-name","field"],["text:bibliography-mark","field"],["text:bookmark-ref","field"],["text:chapter","field"],["text:character-count","field"],["text:conditional-text","field"],["text:creation-date","field"],["text:creation-time","field"],["text:creator","field"],["text:database-display","field"],["text:database-name","field"],["text:database-row-number","field"],["text:date","field"],["text:dde-connection",
"field"],["text:description","field"],["text:editing-cycles","field"],["text:editing-duration","field"],["text:execute-macro","uncategorized"],["text:expression","uncategorized"],["text:file-name","field"],["text:h","text"],["text:hidden-paragraph","text"],["text:hidden-text","text"],["text:image-count","field"],["text:index-entry-span","uncategorized"],["text:index-title-template","uncategorized"],["text:initial-creator","field"],["text:keywords","field"],["text:linenumbering-separator","style"],
["text:measure","uncategorized"],["text:meta","uncategorized"],["text:meta-field","uncategorized"],["text:modification-date","field"],["text:modification-time","field"],["text:note-citation","field"],["text:note-continuation-notice-backward","style"],["text:note-continuation-notice-forward","style"],["text:note-ref","field"],["text:object-count","field"],["text:p","text"],["text:page-continuation","uncategorized"],["text:page-count","field"],["text:page-number","field"],["text:page-variable-get",
"field"],["text:page-variable-set","field"],["text:paragraph-count","field"],["text:placeholder","field"],["text:print-date","field"],["text:print-time","field"],["text:printed-by","field"],["text:reference-ref","field"],["text:ruby-base","text"],["text:ruby-text","text"],["text:script","text"],["text:sender-city","field"],["text:sender-company","field"],["text:sender-country","field"],["text:sender-email","field"],["text:sender-fax","field"],["text:sender-firstname","field"],["text:sender-initials",
"field"],["text:sender-lastname","field"],["text:sender-phone-private","field"],["text:sender-phone-work","field"],["text:sender-position","field"],["text:sender-postal-code","field"],["text:sender-state-or-province","field"],["text:sender-street","field"],["text:sender-title","field"],["text:sequence","uncategorized"],["text:sequence-ref","uncategorized"],["text:sheet-name","uncategorized"],["text:span","text"],["text:subject","field"],["text:table-count","field"],["text:table-formula","deprecated"],
["text:template-name","uncategorized"],["text:text-input","field"],["text:time","field"],["text:title","field"],["text:user-defined","field"],["text:user-field-get","field"],["text:user-field-input","field"],["text:variable-get","field"],["text:variable-input","field"],["text:variable-set","field"],["text:word-count","field"],["xforms:model","uncategorized"]],k={};this.isTextContainer=function(d,b){return"text"===k[d+":"+b]};this.isField=function(d,b){return"field"===k[d+":"+b]};this.getFields=function(){return g.filter(function(d){return"field"===
d[1]}).map(function(d){return d[0]})};(function(){g.forEach(function(d){var b=d[1],c=d[0].split(":");d=c[0];var c=c[1],g=odf.Namespaces.lookupNamespaceURI(d);g?k[g+":"+c]=b:runtime.log("DEBUG: OdfSchema - unknown prefix '"+d+"'")})})()};odf.OdfSchema=new odf.OdfSchemaImpl})();odf.OdfUtilsImpl=function(){function g(a){return"image"===(a&&a.localName)&&a.namespaceURI===S}function k(a){return null!==a&&a.nodeType===Node.ELEMENT_NODE&&"frame"===a.localName&&a.namespaceURI===S&&"as-char"===a.getAttributeNS(Z,"anchor-type")}function d(a){var e;(e="annotation"===(a&&a.localName)&&a.namespaceURI===odf.Namespaces.officens)||(e="div"===(a&&a.localName)&&"annotationWrapper"===a.className);return e}function b(a){return"a"===(a&&a.localName)&&a.namespaceURI===Z}function c(a){var e=
a&&a.localName;return("p"===e||"h"===e)&&a.namespaceURI===Z}function l(a,e){for(a&&void 0!==e&&!c(a)&&a.childNodes.item(e)&&(a=a.childNodes.item(e));a&&!c(a);)a=a.parentNode;return a}function n(a,e){for(;a&&a!==e;){if(a.namespaceURI===odf.Namespaces.officens&&"annotation"===a.localName)return a;a=a.parentNode}return null}function p(a){return/^[ \t\r\n]+$/.test(a)}function q(a){if(null===a||a.nodeType!==Node.ELEMENT_NODE)return!1;var e=a.localName;return P.isTextContainer(a.namespaceURI,e)||"span"===
e&&"webodf-annotationHighlight"===a.className}function f(a){return null===a||a.nodeType!==Node.ELEMENT_NODE?!1:P.isField(a.namespaceURI,a.localName)}function h(a){var e=a&&a.localName,b=!1;e&&(a=a.namespaceURI,a===Z&&(b="s"===e||"tab"===e||"line-break"===e));return b}function a(a){return h(a)||f(a)||k(a)||d(a)}function e(a){var e=a&&a.localName,b=!1;e&&(a=a.namespaceURI,a===Z&&(b="s"===e));return b}function r(a){return-1!==ba.indexOf(a.namespaceURI)}function m(a){if(h(a)||f(a))return!1;if(q(a.parentNode)&&
a.nodeType===Node.TEXT_NODE)return 0===a.textContent.length;for(a=a.firstChild;a;){if(r(a)||!m(a))return!1;a=a.nextSibling}return!0}function y(a){for(;null!==a.firstChild&&q(a);)a=a.firstChild;return a}function u(a){for(;null!==a.lastChild&&q(a);)a=a.lastChild;return a}function z(a){for(;!c(a)&&null===a.previousSibling;)a=a.parentNode;return c(a)?null:u(a.previousSibling)}function t(a){for(;!c(a)&&null===a.nextSibling;)a=a.parentNode;return c(a)?null:y(a.nextSibling)}function s(b){for(var c=!1;b;)if(b.nodeType===
Node.TEXT_NODE)if(0===b.length)b=z(b);else return!p(b.data.substr(b.length-1,1));else a(b)?(c=!1===e(b),b=null):b=z(b);return c}function x(e){var b=!1,c;for(e=e&&y(e);e;){c=e.nodeType===Node.TEXT_NODE?e.length:0;if(0<c&&!p(e.data)){b=!0;break}if(a(e)){b=!0;break}e=t(e)}return b}function w(a,e){return p(a.data.substr(e))?!x(t(a)):!1}function C(e,b){var c=e.data,d;if(!p(c[b])||a(e.parentNode))return!1;0<b?p(c[b-1])||(d=!0):s(z(e))&&(d=!0);return!0===d?w(e,b)?!1:!0:!1}function G(a){return(a=/(-?[0-9]*[0-9][0-9]*(\.[0-9]*)?|0+\.[0-9]*[1-9][0-9]*|\.[0-9]*[1-9][0-9]*)((cm)|(mm)|(in)|(pt)|(pc)|(px)|(%))/.exec(a))?
{value:parseFloat(a[1]),unit:a[3]}:null}function B(a){return(a=G(a))&&(0>a.value||"%"===a.unit)?null:a}function E(a){return(a=G(a))&&"%"!==a.unit?null:a}function J(a){switch(a.namespaceURI){case odf.Namespaces.drawns:case odf.Namespaces.svgns:case odf.Namespaces.dr3dns:return!1;case odf.Namespaces.textns:switch(a.localName){case "note-body":case "ruby-text":return!1}break;case odf.Namespaces.officens:switch(a.localName){case "annotation":case "binary-data":case "event-listeners":return!1}break;default:switch(a.localName){case "cursor":case "editinfo":return!1}}return!0}
function I(a,e){for(;0<e.length&&!H.rangeContainsNode(a,e[0]);)e.shift();for(;0<e.length&&!H.rangeContainsNode(a,e[e.length-1]);)e.pop()}function U(e,b,c){var m;m=H.getNodesInRange(e,function(e){var b=NodeFilter.FILTER_REJECT;if(h(e.parentNode)||f(e.parentNode)||d(e))b=NodeFilter.FILTER_REJECT;else if(e.nodeType===Node.TEXT_NODE){if(c||Boolean(l(e)&&(!p(e.textContent)||C(e,0))))b=NodeFilter.FILTER_ACCEPT}else if(a(e))b=NodeFilter.FILTER_ACCEPT;else if(J(e)||q(e))b=NodeFilter.FILTER_SKIP;return b},
NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT);b||I(e,m);return m}function Q(a,e,b){for(;a;){if(b(a)){e[0]!==a&&e.unshift(a);break}if(d(a))break;a=a.parentNode}}function A(a,e){var b=a;if(e<b.childNodes.length-1)b=b.childNodes[e+1];else{for(;!b.nextSibling;)b=b.parentNode;b=b.nextSibling}for(;b.firstChild;)b=b.firstChild;return b}var Z=odf.Namespaces.textns,S=odf.Namespaces.drawns,v=odf.Namespaces.xlinkns,H=core.DomUtils,ba=[odf.Namespaces.dbns,odf.Namespaces.dcns,odf.Namespaces.dr3dns,odf.Namespaces.drawns,
odf.Namespaces.chartns,odf.Namespaces.formns,odf.Namespaces.numberns,odf.Namespaces.officens,odf.Namespaces.presentationns,odf.Namespaces.stylens,odf.Namespaces.svgns,odf.Namespaces.tablens,odf.Namespaces.textns],P=odf.OdfSchema;this.isImage=g;this.isCharacterFrame=k;this.isInlineRoot=d;this.isTextSpan=function(a){return"span"===(a&&a.localName)&&a.namespaceURI===Z};this.isHyperlink=b;this.getHyperlinkTarget=function(a){return a.getAttributeNS(v,"href")||""};this.isParagraph=c;this.getParagraphElement=
l;this.getParentAnnotation=n;this.isWithinAnnotation=function(a,e){return Boolean(n(a,e))};this.getAnnotationCreator=function(a){return a.getElementsByTagNameNS(odf.Namespaces.dcns,"creator")[0].textContent};this.isListItem=function(a){return"list-item"===(a&&a.localName)&&a.namespaceURI===Z};this.isLineBreak=function(a){return"line-break"===(a&&a.localName)&&a.namespaceURI===Z};this.isODFWhitespace=p;this.isGroupingElement=q;this.isFieldElement=f;this.isCharacterElement=h;this.isAnchoredAsCharacterElement=
a;this.isSpaceElement=e;this.isODFNode=r;this.hasNoODFContent=m;this.firstChild=y;this.lastChild=u;this.previousNode=z;this.nextNode=t;this.scanLeftForNonSpace=s;this.lookLeftForCharacter=function(e){var b,c=b=0;e.nodeType===Node.TEXT_NODE&&(c=e.length);0<c?(b=e.data,b=p(b.substr(c-1,1))?1===c?s(z(e))?2:0:p(b.substr(c-2,1))?0:2:1):a(e)&&(b=1);return b};this.lookRightForCharacter=function(e){var b=!1,c=0;e&&e.nodeType===Node.TEXT_NODE&&(c=e.length);0<c?b=!p(e.data.substr(0,1)):a(e)&&(b=!0);return b};
this.scanLeftForAnyCharacter=function(e){var b=!1,c;for(e=e&&u(e);e;){c=e.nodeType===Node.TEXT_NODE?e.length:0;if(0<c&&!p(e.data)){b=!0;break}if(a(e)){b=!0;break}e=z(e)}return b};this.scanRightForAnyCharacter=x;this.isTrailingWhitespace=w;this.isSignificantWhitespace=C;this.isDowngradableSpaceElement=function(a){return e(a)?s(z(a))&&x(t(a)):!1};this.parseLength=G;this.parseNonNegativeLength=B;this.parseFoFontSize=function(a){var e;e=(e=G(a))&&(0>=e.value||"%"===e.unit)?null:e;return e||E(a)};this.parseFoLineHeight=
function(a){return B(a)||E(a)};this.isTextContentContainingNode=J;this.getTextNodes=function(a,e){var b;b=H.getNodesInRange(a,function(a){var e=NodeFilter.FILTER_REJECT;a.nodeType===Node.TEXT_NODE?Boolean(l(a)&&(!p(a.textContent)||C(a,0)))&&(e=NodeFilter.FILTER_ACCEPT):J(a)&&(e=NodeFilter.FILTER_SKIP);return e},NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT);e||I(a,b);return b};this.getTextElements=U;this.getParagraphElements=function(a){var e;e=H.getNodesInRange(a,function(a){var e=NodeFilter.FILTER_REJECT;
if(c(a))e=NodeFilter.FILTER_ACCEPT;else if(J(a)||q(a))e=NodeFilter.FILTER_SKIP;return e},NodeFilter.SHOW_ELEMENT);Q(a.startContainer,e,c);return e};this.getImageElements=function(a){var e;e=H.getNodesInRange(a,function(a){var e=NodeFilter.FILTER_SKIP;g(a)&&(e=NodeFilter.FILTER_ACCEPT);return e},NodeFilter.SHOW_ELEMENT);Q(a.startContainer,e,g);return e};this.getHyperlinkElements=function(a){var e=[],d=a.cloneRange();a.collapsed&&a.endContainer.nodeType===Node.ELEMENT_NODE&&(a=A(a.endContainer,a.endOffset),
a.nodeType===Node.TEXT_NODE&&d.setEnd(a,1));U(d,!0,!1).forEach(function(a){for(a=a.parentNode;!c(a);){if(b(a)&&-1===e.indexOf(a)){e.push(a);break}a=a.parentNode}});d.detach();return e};this.getNormalizedFontFamilyName=function(a){/^(["'])(?:.|[\n\r])*?\1$/.test(a)||(a=a.replace(/^[ \t\r\n\f]*((?:.|[\n\r])*?)[ \t\r\n\f]*$/,"$1"),/[ \t\r\n\f]/.test(a)&&(a="'"+a.replace(/[ \t\r\n\f]+/g," ")+"'"));return a}};odf.OdfUtils=new odf.OdfUtilsImpl;gui.OdfTextBodyNodeFilter=function(){var g=odf.OdfUtils,k=Node.TEXT_NODE,d=NodeFilter.FILTER_REJECT,b=NodeFilter.FILTER_ACCEPT,c=odf.Namespaces.textns;this.acceptNode=function(l){if(l.nodeType===k){if(!g.isGroupingElement(l.parentNode))return d}else if(l.namespaceURI===c&&"tracked-changes"===l.localName)return d;return b}};xmldom.LSSerializerFilter=function(){};xmldom.LSSerializerFilter.prototype.acceptNode=function(g){};odf.OdfNodeFilter=function(){this.acceptNode=function(g){return"http://www.w3.org/1999/xhtml"===g.namespaceURI?NodeFilter.FILTER_SKIP:g.namespaceURI&&g.namespaceURI.match(/^urn:webodf:/)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}};xmldom.XPathIterator=function(){};xmldom.XPathIterator.prototype.next=function(){};xmldom.XPathIterator.prototype.reset=function(){};
function createXPathSingleton(){function g(b,a,e){return-1!==b&&(b<a||-1===a)&&(b<e||-1===e)}function k(b){for(var a=[],e=0,c=b.length,d;e<c;){var l=b,n=c,p=a,k="",q=[],x=l.indexOf("[",e),w=l.indexOf("/",e),C=l.indexOf("=",e);g(w,x,C)?(k=l.substring(e,w),e=w+1):g(x,w,C)?(k=l.substring(e,x),e=f(l,x,q)):g(C,w,x)?(k=l.substring(e,C),e=C):(k=l.substring(e,n),e=n);p.push({location:k,predicates:q});if(e<c&&"="===b[e]){d=b.substring(e+1,c);if(2<d.length&&("'"===d[0]||'"'===d[0]))d=d.slice(1,d.length-1);
else try{d=parseInt(d,10)}catch(G){}e=c}}return{steps:a,value:d}}function d(){var b=null,a=!1;this.setNode=function(a){b=a};this.reset=function(){a=!1};this.next=function(){var e=a?null:b;a=!0;return e}}function b(b,a,e){this.reset=function(){b.reset()};this.next=function(){for(var c=b.next();c;){c.nodeType===Node.ELEMENT_NODE&&(c=c.getAttributeNodeNS(a,e));if(c)break;c=b.next()}return c}}function c(b,a){var e=b.next(),c=null;this.reset=function(){b.reset();e=b.next();c=null};this.next=function(){for(;e;){if(c)if(a&&
c.firstChild)c=c.firstChild;else{for(;!c.nextSibling&&c!==e;)c=c.parentNode;c===e?e=b.next():c=c.nextSibling}else{do(c=e.firstChild)||(e=b.next());while(e&&!c)}if(c&&c.nodeType===Node.ELEMENT_NODE)return c}return null}}function l(b,a){this.reset=function(){b.reset()};this.next=function(){for(var e=b.next();e&&!a(e);)e=b.next();return e}}function n(b,a,e){a=a.split(":",2);var c=e(a[0]),d=a[1];return new l(b,function(a){return a.localName===d&&a.namespaceURI===c})}function p(b,a,e){var c=new d,m=q(c,
a,e),f=a.value;return void 0===f?new l(b,function(a){c.setNode(a);m.reset();return null!==m.next()}):new l(b,function(a){c.setNode(a);m.reset();return(a=m.next())?a.nodeValue===f:!1})}var q,f;f=function(b,a,e){for(var c=a,d=b.length,f=0;c<d;)"]"===b[c]?(f-=1,0>=f&&e.push(k(b.substring(a,c)))):"["===b[c]&&(0>=f&&(a=c+1),f+=1),c+=1;return c};q=function(d,a,e){var f,m,g,l;for(f=0;f<a.steps.length;f+=1){g=a.steps[f];m=g.location;if(""===m)d=new c(d,!1);else if("@"===m[0]){m=m.substr(1).split(":",2);l=
e(m[0]);if(!l)throw"No namespace associated with the prefix "+m[0];d=new b(d,l,m[1])}else"."!==m&&(d=new c(d,!1),-1!==m.indexOf(":")&&(d=n(d,m,e)));for(m=0;m<g.predicates.length;m+=1)l=g.predicates[m],d=p(d,l,e)}return d};return{getODFElementsWithXPath:function(b,a,e){var c=b.ownerDocument,m=[],f=null;if(c&&"function"===typeof c.evaluate)for(e=c.evaluate(a,b,e,XPathResult.UNORDERED_NODE_ITERATOR_TYPE,null),f=e.iterateNext();null!==f;)f.nodeType===Node.ELEMENT_NODE&&m.push(f),f=e.iterateNext();else{m=
new d;m.setNode(b);b=k(a);m=q(m,b,e);b=[];for(e=m.next();e;)b.push(e),e=m.next();m=b}return m}}}xmldom.XPath=createXPathSingleton();odf.StyleInfo=function(){function g(a,e){var b,c,d,h,m,f=0;if(b=B[a.localName])if(d=b[a.namespaceURI])f=d.length;for(b=0;b<f;b+=1)c=d[b],h=c.ns,m=c.localname,(c=a.getAttributeNS(h,m))&&a.setAttributeNS(h,C[h]+m,e+c);for(d=a.firstElementChild;d;)g(d,e),d=d.nextElementSibling}function k(a,e){var b,c,d,h,m,f=0;if(b=B[a.localName])if(d=b[a.namespaceURI])f=d.length;for(b=0;b<f;b+=1)if(c=d[b],h=c.ns,m=c.localname,c=a.getAttributeNS(h,m))c=c.replace(e,""),a.setAttributeNS(h,C[h]+m,c);for(d=a.firstElementChild;d;)k(d,
e),d=d.nextElementSibling}function d(a,e){var b,c,d,h,m,f=0;if(b=B[a.localName])if(d=b[a.namespaceURI])f=d.length;for(b=0;b<f;b+=1)if(h=d[b],c=h.ns,m=h.localname,c=a.getAttributeNS(c,m))e=e||{},h=h.keyname,e.hasOwnProperty(h)?e[h][c]=1:(m={},m[c]=1,e[h]=m);return e}function b(a,e){var c,h;d(a,e);for(c=a.firstChild;c;)c.nodeType===Node.ELEMENT_NODE&&(h=c,b(h,e)),c=c.nextSibling}function c(a,e,b){this.key=a;this.name=e;this.family=b;this.requires={}}function l(a,e,b){var d=a+'"'+e,h=b[d];h||(h=b[d]=
new c(d,a,e));return h}function n(a,e,b){var c,d,h,m,f,r=0;c=a.getAttributeNS(s,"name");m=a.getAttributeNS(s,"family");c&&m&&(e=l(c,m,b));if(e){if(c=B[a.localName])if(h=c[a.namespaceURI])r=h.length;for(c=0;c<r;c+=1)if(m=h[c],d=m.ns,f=m.localname,d=a.getAttributeNS(d,f))m=m.keyname,m=l(d,m,b),e.requires[m.key]=m}for(a=a.firstElementChild;a;)n(a,e,b),a=a.nextElementSibling;return b}function p(a,e){var b=e[a.family];b||(b=e[a.family]={});b[a.name]=1;Object.keys(a.requires).forEach(function(b){p(a.requires[b],
e)})}function q(a,e){var b=n(a,null,{});Object.keys(b).forEach(function(a){a=b[a];var c=e[a.family];c&&c.hasOwnProperty(a.name)&&p(a,e)})}function f(a,e){function b(e){(e=h.getAttributeNS(s,e))&&(a[e]=!0)}var c=["font-name","font-name-asian","font-name-complex"],d,h;for(d=e&&e.firstElementChild;d;)h=d,c.forEach(b),f(a,h),d=d.nextElementSibling}function h(a,e){function b(a){var c=m.getAttributeNS(s,a);c&&e.hasOwnProperty(c)&&m.setAttributeNS(s,"style:"+a,e[c])}var c=["font-name","font-name-asian",
"font-name-complex"],d,m;for(d=a&&a.firstElementChild;d;)m=d,c.forEach(b),h(m,e),d=d.nextElementSibling}var a=odf.Namespaces.chartns,e=odf.Namespaces.dbns,r=odf.Namespaces.dr3dns,m=odf.Namespaces.drawns,y=odf.Namespaces.formns,u=odf.Namespaces.numberns,z=odf.Namespaces.officens,t=odf.Namespaces.presentationns,s=odf.Namespaces.stylens,x=odf.Namespaces.tablens,w=odf.Namespaces.textns,C={"urn:oasis:names:tc:opendocument:xmlns:chart:1.0":"chart:","urn:oasis:names:tc:opendocument:xmlns:database:1.0":"db:",
"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0":"dr3d:","urn:oasis:names:tc:opendocument:xmlns:drawing:1.0":"draw:","urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0":"fo:","urn:oasis:names:tc:opendocument:xmlns:form:1.0":"form:","urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0":"number:","urn:oasis:names:tc:opendocument:xmlns:office:1.0":"office:","urn:oasis:names:tc:opendocument:xmlns:presentation:1.0":"presentation:","urn:oasis:names:tc:opendocument:xmlns:style:1.0":"style:","urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0":"svg:",
"urn:oasis:names:tc:opendocument:xmlns:table:1.0":"table:","urn:oasis:names:tc:opendocument:xmlns:text:1.0":"chart:","http://www.w3.org/XML/1998/namespace":"xml:"},G={text:[{ens:s,en:"tab-stop",ans:s,a:"leader-text-style"},{ens:s,en:"drop-cap",ans:s,a:"style-name"},{ens:w,en:"notes-configuration",ans:w,a:"citation-body-style-name"},{ens:w,en:"notes-configuration",ans:w,a:"citation-style-name"},{ens:w,en:"a",ans:w,a:"style-name"},{ens:w,en:"alphabetical-index",ans:w,a:"style-name"},{ens:w,en:"linenumbering-configuration",
ans:w,a:"style-name"},{ens:w,en:"list-level-style-number",ans:w,a:"style-name"},{ens:w,en:"ruby-text",ans:w,a:"style-name"},{ens:w,en:"span",ans:w,a:"style-name"},{ens:w,en:"a",ans:w,a:"visited-style-name"},{ens:s,en:"text-properties",ans:s,a:"text-line-through-text-style"},{ens:w,en:"alphabetical-index-source",ans:w,a:"main-entry-style-name"},{ens:w,en:"index-entry-bibliography",ans:w,a:"style-name"},{ens:w,en:"index-entry-chapter",ans:w,a:"style-name"},{ens:w,en:"index-entry-link-end",ans:w,a:"style-name"},
{ens:w,en:"index-entry-link-start",ans:w,a:"style-name"},{ens:w,en:"index-entry-page-number",ans:w,a:"style-name"},{ens:w,en:"index-entry-span",ans:w,a:"style-name"},{ens:w,en:"index-entry-tab-stop",ans:w,a:"style-name"},{ens:w,en:"index-entry-text",ans:w,a:"style-name"},{ens:w,en:"index-title-template",ans:w,a:"style-name"},{ens:w,en:"list-level-style-bullet",ans:w,a:"style-name"},{ens:w,en:"outline-level-style",ans:w,a:"style-name"}],paragraph:[{ens:m,en:"caption",ans:m,a:"text-style-name"},{ens:m,
en:"circle",ans:m,a:"text-style-name"},{ens:m,en:"connector",ans:m,a:"text-style-name"},{ens:m,en:"control",ans:m,a:"text-style-name"},{ens:m,en:"custom-shape",ans:m,a:"text-style-name"},{ens:m,en:"ellipse",ans:m,a:"text-style-name"},{ens:m,en:"frame",ans:m,a:"text-style-name"},{ens:m,en:"line",ans:m,a:"text-style-name"},{ens:m,en:"measure",ans:m,a:"text-style-name"},{ens:m,en:"path",ans:m,a:"text-style-name"},{ens:m,en:"polygon",ans:m,a:"text-style-name"},{ens:m,en:"polyline",ans:m,a:"text-style-name"},
{ens:m,en:"rect",ans:m,a:"text-style-name"},{ens:m,en:"regular-polygon",ans:m,a:"text-style-name"},{ens:z,en:"annotation",ans:m,a:"text-style-name"},{ens:y,en:"column",ans:y,a:"text-style-name"},{ens:s,en:"style",ans:s,a:"next-style-name"},{ens:x,en:"body",ans:x,a:"paragraph-style-name"},{ens:x,en:"even-columns",ans:x,a:"paragraph-style-name"},{ens:x,en:"even-rows",ans:x,a:"paragraph-style-name"},{ens:x,en:"first-column",ans:x,a:"paragraph-style-name"},{ens:x,en:"first-row",ans:x,a:"paragraph-style-name"},
{ens:x,en:"last-column",ans:x,a:"paragraph-style-name"},{ens:x,en:"last-row",ans:x,a:"paragraph-style-name"},{ens:x,en:"odd-columns",ans:x,a:"paragraph-style-name"},{ens:x,en:"odd-rows",ans:x,a:"paragraph-style-name"},{ens:w,en:"notes-configuration",ans:w,a:"default-style-name"},{ens:w,en:"alphabetical-index-entry-template",ans:w,a:"style-name"},{ens:w,en:"bibliography-entry-template",ans:w,a:"style-name"},{ens:w,en:"h",ans:w,a:"style-name"},{ens:w,en:"illustration-index-entry-template",ans:w,a:"style-name"},
{ens:w,en:"index-source-style",ans:w,a:"style-name"},{ens:w,en:"object-index-entry-template",ans:w,a:"style-name"},{ens:w,en:"p",ans:w,a:"style-name"},{ens:w,en:"table-index-entry-template",ans:w,a:"style-name"},{ens:w,en:"table-of-content-entry-template",ans:w,a:"style-name"},{ens:w,en:"table-index-entry-template",ans:w,a:"style-name"},{ens:w,en:"user-index-entry-template",ans:w,a:"style-name"},{ens:s,en:"page-layout-properties",ans:s,a:"register-truth-ref-style-name"}],chart:[{ens:a,en:"axis",ans:a,
a:"style-name"},{ens:a,en:"chart",ans:a,a:"style-name"},{ens:a,en:"data-label",ans:a,a:"style-name"},{ens:a,en:"data-point",ans:a,a:"style-name"},{ens:a,en:"equation",ans:a,a:"style-name"},{ens:a,en:"error-indicator",ans:a,a:"style-name"},{ens:a,en:"floor",ans:a,a:"style-name"},{ens:a,en:"footer",ans:a,a:"style-name"},{ens:a,en:"grid",ans:a,a:"style-name"},{ens:a,en:"legend",ans:a,a:"style-name"},{ens:a,en:"mean-value",ans:a,a:"style-name"},{ens:a,en:"plot-area",ans:a,a:"style-name"},{ens:a,en:"regression-curve",
ans:a,a:"style-name"},{ens:a,en:"series",ans:a,a:"style-name"},{ens:a,en:"stock-gain-marker",ans:a,a:"style-name"},{ens:a,en:"stock-loss-marker",ans:a,a:"style-name"},{ens:a,en:"stock-range-line",ans:a,a:"style-name"},{ens:a,en:"subtitle",ans:a,a:"style-name"},{ens:a,en:"title",ans:a,a:"style-name"},{ens:a,en:"wall",ans:a,a:"style-name"}],section:[{ens:w,en:"alphabetical-index",ans:w,a:"style-name"},{ens:w,en:"bibliography",ans:w,a:"style-name"},{ens:w,en:"illustration-index",ans:w,a:"style-name"},
{ens:w,en:"index-title",ans:w,a:"style-name"},{ens:w,en:"object-index",ans:w,a:"style-name"},{ens:w,en:"section",ans:w,a:"style-name"},{ens:w,en:"table-of-content",ans:w,a:"style-name"},{ens:w,en:"table-index",ans:w,a:"style-name"},{ens:w,en:"user-index",ans:w,a:"style-name"}],ruby:[{ens:w,en:"ruby",ans:w,a:"style-name"}],table:[{ens:e,en:"query",ans:e,a:"style-name"},{ens:e,en:"table-representation",ans:e,a:"style-name"},{ens:x,en:"background",ans:x,a:"style-name"},{ens:x,en:"table",ans:x,a:"style-name"}],
"table-column":[{ens:e,en:"column",ans:e,a:"style-name"},{ens:x,en:"table-column",ans:x,a:"style-name"}],"table-row":[{ens:e,en:"query",ans:e,a:"default-row-style-name"},{ens:e,en:"table-representation",ans:e,a:"default-row-style-name"},{ens:x,en:"table-row",ans:x,a:"style-name"}],"table-cell":[{ens:e,en:"column",ans:e,a:"default-cell-style-name"},{ens:x,en:"table-column",ans:x,a:"default-cell-style-name"},{ens:x,en:"table-row",ans:x,a:"default-cell-style-name"},{ens:x,en:"body",ans:x,a:"style-name"},
{ens:x,en:"covered-table-cell",ans:x,a:"style-name"},{ens:x,en:"even-columns",ans:x,a:"style-name"},{ens:x,en:"covered-table-cell",ans:x,a:"style-name"},{ens:x,en:"even-columns",ans:x,a:"style-name"},{ens:x,en:"even-rows",ans:x,a:"style-name"},{ens:x,en:"first-column",ans:x,a:"style-name"},{ens:x,en:"first-row",ans:x,a:"style-name"},{ens:x,en:"last-column",ans:x,a:"style-name"},{ens:x,en:"last-row",ans:x,a:"style-name"},{ens:x,en:"odd-columns",ans:x,a:"style-name"},{ens:x,en:"odd-rows",ans:x,a:"style-name"},
{ens:x,en:"table-cell",ans:x,a:"style-name"}],graphic:[{ens:r,en:"cube",ans:m,a:"style-name"},{ens:r,en:"extrude",ans:m,a:"style-name"},{ens:r,en:"rotate",ans:m,a:"style-name"},{ens:r,en:"scene",ans:m,a:"style-name"},{ens:r,en:"sphere",ans:m,a:"style-name"},{ens:m,en:"caption",ans:m,a:"style-name"},{ens:m,en:"circle",ans:m,a:"style-name"},{ens:m,en:"connector",ans:m,a:"style-name"},{ens:m,en:"control",ans:m,a:"style-name"},{ens:m,en:"custom-shape",ans:m,a:"style-name"},{ens:m,en:"ellipse",ans:m,a:"style-name"},
{ens:m,en:"frame",ans:m,a:"style-name"},{ens:m,en:"g",ans:m,a:"style-name"},{ens:m,en:"line",ans:m,a:"style-name"},{ens:m,en:"measure",ans:m,a:"style-name"},{ens:m,en:"page-thumbnail",ans:m,a:"style-name"},{ens:m,en:"path",ans:m,a:"style-name"},{ens:m,en:"polygon",ans:m,a:"style-name"},{ens:m,en:"polyline",ans:m,a:"style-name"},{ens:m,en:"rect",ans:m,a:"style-name"},{ens:m,en:"regular-polygon",ans:m,a:"style-name"},{ens:z,en:"annotation",ans:m,a:"style-name"}],presentation:[{ens:r,en:"cube",ans:t,
a:"style-name"},{ens:r,en:"extrude",ans:t,a:"style-name"},{ens:r,en:"rotate",ans:t,a:"style-name"},{ens:r,en:"scene",ans:t,a:"style-name"},{ens:r,en:"sphere",ans:t,a:"style-name"},{ens:m,en:"caption",ans:t,a:"style-name"},{ens:m,en:"circle",ans:t,a:"style-name"},{ens:m,en:"connector",ans:t,a:"style-name"},{ens:m,en:"control",ans:t,a:"style-name"},{ens:m,en:"custom-shape",ans:t,a:"style-name"},{ens:m,en:"ellipse",ans:t,a:"style-name"},{ens:m,en:"frame",ans:t,a:"style-name"},{ens:m,en:"g",ans:t,a:"style-name"},
{ens:m,en:"line",ans:t,a:"style-name"},{ens:m,en:"measure",ans:t,a:"style-name"},{ens:m,en:"page-thumbnail",ans:t,a:"style-name"},{ens:m,en:"path",ans:t,a:"style-name"},{ens:m,en:"polygon",ans:t,a:"style-name"},{ens:m,en:"polyline",ans:t,a:"style-name"},{ens:m,en:"rect",ans:t,a:"style-name"},{ens:m,en:"regular-polygon",ans:t,a:"style-name"},{ens:z,en:"annotation",ans:t,a:"style-name"}],"drawing-page":[{ens:m,en:"page",ans:m,a:"style-name"},{ens:t,en:"notes",ans:m,a:"style-name"},{ens:s,en:"handout-master",
ans:m,a:"style-name"},{ens:s,en:"master-page",ans:m,a:"style-name"}],"list-style":[{ens:w,en:"list",ans:w,a:"style-name"},{ens:w,en:"numbered-paragraph",ans:w,a:"style-name"},{ens:w,en:"list-item",ans:w,a:"style-override"},{ens:s,en:"style",ans:s,a:"list-style-name"}],data:[{ens:s,en:"style",ans:s,a:"data-style-name"},{ens:s,en:"style",ans:s,a:"percentage-data-style-name"},{ens:t,en:"date-time-decl",ans:s,a:"data-style-name"},{ens:w,en:"creation-date",ans:s,a:"data-style-name"},{ens:w,en:"creation-time",
ans:s,a:"data-style-name"},{ens:w,en:"database-display",ans:s,a:"data-style-name"},{ens:w,en:"date",ans:s,a:"data-style-name"},{ens:w,en:"editing-duration",ans:s,a:"data-style-name"},{ens:w,en:"expression",ans:s,a:"data-style-name"},{ens:w,en:"meta-field",ans:s,a:"data-style-name"},{ens:w,en:"modification-date",ans:s,a:"data-style-name"},{ens:w,en:"modification-time",ans:s,a:"data-style-name"},{ens:w,en:"print-date",ans:s,a:"data-style-name"},{ens:w,en:"print-time",ans:s,a:"data-style-name"},{ens:w,
en:"table-formula",ans:s,a:"data-style-name"},{ens:w,en:"time",ans:s,a:"data-style-name"},{ens:w,en:"user-defined",ans:s,a:"data-style-name"},{ens:w,en:"user-field-get",ans:s,a:"data-style-name"},{ens:w,en:"user-field-input",ans:s,a:"data-style-name"},{ens:w,en:"variable-get",ans:s,a:"data-style-name"},{ens:w,en:"variable-input",ans:s,a:"data-style-name"},{ens:w,en:"variable-set",ans:s,a:"data-style-name"}],"page-layout":[{ens:t,en:"notes",ans:s,a:"page-layout-name"},{ens:s,en:"handout-master",ans:s,
a:"page-layout-name"},{ens:s,en:"master-page",ans:s,a:"page-layout-name"}]},B,E=xmldom.XPath;this.collectUsedFontFaces=f;this.changeFontFaceNames=h;this.UsedStyleList=function(a,e){var c={};this.uses=function(a){var e=a.localName,b=a.getAttributeNS(m,"name")||a.getAttributeNS(s,"name");a="style"===e?a.getAttributeNS(s,"family"):a.namespaceURI===u?"data":e;return(a=c[a])?0<a[b]:!1};b(a,c);e&&q(e,c)};this.getStyleName=function(a,e){var b,c,d=B[e.localName];if(d&&(d=d[e.namespaceURI]))for(c=0;c<d.length;c+=
1)if(d[c].keyname===a&&(d=d[c],e.hasAttributeNS(d.ns,d.localname))){b=e.getAttributeNS(d.ns,d.localname);break}return b};this.hasDerivedStyles=function(a,e,b){var c=b.getAttributeNS(s,"name");b=b.getAttributeNS(s,"family");return E.getODFElementsWithXPath(a,'//style:*[@style:parent-style-name="'+c+'"][@style:family="'+b+'"]',e).length?!0:!1};this.prefixStyleNames=function(a,e,b){var c;if(a){for(c=a.firstChild;c;){if(c.nodeType===Node.ELEMENT_NODE){var d=c,h=e,f=d.getAttributeNS(m,"name"),r=void 0;
f?r=m:(f=d.getAttributeNS(s,"name"))&&(r=s);r&&d.setAttributeNS(r,C[r]+"name",h+f)}c=c.nextSibling}g(a,e);b&&g(b,e)}};this.removePrefixFromStyleNames=function(a,e,b){var c=RegExp("^"+e);if(a){for(e=a.firstChild;e;){if(e.nodeType===Node.ELEMENT_NODE){var d=e,h=c,f=d.getAttributeNS(m,"name"),r=void 0;f?r=m:(f=d.getAttributeNS(s,"name"))&&(r=s);r&&(f=f.replace(h,""),d.setAttributeNS(r,C[r]+"name",f))}e=e.nextSibling}k(a,c);b&&k(b,c)}};this.determineStylesForNode=d;B=function(){var a,e,b,c,d,h={},m,f,
r,g;for(b in G)if(G.hasOwnProperty(b))for(c=G[b],e=c.length,a=0;a<e;a+=1)d=c[a],r=d.en,g=d.ens,h.hasOwnProperty(r)?m=h[r]:h[r]=m={},m.hasOwnProperty(g)?f=m[g]:m[g]=f=[],f.push({ns:d.ans,localname:d.a,keyname:b});return h}()};"function"!==typeof Object.create&&(Object.create=function(g){var k=function(){};k.prototype=g;return new k});
xmldom.LSSerializer=function(){function g(b){var d=b||{},g=function(b){var a={},e;for(e in b)b.hasOwnProperty(e)&&(a[b[e]]=e);return a}(b),p=[d],k=[g],f=0;this.push=function(){f+=1;d=p[f]=Object.create(d);g=k[f]=Object.create(g)};this.pop=function(){p.pop();k.pop();f-=1;d=p[f];g=k[f]};this.getLocalNamespaceDefinitions=function(){return g};this.getQName=function(b){var a=b.namespaceURI,e=0,c;if(!a)return b.localName;if(c=g[a])return c+":"+b.localName;do{c||!b.prefix?(c="ns"+e,e+=1):c=b.prefix;if(d[c]===
a)break;if(!d[c]){d[c]=a;g[a]=c;break}c=null}while(null===c);return c+":"+b.localName}}function k(b){return b.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;")}function d(c,g){var n="",p=b.filter?b.filter.acceptNode(g):NodeFilter.FILTER_ACCEPT,q;if(p===NodeFilter.FILTER_ACCEPT&&g.nodeType===Node.ELEMENT_NODE){c.push();q=c.getQName(g);var f,h=g.attributes,a,e,r,m="",y;f="<"+q;a=h.length;for(e=0;e<a;e+=1)r=h.item(e),"http://www.w3.org/2000/xmlns/"!==
r.namespaceURI&&(y=b.filter?b.filter.acceptNode(r):NodeFilter.FILTER_ACCEPT,y===NodeFilter.FILTER_ACCEPT&&(y=c.getQName(r),r="string"===typeof r.value?k(r.value):r.value,m+=" "+(y+'="'+r+'"')));a=c.getLocalNamespaceDefinitions();for(e in a)a.hasOwnProperty(e)&&((h=a[e])?"xmlns"!==h&&(f+=" xmlns:"+a[e]+'="'+e+'"'):f+=' xmlns="'+e+'"');n+=f+(m+">")}if(p===NodeFilter.FILTER_ACCEPT||p===NodeFilter.FILTER_SKIP){for(p=g.firstChild;p;)n+=d(c,p),p=p.nextSibling;g.nodeValue&&(n+=k(g.nodeValue))}q&&(n+="</"+
q+">",c.pop());return n}var b=this;this.filter=null;this.writeToString=function(b,l){if(!b)return"";var n=new g(l);return d(n,b)}};(function(){function g(b){var a,e=p.length;for(a=0;a<e;a+=1)if("urn:oasis:names:tc:opendocument:xmlns:office:1.0"===b.namespaceURI&&b.localName===p[a])return a;return-1}function k(b,a){var e=new c.UsedStyleList(b,a),d=new odf.OdfNodeFilter;this.acceptNode=function(b){var c=d.acceptNode(b);c===NodeFilter.FILTER_ACCEPT&&b.parentNode===a&&b.nodeType===Node.ELEMENT_NODE&&(c=e.uses(b)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT);return c}}function d(b,a){var e=new k(b,a);this.acceptNode=function(a){var b=
e.acceptNode(a);b!==NodeFilter.FILTER_ACCEPT||!a.parentNode||a.parentNode.namespaceURI!==odf.Namespaces.textns||"s"!==a.parentNode.localName&&"tab"!==a.parentNode.localName||(b=NodeFilter.FILTER_REJECT);return b}}function b(b,a){if(a){var e=g(a),c,d=b.firstChild;if(-1!==e){for(;d;){c=g(d);if(-1!==c&&c>e)break;d=d.nextSibling}b.insertBefore(a,d)}}}var c=new odf.StyleInfo,l=core.DomUtils,n=odf.Namespaces.stylens,p="meta settings scripts font-face-decls styles automatic-styles master-styles body".split(" "),
q=Date.now()+"_webodf_",f=new core.Base64;odf.ODFElement=function(){};odf.ODFDocumentElement=function(){};odf.ODFDocumentElement.prototype=new odf.ODFElement;odf.ODFDocumentElement.prototype.constructor=odf.ODFDocumentElement;odf.ODFDocumentElement.prototype.fontFaceDecls=null;odf.ODFDocumentElement.prototype.manifest=null;odf.ODFDocumentElement.prototype.settings=null;odf.ODFDocumentElement.namespaceURI="urn:oasis:names:tc:opendocument:xmlns:office:1.0";odf.ODFDocumentElement.localName="document";
odf.AnnotationElement=function(){};odf.OdfPart=function(b,a,e,c){var d=this;this.size=0;this.type=null;this.name=b;this.container=e;this.url=null;this.mimetype=a;this.onstatereadychange=this.document=null;this.EMPTY=0;this.LOADING=1;this.DONE=2;this.state=this.EMPTY;this.data="";this.load=function(){null!==c&&(this.mimetype=a,c.loadAsDataURL(b,a,function(a,e){a&&runtime.log(a);d.url=e;if(d.onchange)d.onchange(d);if(d.onstatereadychange)d.onstatereadychange(d)}))}};odf.OdfPart.prototype.load=function(){};
odf.OdfPart.prototype.getUrl=function(){return this.data?"data:;base64,"+f.toBase64(this.data):null};odf.OdfContainer=function a(e,g){function m(a){for(var e=a.firstChild,b;e;)b=e.nextSibling,e.nodeType===Node.ELEMENT_NODE?m(e):e.nodeType===Node.PROCESSING_INSTRUCTION_NODE&&a.removeChild(e),e=b}function p(a){var e={},b,c,d=a.ownerDocument.createNodeIterator(a,NodeFilter.SHOW_ELEMENT,null,!1);for(a=d.nextNode();a;)"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===a.namespaceURI&&("annotation"===
a.localName?(b=a.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","name"))&&(e.hasOwnProperty(b)?runtime.log("Warning: annotation name used more than once with <office:annotation/>: '"+b+"'"):e[b]=a):"annotation-end"===a.localName&&((b=a.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","name"))?e.hasOwnProperty(b)?(c=e[b],c.annotationEndElement?runtime.log("Warning: annotation name used more than once with <office:annotation-end/>: '"+b+"'"):c.annotationEndElement=
a):runtime.log("Warning: annotation end without an annotation start, name: '"+b+"'"):runtime.log("Warning: annotation end without a name found"))),a=d.nextNode()}function u(a,e){for(var b=a&&a.firstChild;b;)b.nodeType===Node.ELEMENT_NODE&&b.setAttributeNS("urn:webodf:names:scope","scope",e),b=b.nextSibling}function z(a,e){for(var b=T.rootElement.meta,b=b&&b.firstChild;b&&(b.namespaceURI!==a||b.localName!==e);)b=b.nextSibling;for(b=b&&b.firstChild;b&&b.nodeType!==Node.TEXT_NODE;)b=b.nextSibling;return b?
b.data:null}function t(a){var e={},b;for(a=a.firstChild;a;)a.nodeType===Node.ELEMENT_NODE&&a.namespaceURI===n&&"font-face"===a.localName&&(b=a.getAttributeNS(n,"name"),e[b]=a),a=a.nextSibling;return e}function s(a,e){var b=null,c,d,f;if(a)for(b=a.cloneNode(!0),c=b.firstElementChild;c;)d=c.nextElementSibling,(f=c.getAttributeNS("urn:webodf:names:scope","scope"))&&f!==e&&b.removeChild(c),c=d;return b}function x(a,e){var b,d,f,m=null,g={};if(a)for(e.forEach(function(a){c.collectUsedFontFaces(g,a)}),
m=a.cloneNode(!0),b=m.firstElementChild;b;)d=b.nextElementSibling,f=b.getAttributeNS(n,"name"),g[f]||m.removeChild(b),b=d;return m}function w(a){var e=T.rootElement.ownerDocument,b;if(a){m(a.documentElement);try{b=e.importNode(a.documentElement,!0)}catch(c){}}return b}function C(a){T.state=a;if(T.onchange)T.onchange(T);if(T.onstatereadychange)T.onstatereadychange(T)}function G(a){Y=null;T.rootElement=a;a.fontFaceDecls=l.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","font-face-decls");
a.styles=l.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","styles");a.automaticStyles=l.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles");a.masterStyles=l.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","master-styles");a.body=l.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","body");a.meta=l.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","meta");a.settings=l.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0",
"settings");a.scripts=l.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","scripts");p(a)}function B(e){var d=w(e),f=T.rootElement,m;d&&"document-styles"===d.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===d.namespaceURI?(f.fontFaceDecls=l.getDirectChild(d,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","font-face-decls"),b(f,f.fontFaceDecls),m=l.getDirectChild(d,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","styles"),f.styles=m||e.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0",
"styles"),b(f,f.styles),m=l.getDirectChild(d,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles"),f.automaticStyles=m||e.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles"),u(f.automaticStyles,"document-styles"),b(f,f.automaticStyles),d=l.getDirectChild(d,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","master-styles"),f.masterStyles=d||e.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","master-styles"),b(f,f.masterStyles),
c.prefixStyleNames(f.automaticStyles,q,f.masterStyles)):C(a.INVALID)}function E(e){e=w(e);var d,f,m,g;if(e&&"document-content"===e.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===e.namespaceURI){d=T.rootElement;m=l.getDirectChild(e,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","font-face-decls");if(d.fontFaceDecls&&m){g=d.fontFaceDecls;var r,p,k,q,s={};f=t(g);q=t(m);for(m=m.firstElementChild;m;){r=m.nextElementSibling;if(m.namespaceURI===n&&"font-face"===m.localName)if(p=m.getAttributeNS(n,
"name"),f.hasOwnProperty(p)){if(!m.isEqualNode(f[p])){k=p;for(var A=f,U=q,y=0,Z=void 0,Z=k=k.replace(/\d+$/,"");A.hasOwnProperty(Z)||U.hasOwnProperty(Z);)y+=1,Z=k+y;k=Z;m.setAttributeNS(n,"style:name",k);g.appendChild(m);f[k]=m;delete q[p];s[p]=k}}else g.appendChild(m),f[p]=m,delete q[p];m=r}g=s}else m&&(d.fontFaceDecls=m,b(d,m));f=l.getDirectChild(e,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles");u(f,"document-content");g&&c.changeFontFaceNames(f,g);if(d.automaticStyles&&f)for(g=
f.firstChild;g;)d.automaticStyles.appendChild(g),g=f.firstChild;else f&&(d.automaticStyles=f,b(d,f));e=l.getDirectChild(e,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","body");if(null===e)throw"<office:body/> tag is mising.";d.body=e;b(d,d.body)}else C(a.INVALID)}function J(a){a=w(a);var e;a&&"document-meta"===a.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===a.namespaceURI&&(e=T.rootElement,e.meta=l.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","meta"),
b(e,e.meta))}function I(a){a=w(a);var e;a&&"document-settings"===a.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===a.namespaceURI&&(e=T.rootElement,e.settings=l.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","settings"),b(e,e.settings))}function U(a){a=w(a);var e;if(a&&"manifest"===a.localName&&"urn:oasis:names:tc:opendocument:xmlns:manifest:1.0"===a.namespaceURI)for(e=T.rootElement,e.manifest=a,a=e.manifest.firstElementChild;a;)"file-entry"===a.localName&&"urn:oasis:names:tc:opendocument:xmlns:manifest:1.0"===
a.namespaceURI&&(O[a.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","full-path")]=a.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","media-type")),a=a.nextElementSibling}function Q(a,e,b){a=l.getElementsByTagName(a,e);var c;for(c=0;c<a.length;c+=1)e=a[c],b.hasOwnProperty(e.namespaceURI)||e.parentNode.removeChild(e)}function A(a){Q(a,"script",{"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:office:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:table:1.0":!0,
"urn:oasis:names:tc:opendocument:xmlns:text:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0":!0});Q(a,"style",{"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:style:1.0":!0})}function Z(a){var e=a.firstElementChild,b=[],c,d,f,m=a.attributes,g=m.length;for(c=0;c<g;c+=1)f=m.item(c),d=f.localName.substr(0,2).toLowerCase(),null===f.namespaceURI&&"on"===d&&b.push(f);g=b.length;for(c=
0;c<g;c+=1)a.removeAttributeNode(b[c]);for(;e;)Z(e),e=e.nextElementSibling}function S(e){var b=e.shift();b?W.loadAsDOM(b.path,function(c,d){d&&(A(d),Z(d.documentElement));b.handler(d);T.state===a.INVALID?c?runtime.log("ERROR: Unable to load "+b.path+" - "+c):runtime.log("ERROR: Unable to load "+b.path):(c&&runtime.log("DEBUG: Unable to load "+b.path+" - "+c),S(e))}):(p(T.rootElement),C(a.DONE))}function v(a){var e="";odf.Namespaces.forEachPrefix(function(a,b){e+=" xmlns:"+a+'="'+b+'"'});return'<?xml version="1.0" encoding="UTF-8"?><office:'+
a+" "+e+' office:version="1.2">'}function H(){var a=new xmldom.LSSerializer,e=v("document-meta");a.filter=new odf.OdfNodeFilter;e+=a.writeToString(T.rootElement.meta,odf.Namespaces.namespaceMap);return e+"</office:document-meta>"}function ba(a,e){var b=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","manifest:file-entry");b.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","manifest:full-path",a);b.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0",
"manifest:media-type",e);return b}function P(){var a=runtime.parseXML('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2"></manifest:manifest>'),e=a.documentElement,b=new xmldom.LSSerializer,c;for(c in O)O.hasOwnProperty(c)&&e.appendChild(ba(c,O[c]));b.filter=new odf.OdfNodeFilter;return'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n'+b.writeToString(a,odf.Namespaces.namespaceMap)}function F(){var a,e,b,d=odf.Namespaces.namespaceMap,
f=new xmldom.LSSerializer,m=v("document-styles");e=s(T.rootElement.automaticStyles,"document-styles");b=T.rootElement.masterStyles.cloneNode(!0);a=x(T.rootElement.fontFaceDecls,[b,T.rootElement.styles,e]);c.removePrefixFromStyleNames(e,q,b);f.filter=new k(b,e);m+=f.writeToString(a,d);m+=f.writeToString(T.rootElement.styles,d);m+=f.writeToString(e,d);m+=f.writeToString(b,d);return m+"</office:document-styles>"}function N(){var a,e,b=odf.Namespaces.namespaceMap,c=new xmldom.LSSerializer,f=v("document-content");
e=s(T.rootElement.automaticStyles,"document-content");a=x(T.rootElement.fontFaceDecls,[e]);c.filter=new d(T.rootElement.body,e);f+=c.writeToString(a,b);f+=c.writeToString(e,b);f+=c.writeToString(T.rootElement.body,b);return f+"</office:document-content>"}function $(e,b){runtime.loadXML(e,function(e,c){if(e)b(e);else if(c){A(c);Z(c.documentElement);var d=w(c);d&&"document"===d.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===d.namespaceURI?(G(d),C(a.DONE)):C(a.INVALID)}else b("No DOM was loaded.")})}
function D(a,e){var c;c=T.rootElement;var d=c.meta;d||(c.meta=d=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","meta"),b(c,d));c=d;a&&l.mapKeyValObjOntoNode(c,a,odf.Namespaces.lookupNamespaceURI);e&&l.removeKeyElementsFromNode(c,e,odf.Namespaces.lookupNamespaceURI)}function V(e,b){function c(a,e){var b;e||(e=a);b=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0",e);g[a]=b;g.appendChild(b)}var d=new core.Zip("",null),f="application/vnd.oasis.opendocument."+
e+(!0===b?"-template":""),m=runtime.byteArrayFromString(f,"utf8"),g=T.rootElement,r=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0",e);d.save("mimetype",m,!1,new Date);c("meta");c("settings");c("scripts");c("fontFaceDecls","font-face-decls");c("styles");c("automaticStyles","automatic-styles");c("masterStyles","master-styles");c("body");g.body.appendChild(r);O["/"]=f;O["settings.xml"]="text/xml";O["meta.xml"]="text/xml";O["styles.xml"]="text/xml";O["content.xml"]="text/xml";
C(a.DONE);return d}function aa(){var a,e=new Date,b="";T.rootElement.settings&&T.rootElement.settings.firstElementChild&&(a=new xmldom.LSSerializer,b=v("document-settings"),a.filter=new odf.OdfNodeFilter,b+=a.writeToString(T.rootElement.settings,odf.Namespaces.namespaceMap),b+="</office:document-settings>");(a=b)?(a=runtime.byteArrayFromString(a,"utf8"),W.save("settings.xml",a,!0,e)):W.remove("settings.xml");b=runtime.getWindow();a="WebODF/"+webodf.Version;b&&(a=a+" "+b.navigator.userAgent);D({"meta:generator":a},
null);a=runtime.byteArrayFromString(H(),"utf8");W.save("meta.xml",a,!0,e);a=runtime.byteArrayFromString(F(),"utf8");W.save("styles.xml",a,!0,e);a=runtime.byteArrayFromString(N(),"utf8");W.save("content.xml",a,!0,e);a=runtime.byteArrayFromString(P(),"utf8");W.save("META-INF/manifest.xml",a,!0,e)}function ca(a,e){aa();W.writeAs(a,function(a){e(a)})}var T=this,W,O={},Y,R="";this.onstatereadychange=g;this.state=this.onchange=null;this.getMetadata=z;this.setRootElement=G;this.getContentElement=function(){var a;
Y||(a=T.rootElement.body,Y=l.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","text")||l.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","presentation")||l.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","spreadsheet"));if(!Y)throw"Could not find content element in <office:body/>.";return Y};this.getDocumentType=function(){var a=T.getContentElement();return a&&a.localName};this.isTemplate=function(){return"-template"===O["/"].substr(-9)};
this.setIsTemplate=function(a){var e=O["/"],b="-template"===e.substr(-9);a!==b&&(e=a?e+"-template":e.substr(0,e.length-9),O["/"]=e,a=runtime.byteArrayFromString(e,"utf8"),W.save("mimetype",a,!1,new Date))};this.getPart=function(a){return new odf.OdfPart(a,O[a],T,W)};this.getPartData=function(a,e){W.load(a,e)};this.setMetadata=D;this.incrementEditingCycles=function(){var a=z(odf.Namespaces.metans,"editing-cycles"),a=a?parseInt(a,10):0;isNaN(a)&&(a=0);D({"meta:editing-cycles":a+1},null);return a+1};
this.createByteArray=function(a,e){aa();W.createByteArray(a,e)};this.saveAs=ca;this.save=function(a){ca(R,a)};this.getUrl=function(){return R};this.setBlob=function(a,e,b){b=f.convertBase64ToByteArray(b);W.save(a,b,!1,new Date);O.hasOwnProperty(a)&&runtime.log(a+" has been overwritten.");O[a]=e};this.removeBlob=function(a){var e=W.remove(a);runtime.assert(e,"file is not found: "+a);delete O[a]};this.state=a.LOADING;this.rootElement=function(a){var e=document.createElementNS(a.namespaceURI,a.localName),
b;a=new a.Type;for(b in a)a.hasOwnProperty(b)&&(e[b]=a[b]);return e}({Type:odf.ODFDocumentElement,namespaceURI:odf.ODFDocumentElement.namespaceURI,localName:odf.ODFDocumentElement.localName});e===odf.OdfContainer.DocumentType.TEXT?W=V("text"):e===odf.OdfContainer.DocumentType.TEXT_TEMPLATE?W=V("text",!0):e===odf.OdfContainer.DocumentType.PRESENTATION?W=V("presentation"):e===odf.OdfContainer.DocumentType.PRESENTATION_TEMPLATE?W=V("presentation",!0):e===odf.OdfContainer.DocumentType.SPREADSHEET?W=V("spreadsheet"):
e===odf.OdfContainer.DocumentType.SPREADSHEET_TEMPLATE?W=V("spreadsheet",!0):(R=e,W=new core.Zip(R,function(e,b){W=b;e?$(R,function(b){e&&(W.error=e+"\n"+b,C(a.INVALID))}):S([{path:"styles.xml",handler:B},{path:"content.xml",handler:E},{path:"meta.xml",handler:J},{path:"settings.xml",handler:I},{path:"META-INF/manifest.xml",handler:U}])}))};odf.OdfContainer.EMPTY=0;odf.OdfContainer.LOADING=1;odf.OdfContainer.DONE=2;odf.OdfContainer.INVALID=3;odf.OdfContainer.SAVING=4;odf.OdfContainer.MODIFIED=5;odf.OdfContainer.getContainer=
function(a){return new odf.OdfContainer(a,null)}})();odf.OdfContainer.DocumentType={TEXT:1,TEXT_TEMPLATE:2,PRESENTATION:3,PRESENTATION_TEMPLATE:4,SPREADSHEET:5,SPREADSHEET_TEMPLATE:6};gui.AnnotatableCanvas=function(){};gui.AnnotatableCanvas.prototype.refreshSize=function(){};gui.AnnotatableCanvas.prototype.getZoomLevel=function(){};gui.AnnotatableCanvas.prototype.getSizer=function(){};
gui.AnnotationViewManager=function(g,k,d,b){function c(e){var b=e.annotationEndElement,c=h.createRange(),d=e.getAttributeNS(odf.Namespaces.officens,"name");b&&(c.setStart(e,e.childNodes.length),c.setEnd(b,0),e=a.getTextNodes(c,!1),e.forEach(function(a){var e;a:{for(e=a.parentNode;e.namespaceURI!==odf.Namespaces.officens||"body"!==e.localName;){if(e.namespaceURI===r&&"webodf-annotationHighlight"===e.className&&e.getAttribute("annotation")===d){e=!0;break a}e=e.parentNode}e=!1}e||(e=h.createElement("span"),
e.className="webodf-annotationHighlight",e.setAttribute("annotation",d),a.parentNode.replaceChild(e,a),e.appendChild(a))}));c.detach()}function l(a){var b=g.getSizer();a?(d.style.display="inline-block",b.style.paddingRight=e.getComputedStyle(d).width):(d.style.display="none",b.style.paddingRight=0);g.refreshSize()}function n(){f.sort(function(a,e){return 0!==(a.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_FOLLOWING)?-1:1})}function p(){var a;for(a=0;a<f.length;a+=1){var e=f[a],b=e.parentNode,
c=b.nextElementSibling,h=c.nextElementSibling,r=b.parentNode,l=0,l=f[f.indexOf(e)-1],n=void 0,e=g.getZoomLevel();b.style.left=(d.getBoundingClientRect().left-r.getBoundingClientRect().left)/e+"px";b.style.width=d.getBoundingClientRect().width/e+"px";c.style.width=parseFloat(b.style.left)-30+"px";l?(n=l.parentNode.getBoundingClientRect(),20>=(r.getBoundingClientRect().top-n.bottom)/e?b.style.top=Math.abs(r.getBoundingClientRect().top-n.bottom)/e+20+"px":b.style.top="0px"):b.style.top="0px";h.style.left=
c.getBoundingClientRect().width/e+"px";var c=h.style,r=h.getBoundingClientRect().left/e,l=h.getBoundingClientRect().top/e,n=b.getBoundingClientRect().left/e,p=b.getBoundingClientRect().top/e,k=0,q=0,k=n-r,k=k*k,q=p-l,q=q*q,r=Math.sqrt(k+q);c.width=r+"px";l=Math.asin((b.getBoundingClientRect().top-h.getBoundingClientRect().top)/(e*parseFloat(h.style.width)));h.style.transform="rotate("+l+"rad)";h.style.MozTransform="rotate("+l+"rad)";h.style.WebkitTransform="rotate("+l+"rad)";h.style.msTransform="rotate("+
l+"rad)"}}function q(a){var e=f.indexOf(a),b=a.parentNode.parentNode;"div"===b.localName&&(b.parentNode.insertBefore(a,b),b.parentNode.removeChild(b));a=a.getAttributeNS(odf.Namespaces.officens,"name");a=h.querySelectorAll('span.webodf-annotationHighlight[annotation="'+a+'"]');for(var c,b=0;b<a.length;b+=1){for(c=a.item(b);c.firstChild;)c.parentNode.insertBefore(c.firstChild,c);c.parentNode.removeChild(c)}-1!==e&&f.splice(e,1);0===f.length&&l(!1)}var f=[],h=k.ownerDocument,a=odf.OdfUtils,e=runtime.getWindow(),
r="http://www.w3.org/1999/xhtml";runtime.assert(Boolean(e),"Expected to be run in an environment which has a global window, like a browser.");this.rerenderAnnotations=p;this.rehighlightAnnotations=function(){f.forEach(function(a){c(a)})};this.getMinimumHeightForAnnotationPane=function(){return"none"!==d.style.display&&0<f.length?(f[f.length-1].parentNode.getBoundingClientRect().bottom-d.getBoundingClientRect().top)/g.getZoomLevel()+"px":null};this.addAnnotations=function(e){0!==e.length&&(l(!0),e.forEach(function(e){f.push(e);
var d=h.createElement("div"),m=h.createElement("div"),g=h.createElement("div"),r=h.createElement("div"),l;d.className="annotationWrapper";d.setAttribute("creator",a.getAnnotationCreator(e));e.parentNode.insertBefore(d,e);m.className="annotationNote";m.appendChild(e);b&&(l=h.createElement("div"),l.className="annotationRemoveButton",m.appendChild(l));g.className="annotationConnector horizontal";r.className="annotationConnector angular";d.appendChild(m);d.appendChild(g);d.appendChild(r);e.annotationEndElement&&
c(e)}),n(),p())};this.forgetAnnotation=q;this.forgetAnnotations=function(){for(;f.length;)q(f[0])}};gui.Viewport=function(){};gui.Viewport.prototype.scrollIntoView=function(g,k){};gui.SingleScrollViewport=function(g){this.scrollIntoView=function(k,d){var b,c,l,n;n=g.offsetHeight-g.clientHeight;l=g.offsetWidth-g.clientWidth;var p=g.getBoundingClientRect();if(k&&p){b=p.left+5;c=p.top+5;l=p.right-(l+5);n=p.bottom-(n+5);if(d||k.top<c)g.scrollTop-=c-k.top;else if(k.top>n||k.bottom>n)g.scrollTop=k.bottom-k.top<=n-c?g.scrollTop+(k.bottom-n):g.scrollTop+(k.top-c);k.left<b?g.scrollLeft-=b-k.left:k.right>l&&(g.scrollLeft=k.right-k.left<=l-b?g.scrollLeft+(k.right-l):g.scrollLeft-(b-k.left))}}};(function(){function g(c,d,n,p,k){var f,h=0,a;for(a in c)if(c.hasOwnProperty(a)){if(h===n){f=a;break}h+=1}f?d.getPartData(c[f].href,function(a,h){if(a)runtime.log(a);else if(h){var m="@font-face { font-family: "+(c[f].family||f)+"; src: url(data:application/x-font-ttf;charset=binary;base64,"+b.convertUTF8ArrayToBase64(h)+') format("truetype"); }';try{p.insertRule(m,p.cssRules.length)}catch(y){runtime.log("Problem inserting rule in CSS: "+runtime.toJson(y)+"\nRule: "+m)}}else runtime.log("missing font data for "+
c[f].href);g(c,d,n+1,p,k)}):k&&k()}var k=xmldom.XPath,d=odf.OdfUtils,b=new core.Base64;odf.FontLoader=function(){this.loadFonts=function(b,l){for(var n=b.rootElement.fontFaceDecls;l.cssRules.length;)l.deleteRule(l.cssRules.length-1);if(n){var p={},q,f,h,a;if(n)for(n=k.getODFElementsWithXPath(n,"style:font-face[svg:font-face-src]",odf.Namespaces.lookupNamespaceURI),q=0;q<n.length;q+=1)f=n[q],h=f.getAttributeNS(odf.Namespaces.stylens,"name"),a=d.getNormalizedFontFamilyName(f.getAttributeNS(odf.Namespaces.svgns,
"font-family")),f=k.getODFElementsWithXPath(f,"svg:font-face-src/svg:font-face-uri",odf.Namespaces.lookupNamespaceURI),0<f.length&&(f=f[0].getAttributeNS(odf.Namespaces.xlinkns,"href"),p[h]={href:f,family:a});g(p,b,0,l)}}}})();odf.Formatting=function(){function g(a){return(a=C[a])?x.mergeObjects({},a):{}}function k(){for(var e=a.rootElement.fontFaceDecls,b={},c,d,e=e&&e.firstElementChild;e;){if(c=e.getAttributeNS(m,"name"))if((d=e.getAttributeNS(r,"font-family"))||0<e.getElementsByTagNameNS(r,"font-face-uri").length)b[c]=d;e=e.nextElementSibling}return b}function d(e){for(var b=a.rootElement.styles.firstElementChild;b;){if(b.namespaceURI===m&&"default-style"===b.localName&&b.getAttributeNS(m,"family")===e)return b;b=b.nextElementSibling}return null}
function b(e,b,c){var d,f,h;c=c||[a.rootElement.automaticStyles,a.rootElement.styles];for(h=0;h<c.length;h+=1)for(d=c[h],d=d.firstElementChild;d;){f=d.getAttributeNS(m,"name");if(d.namespaceURI===m&&"style"===d.localName&&d.getAttributeNS(m,"family")===b&&f===e||"list-style"===b&&d.namespaceURI===y&&"list-style"===d.localName&&f===e||"data"===b&&d.namespaceURI===u&&f===e)return d;d=d.nextElementSibling}return null}function c(a){for(var e,b,c,d,h={},f=a.firstElementChild;f;){if(f.namespaceURI===m)for(c=
h[f.nodeName]={},b=f.attributes,e=0;e<b.length;e+=1)d=b.item(e),c[d.name]=d.value;f=f.nextElementSibling}b=a.attributes;for(e=0;e<b.length;e+=1)d=b.item(e),h[d.name]=d.value;return h}function l(e,f){for(var h=a.rootElement.styles,r,l={},n=e.getAttributeNS(m,"family"),p=e;p;)r=c(p),l=x.mergeObjects(r,l),p=(r=p.getAttributeNS(m,"parent-style-name"))?b(r,n,[h]):null;if(p=d(n))r=c(p),l=x.mergeObjects(r,l);!1!==f&&(r=g(n),l=x.mergeObjects(r,l));return l}function n(b,c){function d(a){Object.keys(a).forEach(function(e){Object.keys(a[e]).forEach(function(a){g+=
"|"+e+":"+a+"|"})})}for(var f=b.nodeType===Node.TEXT_NODE?b.parentNode:b,h,m=[],g="",r=!1;f&&!t.isInlineRoot(f)&&f.parentNode!==a.rootElement;)!r&&t.isGroupingElement(f)&&(r=!0),(h=e.determineStylesForNode(f))&&m.push(h),f=f.parentNode;r&&(m.forEach(d),c&&(c[g]=m));return r?m:void 0}function p(e){var c={orderedStyles:[],styleProperties:{}};e.forEach(function(e){Object.keys(e).forEach(function(d){var f=Object.keys(e[d])[0],h={name:f,family:d,displayName:void 0,isCommonStyle:!1},g;(g=b(f,d))?(d=l(g),
c.styleProperties=x.mergeObjects(d,c.styleProperties),h.displayName=g.getAttributeNS(m,"display-name")||void 0,h.isCommonStyle=g.parentNode===a.rootElement.styles):runtime.log("No style element found for '"+f+"' of family '"+d+"'");c.orderedStyles.push(h)})});return c}function q(a,e){var b={},c=[];e||(e={});a.forEach(function(a){n(a,b)});Object.keys(b).forEach(function(a){e[a]||(e[a]=p(b[a]));c.push(e[a])});return c}function f(e){for(var b=a.rootElement.masterStyles.firstElementChild;b&&(b.namespaceURI!==
m||"master-page"!==b.localName||b.getAttributeNS(m,"name")!==e);)b=b.nextElementSibling;return b}function h(a,e){var b;a&&(b=w.convertMeasure(a,"px"));void 0===b&&e&&(b=w.convertMeasure(e,"px"));return b}var a,e=new odf.StyleInfo,r=odf.Namespaces.svgns,m=odf.Namespaces.stylens,y=odf.Namespaces.textns,u=odf.Namespaces.numberns,z=odf.Namespaces.fons,t=odf.OdfUtils,s=core.DomUtils,x=new core.Utils,w=new core.CSSUnits,C={paragraph:{"style:paragraph-properties":{"fo:text-align":"left"}}};this.getSystemDefaultStyleAttributes=
g;this.setOdfContainer=function(e){a=e};this.getFontMap=k;this.getAvailableParagraphStyles=function(){for(var e=a.rootElement.styles,b,c,d=[],e=e&&e.firstElementChild;e;)"style"===e.localName&&e.namespaceURI===m&&(b=e.getAttributeNS(m,"family"),"paragraph"===b&&(b=e.getAttributeNS(m,"name"),c=e.getAttributeNS(m,"display-name")||b,b&&c&&d.push({name:b,displayName:c}))),e=e.nextElementSibling;return d};this.isStyleUsed=function(b){var c,d=a.rootElement;c=e.hasDerivedStyles(d,odf.Namespaces.lookupNamespaceURI,
b);b=(new e.UsedStyleList(d.styles)).uses(b)||(new e.UsedStyleList(d.automaticStyles)).uses(b)||(new e.UsedStyleList(d.body)).uses(b);return c||b};this.getDefaultStyleElement=d;this.getStyleElement=b;this.getStyleAttributes=c;this.getInheritedStyleAttributes=l;this.getFirstCommonParentStyleNameOrSelf=function(e){var c=a.rootElement.styles,d;if(d=b(e,"paragraph",[a.rootElement.automaticStyles]))if(e=d.getAttributeNS(m,"parent-style-name"),!e)return null;return(d=b(e,"paragraph",[c]))?e:null};this.hasParagraphStyle=
function(a){return Boolean(b(a,"paragraph"))};this.getAppliedStyles=q;this.getAppliedStylesForElement=function(a,e){return q([a],e)[0]};this.updateStyle=function(e,b){var c,d;s.mapObjOntoNode(e,b,odf.Namespaces.lookupNamespaceURI);(c=(c=b["style:text-properties"])&&c["style:font-name"])&&!k().hasOwnProperty(c)&&(d=e.ownerDocument.createElementNS(m,"style:font-face"),d.setAttributeNS(m,"style:name",c),d.setAttributeNS(r,"svg:font-family",c),a.rootElement.fontFaceDecls.appendChild(d))};this.createDerivedStyleObject=
function(e,d,f){var h=b(e,d);runtime.assert(Boolean(h),"No style element found for '"+e+"' of family '"+d+"'");e=h.parentNode===a.rootElement.styles?{"style:parent-style-name":e}:c(h);e["style:family"]=d;x.mergeObjects(e,f);return e};this.getDefaultTabStopDistance=function(){for(var a=d("paragraph"),a=a&&a.firstElementChild,e;a;)a.namespaceURI===m&&"paragraph-properties"===a.localName&&(e=a.getAttributeNS(m,"tab-stop-distance")),a=a.nextElementSibling;e||(e="1.25cm");return t.parseNonNegativeLength(e)};
this.getMasterPageElement=f;this.getContentSize=function(e,c){var d,g,r,l,n,p,k,q,y,u;a:{g=b(e,c);runtime.assert("paragraph"===c||"table"===c,"styleFamily must be either paragraph or table");if(g){if(g=g.getAttributeNS(m,"master-page-name"))(d=f(g))||runtime.log("WARN: No master page definition found for "+g);d||(d=f("Standard"));d||(d=a.rootElement.masterStyles.getElementsByTagNameNS(m,"master-page")[0])||runtime.log("WARN: Document has no master pages defined");if(d)for(g=d.getAttributeNS(m,"page-layout-name"),
r=a.rootElement.automaticStyles.getElementsByTagNameNS(m,"page-layout"),l=0;l<r.length;l+=1)if(d=r.item(l),d.getAttributeNS(m,"name")===g)break a}d=null}d||(d=s.getDirectChild(a.rootElement.styles,m,"default-page-layout"));(d=s.getDirectChild(d,m,"page-layout-properties"))?("landscape"===d.getAttributeNS(m,"print-orientation")?(g="29.7cm",r="21.001cm"):(g="21.001cm",r="29.7cm"),g=h(d.getAttributeNS(z,"page-width"),g),r=h(d.getAttributeNS(z,"page-height"),r),l=h(d.getAttributeNS(z,"margin")),void 0===
l?(l=h(d.getAttributeNS(z,"margin-left"),"2cm"),n=h(d.getAttributeNS(z,"margin-right"),"2cm"),p=h(d.getAttributeNS(z,"margin-top"),"2cm"),k=h(d.getAttributeNS(z,"margin-bottom"),"2cm")):l=n=p=k=l,q=h(d.getAttributeNS(z,"padding")),void 0===q?(q=h(d.getAttributeNS(z,"padding-left"),"0cm"),y=h(d.getAttributeNS(z,"padding-right"),"0cm"),u=h(d.getAttributeNS(z,"padding-top"),"0cm"),d=h(d.getAttributeNS(z,"padding-bottom"),"0cm")):q=y=u=d=q):(g=h("21.001cm"),r=h("29.7cm"),l=n=p=k=l=h("2cm"),q=y=u=d=q=
h("0cm"));return{width:g-l-n-q-y,height:r-p-k-u-d}}};(function(){var g=odf.Namespaces.stylens,k=odf.Namespaces.textns,d={graphic:"draw","drawing-page":"draw",paragraph:"text",presentation:"presentation",ruby:"text",section:"text",table:"table","table-cell":"table","table-column":"table","table-row":"table",text:"text",list:"text",page:"office"};odf.StyleTreeNode=function(b){this.derivedStyles={};this.element=b};odf.StyleTree=function(b,c){function l(b){var a,e,c,d={};if(!b)return d;for(b=b.firstElementChild;b;){if(e=b.namespaceURI!==g||"style"!==b.localName&&
"default-style"!==b.localName?b.namespaceURI===k&&"list-style"===b.localName?"list":b.namespaceURI!==g||"page-layout"!==b.localName&&"default-page-layout"!==b.localName?void 0:"page":b.getAttributeNS(g,"family"))(a=b.getAttributeNS(g,"name"))||(a=""),d.hasOwnProperty(e)?c=d[e]:d[e]=c={},c[a]=b;b=b.nextElementSibling}return d}function n(b,a){if(b.hasOwnProperty(a))return b[a];var e=null,c=Object.keys(b),d;for(d=0;d<c.length&&!(e=n(b[c[d]].derivedStyles,a));d+=1);return e}function p(b,a,e){var c,d,
f;if(!a.hasOwnProperty(b))return null;c=new odf.StyleTreeNode(a[b]);d=c.element.getAttributeNS(g,"parent-style-name");f=null;d&&(f=n(e,d)||p(d,a,e));f?f.derivedStyles[b]=c:e[b]=c;delete a[b];return c}function q(b,a){b&&Object.keys(b).forEach(function(e){p(e,b,a)})}var f={};this.getStyleTree=function(){return f};(function(){var h,a,e;a=l(b);e=l(c);Object.keys(d).forEach(function(b){h=f[b]={};q(a[b],h);q(e[b],h)})})()}})();(function(){function g(b,c){try{b.insertRule(c,b.cssRules.length)}catch(d){runtime.log("cannot load rule: "+c+" - "+d)}}function k(b,c){this.listCounterCount=0;this.contentRules=b;this.counterIdStack=[];this.continuedCounterIdStack=c}function d(b){function c(e,d,h,n){var p=d.namespaceURI===l&&"list"===d.localName,k=d.namespaceURI===l&&"list-item"===d.localName;if(p||k){if(p){var p=h+=1,s,x,w;n.listCounterCount+=1;k=e+"-level"+p+"-"+n.listCounterCount;d.setAttributeNS("urn:webodf:names:helper","counter-id",
k);s=n.continuedCounterIdStack.shift();s||(s=k,a+=k+" 1 ",x='text|list[webodfhelper|counter-id="'+k+'"] > text|list-item:first-child > :not(text|list):first-child:before',x+="{",x+="counter-increment: "+s+" 0;",x+="}",g(b,x));for(;n.counterIdStack.length>=p;)n.counterIdStack.pop();n.counterIdStack.push(s);w=n.contentRules[p.toString()]||"";for(x=1;x<=p;x+=1)w=w.replace(x+"webodf-listLevel",n.counterIdStack[x-1]);x='text|list[webodfhelper|counter-id="'+k+'"] > text|list-item > :not(text|list):first-child:before';
x+="{";x+=w;x+="counter-increment: "+s+";";x+="}";g(b,x)}for(d=d.firstElementChild;d;)c(e,d,h,n),d=d.nextElementSibling}else n.continuedCounterIdStack=[]}var d=0,a="",e={};this.createCounterRules=function(a,b,g){var l=b.getAttributeNS(n,"id"),p=[];g&&(g=g.getAttributeNS("urn:webodf:names:helper","counter-id"),p=e[g].slice(0));a=new k(a,p);l?l="Y"+l:(d+=1,l="X"+d);c(l,b,0,a);e[l+"-level1-1"]=a.counterIdStack};this.initialiseCreatedCounters=function(){var e;e="office|document{"+("counter-reset: "+a+
";");e+="}";g(b,e)}}var b=odf.Namespaces.fons,c=odf.Namespaces.stylens,l=odf.Namespaces.textns,n=odf.Namespaces.xmlns,p={1:"decimal",a:"lower-latin",A:"upper-latin",i:"lower-roman",I:"upper-roman"};odf.ListStyleToCss=function(){function k(a){var e=m.parseLength(a);return e?r.convert(e.value,e.unit,"px"):(runtime.log("Could not parse value '"+a+"'."),0)}function f(a){return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function h(a,e){var b;a&&(b=a.getAttributeNS(l,"style-name"));return b===e}function a(a,
e,d){e='text|list[text|style-name="'+e+'"]';var f=d.getAttributeNS(l,"level"),h,m,r,n,p,B,E;d=(h=d.getElementsByTagNameNS(c,"list-level-properties")[0])&&h.getAttributeNS(l,"list-level-position-and-space-mode");m=h&&h.getElementsByTagNameNS(c,"list-level-label-alignment")[0];for(f=f&&parseInt(f,10);1<f;)e+=" > text|list-item > text|list",f-=1;f=h&&h.getAttributeNS(b,"text-align")||"left";switch(f){case "end":f="right";break;case "start":f="left"}"label-alignment"===d?(r=m&&m.getAttributeNS(b,"margin-left")||
"0px",B=m&&m.getAttributeNS(b,"text-indent")||"0px",E=m&&m.getAttributeNS(l,"label-followed-by"),m=k(r)):(r=h&&h.getAttributeNS(l,"space-before")||"0px",n=h&&h.getAttributeNS(l,"min-label-width")||"0px",p=h&&h.getAttributeNS(l,"min-label-distance")||"0px",m=k(r)+k(n));h=e+" > text|list-item{";h+="margin-left: "+m+"px;";h+="}";g(a,h);h=e+" > text|list-item > text|list{";h+="margin-left: "+-m+"px;";h+="}";g(a,h);h=e+" > text|list-item > :not(text|list):first-child::before{";h+="text-align: "+f+";";
h+="display: inline-block;";"label-alignment"===d?(h+="margin-left: "+B+";","listtab"===E&&(h+="padding-right: 0.2cm;")):(h+="min-width: "+n+";",h+="margin-left: "+(0===parseFloat(n)?"":"-")+n+";",h+="padding-right: "+p+";");h+="}";g(a,h)}function e(a,e,b){e=e.getElementsByTagNameNS(l,"list");a=new d(a);var m,g,r,k,q,G,B={},E;for(E=0;E<e.length;E+=1)if(m=e.item(E),G=m.getAttributeNS(l,"style-name")){r=m.getAttributeNS(l,"continue-numbering");k=m.getAttributeNS(l,"continue-list");(q=m.getAttributeNS(n,
"id"))&&(B[q]=m);if(void 0===b[G])q={};else{q=b[G].element.firstElementChild;for(var J=void 0,I={};q;){var J=(J=q.getAttributeNS(l,"level"))&&parseInt(J,10),U=I,Q=q,A="",Z=void 0,S=void 0,v=Z=void 0;if("list-level-style-number"===Q.localName){var H=Q,A=H.getAttributeNS(c,"num-format"),Z=H.getAttributeNS(c,"num-suffix")||"",S=H.getAttributeNS(c,"num-prefix")||"",ba="",P=H.getAttributeNS(l,"level"),H=H.getAttributeNS(l,"display-levels");S&&(ba+='"'+f(S)+'"\n');if(p.hasOwnProperty(A))for(P=P?parseInt(P,
10):1,H=H?parseInt(H,10):1;0<H;)ba+=" counter("+(P-H+1)+"webodf-listLevel,"+p[A]+")",1<H&&(ba+='"."'),H-=1;else ba=A?ba+(' "'+A+'"'):ba+' ""';A="content:"+ba+' "'+f(Z)+'"'}else"list-level-style-image"===Q.localName?A="content: none":"list-level-style-bullet"===Q.localName&&(A=Q.getAttributeNS(l,"bullet-char"),A='content: "'+f(A)+'"');if(Z=Q.getElementsByTagNameNS(c,"list-level-properties")[0])S=Z.getAttributeNS(l,"list-level-position-and-space-mode"),"label-alignment"===S&&((Z=Z.getElementsByTagNameNS(c,
"list-level-label-alignment")[0])&&(v=Z.getAttributeNS(l,"label-followed-by")),"space"===v&&(A+=' "\\a0"'));U[J]="\n"+A+";\n";q=q.nextElementSibling}q=I}r&&!k&&h(g,G)?a.createCounterRules(q,m,g):k&&h(B[k],G)?a.createCounterRules(q,m,B[k]):a.createCounterRules(q,m);g=m}a.initialiseCreatedCounters()}var r=new core.CSSUnits,m=odf.OdfUtils;this.addListStyleRule=a;this.applyListStyles=function(b,c,d){var f,h;(f=c.list)&&Object.keys(f).forEach(function(e){h=f[e];for(var c=h.element.firstElementChild;c;)c.namespaceURI===
l&&a(b,e,c),c=c.nextElementSibling});e(b,d,f)}}})();odf.LazyStyleProperties=function(g,k){var d={};this.value=function(b){var c;d.hasOwnProperty(b)?c=d[b]:(c=k[b](),void 0===c&&g&&(c=g.value(b)),d[b]=c);return c};this.reset=function(b){g=b;d={}}};
odf.StyleParseUtils=function(){function g(d){var b,c;d=(d=/(-?[0-9]*[0-9][0-9]*(\.[0-9]*)?|0+\.[0-9]*[1-9][0-9]*|\.[0-9]*[1-9][0-9]*)((cm)|(mm)|(in)|(pt)|(pc)|(px))/.exec(d))?{value:parseFloat(d[1]),unit:d[3]}:null;c=d&&d.unit;"px"===c?b=d.value:"cm"===c?b=96*(d.value/2.54):"mm"===c?b=96*(d.value/25.4):"in"===c?b=96*d.value:"pt"===c?b=d.value/0.75:"pc"===c&&(b=16*d.value);return b}var k=odf.Namespaces.stylens;this.parseLength=g;this.parsePositiveLengthOrPercent=function(d,b,c){var l;d&&(l=parseFloat(d.substr(0,
d.indexOf("%"))),isNaN(l)&&(l=void 0));var n;void 0!==l?(c&&(n=c.value(b)),l=void 0===n?void 0:l*(n/100)):l=g(d);return l};this.getPropertiesElement=function(d,b,c){for(b=c?c.nextElementSibling:b.firstElementChild;null!==b&&(b.localName!==d||b.namespaceURI!==k);)b=b.nextElementSibling;return b};this.parseAttributeList=function(d){d&&(d=d.replace(/^\s*(.*?)\s*$/g,"$1"));return d&&0<d.length?d.split(/\s+/):[]}};odf.Style2CSS=function(){function g(a,e,b){var c=[];b=b.derivedStyles;var d;var f=z[a],h;void 0===f?e=null:(h=e?"["+f+'|style-name="'+e+'"]':"","presentation"===f&&(f="draw",h=e?'[presentation|style-name="'+e+'"]':""),e=f+"|"+t[a].join(h+","+f+"|")+h);null!==e&&c.push(e);for(d in b)b.hasOwnProperty(d)&&(e=g(a,d,b[d]),c=c.concat(e));return c}function k(a){var e="",b="",e=null;if("default-style"===a.localName)return null;e=a.getAttributeNS(h,"parent-style-name");b=a.getAttributeNS(h,"family");return e=
P.getODFElementsWithXPath(H,e?"//style:*[@style:name='"+e+"'][@style:family='"+b+"']":"//style:default-style[@style:family='"+b+"']",odf.Namespaces.lookupNamespaceURI)[0]}function d(a,e){var b="",c,d,f;for(c=0;c<e.length;c+=1)if(d=e[c],f=a.getAttributeNS(d[0],d[1])){f=f.trim();if(Q.hasOwnProperty(d[1])){var m=f,g=m.indexOf(" "),r=void 0;f=void 0;-1!==g?(r=m.substring(0,g),f=m.substring(g)):(r=m,f="");(r=S.parseLength(r))&&"pt"===r.unit&&0.75>r.value&&(m="0.75pt"+f);f=m}else if(A.hasOwnProperty(d[1])){var m=
a,g=d[0],r=d[1],l=S.parseLength(f),n=void 0,p=void 0,q=void 0,s=void 0,q=void 0;if(l&&"%"===l.unit){n=l.value/100;p=k(m.parentNode);for(s="0";p;){if(q=y.getDirectChild(p,h,"paragraph-properties"))if(q=S.parseLength(q.getAttributeNS(g,r))){if("%"!==q.unit){s=q.value*n+q.unit;break}n*=q.value/100}p=k(p)}f=s}}d[2]&&(b+=d[2]+":"+f+";")}return b}function b(a,e,b,c){return e+e+b+b+c+c}function c(a,e){var b=[a],d=e.derivedStyles;Object.keys(d).forEach(function(a){a=c(a,d[a]);b=b.concat(a)});return b}function l(a,
e,b,d){function f(e,b){var c=[],d;e.forEach(function(a){h.forEach(function(e){c.push('draw|page[webodfhelper|page-style-name="'+e+'"] draw|frame[presentation|class="'+a+'"]')})});0<c.length&&(d=c.join(",")+"{visibility:"+b+";}",a.insertRule(d,a.cssRules.length))}var h=c(e,d),g=[],r=[];["page-number","date-time","header","footer"].forEach(function(a){var e;e=b.getAttributeNS(m,"display-"+a);"true"===e?g.push(a):"false"===e&&r.push(a)});f(g,"visible");f(r,"hidden")}function n(a,c,A,Q){var t,z;if("page"===
c){var H=Q.element,P="",O,Y;Y=O="";A=y.getDirectChild(H,h,"page-layout-properties");var R;if(A)if(R=H.getAttributeNS(h,"name"),P+=d(A,I),(O=y.getDirectChild(A,h,"background-image"))&&(Y=O.getAttributeNS(r,"href"))&&(P=P+("background-image: url('odfkit:"+Y+"');")+d(O,x)),"presentation"===v)for(H=(H=y.getDirectChild(H.parentNode.parentNode,f,"master-styles"))&&H.firstElementChild;H;)H.namespaceURI===h&&"master-page"===H.localName&&H.getAttributeNS(h,"page-layout-name")===R&&(Y=H.getAttributeNS(h,"name"),
O='draw|page[draw|master-page-name="'+Y+'"] {'+P+"}",Y='office|body, draw|page[draw|master-page-name="'+Y+'"] {'+d(A,U)+" }",a.insertRule(O,a.cssRules.length),a.insertRule(Y,a.cssRules.length)),H=H.nextElementSibling;else"text"===v&&(O="office|text {"+P+"}",Y="office|body {width: "+A.getAttributeNS(q,"page-width")+";}",a.insertRule(O,a.cssRules.length),a.insertRule(Y,a.cssRules.length))}else{P=g(c,A,Q).join(",");R="";if(H=y.getDirectChild(Q.element,h,"text-properties")){var L=H,ea=z="";O="";Y=1;H=
""+d(L,s);t=L.getAttributeNS(h,"text-underline-style");"solid"===t&&(z+=" underline");t=L.getAttributeNS(h,"text-line-through-style");"solid"===t&&(z+=" line-through");z.length&&(H=H+("text-decoration:"+z+";\n")+("text-decoration-line:"+z+";\n"),H+="-moz-text-decoration-line:"+z+";\n");t=L.getAttributeNS(h,"text-line-through-type");switch(t){case "double":ea+=" double";break;case "single":ea+=" single"}ea&&(H+="text-decoration-style:"+ea+";\n",H+="-moz-text-decoration-style:"+ea+";\n");if(z=L.getAttributeNS(h,
"font-name")||L.getAttributeNS(q,"font-family"))t=Z[z],H+="font-family: "+(t||z)+";";if(t=L.getAttributeNS(h,"text-position"))z=u.parseAttributeList(t),t=z[0],z=z[1],H+="vertical-align: "+t+"\n; ",z&&(Y=parseFloat(z)/100);if(L.hasAttributeNS(q,"font-size")||1!==Y){for(L=L.parentNode;L;){if(t=(t=y.getDirectChild(L,h,"text-properties"))?S.parseFoFontSize(t.getAttributeNS(q,"font-size")):null){if("%"!==t.unit){O="font-size: "+t.value*Y+t.unit+";";break}Y*=t.value/100}L=k(L)}O||(O="font-size: "+parseFloat(ba)*
Y+F.getUnits(ba)+";")}H+=O;R+=H}if(H=y.getDirectChild(Q.element,h,"paragraph-properties"))O=H,H=""+d(O,w),(Y=y.getDirectChild(O,h,"background-image"))&&(L=Y.getAttributeNS(r,"href"))&&(H=H+("background-image: url('odfkit:"+L+"');")+d(Y,x)),(O=O.getAttributeNS(q,"line-height"))&&"normal"!==O&&(O=S.parseFoLineHeight(O),H="%"!==O.unit?H+("line-height: "+O.value+O.unit+";"):H+("line-height: "+O.value/100+";")),R+=H;if(H=y.getDirectChild(Q.element,h,"graphic-properties"))L=H,H=""+d(L,C),O=L.getAttributeNS(p,
"opacity"),Y=L.getAttributeNS(p,"fill"),L=L.getAttributeNS(p,"fill-color"),"solid"===Y||"hatch"===Y?L&&"none"!==L?(O=isNaN(parseFloat(O))?1:parseFloat(O)/100,Y=L.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,b),(L=(Y=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(Y))?{r:parseInt(Y[1],16),g:parseInt(Y[2],16),b:parseInt(Y[3],16)}:null)&&(H+="background-color: rgba("+L.r+","+L.g+","+L.b+","+O+");")):H+="background: none;":"none"===Y&&(H+="background: none;"),R+=H;if(H=y.getDirectChild(Q.element,h,"drawing-page-properties"))O=
H,Y=""+d(O,C),"true"===O.getAttributeNS(m,"background-visible")&&(Y+="background: none;"),R+=Y,l(a,A,H,Q);if(H=y.getDirectChild(Q.element,h,"table-cell-properties"))A=R,R=""+d(H,G),R=A+R;if(H=y.getDirectChild(Q.element,h,"table-row-properties"))A=R,R=""+d(H,E),R=A+R;if(H=y.getDirectChild(Q.element,h,"table-column-properties"))A=R,R=""+d(H,B),R=A+R;if(H=y.getDirectChild(Q.element,h,"table-properties"))A=R,R=""+d(H,J),H=H.getAttributeNS(e,"border-model"),"collapsing"===H?R+="border-collapse:collapse;":
"separating"===H&&(R+="border-collapse:separate;"),R=A+R;0!==R.length&&a.insertRule(P+"{"+R+"}",a.cssRules.length)}for(var ga in Q.derivedStyles)Q.derivedStyles.hasOwnProperty(ga)&&n(a,c,ga,Q.derivedStyles[ga])}var p=odf.Namespaces.drawns,q=odf.Namespaces.fons,f=odf.Namespaces.officens,h=odf.Namespaces.stylens,a=odf.Namespaces.svgns,e=odf.Namespaces.tablens,r=odf.Namespaces.xlinkns,m=odf.Namespaces.presentationns,y=core.DomUtils,u=new odf.StyleParseUtils,z={graphic:"draw","drawing-page":"draw",paragraph:"text",
presentation:"presentation",ruby:"text",section:"text",table:"table","table-cell":"table","table-column":"table","table-row":"table",text:"text",list:"text",page:"office"},t={graphic:"circle connected control custom-shape ellipse frame g line measure page page-thumbnail path polygon polyline rect regular-polygon".split(" "),paragraph:"alphabetical-index-entry-template h illustration-index-entry-template index-source-style object-index-entry-template p table-index-entry-template table-of-content-entry-template user-index-entry-template".split(" "),
presentation:"caption circle connector control custom-shape ellipse frame g line measure page-thumbnail path polygon polyline rect regular-polygon".split(" "),"drawing-page":"caption circle connector control page custom-shape ellipse frame g line measure page-thumbnail path polygon polyline rect regular-polygon".split(" "),ruby:["ruby","ruby-text"],section:"alphabetical-index bibliography illustration-index index-title object-index section table-of-content table-index user-index".split(" "),table:["background",
"table"],"table-cell":"body covered-table-cell even-columns even-rows first-column first-row last-column last-row odd-columns odd-rows table-cell".split(" "),"table-column":["table-column"],"table-row":["table-row"],text:"a index-entry-chapter index-entry-link-end index-entry-link-start index-entry-page-number index-entry-span index-entry-tab-stop index-entry-text index-title-template linenumbering-configuration list-level-style-number list-level-style-bullet outline-level-style span".split(" "),
list:["list-item"]},s=[[q,"color","color"],[q,"background-color","background-color"],[q,"font-weight","font-weight"],[q,"font-style","font-style"]],x=[[h,"repeat","background-repeat"]],w=[[q,"background-color","background-color"],[q,"text-align","text-align"],[q,"text-indent","text-indent"],[q,"padding","padding"],[q,"padding-left","padding-left"],[q,"padding-right","padding-right"],[q,"padding-top","padding-top"],[q,"padding-bottom","padding-bottom"],[q,"border-left","border-left"],[q,"border-right",
"border-right"],[q,"border-top","border-top"],[q,"border-bottom","border-bottom"],[q,"margin","margin"],[q,"margin-left","margin-left"],[q,"margin-right","margin-right"],[q,"margin-top","margin-top"],[q,"margin-bottom","margin-bottom"],[q,"border","border"]],C=[[q,"background-color","background-color"],[q,"min-height","min-height"],[p,"stroke","border"],[a,"stroke-color","border-color"],[a,"stroke-width","border-width"],[q,"border","border"],[q,"border-left","border-left"],[q,"border-right","border-right"],
[q,"border-top","border-top"],[q,"border-bottom","border-bottom"]],G=[[q,"background-color","background-color"],[q,"border-left","border-left"],[q,"border-right","border-right"],[q,"border-top","border-top"],[q,"border-bottom","border-bottom"],[q,"border","border"]],B=[[h,"column-width","width"]],E=[[h,"row-height","height"],[q,"keep-together",null]],J=[[h,"width","width"],[q,"margin-left","margin-left"],[q,"margin-right","margin-right"],[q,"margin-top","margin-top"],[q,"margin-bottom","margin-bottom"]],
I=[[q,"background-color","background-color"],[q,"padding","padding"],[q,"padding-left","padding-left"],[q,"padding-right","padding-right"],[q,"padding-top","padding-top"],[q,"padding-bottom","padding-bottom"],[q,"border","border"],[q,"border-left","border-left"],[q,"border-right","border-right"],[q,"border-top","border-top"],[q,"border-bottom","border-bottom"],[q,"margin","margin"],[q,"margin-left","margin-left"],[q,"margin-right","margin-right"],[q,"margin-top","margin-top"],[q,"margin-bottom","margin-bottom"]],
U=[[q,"page-width","width"],[q,"page-height","height"]],Q={border:!0,"border-left":!0,"border-right":!0,"border-top":!0,"border-bottom":!0,"stroke-width":!0},A={margin:!0,"margin-left":!0,"margin-right":!0,"margin-top":!0,"margin-bottom":!0},Z={},S=odf.OdfUtils,v,H,ba,P=xmldom.XPath,F=new core.CSSUnits;this.style2css=function(a,e,b,c,d){function f(a,e){h="@namespace "+a+" url("+e+");";try{b.insertRule(h,b.cssRules.length)}catch(c){}}var h,m,g;for(H=e;b.cssRules.length;)b.deleteRule(b.cssRules.length-
1);odf.Namespaces.forEachPrefix(f);f("webodfhelper","urn:webodf:names:helper");Z=c;v=a;ba=runtime.getWindow().getComputedStyle(document.body,null).getPropertyValue("font-size")||"12pt";for(g in z)if(z.hasOwnProperty(g))for(m in a=d[g],a)a.hasOwnProperty(m)&&n(b,g,m,a[m])}};(function(){function g(k,d){var b=this;this.getDistance=function(c){var d=b.x-c.x;c=b.y-c.y;return Math.sqrt(d*d+c*c)};this.getCenter=function(c){return new g((b.x+c.x)/2,(b.y+c.y)/2)};b.x=k;b.y=d}gui.ZoomHelper=function(){function k(a,b,c,d){a=d?"translate3d("+a+"px, "+b+"px, 0) scale3d("+c+", "+c+", 1)":"translate("+a+"px, "+b+"px) scale("+c+")";e.style.WebkitTransform=a;e.style.MozTransform=a;e.style.msTransform=a;e.style.OTransform=a;e.style.transform=a}function d(a){a?k(-r.x,-r.y,u,!0):(k(0,
0,u,!0),k(0,0,u,!1))}function b(a){if(s&&B){var e=s.style.overflow,b=s.classList.contains("webodf-customScrollbars");a&&b||!a&&!b||(a?(s.classList.add("webodf-customScrollbars"),s.style.overflow="hidden",runtime.requestAnimationFrame(function(){s.style.overflow=e})):s.classList.remove("webodf-customScrollbars"))}}function c(){k(-r.x,-r.y,u,!0);s.scrollLeft=0;s.scrollTop=0;E=x.style.overflow;x.style.overflow="visible";b(!1)}function l(){k(0,0,u,!0);s.scrollLeft=r.x;s.scrollTop=r.y;x.style.overflow=
E||"";b(!0)}function n(a){return new g(a.pageX-e.offsetLeft,a.pageY-e.offsetTop)}function p(a){m&&(r.x-=a.x-m.x,r.y-=a.y-m.y,r=new g(Math.min(Math.max(r.x,e.offsetLeft),(e.offsetLeft+e.offsetWidth)*u-s.clientWidth),Math.min(Math.max(r.y,e.offsetTop),(e.offsetTop+e.offsetHeight)*u-s.clientHeight)));m=a}function q(a){var e=a.touches.length,b=0<e?n(a.touches[0]):null;a=1<e?n(a.touches[1]):null;b&&a?(y=b.getDistance(a),z=u,m=b.getCenter(a),c(),G=C.PINCH):b&&(m=b,G=C.SCROLL)}function f(a){var b=a.touches.length,
f=0<b?n(a.touches[0]):null,b=1<b?n(a.touches[1]):null;if(f&&b)if(a.preventDefault(),G===C.SCROLL)G=C.PINCH,c(),y=f.getDistance(b);else{a=f.getCenter(b);f=f.getDistance(b)/y;p(a);var b=u,h=Math.min(t,e.offsetParent.clientWidth/e.offsetWidth);u=z*f;u=Math.min(Math.max(u,h),t);f=u/b;r.x+=(f-1)*(a.x+r.x);r.y+=(f-1)*(a.y+r.y);d(!0)}else f&&(G===C.PINCH?(G=C.SCROLL,l()):p(f))}function h(){G===C.PINCH&&(w.emit(gui.ZoomHelper.signalZoomChanged,u),l(),d(!1));G=C.NONE}function a(){s&&(s.removeEventListener("touchstart",
q,!1),s.removeEventListener("touchmove",f,!1),s.removeEventListener("touchend",h,!1))}var e,r,m,y,u,z,t=4,s,x,w=new core.EventNotifier([gui.ZoomHelper.signalZoomChanged]),C={NONE:0,SCROLL:1,PINCH:2},G=C.NONE,B=runtime.getWindow().hasOwnProperty("ontouchstart"),E="";this.subscribe=function(a,e){w.subscribe(a,e)};this.unsubscribe=function(a,e){w.unsubscribe(a,e)};this.getZoomLevel=function(){return u};this.setZoomLevel=function(a){e&&(u=a,d(!1),w.emit(gui.ZoomHelper.signalZoomChanged,u))};this.destroy=
function(e){a();b(!1);e()};this.setZoomableElement=function(c){a();e=c;s=e.offsetParent;x=e.parentNode;d(!1);s&&(s.addEventListener("touchstart",q,!1),s.addEventListener("touchmove",f,!1),s.addEventListener("touchend",h,!1));b(!0)};z=u=1;r=new g(0,0)};gui.ZoomHelper.signalZoomChanged="zoomChanged"})();ops.Canvas=function(){};ops.Canvas.prototype.getZoomLevel=function(){};ops.Canvas.prototype.getElement=function(){};ops.Canvas.prototype.getSizer=function(){};ops.Canvas.prototype.getZoomHelper=function(){};(function(){function g(){function a(c){b=!0;runtime.setTimeout(function(){try{c()}catch(d){runtime.log(String(d)+"\n"+d.stack)}b=!1;0<e.length&&a(e.pop())},10)}var e=[],b=!1;this.clearQueue=function(){e.length=0};this.addToQueue=function(c){if(0===e.length&&!b)return a(c);e.push(c)}}function k(a){function e(){for(;0<b.cssRules.length;)b.deleteRule(0);b.insertRule("#shadowContent draw|page {display:none;}",0);b.insertRule("office|presentation draw|page {display:none;}",1);b.insertRule("#shadowContent draw|page:nth-of-type("+
c+") {display:block;}",2);b.insertRule("office|presentation draw|page:nth-of-type("+c+") {display:block;}",3)}var b=a.sheet,c=1;this.showFirstPage=function(){c=1;e()};this.showNextPage=function(){c+=1;e()};this.showPreviousPage=function(){1<c&&(c-=1,e())};this.showPage=function(a){0<a&&(c=a,e())};this.css=a;this.destroy=function(e){a.parentNode.removeChild(a);e()}}function d(a){a=a.sheet;for(var e=a.cssRules;e.length;)a.deleteRule(e.length-1)}function b(a,e,b){var c=new odf.Style2CSS,d=new odf.ListStyleToCss;
b=b.sheet;var f=(new odf.StyleTree(a.rootElement.styles,a.rootElement.automaticStyles)).getStyleTree();c.style2css(a.getDocumentType(),a.rootElement,b,e.getFontMap(),f);d.applyListStyles(b,f,a.rootElement.body)}function c(a,e){(new odf.FontLoader).loadFonts(a,e.sheet)}function l(a,e,b){var c=null;a=a.rootElement.body.getElementsByTagNameNS(E,b+"-decl");b=e.getAttributeNS(E,"use-"+b+"-name");var d;if(b&&0<a.length)for(e=0;e<a.length;e+=1)if(d=a[e],d.getAttributeNS(E,"name")===b){c=d.textContent;break}return c}
function n(a,e,b,c){var d=a.ownerDocument;e=I.getElementsByTagNameNS(a,e,b);for(a=0;a<e.length;a+=1)I.removeAllChildNodes(e[a]),c&&(b=e[a],b.appendChild(d.createTextNode(c)))}function p(a,e,b){e.setAttributeNS("urn:webodf:names:helper","styleid",a);var c,d=e.getAttributeNS(G,"anchor-type"),f=e.getAttributeNS(w,"x"),h=e.getAttributeNS(w,"y"),m=e.getAttributeNS(w,"width"),g=e.getAttributeNS(w,"height"),r=e.getAttributeNS(t,"min-height"),l=e.getAttributeNS(t,"min-width");if("as-char"===d)c="display: inline-block;";
else if(d||f||h)c="position: absolute;";else if(m||g||r||l)c="display: block;";f&&(c+="left: "+f+";");h&&(c+="top: "+h+";");m&&(c+="width: "+m+";");g&&(c+="height: "+g+";");r&&(c+="min-height: "+r+";");l&&(c+="min-width: "+l+";");c&&(c="draw|"+e.localName+'[webodfhelper|styleid="'+a+'"] {'+c+"}",b.insertRule(c,b.cssRules.length))}function q(a){for(a=a.firstChild;a;){if(a.namespaceURI===s&&"binary-data"===a.localName)return"data:image/png;base64,"+a.textContent.replace(/[\r\n\s]/g,"");a=a.nextSibling}return""}
function f(a,e,b,c){function d(e){e&&(e='draw|image[webodfhelper|styleid="'+a+'"] {'+("background-image: url("+e+");")+"}",c.insertRule(e,c.cssRules.length))}function f(a){d(a.url)}b.setAttributeNS("urn:webodf:names:helper","styleid",a);var h=b.getAttributeNS(B,"href"),m;if(h)try{m=e.getPart(h),m.onchange=f,m.load()}catch(g){runtime.log("slight problem: "+String(g))}else h=q(b),d(h)}function h(a){var e=a.ownerDocument;I.getElementsByTagNameNS(a,G,"line-break").forEach(function(a){a.hasChildNodes()||
a.appendChild(e.createElement("br"))})}function a(a){var e=a.ownerDocument;I.getElementsByTagNameNS(a,G,"s").forEach(function(a){var b,c;I.removeAllChildNodes(a);a.appendChild(e.createTextNode(" "));c=parseInt(a.getAttributeNS(G,"c"),10);if(1<c)for(a.removeAttributeNS(G,"c"),b=1;b<c;b+=1)a.parentNode.insertBefore(a.cloneNode(!0),a)})}function e(a){I.getElementsByTagNameNS(a,G,"tab").forEach(function(a){a.textContent="\t"})}function r(a,e){function b(a,c){var h=m.documentElement.namespaceURI;"video/"===
c.substr(0,6)?(d=m.createElementNS(h,"video"),d.setAttribute("controls","controls"),f=m.createElementNS(h,"source"),a&&f.setAttribute("src",a),f.setAttribute("type",c),d.appendChild(f),e.parentNode.appendChild(d)):e.innerHtml="Unrecognised Plugin"}function c(a){b(a.url,a.mimetype)}var d,f,h,m=e.ownerDocument,g;if(h=e.getAttributeNS(B,"href"))try{g=a.getPart(h),g.onchange=c,g.load()}catch(r){runtime.log("slight problem: "+String(r))}else runtime.log("using MP4 data fallback"),h=q(e),b(h,"video/mp4")}
function m(a){var e=a.getElementsByTagName("head")[0],b,c;b=a.styleSheets.length;for(c=e.firstElementChild;c&&("style"!==c.localName||!c.hasAttribute("webodfcss"));)c=c.nextElementSibling;if(c)return b=parseInt(c.getAttribute("webodfcss"),10),c.setAttribute("webodfcss",b+1),c;"string"===String(typeof webodf_css)?b=webodf_css:(c="webodf.css",runtime.currentDirectory&&(c=runtime.currentDirectory(),0<c.length&&"/"!==c.substr(-1)&&(c+="/"),c+="../webodf.css"),b=runtime.readFileSync(c,"utf-8"));c=a.createElementNS(e.namespaceURI,
"style");c.setAttribute("media","screen, print, handheld, projection");c.setAttribute("type","text/css");c.setAttribute("webodfcss","1");c.appendChild(a.createTextNode(b));e.appendChild(c);return c}function y(a){var e=parseInt(a.getAttribute("webodfcss"),10);1===e?a.parentNode.removeChild(a):a.setAttribute("count",e-1)}function u(a){var e=a.getElementsByTagName("head")[0],b=a.createElementNS(e.namespaceURI,"style"),c="";b.setAttribute("type","text/css");b.setAttribute("media","screen, print, handheld, projection");
odf.Namespaces.forEachPrefix(function(a,e){c+="@namespace "+a+" url("+e+");\n"});c+="@namespace webodfhelper url(urn:webodf:names:helper);\n";b.appendChild(a.createTextNode(c));e.appendChild(b);return b}var z=odf.Namespaces.drawns,t=odf.Namespaces.fons,s=odf.Namespaces.officens,x=odf.Namespaces.stylens,w=odf.Namespaces.svgns,C=odf.Namespaces.tablens,G=odf.Namespaces.textns,B=odf.Namespaces.xlinkns,E=odf.Namespaces.presentationns,J=xmldom.XPath,I=core.DomUtils;odf.OdfCanvas=function(q,t){function A(a,
e,b){function c(a,e,b,d){ja.addToQueue(function(){f(a,e,b,d)})}var d,h;d=e.getElementsByTagNameNS(z,"image");for(e=0;e<d.length;e+=1)h=d.item(e),c("image"+String(e),a,h,b)}function Z(a,e){function b(a,e){ja.addToQueue(function(){r(a,e)})}var c,d,f;d=e.getElementsByTagNameNS(z,"plugin");for(c=0;c<d.length;c+=1)f=d.item(c),b(a,f)}function B(){var a;a=aa.firstChild;var e=fa.getZoomLevel();a&&(aa.style.WebkitTransformOrigin="0% 0%",aa.style.MozTransformOrigin="0% 0%",aa.style.msTransformOrigin="0% 0%",
aa.style.OTransformOrigin="0% 0%",aa.style.transformOrigin="0% 0%",O&&((a=O.getMinimumHeightForAnnotationPane())?aa.style.minHeight=a:aa.style.removeProperty("min-height")),q.style.width=Math.round(e*aa.offsetWidth)+"px",q.style.height=Math.round(e*aa.offsetHeight)+"px",q.style.display="inline-block")}function v(b,c){var d=ea.sheet;I.removeAllChildNodes(q);aa=N.createElementNS(q.namespaceURI,"div");aa.style.display="inline-block";aa.style.background="white";aa.style.setProperty("float","left","important");
aa.appendChild(c);q.appendChild(aa);ca=N.createElementNS(q.namespaceURI,"div");ca.id="annotationsPane";ga=N.createElementNS(q.namespaceURI,"div");ga.id="shadowContent";ga.style.position="absolute";ga.style.top=0;ga.style.left=0;b.getContentElement().appendChild(ga);var f=c.body,m,g=[],r;for(m=f.firstElementChild;m&&m!==f;)if(m.namespaceURI===z&&(g[g.length]=m),m.firstElementChild)m=m.firstElementChild;else{for(;m&&m!==f&&!m.nextElementSibling;)m=m.parentNode;m&&m.nextElementSibling&&(m=m.nextElementSibling)}for(r=
0;r<g.length;r+=1)m=g[r],p("frame"+String(r),m,d);g=J.getODFElementsWithXPath(f,".//*[*[@text:anchor-type='paragraph']]",odf.Namespaces.lookupNamespaceURI);for(m=0;m<g.length;m+=1)f=g[m],f.setAttributeNS&&f.setAttributeNS("urn:webodf:names:helper","containsparagraphanchor",!0);f=D;m=ga;var k,y,v,u,t=0,Q;r=b.rootElement.ownerDocument;if((g=c.body.firstElementChild)&&g.namespaceURI===s&&("presentation"===g.localName||"drawing"===g.localName))for(g=g.firstElementChild;g;){if(k=(k=g.getAttributeNS(z,
"master-page-name"))?f.getMasterPageElement(k):null){y=g.getAttributeNS("urn:webodf:names:helper","styleid");v=r.createElementNS(z,"draw:page");Q=k.firstElementChild;for(t=0;Q;)"true"!==Q.getAttributeNS(E,"placeholder")&&(u=Q.cloneNode(!0),v.appendChild(u)),Q=Q.nextElementSibling,t+=1;Q=u=t=void 0;for(var B=I.getElementsByTagNameNS(v,z,"frame"),t=0;t<B.length;t+=1)u=B[t],(Q=u.getAttributeNS(E,"class"))&&!/^(date-time|footer|header|page-number)$/.test(Q)&&u.parentNode.removeChild(u);u=I.getElementsByTagNameNS(v,
z,"*");for(t=0;t<u.length;t+=1)p(y+"_"+t,u[t],d);m.appendChild(v);t=String(m.getElementsByTagNameNS(z,"page").length);n(v,G,"page-number",t);n(v,E,"header",l(b,g,"header"));n(v,E,"footer",l(b,g,"footer"));p(y,v,d);v.setAttributeNS("urn:webodf:names:helper","page-style-name",g.getAttributeNS(z,"style-name"));v.setAttributeNS(z,"draw:master-page-name",k.getAttributeNS(x,"name"))}g=g.nextElementSibling}f=q.namespaceURI;g=I.getElementsByTagNameNS(c.body,C,"table-cell");for(m=0;m<g.length;m+=1)r=g[m],
r.hasAttributeNS(C,"number-columns-spanned")&&r.setAttributeNS(f,"colspan",r.getAttributeNS(C,"number-columns-spanned")),r.hasAttributeNS(C,"number-rows-spanned")&&r.setAttributeNS(f,"rowspan",r.getAttributeNS(C,"number-rows-spanned"));h(c.body);a(c.body);e(c.body);A(b,c.body,d);Z(b,c.body);aa.insertBefore(ga,aa.firstChild);fa.setZoomableElement(aa)}function w(a){T?(ca.parentNode||aa.appendChild(ca),O&&O.forgetAnnotations(),O=new gui.AnnotationViewManager(F,a.body,ca,W),a=I.getElementsByTagNameNS(a.body,
s,"annotation"),O.addAnnotations(a),B()):ca.parentNode&&(aa.removeChild(ca),O.forgetAnnotations(),B())}function ba(a){function e(){d(R);d(L);d(ea);I.removeAllChildNodes(q);q.style.display="inline-block";var f=$.rootElement;q.ownerDocument.importNode(f,!0);D.setOdfContainer($);c($,R);b($,D,L);v($,f);w(f);a||ja.addToQueue(function(){var a=[$];if(da.hasOwnProperty("statereadychange")){var e=da.statereadychange,b;for(b=0;b<e.length;b+=1)e[b].apply(null,a)}})}$.state===odf.OdfContainer.DONE?e():(runtime.log("WARNING: refreshOdf called but ODF was not DONE."),
ha=runtime.setTimeout(function qa(){$.state===odf.OdfContainer.DONE?e():(runtime.log("will be back later..."),ha=runtime.setTimeout(qa,500))},100))}function P(a){ja.clearQueue();I.removeAllChildNodes(q);q.appendChild(q.ownerDocument.createTextNode(runtime.tr("Loading")+a+"..."));q.removeAttribute("style");$=new odf.OdfContainer(a,function(a){$=a;ba(!1)})}runtime.assert(null!==q&&void 0!==q,"odf.OdfCanvas constructor needs DOM element");runtime.assert(null!==q.ownerDocument&&void 0!==q.ownerDocument,
"odf.OdfCanvas constructor needs DOM");var F=this,N=q.ownerDocument,$,D=new odf.Formatting,V,aa=null,ca=null,T=!1,W=!1,O=null,Y,R,L,ea,ga,da={},ha,ma,la=!1,ia=!1,ja=new g,fa=new gui.ZoomHelper,pa=t||new gui.SingleScrollViewport(q.parentNode);this.refreshCSS=function(){la=!0;ma.trigger()};this.refreshSize=function(){ma.trigger()};this.odfContainer=function(){return $};this.setOdfContainer=function(a,e){$=a;ba(!0===e)};this.load=this.load=P;this.save=function(a){$.save(a)};this.addListener=function(a,
e){switch(a){case "click":var b=q,c=a;b.addEventListener?b.addEventListener(c,e,!1):b.attachEvent?b.attachEvent("on"+c,e):b["on"+c]=e;break;default:b=da.hasOwnProperty(a)?da[a]:da[a]=[],e&&-1===b.indexOf(e)&&b.push(e)}};this.getFormatting=function(){return D};this.getAnnotationViewManager=function(){return O};this.refreshAnnotations=function(){w($.rootElement)};this.rerenderAnnotations=function(){O&&(ia=!0,ma.trigger())};this.getSizer=function(){return aa};this.enableAnnotations=function(a,e){a!==
T&&(T=a,W=e,$&&w($.rootElement))};this.addAnnotation=function(a){O&&(O.addAnnotations([a]),B())};this.forgetAnnotation=function(a){O&&(O.forgetAnnotation(a),B())};this.getZoomHelper=function(){return fa};this.setZoomLevel=function(a){fa.setZoomLevel(a)};this.getZoomLevel=function(){return fa.getZoomLevel()};this.fitToContainingElement=function(a,e){var b=fa.getZoomLevel(),c=q.offsetHeight/b,b=a/(q.offsetWidth/b);e/c<b&&(b=e/c);fa.setZoomLevel(b)};this.fitToWidth=function(a){var e=q.offsetWidth/fa.getZoomLevel();
fa.setZoomLevel(a/e)};this.fitSmart=function(a,e){var b,c;c=fa.getZoomLevel();b=q.offsetWidth/c;c=q.offsetHeight/c;b=a/b;void 0!==e&&e/c<b&&(b=e/c);fa.setZoomLevel(Math.min(1,b))};this.fitToHeight=function(a){var e=q.offsetHeight/fa.getZoomLevel();fa.setZoomLevel(a/e)};this.showFirstPage=function(){V.showFirstPage()};this.showNextPage=function(){V.showNextPage()};this.showPreviousPage=function(){V.showPreviousPage()};this.showPage=function(a){V.showPage(a);B()};this.getElement=function(){return q};
this.getViewport=function(){return pa};this.getStyleSheet=function(){return Y};this.addCssForFrameWithImage=function(a){var e=a.getAttributeNS(z,"name"),b=a.firstElementChild;p(e,a,ea.sheet);b&&f(e+"img",$,b,ea.sheet)};this.destroy=function(a){var e=N.getElementsByTagName("head")[0],b=[V.destroy,ma.destroy];runtime.clearTimeout(ha);ca&&ca.parentNode&&ca.parentNode.removeChild(ca);fa.destroy(function(){aa&&(q.removeChild(aa),aa=null)});y(Y);e.removeChild(R);e.removeChild(L);e.removeChild(ea);core.Async.destroyAll(b,
a)};Y=m(N);V=new k(u(N));R=u(N);L=u(N);ea=u(N);ma=core.Task.createRedrawTask(function(){la&&(b($,D,L),la=!1);ia&&(O&&O.rerenderAnnotations(),ia=!1);B()});fa.subscribe(gui.ZoomHelper.signalZoomChanged,B)}})();odf.StepUtils=function(){this.getContentBounds=function(g){var k=g.container(),d,b;runtime.assert(g.isStep(),"Step iterator must be on a step");k.nodeType===Node.TEXT_NODE&&0<g.offset()?d=g.offset():(k=g.leftNode())&&k.nodeType===Node.TEXT_NODE&&(d=k.length);k&&(k.nodeType===Node.TEXT_NODE?(runtime.assert(0<d,"Empty text node found"),b={container:k,startOffset:d-1,endOffset:d}):b={container:k,startOffset:0,endOffset:k.childNodes.length});return b}};ops.MemberProperties=function(){};
ops.Member=function(g,k){var d=new ops.MemberProperties;this.getMemberId=function(){return g};this.getProperties=function(){return d};this.setProperties=function(b){Object.keys(b).forEach(function(c){d[c]=b[c]})};this.removeProperties=function(b){Object.keys(b).forEach(function(b){"fullName"!==b&&"color"!==b&&"imageUrl"!==b&&d.hasOwnProperty(b)&&delete d[b]})};runtime.assert(Boolean(g),"No memberId was supplied!");k.fullName||(k.fullName=runtime.tr("Unknown Author"));k.color||(k.color="black");k.imageUrl||
(k.imageUrl="avatar-joe.png");d=k};ops.Document=function(){};ops.Document.prototype.getMemberIds=function(){};ops.Document.prototype.removeCursor=function(g){};ops.Document.prototype.getDocumentElement=function(){};ops.Document.prototype.getRootNode=function(){};ops.Document.prototype.getDOMDocument=function(){};ops.Document.prototype.cloneDocumentElement=function(){};ops.Document.prototype.setDocumentElement=function(g){};ops.Document.prototype.subscribe=function(g,k){};ops.Document.prototype.unsubscribe=function(g,k){};
ops.Document.prototype.getCanvas=function(){};ops.Document.prototype.createRootFilter=function(g){};ops.Document.prototype.createPositionIterator=function(g){};ops.Document.signalCursorAdded="cursor/added";ops.Document.signalCursorRemoved="cursor/removed";ops.Document.signalCursorMoved="cursor/moved";ops.Document.signalMemberAdded="member/added";ops.Document.signalMemberUpdated="member/updated";ops.Document.signalMemberRemoved="member/removed";ops.OdtCursor=function(g,k){var d=this,b={},c,l,n=new core.EventNotifier([ops.OdtCursor.signalCursorUpdated]);this.removeFromDocument=function(){l.remove()};this.subscribe=function(b,c){n.subscribe(b,c)};this.unsubscribe=function(b,c){n.unsubscribe(b,c)};this.getMemberId=function(){return g};this.getNode=function(){return l.getNode()};this.getAnchorNode=function(){return l.getAnchorNode()};this.getSelectedRange=function(){return l.getSelectedRange()};this.setSelectedRange=function(b,c){l.setSelectedRange(b,
c);n.emit(ops.OdtCursor.signalCursorUpdated,d)};this.hasForwardSelection=function(){return l.hasForwardSelection()};this.getDocument=function(){return k};this.getSelectionType=function(){return c};this.setSelectionType=function(d){b.hasOwnProperty(d)?c=d:runtime.log("Invalid selection type: "+d)};this.resetSelectionType=function(){d.setSelectionType(ops.OdtCursor.RangeSelection)};l=new core.Cursor(k.getDOMDocument(),g);b[ops.OdtCursor.RangeSelection]=!0;b[ops.OdtCursor.RegionSelection]=!0;d.resetSelectionType()};
ops.OdtCursor.RangeSelection="Range";ops.OdtCursor.RegionSelection="Region";ops.OdtCursor.signalCursorUpdated="cursorUpdated";(function(){var g=0;ops.StepsCache=function(k,d,b){function c(a,e){var c=this;this.nodeId=a;this.steps=-1;this.node=e;this.previousBookmark=this.nextBookmark=null;this.setIteratorPosition=function(a){a.setPositionBeforeElement(e);b(c.steps,a)}}function l(a,e,c){var d=this;this.nodeId=a;this.steps=e;this.node=c;this.previousBookmark=this.nextBookmark=null;this.setIteratorPosition=function(a){a.setUnfilteredPosition(c,0);b(d.steps,a)}}function n(a,e){var b="["+a.nodeId;e&&(b+=" => "+e.nodeId);return b+
"]"}function p(){for(var a=z,e,b,c,d=new core.LoopWatchDog(0,1E5),f={};a;){d.check();(e=a.previousBookmark)?runtime.assert(e.nextBookmark===a,"Broken bookmark link to previous @"+n(e,a)):(runtime.assert(a===z,"Broken bookmark link @"+n(a)),runtime.assert(void 0===t||z===z||z.steps<=t,"Base point is damaged @"+n(a)));(b=a.nextBookmark)&&runtime.assert(b.previousBookmark===a,"Broken bookmark link to next @"+n(a,b));if(void 0===t||a===z||a.steps<=t)runtime.assert(u.containsNode(k,a.node),"Disconnected node is being reported as undamaged @"+
n(a)),e&&(c=a.node.compareDocumentPosition(e.node),runtime.assert(0===c||0!==(c&x),"Bookmark order with previous does not reflect DOM order @"+n(e,a))),b&&u.containsNode(k,b.node)&&(c=a.node.compareDocumentPosition(b.node),runtime.assert(0===c||0!==(c&s),"Bookmark order with next does not reflect DOM order @"+n(a,b)));a=a.nextBookmark}Object.keys(m).forEach(function(a){var e=m[a];(void 0===t||a<=t)&&runtime.assert(e.steps<=a,"Bookmark step of "+e.steps+" exceeds cached step lookup for "+a+" @"+n(e));
runtime.assert(!1===f.hasOwnProperty(e.nodeId),"Bookmark "+n(e)+" appears twice in cached step lookup at steps "+f[e.nodeId]+" and "+a);f[e.nodeId]=a})}function q(a){var e="";a.nodeType===Node.ELEMENT_NODE&&(e=a.getAttributeNS(r,"nodeId")||"");return e}function f(a){var e=g.toString();a.setAttributeNS(r,"nodeId",e);g+=1;return e}function h(a){var e,b,c=new core.LoopWatchDog(0,1E4);void 0!==t&&a>t&&(a=t);for(e=Math.floor(a/d)*d;!b&&0<=e;)b=m[e],e-=d;for(b=b||z;b.nextBookmark&&b.nextBookmark.steps<=
a;)c.check(),b=b.nextBookmark;runtime.assert(-1===a||b.steps<=a,"Bookmark @"+n(b)+" at step "+b.steps+" exceeds requested step of "+a);return b}function a(a){a.previousBookmark&&(a.previousBookmark.nextBookmark=a.nextBookmark);a.nextBookmark&&(a.nextBookmark.previousBookmark=a.previousBookmark)}function e(a){for(var e,b=null;!b&&a&&a!==k;)(e=q(a))&&(b=y[e])&&b.node!==a&&(runtime.log("Cloned node detected. Creating new bookmark"),b=null,a.removeAttributeNS(r,"nodeId")),a=a.parentNode;return b}var r=
"urn:webodf:names:steps",m={},y={},u=core.DomUtils,z,t,s=Node.DOCUMENT_POSITION_FOLLOWING,x=Node.DOCUMENT_POSITION_PRECEDING,w;this.updateBookmark=function(e,b){var g,r=Math.ceil(e/d)*d,l,n,p;if(void 0!==t&&t<e){l=h(t);for(n=l.nextBookmark;n&&n.steps<=e;)g=n.nextBookmark,p=Math.ceil(n.steps/d)*d,m[p]===n&&delete m[p],u.containsNode(k,n.node)?n.steps=e+1:(a(n),delete y[n.nodeId]),n=g;t=e}else l=h(e);n=q(b)||f(b);g=y[n];g?g.node!==b&&(runtime.log("Cloned node detected. Creating new bookmark"),n=f(b),
g=y[n]=new c(n,b)):g=y[n]=new c(n,b);n=g;n.steps!==e&&(g=Math.ceil(n.steps/d)*d,g!==r&&m[g]===n&&delete m[g],n.steps=e);if(l!==n&&l.nextBookmark!==n){if(l.steps===n.steps)for(;0!==(n.node.compareDocumentPosition(l.node)&s)&&l!==z;)l=l.previousBookmark;l!==n&&l.nextBookmark!==n&&(a(n),g=l.nextBookmark,n.nextBookmark=l.nextBookmark,n.previousBookmark=l,l.nextBookmark=n,g&&(g.previousBookmark=n))}l=m[r];if(!l||n.steps>l.steps)m[r]=n;w()};this.setToClosestStep=function(a,e){var b;w();b=h(a);b.setIteratorPosition(e);
return b.steps};this.setToClosestDomPoint=function(a,b,c){var d,f;w();if(a===k&&0===b)d=z;else if(a===k&&b===k.childNodes.length)for(f in d=z,m)m.hasOwnProperty(f)&&(a=m[f],a.steps>d.steps&&(d=a));else if(d=e(a.childNodes.item(b)||a),!d)for(c.setUnfilteredPosition(a,b);!d&&c.previousNode();)d=e(c.getCurrentNode());d=d||z;void 0!==t&&d.steps>t&&(d=h(t));d.setIteratorPosition(c);return d.steps};this.damageCacheAfterStep=function(a){0>a&&(a=-1);void 0===t?t=a:a<t&&(t=a);w()};(function(){var a=q(k)||
f(k);z=new l(a,0,k);w=ops.StepsCache.ENABLE_CACHE_VERIFICATION?p:function(){}})()};ops.StepsCache.ENABLE_CACHE_VERIFICATION=!1;ops.StepsCache.Bookmark=function(){};ops.StepsCache.Bookmark.prototype.setIteratorPosition=function(g){}})();(function(){ops.OdtStepsTranslator=function(g,k,d,b){function c(a,b,c){var d=b.getCurrentNode();b.isBeforeNode()&&p.isParagraph(d)&&(c||(a+=1),n.updateBookmark(a,d))}function l(e,b){if(!b||d.acceptPosition(e)===f)return!0;for(;e.previousPosition();)if(d.acceptPosition(e)===f){if(b(h,e.container(),e.unfilteredDomOffset()))return!0;break}for(;e.nextPosition();)if(d.acceptPosition(e)===f){if(b(a,e.container(),e.unfilteredDomOffset()))return!0;break}return!1}var n,p=odf.OdfUtils,q=core.DomUtils,f=core.PositionFilter.FilterResult.FILTER_ACCEPT,
h=core.StepDirection.PREVIOUS,a=core.StepDirection.NEXT;this.convertStepsToDomPoint=function(a){var b,h;if(isNaN(a))throw new TypeError("Requested steps is not numeric ("+a+")");if(0>a)throw new RangeError("Requested steps is negative ("+a+")");for(b=n.setToClosestStep(a,k);b<a&&k.nextPosition();)(h=d.acceptPosition(k)===f)&&(b+=1),c(b,k,h);if(b!==a)throw new RangeError("Requested steps ("+a+") exceeds available steps ("+b+")");return{node:k.container(),offset:k.unfilteredDomOffset()}};this.convertDomPointToSteps=
function(a,b,h){var p;q.containsNode(g,a)||(b=0>q.comparePoints(g,0,a,b),a=g,b=b?0:g.childNodes.length);k.setUnfilteredPosition(a,b);l(k,h)||k.setUnfilteredPosition(a,b);h=k.container();b=k.unfilteredDomOffset();a=n.setToClosestDomPoint(h,b,k);if(0>q.comparePoints(k.container(),k.unfilteredDomOffset(),h,b))return 0<a?a-1:a;for(;(k.container()!==h||k.unfilteredDomOffset()!==b)&&k.nextPosition();)(p=d.acceptPosition(k)===f)&&(a+=1),c(a,k,p);return a+0};this.prime=function(){var a,b;for(a=n.setToClosestStep(0,
k);k.nextPosition();)(b=d.acceptPosition(k)===f)&&(a+=1),c(a,k,b)};this.handleStepsInserted=function(a){n.damageCacheAfterStep(a.position)};this.handleStepsRemoved=function(a){n.damageCacheAfterStep(a.position-1)};n=new ops.StepsCache(g,b,function(a,b){do{if(d.acceptPosition(b)===f){c(a,b,!0);break}c(a-1,b,!1)}while(b.nextPosition())})}})();ops.Operation=function(){};ops.Operation.prototype.init=function(g){};ops.Operation.prototype.execute=function(g){};ops.Operation.prototype.spec=function(){};ops.TextPositionFilter=function(){function g(b,c){for(;b&&c(b)!==l;)b=b.previousSibling;return b}function k(b,c,f,h){var a;if(c){if(d.isInlineRoot(c)&&d.isGroupingElement(f))return n;h=d.lookLeftForCharacter(c);if(1===h||2===h&&(d.scanRightForAnyCharacter(f)||d.scanRightForAnyCharacter(d.nextNode(b))))return l}else if(d.isGroupingElement(b)&&d.isInlineRoot(g(b.previousSibling,h)))return l;h=null===c&&d.isParagraph(b);a=d.lookRightForCharacter(f);if(h)return a?l:d.scanRightForAnyCharacter(f)?n:l;if(!a)return n;
c=c||d.previousNode(b);return d.scanLeftForAnyCharacter(c)?n:l}var d=odf.OdfUtils,b=Node.ELEMENT_NODE,c=Node.TEXT_NODE,l=core.PositionFilter.FilterResult.FILTER_ACCEPT,n=core.PositionFilter.FilterResult.FILTER_REJECT;this.acceptPosition=function(g){var q=g.container(),f=q.nodeType,h,a,e;if(f!==b&&f!==c)return n;if(f===c){f=g.unfilteredDomOffset();h=q.data;runtime.assert(f!==h.length,"Unexpected offset.");if(0<f){g=h[f-1];if(!d.isODFWhitespace(g))return l;if(1<f)if(g=h[f-2],!d.isODFWhitespace(g))e=
l;else{if(!d.isODFWhitespace(h.substr(0,f)))return n}else a=d.previousNode(q),d.scanLeftForNonSpace(a)&&(e=l);if(e===l)return d.isTrailingWhitespace(q,f)?n:l;g=h[f];return d.isODFWhitespace(g)?n:d.scanLeftForAnyCharacter(d.previousNode(q))?n:l}a=g.leftNode();e=q;q=q.parentNode;e=k(q,a,e,g.getNodeFilter())}else d.isGroupingElement(q)?(a=g.leftNode(),e=g.rightNode(),e=k(q,a,e,g.getNodeFilter())):e=n;return e}};ops.OdtDocument=function(g){function k(a){return new core.PositionIterator(a,J,Q,!1)}function d(){var a=g.odfContainer().getContentElement(),e=a&&a.localName;runtime.assert("text"===e,"Unsupported content element type '"+e+"' for OdtDocument");return a}function b(){return e.getDocumentElement().ownerDocument}function c(a){for(;a&&!(a.namespaceURI===odf.Namespaces.officens&&"text"===a.localName||a.namespaceURI===odf.Namespaces.officens&&"annotation"===a.localName);)a=a.parentNode;return a}function l(a){this.acceptPosition=
function(e){e=e.container();var b;b="string"===typeof a?u[a].getNode():a;return c(e)===c(b)?s:x}}function n(a,e,b,c){c=k(c);var d;1===b.length?d=b[0]:(d=new core.PositionFilterChain,b.forEach(d.addFilter));b=new core.StepIterator(d,c);b.setPosition(a,e);return b}function p(a){var e=k(d());a=G.convertStepsToDomPoint(a);e.setUnfilteredPosition(a.node,a.offset);return e}function q(a){return a===w}function f(a){var b=a.spec(),c=b.memberid,d=(new Date(b.timestamp)).toISOString(),b=g.odfContainer();a.isEdit&&
(c=e.getMember(c).getProperties().fullName,b.setMetadata({"dc:creator":c,"dc:date":d},null),c={setProperties:{"dc:creator":c,"dc:date":d},removedProperties:[]},B||(c.setProperties["meta:editing-cycles"]=b.incrementEditingCycles(),E||b.setMetadata(null,["meta:editing-duration","meta:document-statistic"])),B=a,e.emit(ops.OdtDocument.signalMetadataUpdated,c))}function h(a){var b,e=[],c,d=2;runtime.assert(a.isStep(),"positionIterator is not at a step");do{if(b=r.getContentBounds(a))if(b=b.container,m.isDowngradableSpaceElement(b)){for(c=
b.lastChild;b.firstChild;)e.push(b.firstChild),b.parentNode.insertBefore(b.firstChild,b);b.parentNode.removeChild(b);a.setPosition(c,c.nodeType===Node.TEXT_NODE?c.length:c.childNodes.length);a.roundToPreviousStep()}d-=1}while(0<d&&a.nextStep());e.forEach(y.normalizeTextNodes)}function a(a,b,e){a=a.childNodes.item(b)||a;return(a=m.getParagraphElement(a))&&y.containsNode(e,a)?a:e}var e=this,r,m=odf.OdfUtils,y=core.DomUtils,u={},z={},t=new core.EventNotifier([ops.Document.signalMemberAdded,ops.Document.signalMemberUpdated,
ops.Document.signalMemberRemoved,ops.Document.signalCursorAdded,ops.Document.signalCursorRemoved,ops.Document.signalCursorMoved,ops.OdtDocument.signalParagraphChanged,ops.OdtDocument.signalParagraphStyleModified,ops.OdtDocument.signalCommonStyleCreated,ops.OdtDocument.signalCommonStyleDeleted,ops.OdtDocument.signalTableAdded,ops.OdtDocument.signalOperationStart,ops.OdtDocument.signalOperationEnd,ops.OdtDocument.signalProcessingBatchStart,ops.OdtDocument.signalProcessingBatchEnd,ops.OdtDocument.signalUndoStackChanged,
ops.OdtDocument.signalStepsInserted,ops.OdtDocument.signalStepsRemoved,ops.OdtDocument.signalMetadataUpdated,ops.OdtDocument.signalAnnotationAdded]),s=core.PositionFilter.FilterResult.FILTER_ACCEPT,x=core.PositionFilter.FilterResult.FILTER_REJECT,w=core.StepDirection.NEXT,C,G,B,E=!1,J=NodeFilter.SHOW_ALL,I=new gui.BlacklistNamespaceNodeFilter(["urn:webodf:names:cursor","urn:webodf:names:editinfo"]),U=new gui.OdfTextBodyNodeFilter,Q=new core.NodeFilterChain([I,U]);this.createPositionIterator=k;this.getDocumentElement=
function(){return g.odfContainer().rootElement};this.cloneDocumentElement=function(){var a=e.getDocumentElement(),b=g.getAnnotationViewManager();b&&b.forgetAnnotations();a=a.cloneNode(!0);g.refreshAnnotations();e.fixCursorPositions();return a};this.setDocumentElement=function(a){var b=g.odfContainer();t.unsubscribe(ops.OdtDocument.signalStepsInserted,G.handleStepsInserted);t.unsubscribe(ops.OdtDocument.signalStepsRemoved,G.handleStepsRemoved);b.setRootElement(a);g.setOdfContainer(b,!0);g.refreshCSS();
a=d();G=new ops.OdtStepsTranslator(a,k(a),C,500);t.subscribe(ops.OdtDocument.signalStepsInserted,G.handleStepsInserted);t.subscribe(ops.OdtDocument.signalStepsRemoved,G.handleStepsRemoved)};this.getDOMDocument=b;this.getRootElement=c;this.createStepIterator=n;this.getIteratorAtPosition=p;this.convertCursorStepToDomPoint=function(a){return G.convertStepsToDomPoint(a)};this.convertDomPointToCursorStep=function(a,b,e){var c;e===w&&(c=q);return G.convertDomPointToSteps(a,b,c)};this.convertDomToCursorRange=
function(a){var b;b=G.convertDomPointToSteps(a.anchorNode,a.anchorOffset);a=a.anchorNode===a.focusNode&&a.anchorOffset===a.focusOffset?b:G.convertDomPointToSteps(a.focusNode,a.focusOffset);return{position:b,length:a-b}};this.convertCursorToDomRange=function(a,e){var c=b().createRange(),d,f;d=G.convertStepsToDomPoint(a);e?(f=G.convertStepsToDomPoint(a+e),0<e?(c.setStart(d.node,d.offset),c.setEnd(f.node,f.offset)):(c.setStart(f.node,f.offset),c.setEnd(d.node,d.offset))):c.setStart(d.node,d.offset);
return c};this.upgradeWhitespacesAtPosition=function(a){var b=p(a),b=new core.StepIterator(C,b),e,c=2;runtime.assert(b.isStep(),"positionIterator is not at a step (requested step: "+a+")");do{if(e=r.getContentBounds(b))if(a=e.container,e=e.startOffset,a.nodeType===Node.TEXT_NODE&&m.isSignificantWhitespace(a,e)){runtime.assert(" "===a.data[e],"upgradeWhitespaceToElement: textNode.data[offset] should be a literal space");var d=a.ownerDocument.createElementNS(odf.Namespaces.textns,"text:s"),f=a.parentNode,
h=a;d.appendChild(a.ownerDocument.createTextNode(" "));1===a.length?f.replaceChild(d,a):(a.deleteData(e,1),0<e&&(e<a.length&&a.splitText(e),h=a.nextSibling),f.insertBefore(d,h));a=d;b.setPosition(a,a.childNodes.length);b.roundToPreviousStep()}c-=1}while(0<c&&b.nextStep())};this.downgradeWhitespaces=h;this.downgradeWhitespacesAtPosition=function(a){a=p(a);a=new core.StepIterator(C,a);h(a)};this.getTextNodeAtStep=function(a,c){var d=p(a),f=d.container(),h,m=0,g=null;f.nodeType===Node.TEXT_NODE?(h=f,
m=d.unfilteredDomOffset(),0<h.length&&(0<m&&(h=h.splitText(m)),h.parentNode.insertBefore(b().createTextNode(""),h),h=h.previousSibling,m=0)):(h=b().createTextNode(""),m=0,f.insertBefore(h,d.rightNode()));if(c){if(u[c]&&e.getCursorPosition(c)===a){for(g=u[c].getNode();g.nextSibling&&"cursor"===g.nextSibling.localName;)g.parentNode.insertBefore(g.nextSibling,g);0<h.length&&h.nextSibling!==g&&(h=b().createTextNode(""),m=0);g.parentNode.insertBefore(h,g)}}else for(;h.nextSibling&&"cursor"===h.nextSibling.localName;)h.parentNode.insertBefore(h.nextSibling,
h);for(;h.previousSibling&&h.previousSibling.nodeType===Node.TEXT_NODE;)d=h.previousSibling,d.appendData(h.data),m=d.length,h=d,h.parentNode.removeChild(h.nextSibling);for(;h.nextSibling&&h.nextSibling.nodeType===Node.TEXT_NODE;)d=h.nextSibling,h.appendData(d.data),h.parentNode.removeChild(d);return{textNode:h,offset:m}};this.fixCursorPositions=function(){Object.keys(u).forEach(function(b){var d=u[b],f=c(d.getNode()),h=e.createRootFilter(f),m,g,l,r=!1;l=d.getSelectedRange();m=a(l.startContainer,l.startOffset,
f);g=n(l.startContainer,l.startOffset,[C,h],m);l.collapsed?f=g:(m=a(l.endContainer,l.endOffset,f),f=n(l.endContainer,l.endOffset,[C,h],m));g.isStep()&&f.isStep()?g.container()!==f.container()||g.offset()!==f.offset()||l.collapsed&&d.getAnchorNode()===d.getNode()||(r=!0,l.setStart(g.container(),g.offset()),l.collapse(!0)):(r=!0,runtime.assert(g.roundToClosestStep(),"No walkable step found for cursor owned by "+b),l.setStart(g.container(),g.offset()),runtime.assert(f.roundToClosestStep(),"No walkable step found for cursor owned by "+
b),l.setEnd(f.container(),f.offset()));r&&(d.setSelectedRange(l,d.hasForwardSelection()),e.emit(ops.Document.signalCursorMoved,d))})};this.getCursorPosition=function(a){return(a=u[a])?G.convertDomPointToSteps(a.getNode(),0):0};this.getCursorSelection=function(a){a=u[a];var b=0,e=0;a&&(b=G.convertDomPointToSteps(a.getNode(),0),e=G.convertDomPointToSteps(a.getAnchorNode(),0));return{position:e,length:b-e}};this.getPositionFilter=function(){return C};this.getOdfCanvas=function(){return g};this.getCanvas=
function(){return g};this.getRootNode=d;this.addMember=function(a){runtime.assert(void 0===z[a.getMemberId()],"This member already exists");z[a.getMemberId()]=a};this.getMember=function(a){return z.hasOwnProperty(a)?z[a]:null};this.removeMember=function(a){delete z[a]};this.getCursor=function(a){return u[a]};this.getMemberIds=function(){var a=[],b;for(b in u)u.hasOwnProperty(b)&&a.push(u[b].getMemberId());return a};this.addCursor=function(a){runtime.assert(Boolean(a),"OdtDocument::addCursor without cursor");
var b=a.getMemberId(),c=e.convertCursorToDomRange(0,0);runtime.assert("string"===typeof b,"OdtDocument::addCursor has cursor without memberid");runtime.assert(!u[b],"OdtDocument::addCursor is adding a duplicate cursor with memberid "+b);a.setSelectedRange(c,!0);u[b]=a};this.removeCursor=function(a){var b=u[a];return b?(b.removeFromDocument(),delete u[a],e.emit(ops.Document.signalCursorRemoved,a),!0):!1};this.moveCursor=function(a,b,c,d){a=u[a];b=e.convertCursorToDomRange(b,c);a&&(a.setSelectedRange(b,
0<=c),a.setSelectionType(d||ops.OdtCursor.RangeSelection))};this.getFormatting=function(){return g.getFormatting()};this.emit=function(a,b){t.emit(a,b)};this.subscribe=function(a,b){t.subscribe(a,b)};this.unsubscribe=function(a,b){t.unsubscribe(a,b)};this.createRootFilter=function(a){return new l(a)};this.close=function(a){a()};this.destroy=function(a){a()};(function(){var a=d();C=new ops.TextPositionFilter;r=new odf.StepUtils;G=new ops.OdtStepsTranslator(a,k(a),C,500);t.subscribe(ops.OdtDocument.signalStepsInserted,
G.handleStepsInserted);t.subscribe(ops.OdtDocument.signalStepsRemoved,G.handleStepsRemoved);t.subscribe(ops.OdtDocument.signalOperationEnd,f);t.subscribe(ops.OdtDocument.signalProcessingBatchEnd,core.Task.processTasks)})()};ops.OdtDocument.signalParagraphChanged="paragraph/changed";ops.OdtDocument.signalTableAdded="table/added";ops.OdtDocument.signalCommonStyleCreated="style/created";ops.OdtDocument.signalCommonStyleDeleted="style/deleted";ops.OdtDocument.signalParagraphStyleModified="paragraphstyle/modified";
ops.OdtDocument.signalOperationStart="operation/start";ops.OdtDocument.signalOperationEnd="operation/end";ops.OdtDocument.signalProcessingBatchStart="router/batchstart";ops.OdtDocument.signalProcessingBatchEnd="router/batchend";ops.OdtDocument.signalUndoStackChanged="undo/changed";ops.OdtDocument.signalStepsInserted="steps/inserted";ops.OdtDocument.signalStepsRemoved="steps/removed";ops.OdtDocument.signalMetadataUpdated="metadata/updated";ops.OdtDocument.signalAnnotationAdded="annotation/added";ops.OpAddAnnotation=function(){function g(b,c,d){var h=b.getTextNodeAtStep(d,k);h&&(b=h.textNode,d=b.parentNode,h.offset!==b.length&&b.splitText(h.offset),d.insertBefore(c,b.nextSibling),0===b.length&&d.removeChild(b))}var k,d,b,c,l,n;this.init=function(g){k=g.memberid;d=parseInt(g.timestamp,10);b=parseInt(g.position,10);c=void 0!==g.length?parseInt(g.length,10)||0:void 0;l=g.name};this.isEdit=!0;this.group=void 0;this.execute=function(p){var q=p.getCursor(k),f,h;n=p.getDOMDocument();var a=new Date(d),
e,r,m;e=n.createElementNS(odf.Namespaces.officens,"office:annotation");e.setAttributeNS(odf.Namespaces.officens,"office:name",l);f=n.createElementNS(odf.Namespaces.dcns,"dc:creator");f.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",k);f.textContent=p.getMember(k).getProperties().fullName;h=n.createElementNS(odf.Namespaces.dcns,"dc:date");h.appendChild(n.createTextNode(a.toISOString()));a=n.createElementNS(odf.Namespaces.textns,"text:list");r=n.createElementNS(odf.Namespaces.textns,
"text:list-item");m=n.createElementNS(odf.Namespaces.textns,"text:p");r.appendChild(m);a.appendChild(r);e.appendChild(f);e.appendChild(h);e.appendChild(a);void 0!==c&&(f=n.createElementNS(odf.Namespaces.officens,"office:annotation-end"),f.setAttributeNS(odf.Namespaces.officens,"office:name",l),e.annotationEndElement=f,g(p,f,b+c));g(p,e,b);p.emit(ops.OdtDocument.signalStepsInserted,{position:b});q&&(f=n.createRange(),h=e.getElementsByTagNameNS(odf.Namespaces.textns,"p")[0],f.selectNodeContents(h),
q.setSelectedRange(f,!1),q.setSelectionType(ops.OdtCursor.RangeSelection),p.emit(ops.Document.signalCursorMoved,q));p.getOdfCanvas().addAnnotation(e);p.fixCursorPositions();p.emit(ops.OdtDocument.signalAnnotationAdded,{memberId:k,annotation:e});return!0};this.spec=function(){return{optype:"AddAnnotation",memberid:k,timestamp:d,position:b,length:c,name:l}}};ops.OpAddCursor=function(){var g,k;this.init=function(d){g=d.memberid;k=d.timestamp};this.isEdit=!1;this.group=void 0;this.execute=function(d){var b=d.getCursor(g);if(b)return!1;b=new ops.OdtCursor(g,d);d.addCursor(b);d.emit(ops.Document.signalCursorAdded,b);return!0};this.spec=function(){return{optype:"AddCursor",memberid:g,timestamp:k}}};ops.OpAddMember=function(){var g,k,d;this.init=function(b){g=b.memberid;k=parseInt(b.timestamp,10);d=b.setProperties};this.isEdit=!1;this.group=void 0;this.execute=function(b){var c;if(b.getMember(g))return!1;c=new ops.Member(g,d);b.addMember(c);b.emit(ops.Document.signalMemberAdded,c);return!0};this.spec=function(){return{optype:"AddMember",memberid:g,timestamp:k,setProperties:d}}};ops.OpAddStyle=function(){var g,k,d,b,c,l,n=odf.Namespaces.stylens;this.init=function(n){g=n.memberid;k=n.timestamp;d=n.styleName;b=n.styleFamily;c="true"===n.isAutomaticStyle||!0===n.isAutomaticStyle;l=n.setProperties};this.isEdit=!0;this.group=void 0;this.execute=function(g){var k=g.getOdfCanvas().odfContainer(),f=g.getFormatting(),h=g.getDOMDocument().createElementNS(n,"style:style");if(!h)return!1;l&&f.updateStyle(h,l);h.setAttributeNS(n,"style:family",b);h.setAttributeNS(n,"style:name",d);c?
k.rootElement.automaticStyles.appendChild(h):k.rootElement.styles.appendChild(h);g.getOdfCanvas().refreshCSS();c||g.emit(ops.OdtDocument.signalCommonStyleCreated,{name:d,family:b});return!0};this.spec=function(){return{optype:"AddStyle",memberid:g,timestamp:k,styleName:d,styleFamily:b,isAutomaticStyle:c,setProperties:l}}};odf.ObjectNameGenerator=function(g,k){function d(a,b){var e={};this.generateName=function(){var c=b(),d=0,f;do f=a+d,d+=1;while(e[f]||c[f]);e[f]=!0;return f}}function b(){var a={};[g.rootElement.automaticStyles,g.rootElement.styles].forEach(function(b){for(b=b.firstElementChild;b;)b.namespaceURI===c&&"style"===b.localName&&(a[b.getAttributeNS(c,"name")]=!0),b=b.nextElementSibling});return a}var c=odf.Namespaces.stylens,l=odf.Namespaces.drawns,n=odf.Namespaces.xlinkns,p=(new core.Utils).hashString(k),
q=null,f=null,h=null,a={},e={};this.generateStyleName=function(){null===q&&(q=new d("auto"+p+"_",function(){return b()}));return q.generateName()};this.generateFrameName=function(){var b,e,c;if(null===f){e=g.rootElement.body.getElementsByTagNameNS(l,"frame");for(b=0;b<e.length;b+=1)c=e.item(b),a[c.getAttributeNS(l,"name")]=!0;f=new d("fr"+p+"_",function(){return a})}return f.generateName()};this.generateImageName=function(){var a,b,c;if(null===h){c=g.rootElement.body.getElementsByTagNameNS(l,"image");
for(a=0;a<c.length;a+=1)b=c.item(a),b=b.getAttributeNS(n,"href"),b=b.substring(9,b.lastIndexOf(".")),e[b]=!0;h=new d("img"+p+"_",function(){return e})}return h.generateName()}};odf.TextStyleApplicator=function(g,k,d){function b(b){function c(a,b){return"object"===typeof a&&"object"===typeof b?Object.keys(a).every(function(d){return c(a[d],b[d])}):a===b}var a={};this.isStyleApplied=function(e){e=k.getAppliedStylesForElement(e,a).styleProperties;return c(b,e)}}function c(b){var c={};this.applyStyleToContainer=function(a){var e;e=a.getAttributeNS(p,"style-name");var l=a.ownerDocument;e=e||"";if(!c.hasOwnProperty(e)){var m=e,n;n=e?k.createDerivedStyleObject(e,"text",b):b;l=
l.createElementNS(q,"style:style");k.updateStyle(l,n);l.setAttributeNS(q,"style:name",g.generateStyleName());l.setAttributeNS(q,"style:family","text");l.setAttributeNS("urn:webodf:names:scope","scope","document-content");d.appendChild(l);c[m]=l}e=c[e].getAttributeNS(q,"name");a.setAttributeNS(p,"text:style-name",e)}}function l(b,c){var a=b.ownerDocument,e=b.parentNode,d,g,l,k=new core.LoopWatchDog(1E4);g=[];g.push(b);for(l=b.nextSibling;l&&n.rangeContainsNode(c,l);)k.check(),g.push(l),l=l.nextSibling;
"span"!==e.localName||e.namespaceURI!==p?(d=a.createElementNS(p,"text:span"),e.insertBefore(d,b),a=!1):(b.previousSibling&&!n.rangeContainsNode(c,e.firstChild)?(d=e.cloneNode(!1),e.parentNode.insertBefore(d,e.nextSibling)):d=e,a=!0);g.forEach(function(a){a.parentNode!==d&&d.appendChild(a)});if(l&&a)for(g=d.cloneNode(!1),d.parentNode.insertBefore(g,d.nextSibling);l;)k.check(),a=l.nextSibling,g.appendChild(l),l=a;return d}var n=core.DomUtils,p=odf.Namespaces.textns,q=odf.Namespaces.stylens;this.applyStyle=
function(d,h,a){var e={},g,m,n,k;runtime.assert(a&&a.hasOwnProperty("style:text-properties"),"applyStyle without any text properties");e["style:text-properties"]=a["style:text-properties"];n=new c(e);k=new b(e);d.forEach(function(a){g=k.isStyleApplied(a);!1===g&&(m=l(a,h),n.applyStyleToContainer(m))})}};ops.OpApplyDirectStyling=function(){function g(b,c,d){var a=b.getOdfCanvas().odfContainer(),e=p.splitBoundaries(c),g=n.getTextNodes(c,!1);(new odf.TextStyleApplicator(new odf.ObjectNameGenerator(a,k),b.getFormatting(),a.rootElement.automaticStyles)).applyStyle(g,c,d);e.forEach(p.normalizeTextNodes)}var k,d,b,c,l,n=odf.OdfUtils,p=core.DomUtils;this.init=function(g){k=g.memberid;d=g.timestamp;b=parseInt(g.position,10);c=parseInt(g.length,10);l=g.setProperties};this.isEdit=!0;this.group=void 0;this.execute=
function(p){var f=p.convertCursorToDomRange(b,c),h=n.getParagraphElements(f);g(p,f,l);f.detach();p.getOdfCanvas().refreshCSS();p.fixCursorPositions();h.forEach(function(a){p.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:a,memberId:k,timeStamp:d})});p.getOdfCanvas().rerenderAnnotations();return!0};this.spec=function(){return{optype:"ApplyDirectStyling",memberid:k,timestamp:d,position:b,length:c,setProperties:l}}};ops.OpApplyHyperlink=function(){function g(b){for(;b;){if(p.isHyperlink(b))return!0;b=b.parentNode}return!1}var k,d,b,c,l,n=core.DomUtils,p=odf.OdfUtils;this.init=function(g){k=g.memberid;d=g.timestamp;b=g.position;c=g.length;l=g.hyperlink};this.isEdit=!0;this.group=void 0;this.execute=function(q){var f=q.getDOMDocument(),h=q.convertCursorToDomRange(b,c),a=n.splitBoundaries(h),e=[],r=p.getTextNodes(h,!1);if(0===r.length)return!1;r.forEach(function(a){var b=p.getParagraphElement(a);runtime.assert(!1===
g(a),"The given range should not contain any link.");var c=l,d=f.createElementNS(odf.Namespaces.textns,"text:a");d.setAttributeNS(odf.Namespaces.xlinkns,"xlink:type","simple");d.setAttributeNS(odf.Namespaces.xlinkns,"xlink:href",c);a.parentNode.insertBefore(d,a);d.appendChild(a);-1===e.indexOf(b)&&e.push(b)});a.forEach(n.normalizeTextNodes);h.detach();q.fixCursorPositions();q.getOdfCanvas().refreshSize();q.getOdfCanvas().rerenderAnnotations();e.forEach(function(a){q.emit(ops.OdtDocument.signalParagraphChanged,
{paragraphElement:a,memberId:k,timeStamp:d})});return!0};this.spec=function(){return{optype:"ApplyHyperlink",memberid:k,timestamp:d,position:b,length:c,hyperlink:l}}};ops.OpCreateBulletlist=function(){var g,k,d,b=odf.OdfUtils;this.init=function(b){g=b.memberid;k=b.timestamp;d=b.position};this.isEdit=!0;this.group=void 0;this.execute=function(c){var l,n=c.getDOMDocument();l=c.convertCursorToDomRange(d,1);var p=[];l=b.getTextNodes(l,!0);console.log("textNodes");console.log(l.length);if(0===l.length)return!1;l=b.getParagraphElement(l[0]);var q=n.createElementNS(odf.Namespaces.textns,"text:list"),n=n.createElementNS(odf.Namespaces.textns,"text:list-item");q.setAttributeNS(odf.Namespaces.textns,
"text:style-name","L1");q.setAttributeNS("urn:webodf:names:helper","counter-id","X1-level1-1");q.appendChild(n);l.parentNode.insertBefore(q,l);n.appendChild(l);-1===p.indexOf(l)&&p.push(l);c.fixCursorPositions();c.getOdfCanvas().refreshSize();c.getOdfCanvas().rerenderAnnotations();p.forEach(function(b){c.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:b,memberId:g,timeStamp:k})});gui.BulletlistController.setDefaultStyle(c,g,d);return!0};this.spec=function(){return{optype:"CreateBulletlist",
memberid:g,timestamp:k,position:d}}};ops.OpInsertImage=function(){var g,k,d,b,c,l,n,p,q=odf.Namespaces.drawns,f=odf.Namespaces.svgns,h=odf.Namespaces.textns,a=odf.Namespaces.xlinkns,e=odf.OdfUtils;this.init=function(a){g=a.memberid;k=a.timestamp;d=a.position;b=a.filename;c=a.frameWidth;l=a.frameHeight;n=a.frameStyleName;p=a.frameName};this.isEdit=!0;this.group=void 0;this.execute=function(r){var m=r.getOdfCanvas(),y=r.getTextNodeAtStep(d,g),u,z;if(!y)return!1;u=y.textNode;z=e.getParagraphElement(u);var y=y.offset!==u.length?u.splitText(y.offset):
u.nextSibling,t=r.getDOMDocument(),s=t.createElementNS(q,"draw:image"),t=t.createElementNS(q,"draw:frame");s.setAttributeNS(a,"xlink:href",b);s.setAttributeNS(a,"xlink:type","simple");s.setAttributeNS(a,"xlink:show","embed");s.setAttributeNS(a,"xlink:actuate","onLoad");t.setAttributeNS(q,"draw:style-name",n);t.setAttributeNS(q,"draw:name",p);t.setAttributeNS(h,"text:anchor-type","as-char");t.setAttributeNS(f,"svg:width",c);t.setAttributeNS(f,"svg:height",l);t.appendChild(s);u.parentNode.insertBefore(t,
y);r.emit(ops.OdtDocument.signalStepsInserted,{position:d});0===u.length&&u.parentNode.removeChild(u);m.addCssForFrameWithImage(t);m.refreshCSS();r.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:z,memberId:g,timeStamp:k});m.rerenderAnnotations();return!0};this.spec=function(){return{optype:"InsertImage",memberid:g,timestamp:k,filename:b,position:d,frameWidth:c,frameHeight:l,frameStyleName:n,frameName:p}}};ops.OpInsertTable=function(){function g(a,e){var d;if(1===f.length)d=f[0];else if(3===f.length)switch(a){case 0:d=f[0];break;case b-1:d=f[2];break;default:d=f[1]}else d=f[a];if(1===d.length)return d[0];if(3===d.length)switch(e){case 0:return d[0];case c-1:return d[2];default:return d[1]}return d[e]}var k,d,b,c,l,n,p,q,f,h=odf.OdfUtils;this.init=function(a){k=a.memberid;d=a.timestamp;l=a.position;b=a.initialRows;c=a.initialColumns;n=a.tableName;p=a.tableStyleName;q=a.tableColumnStyleName;f=a.tableCellStyleMatrix};
this.isEdit=!0;this.group=void 0;this.execute=function(a){var e=a.getTextNodeAtStep(l),f=a.getRootNode();if(e){var m=a.getDOMDocument(),y=m.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table"),u=m.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table-column"),z,t,s,x;p&&y.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:style-name",p);n&&y.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:name",n);u.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0",
"table:number-columns-repeated",c);q&&u.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:style-name",q);y.appendChild(u);for(s=0;s<b;s+=1){u=m.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table-row");for(x=0;x<c;x+=1)z=m.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table-cell"),(t=g(s,x))&&z.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:style-name",t),t=m.createElementNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0",
"text:p"),z.appendChild(t),u.appendChild(z);y.appendChild(u)}e=h.getParagraphElement(e.textNode);f.insertBefore(y,e.nextSibling);a.emit(ops.OdtDocument.signalStepsInserted,{position:l});a.getOdfCanvas().refreshSize();a.emit(ops.OdtDocument.signalTableAdded,{tableElement:y,memberId:k,timeStamp:d});a.getOdfCanvas().rerenderAnnotations();return!0}return!1};this.spec=function(){return{optype:"InsertTable",memberid:k,timestamp:d,position:l,initialRows:b,initialColumns:c,tableName:n,tableStyleName:p,tableColumnStyleName:q,
tableCellStyleMatrix:f}}};ops.OpInsertText=function(){var g,k,d,b,c,l=odf.OdfUtils;this.init=function(l){g=l.memberid;k=l.timestamp;d=l.position;c=l.text;b="true"===l.moveCursor||!0===l.moveCursor};this.isEdit=!0;this.group=void 0;this.execute=function(n){var p,q,f,h=null,a=n.getDOMDocument(),e,r=0,m,y=n.getCursor(g),u;n.upgradeWhitespacesAtPosition(d);if(p=n.getTextNodeAtStep(d)){q=p.textNode;h=q.nextSibling;f=q.parentNode;e=l.getParagraphElement(q);for(u=0;u<c.length;u+=1)if("\t"===c[u]||"\t"!==c[u]&&l.isODFWhitespace(c[u])&&
(0===u||u===c.length-1||"\t"!==c[u-1]&&l.isODFWhitespace(c[u-1])))0===r?(p.offset!==q.length&&(h=q.splitText(p.offset)),0<u&&q.appendData(c.substring(0,u))):r<u&&(r=c.substring(r,u),f.insertBefore(a.createTextNode(r),h)),r=u+1,"\t"===c[u]?(m=a.createElementNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","text:tab"),m.appendChild(a.createTextNode("\t"))):(" "!==c[u]&&runtime.log("WARN: InsertText operation contains non-tab, non-space whitespace character (character code "+c.charCodeAt(u)+")"),
m=a.createElementNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","text:s"),m.appendChild(a.createTextNode(" "))),f.insertBefore(m,h);0===r?q.insertData(p.offset,c):r<c.length&&(p=c.substring(r),f.insertBefore(a.createTextNode(p),h));f=q.parentNode;h=q.nextSibling;f.removeChild(q);f.insertBefore(q,h);0===q.length&&q.parentNode.removeChild(q);n.emit(ops.OdtDocument.signalStepsInserted,{position:d});y&&b&&(n.moveCursor(g,d+c.length,0),n.emit(ops.Document.signalCursorMoved,y));n.downgradeWhitespacesAtPosition(d);
n.downgradeWhitespacesAtPosition(d+c.length);n.getOdfCanvas().refreshSize();n.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:e,memberId:g,timeStamp:k});n.getOdfCanvas().rerenderAnnotations();return!0}return!1};this.spec=function(){return{optype:"InsertText",memberid:g,timestamp:k,position:d,text:c,moveCursor:b}}};odf.CollapsingRules=function(g){function k(c){return b.isODFNode(c)||"br"===c.localName&&b.isLineBreak(c.parentNode)||c.nodeType===Node.TEXT_NODE&&b.isODFNode(c.parentNode)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}function d(l){var n;l.nodeType===Node.TEXT_NODE?(n=l.parentNode,n.removeChild(l)):n=c.removeUnwantedNodes(l,k);return n&&!b.isParagraph(n)&&n!==g&&b.hasNoODFContent(n)?d(n):n}var b=odf.OdfUtils,c=core.DomUtils;this.mergeChildrenIntoParent=d};ops.OpMergeParagraph=function(){function g(a){return odf.OdfUtils.isInlineRoot(a)?NodeFilter.FILTER_SKIP:h.isGroupingElement(a)&&h.hasNoODFContent(a)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}function k(a){if(a.nodeType===Node.TEXT_NODE){if(0===a.length)return runtime.log("WARN: Empty text node found during merge operation"),!0;if(h.isODFWhitespace(a.data)&&!1===h.isSignificantWhitespace(a,0))return!0;a="#text"}else a=(a.prefix?a.prefix+":":"")+a.localName;runtime.log("WARN: Unexpected text element found near paragraph boundary ["+
a+"]");return!1}function d(b){b.collapsed||(a.splitBoundaries(b),b=h.getTextElements(b,!1,!0).filter(k),b.forEach(function(a){a.parentNode.removeChild(a)}))}function b(a,b,e){a=a.convertCursorStepToDomPoint(b);var c=h.getParagraphElement(a.node,a.offset);runtime.assert(Boolean(c),"Paragraph not found at step "+b);e&&e.setPosition(a.node,a.offset);return c}var c,l,n,p,q,f,h=odf.OdfUtils,a=core.DomUtils,e=odf.Namespaces.textns;this.init=function(a){c=a.memberid;l=a.timestamp;n=a.moveCursor;p=a.paragraphStyleName;
q=parseInt(a.sourceStartPosition,10);f=parseInt(a.destinationStartPosition,10)};this.isEdit=!0;this.group=void 0;this.execute=function(h){var m,k,u=h.getCursor(c);m=h.getRootNode();var z=new odf.CollapsingRules(m),t=h.createStepIterator(m,0,[h.getPositionFilter()],m),s;runtime.assert(f<q,"Destination paragraph ("+f+") must be before source paragraph ("+q+")");k=b(h,f);m=b(h,q,t);t.previousStep();runtime.assert(a.containsNode(k,t.container()),"Destination paragraph must be adjacent to the source paragraph");
s=k.ownerDocument.createRange();t.setPosition(k,k.childNodes.length);t.roundToPreviousStep();s.setStart(t.container(),t.offset());s.setEnd(k,k.childNodes.length);d(s);s=k.childNodes.length;var x=m.ownerDocument.createRange();t.setPosition(m,0);t.roundToNextStep();x.setStart(m,0);x.setEnd(t.container(),t.offset());d(x);for(x=m.firstChild;x;)"editinfo"===x.localName?m.removeChild(x):(k.appendChild(x),a.removeUnwantedNodes(x,g)),x=m.firstChild;runtime.assert(0===m.childNodes.length,"Source paragraph should be empty before it is removed");
z.mergeChildrenIntoParent(m);h.emit(ops.OdtDocument.signalStepsRemoved,{position:q-1});t.setPosition(k,s);t.roundToClosestStep();t.previousStep()||t.roundToNextStep();h.downgradeWhitespaces(t);p?k.setAttributeNS(e,"text:style-name",p):k.removeAttributeNS(e,"style-name");u&&n&&(h.moveCursor(c,q-1,0),h.emit(ops.Document.signalCursorMoved,u));h.fixCursorPositions();h.getOdfCanvas().refreshSize();h.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:k,memberId:c,timeStamp:l});h.getOdfCanvas().rerenderAnnotations();
return!0};this.spec=function(){return{optype:"MergeParagraph",memberid:c,timestamp:l,moveCursor:n,paragraphStyleName:p,sourceStartPosition:q,destinationStartPosition:f}}};ops.OpMoveCursor=function(){var g,k,d,b,c;this.init=function(l){g=l.memberid;k=l.timestamp;d=l.position;b=l.length||0;c=l.selectionType||ops.OdtCursor.RangeSelection};this.isEdit=!1;this.group=void 0;this.execute=function(l){var n=l.getCursor(g),k;if(!n)return!1;k=l.convertCursorToDomRange(d,b);n.setSelectedRange(k,0<=b);n.setSelectionType(c);l.emit(ops.Document.signalCursorMoved,n);return!0};this.spec=function(){return{optype:"MoveCursor",memberid:g,timestamp:k,position:d,length:b,selectionType:c}}};ops.OpRemoveAnnotation=function(){var g,k,d,b,c=core.DomUtils;this.init=function(c){g=c.memberid;k=c.timestamp;d=parseInt(c.position,10);b=parseInt(c.length,10)};this.isEdit=!0;this.group=void 0;this.execute=function(b){function g(b){q.parentNode.insertBefore(b,q)}for(var k=b.getIteratorAtPosition(d).container(),q;k.namespaceURI!==odf.Namespaces.officens||"annotation"!==k.localName;)k=k.parentNode;if(null===k)return!1;q=k;k=q.annotationEndElement;b.getOdfCanvas().forgetAnnotation(q);c.getElementsByTagNameNS(q,
"urn:webodf:names:cursor","cursor").forEach(g);c.getElementsByTagNameNS(q,"urn:webodf:names:cursor","anchor").forEach(g);q.parentNode.removeChild(q);k&&k.parentNode.removeChild(k);b.emit(ops.OdtDocument.signalStepsRemoved,{position:0<d?d-1:d});b.getOdfCanvas().rerenderAnnotations();b.fixCursorPositions();return!0};this.spec=function(){return{optype:"RemoveAnnotation",memberid:g,timestamp:k,position:d,length:b}}};ops.OpRemoveBlob=function(){var g,k,d;this.init=function(b){g=b.memberid;k=b.timestamp;d=b.filename};this.isEdit=!0;this.group=void 0;this.execute=function(b){b.getOdfCanvas().odfContainer().removeBlob(d);return!0};this.spec=function(){return{optype:"RemoveBlob",memberid:g,timestamp:k,filename:d}}};ops.OpRemoveCursor=function(){var g,k;this.init=function(d){g=d.memberid;k=d.timestamp};this.isEdit=!1;this.group=void 0;this.execute=function(d){return d.removeCursor(g)?!0:!1};this.spec=function(){return{optype:"RemoveCursor",memberid:g,timestamp:k}}};ops.OpRemoveHyperlink=function(){var g,k,d,b,c=core.DomUtils,l=odf.OdfUtils;this.init=function(c){g=c.memberid;k=c.timestamp;d=c.position;b=c.length};this.isEdit=!0;this.group=void 0;this.execute=function(n){var p=n.convertCursorToDomRange(d,b),q=l.getHyperlinkElements(p);runtime.assert(1===q.length,"The given range should only contain a single link.");q=c.mergeIntoParent(q[0]);p.detach();n.fixCursorPositions();n.getOdfCanvas().refreshSize();n.getOdfCanvas().rerenderAnnotations();n.emit(ops.OdtDocument.signalParagraphChanged,
{paragraphElement:l.getParagraphElement(q),memberId:g,timeStamp:k});return!0};this.spec=function(){return{optype:"RemoveHyperlink",memberid:g,timestamp:k,position:d,length:b}}};ops.OpRemoveMember=function(){var g,k;this.init=function(d){g=d.memberid;k=parseInt(d.timestamp,10)};this.isEdit=!1;this.group=void 0;this.execute=function(d){if(!d.getMember(g))return!1;d.removeMember(g);d.emit(ops.Document.signalMemberRemoved,g);return!0};this.spec=function(){return{optype:"RemoveMember",memberid:g,timestamp:k}}};ops.OpRemoveStyle=function(){var g,k,d,b;this.init=function(c){g=c.memberid;k=c.timestamp;d=c.styleName;b=c.styleFamily};this.isEdit=!0;this.group=void 0;this.execute=function(c){var g=c.getFormatting().getStyleElement(d,b);if(!g)return!1;g.parentNode.removeChild(g);c.getOdfCanvas().refreshCSS();c.emit(ops.OdtDocument.signalCommonStyleDeleted,{name:d,family:b});return!0};this.spec=function(){return{optype:"RemoveStyle",memberid:g,timestamp:k,styleName:d,styleFamily:b}}};ops.OpRemoveText=function(){var g,k,d,b,c=odf.OdfUtils,l=core.DomUtils;this.init=function(c){runtime.assert(0<=c.length,"OpRemoveText only supports positive lengths");g=c.memberid;k=c.timestamp;d=parseInt(c.position,10);b=parseInt(c.length,10)};this.isEdit=!0;this.group=void 0;this.execute=function(n){var p,q,f,h=n.getCursor(g),a=new odf.CollapsingRules(n.getRootNode());n.upgradeWhitespacesAtPosition(d);n.upgradeWhitespacesAtPosition(d+b);p=n.convertCursorToDomRange(d,b);l.splitBoundaries(p);q=c.getTextElements(p,
!1,!0);f=c.getParagraphElement(p.startContainer,p.startOffset);runtime.assert(void 0!==f,"Attempting to remove text outside a paragraph element");p.detach();q.forEach(function(b){b.parentNode?(runtime.assert(l.containsNode(f,b),"RemoveText only supports removing elements within the same paragraph"),a.mergeChildrenIntoParent(b)):runtime.log("WARN: text element has already been removed from it's container")});n.emit(ops.OdtDocument.signalStepsRemoved,{position:d});n.downgradeWhitespacesAtPosition(d);
n.fixCursorPositions();n.getOdfCanvas().refreshSize();n.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:f,memberId:g,timeStamp:k});h&&(h.resetSelectionType(),n.emit(ops.Document.signalCursorMoved,h));n.getOdfCanvas().rerenderAnnotations();return!0};this.spec=function(){return{optype:"RemoveText",memberid:g,timestamp:k,position:d,length:b}}};ops.OpSetBlob=function(){var g,k,d,b,c;this.init=function(l){g=l.memberid;k=l.timestamp;d=l.filename;b=l.mimetype;c=l.content};this.isEdit=!0;this.group=void 0;this.execute=function(g){g.getOdfCanvas().odfContainer().setBlob(d,b,c);return!0};this.spec=function(){return{optype:"SetBlob",memberid:g,timestamp:k,filename:d,mimetype:b,content:c}}};ops.OpSetParagraphStyle=function(){function g(b,c,d){var f=[b.getPositionFilter()],h=d.container();d=d.unfilteredDomOffset();return!1===b.createStepIterator(h,d,f,c).previousStep()}var k,d,b,c,l=odf.OdfUtils;this.init=function(g){k=g.memberid;d=g.timestamp;b=g.position;c=g.styleName};this.isEdit=!0;this.group=void 0;this.execute=function(n){var p,q;p=n.getIteratorAtPosition(b);return(q=l.getParagraphElement(p.container()))?(runtime.assert(g(n,q,p),"SetParagraphStyle position should be the first position in the paragraph"),
c?q.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","text:style-name",c):q.removeAttributeNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","style-name"),n.getOdfCanvas().refreshSize(),n.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:q,timeStamp:d,memberId:k}),n.getOdfCanvas().rerenderAnnotations(),!0):!1};this.spec=function(){return{optype:"SetParagraphStyle",memberid:k,timestamp:d,position:b,styleName:c}}};ops.OpSplitParagraph=function(){var g,k,d,b,c,l,n=odf.OdfUtils,p=odf.Namespaces.textns;this.init=function(n){g=n.memberid;k=n.timestamp;b=n.position;d=n.sourceParagraphPosition;l=n.paragraphStyleName;c="true"===n.moveCursor||!0===n.moveCursor};this.isEdit=!0;this.group=void 0;this.execute=function(d){var f,h,a,e,r,m,y,u=d.getCursor(g);d.upgradeWhitespacesAtPosition(b);f=d.getTextNodeAtStep(b);if(!f)return!1;h=n.getParagraphElement(f.textNode);if(!h)return!1;a=n.isListItem(h.parentNode)?h.parentNode:
h;0===f.offset?(y=f.textNode.previousSibling,m=null):(y=f.textNode,m=f.offset>=f.textNode.length?null:f.textNode.splitText(f.offset));for(e=f.textNode;e!==a;){e=e.parentNode;r=e.cloneNode(!1);m&&r.appendChild(m);if(y)for(;y&&y.nextSibling;)r.appendChild(y.nextSibling);else for(;e.firstChild;)r.appendChild(e.firstChild);e.parentNode.insertBefore(r,e.nextSibling);y=e;m=r}n.isListItem(m)&&(m=m.childNodes.item(0));l?m.setAttributeNS(p,"text:style-name",l):m.removeAttributeNS(p,"style-name");0===f.textNode.length&&
f.textNode.parentNode.removeChild(f.textNode);d.emit(ops.OdtDocument.signalStepsInserted,{position:b});u&&c&&(d.moveCursor(g,b+1,0),d.emit(ops.Document.signalCursorMoved,u));d.fixCursorPositions();d.getOdfCanvas().refreshSize();d.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:h,memberId:g,timeStamp:k});d.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:m,memberId:g,timeStamp:k});d.getOdfCanvas().rerenderAnnotations();return!0};this.spec=function(){return{optype:"SplitParagraph",
memberid:g,timestamp:k,position:b,sourceParagraphPosition:d,paragraphStyleName:l,moveCursor:c}}};ops.OpUpdateMember=function(){function g(c){var d="//dc:creator[@editinfo:memberid='"+k+"']";c=xmldom.XPath.getODFElementsWithXPath(c.getRootNode(),d,function(b){return"editinfo"===b?"urn:webodf:names:editinfo":odf.Namespaces.lookupNamespaceURI(b)});for(d=0;d<c.length;d+=1)c[d].textContent=b.fullName}var k,d,b,c;this.init=function(g){k=g.memberid;d=parseInt(g.timestamp,10);b=g.setProperties;c=g.removedProperties};this.isEdit=!1;this.group=void 0;this.execute=function(d){var n=d.getMember(k);if(!n)return!1;
c&&n.removeProperties(c);b&&(n.setProperties(b),b.fullName&&g(d));d.emit(ops.Document.signalMemberUpdated,n);return!0};this.spec=function(){return{optype:"UpdateMember",memberid:k,timestamp:d,setProperties:b,removedProperties:c}}};ops.OpUpdateMetadata=function(){var g,k,d,b;this.init=function(c){g=c.memberid;k=parseInt(c.timestamp,10);d=c.setProperties;b=c.removedProperties};this.isEdit=!0;this.group=void 0;this.execute=function(c){var g=c.getOdfCanvas().odfContainer(),n=null;b&&(n=b.attributes.split(","));g.setMetadata(d,n);c.emit(ops.OdtDocument.signalMetadataUpdated,{setProperties:null!==d?d:{},removedProperties:null!==n?n:[]});return!0};this.spec=function(){return{optype:"UpdateMetadata",memberid:g,timestamp:k,setProperties:d,
removedProperties:b}}};ops.OpUpdateParagraphStyle=function(){function g(b,c){var d,h,a=c?c.split(","):[];for(d=0;d<a.length;d+=1)h=a[d].split(":"),b.removeAttributeNS(odf.Namespaces.lookupNamespaceURI(h[0]),h[1])}var k,d,b,c,l,n=odf.Namespaces.stylens;this.init=function(g){k=g.memberid;d=g.timestamp;b=g.styleName;c=g.setProperties;l=g.removedProperties};this.isEdit=!0;this.group=void 0;this.execute=function(d){var k=d.getFormatting(),f,h,a;return(f=""!==b?k.getStyleElement(b,"paragraph"):k.getDefaultStyleElement("paragraph"))?
(h=f.getElementsByTagNameNS(n,"paragraph-properties").item(0),a=f.getElementsByTagNameNS(n,"text-properties").item(0),c&&k.updateStyle(f,c),l&&(k=l["style:paragraph-properties"],h&&k&&(g(h,k.attributes),0===h.attributes.length&&f.removeChild(h)),k=l["style:text-properties"],a&&k&&(g(a,k.attributes),0===a.attributes.length&&f.removeChild(a)),g(f,l.attributes)),d.getOdfCanvas().refreshCSS(),d.emit(ops.OdtDocument.signalParagraphStyleModified,b),d.getOdfCanvas().rerenderAnnotations(),!0):!1};this.spec=
function(){return{optype:"UpdateParagraphStyle",memberid:k,timestamp:d,styleName:b,setProperties:c,removedProperties:l}}};ops.OperationFactory=function(){function g(d){return function(b){return new d}}var k;this.register=function(d,b){k[d]=b};this.create=function(d){var b=null,c=k[d.optype];c&&(b=c(d),b.init(d));return b};k={AddMember:g(ops.OpAddMember),UpdateMember:g(ops.OpUpdateMember),RemoveMember:g(ops.OpRemoveMember),AddCursor:g(ops.OpAddCursor),ApplyDirectStyling:g(ops.OpApplyDirectStyling),SetBlob:g(ops.OpSetBlob),RemoveBlob:g(ops.OpRemoveBlob),InsertImage:g(ops.OpInsertImage),InsertTable:g(ops.OpInsertTable),
InsertText:g(ops.OpInsertText),RemoveText:g(ops.OpRemoveText),MergeParagraph:g(ops.OpMergeParagraph),SplitParagraph:g(ops.OpSplitParagraph),SetParagraphStyle:g(ops.OpSetParagraphStyle),UpdateParagraphStyle:g(ops.OpUpdateParagraphStyle),AddStyle:g(ops.OpAddStyle),RemoveStyle:g(ops.OpRemoveStyle),MoveCursor:g(ops.OpMoveCursor),RemoveCursor:g(ops.OpRemoveCursor),AddAnnotation:g(ops.OpAddAnnotation),RemoveAnnotation:g(ops.OpRemoveAnnotation),UpdateMetadata:g(ops.OpUpdateMetadata),ApplyHyperlink:g(ops.OpApplyHyperlink),
CreateBulletlist:g(ops.OpCreateBulletlist),RemoveHyperlink:g(ops.OpRemoveHyperlink)}};ops.OperationRouter=function(){};ops.OperationRouter.prototype.setOperationFactory=function(g){};ops.OperationRouter.prototype.setPlaybackFunction=function(g){};ops.OperationRouter.prototype.push=function(g){};ops.OperationRouter.prototype.close=function(g){};ops.OperationRouter.prototype.subscribe=function(g,k){};ops.OperationRouter.prototype.unsubscribe=function(g,k){};ops.OperationRouter.prototype.hasLocalUnsyncedOps=function(){};ops.OperationRouter.prototype.hasSessionHostConnection=function(){};
ops.OperationRouter.signalProcessingBatchStart="router/batchstart";ops.OperationRouter.signalProcessingBatchEnd="router/batchend";ops.TrivialOperationRouter=function(){var g=new core.EventNotifier([ops.OperationRouter.signalProcessingBatchStart,ops.OperationRouter.signalProcessingBatchEnd]),k,d,b=0;this.setOperationFactory=function(b){k=b};this.setPlaybackFunction=function(b){d=b};this.push=function(c){b+=1;g.emit(ops.OperationRouter.signalProcessingBatchStart,{});c.forEach(function(c){c=c.spec();c.timestamp=Date.now();c=k.create(c);c.group="g"+b;d(c)});g.emit(ops.OperationRouter.signalProcessingBatchEnd,{})};this.close=function(b){b()};
this.subscribe=function(b,d){g.subscribe(b,d)};this.unsubscribe=function(b,d){g.unsubscribe(b,d)};this.hasLocalUnsyncedOps=function(){return!1};this.hasSessionHostConnection=function(){return!0}};ops.Session=function(g){function k(b){c.emit(ops.OdtDocument.signalProcessingBatchStart,b)}function d(b){c.emit(ops.OdtDocument.signalProcessingBatchEnd,b)}var b=new ops.OperationFactory,c=new ops.OdtDocument(g),l=null;this.setOperationFactory=function(c){b=c;l&&l.setOperationFactory(b)};this.setOperationRouter=function(g){l&&(l.unsubscribe(ops.OperationRouter.signalProcessingBatchStart,k),l.unsubscribe(ops.OperationRouter.signalProcessingBatchEnd,d));l=g;l.subscribe(ops.OperationRouter.signalProcessingBatchStart,
k);l.subscribe(ops.OperationRouter.signalProcessingBatchEnd,d);g.setPlaybackFunction(function(b){c.emit(ops.OdtDocument.signalOperationStart,b);return b.execute(c)?(c.emit(ops.OdtDocument.signalOperationEnd,b),!0):!1});g.setOperationFactory(b)};this.getOperationFactory=function(){return b};this.getOdtDocument=function(){return c};this.enqueue=function(b){l.push(b)};this.close=function(b){l.close(function(d){d?b(d):c.close(b)})};this.destroy=function(b){c.destroy(b)};this.setOperationRouter(new ops.TrivialOperationRouter)};gui.AnnotationController=function(g,k,d){function b(){var a=p.getCursor(d),a=a&&a.getNode(),b=!1;a&&(b=!h.isWithinAnnotation(a,p.getRootNode()));b!==q&&(q=b,f.emit(gui.AnnotationController.annotatableChanged,q))}function c(a){a.getMemberId()===d&&b()}function l(a){a===d&&b()}function n(a){a.getMemberId()===d&&b()}var p=g.getOdtDocument(),q=!1,f=new core.EventNotifier([gui.AnnotationController.annotatableChanged]),h=odf.OdfUtils,a=core.StepDirection.NEXT;this.isAnnotatable=function(){return q};this.addAnnotation=
function(){var a=new ops.OpAddAnnotation,b=p.getCursorSelection(d),c=b.length,b=b.position;q&&(0===c?c=void 0:(b=0<=c?b:b+c,c=Math.abs(c)),a.init({memberid:d,position:b,length:c,name:d+Date.now()}),g.enqueue([a]))};this.removeAnnotation=function(b){var c,f;c=p.getMember(d).getProperties().fullName;if(!0!==k.getState(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN)||c===h.getAnnotationCreator(b))c=p.convertDomPointToCursorStep(b,0,a),f=p.convertDomPointToCursorStep(b,b.childNodes.length),b=
new ops.OpRemoveAnnotation,b.init({memberid:d,position:c,length:f-c}),f=new ops.OpMoveCursor,f.init({memberid:d,position:0<c?c-1:c,length:0}),g.enqueue([b,f])};this.subscribe=function(a,b){f.subscribe(a,b)};this.unsubscribe=function(a,b){f.unsubscribe(a,b)};this.destroy=function(a){p.unsubscribe(ops.Document.signalCursorAdded,c);p.unsubscribe(ops.Document.signalCursorRemoved,l);p.unsubscribe(ops.Document.signalCursorMoved,n);a()};k.registerConstraint(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN);
p.subscribe(ops.Document.signalCursorAdded,c);p.subscribe(ops.Document.signalCursorRemoved,l);p.subscribe(ops.Document.signalCursorMoved,n);b()};gui.AnnotationController.annotatableChanged="annotatable/changed";gui.Avatar=function(g,k){var d=this,b,c,l;this.setColor=function(b){c.style.borderColor=b};this.setImageUrl=function(b){d.isVisible()?c.src=b:l=b};this.isVisible=function(){return"block"===b.style.display};this.show=function(){l&&(c.src=l,l=void 0);b.style.display="block"};this.hide=function(){b.style.display="none"};this.markAsFocussed=function(c){c?b.classList.add("active"):b.classList.remove("active")};this.destroy=function(c){g.removeChild(b);c()};(function(){var d=g.ownerDocument;b=d.createElement("div");
c=d.createElement("img");b.appendChild(c);b.style.display=k?"block":"none";b.className="handle";g.appendChild(b)})()};gui.SessionContext=function(g,k){var d=g.getOdtDocument(),b=odf.OdfUtils;this.isLocalCursorWithinOwnAnnotation=function(){var c=d.getCursor(k),g;if(!c)return!1;g=c&&c.getNode();c=d.getMember(k).getProperties().fullName;return(g=b.getParentAnnotation(g,d.getRootNode()))&&b.getAnnotationCreator(g)===c?!0:!1}};gui.BulletlistController=function(g,k,d,b){function c(){var b=!0;!0===k.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)&&(b=d.isLocalCursorWithinOwnAnnotation());b!==f&&(f=b,q.emit(gui.BulletlistController.enabledChanged,f))}function l(d){d.getMemberId()===b&&c()}var n=odf.OdfUtils,p=g.getOdtDocument(),q=new core.EventNotifier([gui.BulletlistController.enabledChanged]),f=!1;gui.BulletlistController.session=g;this.isEnabled=function(){return f};this.subscribe=function(b,a){q.subscribe(b,a)};this.unsubscribe=
function(b,a){q.unsubscribe(b,a)};this.addBulletlist=function(){if(f){var c=p.getCursorSelection(b),a=p.getCursor(b);n.getParagraphElement(a.getNode()).getAttributeNS(odf.Namespaces.textns,"style-name");var a=[],e=new ops.OpCreateBulletlist;e.init({memberid:b,length:c.length,position:c.position});a.push(e);g.enqueue(a)}};this.removeBulletlist=function(){};this.destroy=function(b){p.unsubscribe(ops.Document.signalCursorMoved,l);k.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,c);b()};p.subscribe(ops.Document.signalCursorMoved,
l);k.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,c);c()};gui.BulletlistController.enabledChanged="enabled/changed";gui.BulletlistController.session=null;
gui.BulletlistController.setDefaultStyle=function(g,k,d){var b=g.getDOMDocument(),c;c='text|list[webodfhelper|counter-id="X1-level1-1"] > text|list-item > :not(text|list):first-child::before{   content: "\u2022";';c+="   counter-increment: X1-level1-1 1;";c+="   text-align: left;";c+="   display: inline-block;";c+="   margin-left: 0.635cm;";c+="   padding-right: 0.2cm;";c+="}";var l=g.getOdfCanvas().getStyleSheet().sheet;l.insertRule(c,l.cssRules.length);if(!g.getOdfCanvas().getFormatting().getStyleElement("L1",
"list-style")){c=b.createElementNS(odf.Namespaces.textns,"text:list-style");c.setAttributeNS(odf.Namespaces.stylens,"style:name","L1");var n=b.createElementNS(odf.Namespaces.textns,"text:list-level-style-bullet");n.setAttributeNS(odf.Namespaces.textns,"text:bullet-char","\u2022");n.setAttributeNS(odf.Namespaces.textns,"text:level","1");n.setAttributeNS(odf.Namespaces.textns,"text:style-name","Bullet_20_Symbols");c.appendChild(n);l=b.createElementNS(odf.Namespaces.stylens,"style:list-level-properties");
l.setAttributeNS(odf.Namespaces.textns,"text:list-level-position-and-space-mode","label-alignment");n.appendChild(l);b=b.createElementNS(odf.Namespaces.stylens,"style:list-level-label-alignment");b.setAttributeNS(odf.Namespaces.fons,"fo:margin-left","1.27cm");b.setAttributeNS(odf.Namespaces.fons,"fo:text-indent","-0.635cm");b.setAttributeNS(odf.Namespaces.textns,"text:label-followed-by","listtab");b.setAttributeNS(odf.Namespaces.textns,"text:list-tab-stop-position","1.27cm");l.appendChild(b);g.getOdfCanvas().odfContainer().rootElement.automaticStyles.appendChild(c);
b=new ops.OpAddStyle;b.init({memberid:k,styleName:"P1",styleFamily:"paragraph",isAutomaticStyle:!0,setProperties:{"style:list-style-name":"L1","style:list-parent-name":"Standard"}});gui.BulletlistController.session.enqueue([b])}d=g.getIteratorAtPosition(d);if(d=odf.OdfUtils.getParagraphElement(d.container()))g.getOdfCanvas().refreshSize(),g.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:d,timeStamp:void 0,memberId:k}),g.getOdfCanvas().rerenderAnnotations()};gui.StepInfo=function(){};gui.StepInfo.VisualDirection={LEFT_TO_RIGHT:0,RIGHT_TO_LEFT:1};gui.StepInfo.prototype.container=function(){};gui.StepInfo.prototype.offset=function(){};gui.VisualStepScanner=function(){};gui.VisualStepScanner.prototype.process=function(g,k,d){};gui.GuiStepUtils=function(){function g(c){c=d.getContentBounds(c);var g,f=null;if(c)if(c.container.nodeType===Node.TEXT_NODE)g=c.container.ownerDocument.createRange(),g.setStart(c.container,c.startOffset),g.setEnd(c.container,c.endOffset),(f=0<g.getClientRects().length?g.getBoundingClientRect():null)&&" "===c.container.data.substring(c.startOffset,c.endOffset)&&1>=f.width&&(f=null),g.detach();else if(k.isCharacterElement(c.container)||k.isCharacterFrame(c.container))f=b.getBoundingClientRect(c.container);
return f}var k=odf.OdfUtils,d=new odf.StepUtils,b=core.DomUtils,c=core.StepDirection.NEXT,l=gui.StepInfo.VisualDirection.LEFT_TO_RIGHT,n=gui.StepInfo.VisualDirection.RIGHT_TO_LEFT;this.getContentRect=g;this.moveToFilteredStep=function(b,d,f){function h(a,b){b.process(t,m,y)&&(a=!0,!u&&b.token&&(u=b.token));return a}var a=d===c,e,k,m,y,u,z=b.snapshot();e=!1;var t;do e=g(b),t={token:b.snapshot(),container:b.container,offset:b.offset,direction:d,visualDirection:d===c?l:n},k=b.nextStep()?g(b):null,b.restore(t.token),
a?(m=e,y=k):(m=k,y=e),e=f.reduce(h,!1);while(!e&&b.advanceStep(d));e||f.forEach(function(a){!u&&a.token&&(u=a.token)});b.restore(u||z);return Boolean(u)}};gui.Caret=function(g,k,d,b){function c(){h.style.opacity="0"===h.style.opacity?"1":"0";x.trigger()}function l(){m.selectNodeContents(r);return m.getBoundingClientRect()}function n(){Object.keys(B).forEach(function(a){E[a]=B[a]})}function p(){if(!1===B.isShown||g.getSelectionType()!==ops.OdtCursor.RangeSelection||!b&&!g.getSelectedRange().collapsed)B.visibility="hidden",h.style.visibility="hidden",x.cancel();else if(B.visibility="visible",h.style.visibility="visible",!1===B.isFocused)h.style.opacity=
"1",x.cancel();else{if(w||E.visibility!==B.visibility)h.style.opacity="1",x.cancel();x.trigger()}if(G||C){var c;c=g.getNode();var d,m,r=u.getBoundingClientRect(y.getSizer()),p=!1,q=0;c.removeAttributeNS("urn:webodf:names:cursor","caret-sizer-active");if(0<c.getClientRects().length)m=l(),q=m.left-u.getBoundingClientRect(c).left,p=!0;else if(t.setPosition(c,0),m=z.getContentRect(t),!m&&t.nextStep()&&(d=z.getContentRect(t))&&(m=d,p=!0),m||(c.setAttributeNS("urn:webodf:names:cursor","caret-sizer-active",
"true"),m=l(),p=!0),!m)for(runtime.log("WARN: No suitable client rectangle found for visual caret for "+g.getMemberId());c;){if(0<c.getClientRects().length){m=u.getBoundingClientRect(c);p=!0;break}c=c.parentNode}m=u.translateRect(m,r,y.getZoomLevel());c={top:m.top,height:m.height,right:p?m.left:m.right,width:u.adaptRangeDifferenceToZoomLevel(q,y.getZoomLevel())};8>c.height&&(c={top:c.top-(8-c.height)/2,height:8,right:c.right});f.style.height=c.height+"px";f.style.top=c.top+"px";f.style.left=c.right-
c.width+"px";f.style.width=c.width?c.width+"px":"";e&&(c=runtime.getWindow().getComputedStyle(g.getNode(),null),c.font?e.style.font=c.font:(e.style.fontStyle=c.fontStyle,e.style.fontVariant=c.fontVariant,e.style.fontWeight=c.fontWeight,e.style.fontSize=c.fontSize,e.style.lineHeight=c.lineHeight,e.style.fontFamily=c.fontFamily))}B.isShown&&C&&k.scrollIntoView(h.getBoundingClientRect());E.isFocused!==B.isFocused&&a.markAsFocussed(B.isFocused);n();G=C=w=!1}function q(a){f.parentNode.removeChild(f);r.parentNode.removeChild(r);
a()}var f,h,a,e,r,m,y=g.getDocument().getCanvas(),u=core.DomUtils,z=new gui.GuiStepUtils,t,s,x,w=!1,C=!1,G=!1,B={isFocused:!1,isShown:!0,visibility:"hidden"},E={isFocused:!B.isFocused,isShown:!B.isShown,visibility:"hidden"};this.handleUpdate=function(){G=!0;s.trigger()};this.refreshCursorBlinking=function(){w=!0;s.trigger()};this.setFocus=function(){B.isFocused=!0;s.trigger()};this.removeFocus=function(){B.isFocused=!1;s.trigger()};this.show=function(){B.isShown=!0;s.trigger()};this.hide=function(){B.isShown=
!1;s.trigger()};this.setAvatarImageUrl=function(b){a.setImageUrl(b)};this.setColor=function(b){h.style.borderColor=b;a.setColor(b)};this.getCursor=function(){return g};this.getFocusElement=function(){return h};this.toggleHandleVisibility=function(){a.isVisible()?a.hide():a.show()};this.showHandle=function(){a.show()};this.hideHandle=function(){a.hide()};this.setOverlayElement=function(a){e=a;f.appendChild(a);G=!0;s.trigger()};this.ensureVisible=function(){C=!0;s.trigger()};this.getBoundingClientRect=
function(){return u.getBoundingClientRect(f)};this.destroy=function(b){core.Async.destroyAll([s.destroy,x.destroy,a.destroy,q],b)};(function(){var b=g.getDocument(),e=[b.createRootFilter(g.getMemberId()),b.getPositionFilter()],l=b.getDOMDocument();m=l.createRange();r=l.createElement("span");r.className="webodf-caretSizer";r.textContent="|";g.getNode().appendChild(r);f=l.createElement("div");f.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",g.getMemberId());f.className="webodf-caretOverlay";
h=l.createElement("div");h.className="caret";f.appendChild(h);a=new gui.Avatar(f,d);y.getSizer().appendChild(f);t=b.createStepIterator(g.getNode(),0,e,b.getRootNode());s=core.Task.createRedrawTask(p);x=core.Task.createTimeoutTask(c,500);s.triggerImmediate()})()};odf.TextSerializer=function(){function g(b){var c="",l=k.filter?k.filter.acceptNode(b):NodeFilter.FILTER_ACCEPT,n=b.nodeType,p;if((l===NodeFilter.FILTER_ACCEPT||l===NodeFilter.FILTER_SKIP)&&d.isTextContentContainingNode(b))for(p=b.firstChild;p;)c+=g(p),p=p.nextSibling;l===NodeFilter.FILTER_ACCEPT&&(n===Node.ELEMENT_NODE&&d.isParagraph(b)?c+="\n":n===Node.TEXT_NODE&&b.textContent&&(c+=b.textContent));return c}var k=this,d=odf.OdfUtils;this.filter=null;this.writeToString=function(b){if(!b)return"";
b=g(b);"\n"===b[b.length-1]&&(b=b.substr(0,b.length-1));return b}};gui.MimeDataExporter=function(){var g;this.exportRangeToDataTransfer=function(k,d){var b;b=d.startContainer.ownerDocument.createElement("span");b.appendChild(d.cloneContents());b=g.writeToString(b);try{k.setData("text/plain",b)}catch(c){k.setData("Text",b)}};g=new odf.TextSerializer;g.filter=new odf.OdfNodeFilter};gui.Clipboard=function(g){this.setDataFromRange=function(k,d){var b,c=k.clipboardData;b=runtime.getWindow();!c&&b&&(c=b.clipboardData);c?(b=!0,g.exportRangeToDataTransfer(c,d),k.preventDefault()):b=!1;return b}};gui.StyleSummary=function(g){function k(b,d){var k=b+"|"+d,q;c.hasOwnProperty(k)||(q=[],g.forEach(function(c){c=(c=c.styleProperties[b])&&c[d];-1===q.indexOf(c)&&q.push(c)}),c[k]=q);return c[k]}function d(b,c,d){return function(){var g=k(b,c);return d.length>=g.length&&g.every(function(b){return-1!==d.indexOf(b)})}}function b(b,c){var d=k(b,c);return 1===d.length?d[0]:void 0}var c={};this.getPropertyValues=k;this.getCommonValue=b;this.isBold=d("style:text-properties","fo:font-weight",["bold"]);this.isItalic=
d("style:text-properties","fo:font-style",["italic"]);this.hasUnderline=d("style:text-properties","style:text-underline-style",["solid"]);this.hasStrikeThrough=d("style:text-properties","style:text-line-through-style",["solid"]);this.fontSize=function(){var c=b("style:text-properties","fo:font-size");return c&&parseFloat(c)};this.fontName=function(){return b("style:text-properties","style:font-name")};this.isAlignedLeft=d("style:paragraph-properties","fo:text-align",["left","start"]);this.isAlignedCenter=
d("style:paragraph-properties","fo:text-align",["center"]);this.isAlignedRight=d("style:paragraph-properties","fo:text-align",["right","end"]);this.isAlignedJustified=d("style:paragraph-properties","fo:text-align",["justify"]);this.text={isBold:this.isBold,isItalic:this.isItalic,hasUnderline:this.hasUnderline,hasStrikeThrough:this.hasStrikeThrough,fontSize:this.fontSize,fontName:this.fontName};this.paragraph={isAlignedLeft:this.isAlignedLeft,isAlignedCenter:this.isAlignedCenter,isAlignedRight:this.isAlignedRight,
isAlignedJustified:this.isAlignedJustified}};gui.DirectFormattingController=function(g,k,d,b,c,l,n){function p(){return V.value().styleSummary}function q(){return V.value().enabledFeatures}function f(a){var b;a.collapsed?(b=a.startContainer,b.hasChildNodes()&&a.startOffset<b.childNodes.length&&(b=b.childNodes.item(a.startOffset)),a=[b]):a=ba.getTextElements(a,!0,!1);return a}function h(){var a=v.getCursor(b),e=a&&a.getSelectedRange(),c=[],c=[],h=!0,g={directTextStyling:!0,directParagraphStyling:!0};e&&(c=f(e),0===c.length&&(c=[e.startContainer,
e.endContainer],h=!1),c=v.getFormatting().getAppliedStyles(c));void 0!==c[0]&&$&&(c[0].styleProperties=H.mergeObjects(c[0].styleProperties,$));!0===k.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)&&(g.directTextStyling=g.directParagraphStyling=d.isLocalCursorWithinOwnAnnotation());g.directTextStyling&&(g.directTextStyling=h&&void 0!==a&&a.getSelectionType()===ops.OdtCursor.RangeSelection);return{enabledFeatures:g,appliedStyles:c,styleSummary:new gui.StyleSummary(c)}}function a(a,b){var e={};Object.keys(a).forEach(function(c){var d=
a[c](),f=b[c]();d!==f&&(e[c]=f)});return e}function e(){var b,e;e=D.styleSummary;var c=V.value(),d=c.styleSummary,f=D.enabledFeatures,h=c.enabledFeatures;b=a(e.text,d.text);e=a(e.paragraph,d.paragraph);f=!(h.directTextStyling===f.directTextStyling&&h.directParagraphStyling===f.directParagraphStyling);D=c;f&&P.emit(gui.DirectFormattingController.enabledChanged,h);0<Object.keys(b).length&&P.emit(gui.DirectFormattingController.textStylingChanged,b);0<Object.keys(e).length&&P.emit(gui.DirectFormattingController.paragraphStylingChanged,
e)}function r(){V.reset();e()}function m(a){("string"===typeof a?a:a.getMemberId())===b&&V.reset()}function y(){V.reset()}function u(a){var e=v.getCursor(b);a=a.paragraphElement;e&&ba.getParagraphElement(e.getNode())===a&&V.reset()}function z(a,b){b(!a());return!0}function t(a){if(q().directTextStyling){var e=v.getCursorSelection(b),c={"style:text-properties":a};0!==e.length?(a=new ops.OpApplyDirectStyling,a.init({memberid:b,position:e.position,length:e.length,setProperties:c}),g.enqueue([a])):($=
H.mergeObjects($||{},c),V.reset())}}function s(a,b){var e={};e[a]=b;t(e)}function x(a){a=a.spec();$&&a.memberid===b&&"SplitParagraph"!==a.optype&&($=null,V.reset())}function w(a){s("fo:font-weight",a?"bold":"normal")}function C(a){s("fo:font-style",a?"italic":"normal")}function G(a){s("style:text-underline-style",a?"solid":"none")}function B(a){s("style:text-line-through-style",a?"solid":"none")}function E(a){if(q().directParagraphStyling){var e=v.getCursor(b).getSelectedRange(),e=ba.getParagraphElements(e),
d=v.getFormatting(),f=[],h={},m;e.forEach(function(e){var g=v.convertDomPointToCursorStep(e,0,N),l=e.getAttributeNS(odf.Namespaces.textns,"style-name"),k;e=l?h.hasOwnProperty(l)?h[l]:void 0:m;e||(e=c.generateStyleName(),l?(h[l]=e,k=d.createDerivedStyleObject(l,"paragraph",{})):(m=e,k={}),k=a(k),l=new ops.OpAddStyle,l.init({memberid:b,styleName:e.toString(),styleFamily:"paragraph",isAutomaticStyle:!0,setProperties:k}),f.push(l));l=new ops.OpSetParagraphStyle;l.init({memberid:b,styleName:e.toString(),
position:g});f.push(l)});g.enqueue(f)}}function J(a){E(function(b){return H.mergeObjects(b,a)})}function I(a){J({"style:paragraph-properties":{"fo:text-align":a}})}function U(a,b){var e=v.getFormatting().getDefaultTabStopDistance(),c=b["style:paragraph-properties"],d;c&&(c=c["fo:margin-left"],d=ba.parseLength(c));return H.mergeObjects(b,{"style:paragraph-properties":{"fo:margin-left":d&&d.unit===e.unit?d.value+a*e.value+d.unit:a*e.value+e.unit}})}function Q(a,b){var e=f(a),e=0===e.length?[a.startContainer]:
e,e=v.getFormatting().getAppliedStyles(e),c=0<e.length?e[0].styleProperties:void 0,d=v.getFormatting().getAppliedStylesForElement(b).styleProperties;if(!c||"text"!==c["style:family"]||!c["style:text-properties"])return!1;if(!d||!d["style:text-properties"])return!0;c=c["style:text-properties"];d=d["style:text-properties"];return!Object.keys(c).every(function(a){return c[a]===d[a]})}function A(){}function Z(){return!1}var S=this,v=g.getOdtDocument(),H=new core.Utils,ba=odf.OdfUtils,P=new core.EventNotifier([gui.DirectFormattingController.enabledChanged,
gui.DirectFormattingController.textStylingChanged,gui.DirectFormattingController.paragraphStylingChanged]),F=odf.Namespaces.textns,N=core.StepDirection.NEXT,$=null,D,V;this.enabledFeatures=q;this.formatTextSelection=t;this.createCursorStyleOp=function(a,e,c){var d=null,f=$;c&&(f=(c=V.value().appliedStyles[0])&&c.styleProperties);f&&f["style:text-properties"]&&(d=new ops.OpApplyDirectStyling,d.init({memberid:b,position:a,length:e,setProperties:{"style:text-properties":f["style:text-properties"]}}),
$=null,V.reset());return d};this.setBold=w;this.setItalic=C;this.setHasUnderline=G;this.setHasStrikethrough=B;this.setFontSize=function(a){s("fo:font-size",a+"pt")};this.setFontName=function(a){s("style:font-name",a)};this.getAppliedStyles=function(){return V.value().appliedStyles};this.toggleBold=z.bind(S,function(){return p().isBold()},w);this.toggleItalic=z.bind(S,function(){return p().isItalic()},C);this.toggleUnderline=z.bind(S,function(){return p().hasUnderline()},G);this.toggleStrikethrough=
z.bind(S,function(){return p().hasStrikeThrough()},B);this.isBold=function(){return p().isBold()};this.isItalic=function(){return p().isItalic()};this.hasUnderline=function(){return p().hasUnderline()};this.hasStrikeThrough=function(){return p().hasStrikeThrough()};this.fontSize=function(){return p().fontSize()};this.fontName=function(){return p().fontName()};this.isAlignedLeft=function(){return p().isAlignedLeft()};this.isAlignedCenter=function(){return p().isAlignedCenter()};this.isAlignedRight=
function(){return p().isAlignedRight()};this.isAlignedJustified=function(){return p().isAlignedJustified()};this.alignParagraphLeft=function(){I("left");return!0};this.alignParagraphCenter=function(){I("center");return!0};this.alignParagraphRight=function(){I("right");return!0};this.alignParagraphJustified=function(){I("justify");return!0};this.indent=function(){E(U.bind(null,1));return!0};this.outdent=function(){E(U.bind(null,-1));return!0};this.createParagraphStyleOps=function(a){if(!q().directParagraphStyling)return[];
var e=v.getCursor(b),d=e.getSelectedRange(),f=[],h,g;e.hasForwardSelection()?(h=e.getAnchorNode(),g=e.getNode()):(h=e.getNode(),g=e.getAnchorNode());e=ba.getParagraphElement(g);runtime.assert(Boolean(e),"DirectFormattingController: Cursor outside paragraph");var m=e,l=[v.getPositionFilter(),v.createRootFilter(b)];if(!1!==v.createStepIterator(d.endContainer,d.endOffset,l,m).nextStep())return f;g!==h&&(e=ba.getParagraphElement(h));if(!$&&!Q(d,e))return f;d=(d=V.value().appliedStyles[0])&&d.styleProperties;
if(!d)return f;if(e=e.getAttributeNS(F,"style-name"))d={"style:text-properties":d["style:text-properties"]},d=v.getFormatting().createDerivedStyleObject(e,"paragraph",d);h=c.generateStyleName();e=new ops.OpAddStyle;e.init({memberid:b,styleName:h,styleFamily:"paragraph",isAutomaticStyle:!0,setProperties:d});f.push(e);e=new ops.OpSetParagraphStyle;e.init({memberid:b,styleName:h,position:a});f.push(e);return f};this.subscribe=function(a,b){P.subscribe(a,b)};this.unsubscribe=function(a,b){P.unsubscribe(a,
b)};this.destroy=function(a){v.unsubscribe(ops.Document.signalCursorAdded,m);v.unsubscribe(ops.Document.signalCursorRemoved,m);v.unsubscribe(ops.Document.signalCursorMoved,m);v.unsubscribe(ops.OdtDocument.signalParagraphStyleModified,y);v.unsubscribe(ops.OdtDocument.signalParagraphChanged,u);v.unsubscribe(ops.OdtDocument.signalOperationEnd,x);v.unsubscribe(ops.OdtDocument.signalProcessingBatchEnd,e);k.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,r);a()};(function(){v.subscribe(ops.Document.signalCursorAdded,
m);v.subscribe(ops.Document.signalCursorRemoved,m);v.subscribe(ops.Document.signalCursorMoved,m);v.subscribe(ops.OdtDocument.signalParagraphStyleModified,y);v.subscribe(ops.OdtDocument.signalParagraphChanged,u);v.subscribe(ops.OdtDocument.signalOperationEnd,x);v.subscribe(ops.OdtDocument.signalProcessingBatchEnd,e);k.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,r);V=new core.LazyProperty(h);D=V.value();l||(S.formatTextSelection=A,S.setBold=A,S.setItalic=A,S.setHasUnderline=A,S.setHasStrikethrough=
A,S.setFontSize=A,S.setFontName=A,S.toggleBold=Z,S.toggleItalic=Z,S.toggleUnderline=Z,S.toggleStrikethrough=Z);n||(S.alignParagraphCenter=A,S.alignParagraphJustified=A,S.alignParagraphLeft=A,S.alignParagraphRight=A,S.createParagraphStyleOps=function(){return[]},S.indent=A,S.outdent=A)})()};gui.DirectFormattingController.enabledChanged="enabled/changed";gui.DirectFormattingController.textStylingChanged="textStyling/changed";gui.DirectFormattingController.paragraphStylingChanged="paragraphStyling/changed";
gui.DirectFormattingController.SelectionInfo=function(){};gui.KeyboardHandler=function(){function g(b,d){d||(d=k.None);switch(b){case gui.KeyboardHandler.KeyCode.LeftMeta:case gui.KeyboardHandler.KeyCode.RightMeta:case gui.KeyboardHandler.KeyCode.MetaInMozilla:d|=k.Meta;break;case gui.KeyboardHandler.KeyCode.Ctrl:d|=k.Ctrl;break;case gui.KeyboardHandler.KeyCode.Alt:d|=k.Alt;break;case gui.KeyboardHandler.KeyCode.Shift:d|=k.Shift}return b+":"+d}var k=gui.KeyboardHandler.Modifier,d=null,b={};this.setDefault=function(b){d=b};this.bind=function(c,d,k,p){c=g(c,
d);runtime.assert(p||!1===b.hasOwnProperty(c),"tried to overwrite the callback handler of key combo: "+c);b[c]=k};this.unbind=function(c,d){var k=g(c,d);delete b[k]};this.reset=function(){d=null;b={}};this.handleEvent=function(c){var l=c.keyCode,n=k.None;c.metaKey&&(n|=k.Meta);c.ctrlKey&&(n|=k.Ctrl);c.altKey&&(n|=k.Alt);c.shiftKey&&(n|=k.Shift);l=g(l,n);l=b[l];n=!1;l?n=l():null!==d&&(n=d(c));n&&(c.preventDefault?c.preventDefault():c.returnValue=!1)}};
gui.KeyboardHandler.Modifier={None:0,Meta:1,Ctrl:2,Alt:4,CtrlAlt:6,Shift:8,MetaShift:9,CtrlShift:10,AltShift:12};gui.KeyboardHandler.KeyCode={Backspace:8,Tab:9,Clear:12,Enter:13,Shift:16,Ctrl:17,Alt:18,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,Delete:46,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,LeftMeta:91,RightMeta:93,MetaInMozilla:224};gui.HyperlinkClickHandler=function(g,k,d){function b(){var a=g();runtime.assert(Boolean(a.classList),"Document container has no classList element");a.classList.remove("webodf-inactiveLinks")}function c(){var a=g();runtime.assert(Boolean(a.classList),"Document container has no classList element");a.classList.add("webodf-inactiveLinks")}function l(){a.removeEventListener("focus",c,!1);r.forEach(function(a){k.unbind(a.keyCode,a.modifier);d.unbind(a.keyCode,a.modifier)});r.length=0}function n(e){l();
if(e!==p.None){a.addEventListener("focus",c,!1);switch(e){case p.Ctrl:r.push({keyCode:q.Ctrl,modifier:p.None});break;case p.Meta:r.push({keyCode:q.LeftMeta,modifier:p.None}),r.push({keyCode:q.RightMeta,modifier:p.None}),r.push({keyCode:q.MetaInMozilla,modifier:p.None})}r.forEach(function(a){k.bind(a.keyCode,a.modifier,b);d.bind(a.keyCode,a.modifier,c)})}}var p=gui.KeyboardHandler.Modifier,q=gui.KeyboardHandler.KeyCode,f=xmldom.XPath,h=odf.OdfUtils,a=runtime.getWindow(),e=p.None,r=[];runtime.assert(null!==
a,"Expected to be run in an environment which has a global window, like a browser.");this.handleClick=function(b){var c=b.target||b.srcElement,d,l;b.ctrlKey?d=p.Ctrl:b.metaKey&&(d=p.Meta);if(e===p.None||e===d){a:{for(;null!==c;){if(h.isHyperlink(c))break a;if(h.isParagraph(c))break;c=c.parentNode}c=null}c&&(c=h.getHyperlinkTarget(c),""!==c&&("#"===c[0]?(c=c.substring(1),d=g(),l=f.getODFElementsWithXPath(d,"//text:bookmark-start[@text:name='"+c+"']",odf.Namespaces.lookupNamespaceURI),0===l.length&&
(l=f.getODFElementsWithXPath(d,"//text:bookmark[@text:name='"+c+"']",odf.Namespaces.lookupNamespaceURI)),0<l.length&&l[0].scrollIntoView(!0)):/^\s*(javascript|data):/.test(c)?runtime.log("WARN:","potentially malicious URL ignored"):a.open(c),b.preventDefault?b.preventDefault():b.returnValue=!1))}};this.setModifier=function(a){e!==a&&(runtime.assert(a===p.None||a===p.Ctrl||a===p.Meta,"Unsupported KeyboardHandler.Modifier value: "+a),e=a,e!==p.None?c():b(),n(e))};this.getModifier=function(){return e};
this.destroy=function(a){c();l();a()}};gui.EventManager=function(g){function k(a){function b(a,e,c){var d,f=!1;d="on"+e;a.attachEvent&&(a.attachEvent(d,c),f=!0);!f&&a.addEventListener&&(a.addEventListener(e,c,!1),f=!0);f&&!x[e]||!a.hasOwnProperty(d)||(a[d]=c)}function e(a,b,c){var d="on"+b;a.detachEvent&&a.detachEvent(d,c);a.removeEventListener&&a.removeEventListener(b,c,!1);a[d]===c&&(a[d]=null)}function c(b){if(-1===f.indexOf(b)){f.push(b);if(d.filters.every(function(a){return a(b)}))try{h.emit(a,b)}catch(e){runtime.log("Error occurred while processing "+
a+":\n"+e.message+"\n"+e.stack)}runtime.setTimeout(function(){f.splice(f.indexOf(b),1)},0)}}var d=this,f=[],h=new core.EventNotifier([a]);this.filters=[];this.subscribe=function(b){h.subscribe(a,b)};this.unsubscribe=function(b){h.unsubscribe(a,b)};this.destroy=function(){e(s,a,c);e(B,a,c);e(E,a,c)};w[a]&&b(s,a,c);b(B,a,c);b(E,a,c)}function d(a,b,e){function c(b){e(b,d,function(b){b.type=a;f.emit(a,b)})}var d={},f=new core.EventNotifier([a]);this.subscribe=function(b){f.subscribe(a,b)};this.unsubscribe=
function(b){f.unsubscribe(a,b)};this.destroy=function(){b.forEach(function(a){J.unsubscribe(a,c)})};(function(){b.forEach(function(a){J.subscribe(a,c)})})()}function b(a){runtime.clearTimeout(a);delete I[a]}function c(a,e){var c=runtime.setTimeout(function(){a();b(c)},e);I[c]=!0;return c}function l(a,e,d){var f=a.touches.length,h=a.touches[0],g=e.timer;"touchmove"===a.type||"touchend"===a.type?g&&b(g):"touchstart"===a.type&&(1!==f?runtime.clearTimeout(g):g=c(function(){d({clientX:h.clientX,clientY:h.clientY,
pageX:h.pageX,pageY:h.pageY,target:a.target||a.srcElement||null,detail:1})},400));e.timer=g}function n(a,b,e){var c=a.touches[0],d=a.target||a.srcElement||null,f=b.target;1!==a.touches.length||"touchend"===a.type?f=null:"touchstart"===a.type&&"webodf-draggable"===d.getAttribute("class")?f=d:"touchmove"===a.type&&f&&(a.preventDefault(),a.stopPropagation(),e({clientX:c.clientX,clientY:c.clientY,pageX:c.pageX,pageY:c.pageY,target:f,detail:1}));b.target=f}function p(a,b,e){var c=a.target||a.srcElement||
null,d=b.dragging;"drag"===a.type?d=!0:"touchend"===a.type&&d&&(d=!1,a=a.changedTouches[0],e({clientX:a.clientX,clientY:a.clientY,pageX:a.pageX,pageY:a.pageY,target:c,detail:1}));b.dragging=d}function q(){E.classList.add("webodf-touchEnabled");J.unsubscribe("touchstart",q)}function f(a){var b=a.scrollX,e=a.scrollY;this.restore=function(){a.scrollX===b&&a.scrollY===e||a.scrollTo(b,e)}}function h(a){var b=a.scrollTop,e=a.scrollLeft;this.restore=function(){if(a.scrollTop!==b||a.scrollLeft!==e)a.scrollTop=
b,a.scrollLeft=e}}function a(a,b){var e=G[a]||C[a]||null;!e&&b&&(e=G[a]=new k(a));return e}function e(b,e){a(b,!0).subscribe(e)}function r(b,e){var c=a(b,!1);c&&c.unsubscribe(e)}function m(){return g.getDOMDocument().activeElement===B}function y(){m()&&B.blur();B.setAttribute("disabled","true")}function u(){B.removeAttribute("disabled")}function z(a){for(var b=[];a;)(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight)&&b.push(new h(a)),a=a.parentNode;b.push(new f(s));return b}function t(){var a;
m()||(a=z(B),u(),B.focus(),a.forEach(function(a){a.restore()}))}var s=runtime.getWindow(),x={beforecut:!0,beforepaste:!0,longpress:!0,drag:!0,dragstop:!0},w={mousedown:!0,mouseup:!0,focus:!0},C={},G={},B,E=g.getCanvas().getElement(),J=this,I={};this.addFilter=function(b,e){a(b,!0).filters.push(e)};this.removeFilter=function(b,e){var c=a(b,!0),d=c.filters.indexOf(e);-1!==d&&c.filters.splice(d,1)};this.subscribe=e;this.unsubscribe=r;this.hasFocus=m;this.focus=t;this.getEventTrap=function(){return B};
this.setEditing=function(a){var b=m();b&&B.blur();a?B.removeAttribute("readOnly"):B.setAttribute("readOnly","true");b&&t()};this.destroy=function(a){r("touchstart",q);Object.keys(I).forEach(function(a){b(parseInt(a,10))});I.length=0;Object.keys(C).forEach(function(a){C[a].destroy()});C={};r("mousedown",y);r("mouseup",u);r("contextmenu",u);Object.keys(G).forEach(function(a){G[a].destroy()});G={};B.parentNode.removeChild(B);a()};(function(){var a=g.getOdfCanvas().getSizer(),b=a.ownerDocument;runtime.assert(Boolean(s),
"EventManager requires a window object to operate correctly");B=b.createElement("textarea");B.id="eventTrap";B.setAttribute("tabindex","-1");B.setAttribute("readOnly","true");B.setAttribute("rows","1");a.appendChild(B);e("mousedown",y);e("mouseup",u);e("contextmenu",u);C.longpress=new d("longpress",["touchstart","touchmove","touchend"],l);C.drag=new d("drag",["touchstart","touchmove","touchend"],n);C.dragstop=new d("dragstop",["drag","touchend"],p);e("touchstart",q)})()};gui.IOSSafariSupport=function(g){function k(){d.innerHeight!==d.outerHeight&&(b.style.display="none",runtime.requestAnimationFrame(function(){b.style.display="block"}))}var d=runtime.getWindow(),b=g.getEventTrap();this.destroy=function(c){g.unsubscribe("focus",k);b.removeAttribute("autocapitalize");b.style.WebkitTransform="";c()};g.subscribe("focus",k);b.setAttribute("autocapitalize","off");b.style.WebkitTransform="translateX(-10000px)"};gui.HyperlinkController=function(g,k,d,b){function c(){var b=!0;!0===k.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)&&(b=d.isLocalCursorWithinOwnAnnotation());b!==f&&(f=b,q.emit(gui.HyperlinkController.enabledChanged,f))}function l(d){d.getMemberId()===b&&c()}var n=odf.OdfUtils,p=g.getOdtDocument(),q=new core.EventNotifier([gui.HyperlinkController.enabledChanged]),f=!1;this.isEnabled=function(){return f};this.subscribe=function(b,a){q.subscribe(b,a)};this.unsubscribe=function(b,a){q.unsubscribe(b,
a)};this.addHyperlink=function(c,a){if(f){var e=p.getCursorSelection(b),d=new ops.OpApplyHyperlink,m=[];if(0===e.length||a)a=a||c,d=new ops.OpInsertText,d.init({memberid:b,position:e.position,text:a}),e.length=a.length,m.push(d);d=new ops.OpApplyHyperlink;d.init({memberid:b,position:e.position,length:e.length,hyperlink:c});m.push(d);g.enqueue(m)}};this.removeHyperlinks=function(){if(f){var c=p.createPositionIterator(p.getRootNode()),a=p.getCursor(b).getSelectedRange(),e=n.getHyperlinkElements(a),
d=a.collapsed&&1===e.length,m=p.getDOMDocument().createRange(),l=[],k,q;0!==e.length&&(e.forEach(function(a){m.selectNodeContents(a);k=p.convertDomToCursorRange({anchorNode:m.startContainer,anchorOffset:m.startOffset,focusNode:m.endContainer,focusOffset:m.endOffset});q=new ops.OpRemoveHyperlink;q.init({memberid:b,position:k.position,length:k.length});l.push(q)}),d||(d=e[0],-1===a.comparePoint(d,0)&&(m.setStart(d,0),m.setEnd(a.startContainer,a.startOffset),k=p.convertDomToCursorRange({anchorNode:m.startContainer,
anchorOffset:m.startOffset,focusNode:m.endContainer,focusOffset:m.endOffset}),0<k.length&&(q=new ops.OpApplyHyperlink,q.init({memberid:b,position:k.position,length:k.length,hyperlink:n.getHyperlinkTarget(d)}),l.push(q))),e=e[e.length-1],c.moveToEndOfNode(e),c=c.unfilteredDomOffset(),1===a.comparePoint(e,c)&&(m.setStart(a.endContainer,a.endOffset),m.setEnd(e,c),k=p.convertDomToCursorRange({anchorNode:m.startContainer,anchorOffset:m.startOffset,focusNode:m.endContainer,focusOffset:m.endOffset}),0<k.length&&
(q=new ops.OpApplyHyperlink,q.init({memberid:b,position:k.position,length:k.length,hyperlink:n.getHyperlinkTarget(e)}),l.push(q)))),g.enqueue(l),m.detach())}};this.destroy=function(b){p.unsubscribe(ops.Document.signalCursorMoved,l);k.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,c);b()};p.subscribe(ops.Document.signalCursorMoved,l);k.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,c);c()};gui.HyperlinkController.enabledChanged="enabled/changed";gui.ImageController=function(g,k,d,b,c){function l(){var a=!0;!0===k.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)&&(a=d.isLocalCursorWithinOwnAnnotation());a!==r&&(r=a,e.emit(gui.ImageController.enabledChanged,r))}function n(a){a.getMemberId()===b&&l()}var p={"image/gif":".gif","image/jpeg":".jpg","image/png":".png"},q=odf.Namespaces.textns,f=g.getOdtDocument(),h=odf.OdfUtils,a=f.getFormatting(),e=new core.EventNotifier([gui.HyperlinkController.enabledChanged]),r=!1;this.isEnabled=function(){return r};
this.subscribe=function(a,b){e.subscribe(a,b)};this.unsubscribe=function(a,b){e.unsubscribe(a,b)};this.insertImage=function(e,d,l,k){if(r){runtime.assert(0<l&&0<k,"Both width and height of the image should be greater than 0px.");k={width:l,height:k};if(l=h.getParagraphElement(f.getCursor(b).getNode()).getAttributeNS(q,"style-name")){l=a.getContentSize(l,"paragraph");var n=1,s=1;k.width>l.width&&(n=l.width/k.width);k.height>l.height&&(s=l.height/k.height);l=Math.min(n,s);k={width:k.width*l,height:k.height*
l}}l=k.width/37.8+"cm";k=k.height/37.8+"cm";var x=f.getOdfCanvas().odfContainer().rootElement.styles,n=e.toLowerCase(),s=p.hasOwnProperty(n)?p[n]:null,w,n=[];runtime.assert(null!==s,"Image type is not supported: "+e);s="Pictures/"+c.generateImageName()+s;w=new ops.OpSetBlob;w.init({memberid:b,filename:s,mimetype:e,content:d});n.push(w);a.getStyleElement("Graphics","graphic",[x])||(e=new ops.OpAddStyle,e.init({memberid:b,styleName:"Graphics",styleFamily:"graphic",isAutomaticStyle:!1,setProperties:{"style:graphic-properties":{"text:anchor-type":"paragraph",
"svg:x":"0cm","svg:y":"0cm","style:wrap":"dynamic","style:number-wrapped-paragraphs":"no-limit","style:wrap-contour":"false","style:vertical-pos":"top","style:vertical-rel":"paragraph","style:horizontal-pos":"center","style:horizontal-rel":"paragraph"}}}),n.push(e));e=c.generateStyleName();d=new ops.OpAddStyle;d.init({memberid:b,styleName:e,styleFamily:"graphic",isAutomaticStyle:!0,setProperties:{"style:parent-style-name":"Graphics","style:graphic-properties":{"style:vertical-pos":"top","style:vertical-rel":"baseline",
"style:horizontal-pos":"center","style:horizontal-rel":"paragraph","fo:background-color":"transparent","style:background-transparency":"100%","style:shadow":"none","style:mirror":"none","fo:clip":"rect(0cm, 0cm, 0cm, 0cm)","draw:luminance":"0%","draw:contrast":"0%","draw:red":"0%","draw:green":"0%","draw:blue":"0%","draw:gamma":"100%","draw:color-inversion":"false","draw:image-opacity":"100%","draw:color-mode":"standard"}}});n.push(d);w=new ops.OpInsertImage;w.init({memberid:b,position:f.getCursorPosition(b),
filename:s,frameWidth:l,frameHeight:k,frameStyleName:e,frameName:c.generateFrameName()});n.push(w);g.enqueue(n)}};this.destroy=function(a){f.unsubscribe(ops.Document.signalCursorMoved,n);k.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,l);a()};f.subscribe(ops.Document.signalCursorMoved,n);k.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,l);l()};gui.ImageController.enabledChanged="enabled/changed";gui.ImageSelector=function(g){function k(){var d=g.getSizer(),l=c.createElement("div");l.id="imageSelector";l.style.borderWidth="1px";d.appendChild(l);b.forEach(function(b){var d=c.createElement("div");d.className=b;l.appendChild(d)});return l}var d=odf.Namespaces.svgns,b="topLeft topRight bottomRight bottomLeft topMiddle rightMiddle bottomMiddle leftMiddle".split(" "),c=g.getElement().ownerDocument,l=!1;this.select=function(b){var p,q,f=c.getElementById("imageSelector");f||(f=k());l=!0;p=f.parentNode;
q=b.getBoundingClientRect();var h=p.getBoundingClientRect(),a=g.getZoomLevel();p=(q.left-h.left)/a-1;q=(q.top-h.top)/a-1;f.style.display="block";f.style.left=p+"px";f.style.top=q+"px";f.style.width=b.getAttributeNS(d,"width");f.style.height=b.getAttributeNS(d,"height")};this.clearSelection=function(){var b;l&&(b=c.getElementById("imageSelector"))&&(b.style.display="none");l=!1};this.isSelectorElement=function(b){var d=c.getElementById("imageSelector");return d?b===d||b.parentNode===d:!1}};(function(){function g(g){function d(b){n=b.which&&String.fromCharCode(b.which)===l;l=void 0;return!1===n}function b(){n=!1}function c(b){l=b.data;n=!1}var l,n=!1;this.destroy=function(l){g.unsubscribe("textInput",b);g.unsubscribe("compositionend",c);g.removeFilter("keypress",d);l()};g.subscribe("textInput",b);g.subscribe("compositionend",c);g.addFilter("keypress",d)}gui.InputMethodEditor=function(k,d){function b(b){e&&(b?e.getNode().setAttributeNS(a,"composing","true"):(e.getNode().removeAttributeNS(a,
"composing"),y.textContent=""))}function c(){z&&(z=!1,b(!1),s.emit(gui.InputMethodEditor.signalCompositionEnd,{data:t}),t="")}function l(){B||(B=!0,c(),e&&e.getSelectedRange().collapsed?r.value="":r.value=w.writeToString(e.getSelectedRange().cloneContents()),r.setSelectionRange(0,r.value.length),B=!1)}function n(){d.hasFocus()&&u.trigger()}function p(){x=void 0;u.cancel();b(!0);z||s.emit(gui.InputMethodEditor.signalCompositionStart,{data:""})}function q(a){a=x=a.data;z=!0;t+=a;u.trigger()}function f(a){a.data!==
x&&(a=a.data,z=!0,t+=a,u.trigger());x=void 0}function h(){y.textContent=r.value}var a="urn:webodf:names:cursor",e=null,r=d.getEventTrap(),m=r.ownerDocument,y,u,z=!1,t="",s=new core.EventNotifier([gui.InputMethodEditor.signalCompositionStart,gui.InputMethodEditor.signalCompositionEnd]),x,w,C=[],G,B=!1;this.subscribe=s.subscribe;this.unsubscribe=s.unsubscribe;this.registerCursor=function(a){a.getMemberId()===k&&(e=a,e.getNode().appendChild(y),a.subscribe(ops.OdtCursor.signalCursorUpdated,n),d.subscribe("input",
h),d.subscribe("compositionupdate",h))};this.removeCursor=function(a){e&&a===k&&(e.getNode().removeChild(y),e.unsubscribe(ops.OdtCursor.signalCursorUpdated,n),d.unsubscribe("input",h),d.unsubscribe("compositionupdate",h),e=null)};this.destroy=function(a){d.unsubscribe("compositionstart",p);d.unsubscribe("compositionend",q);d.unsubscribe("textInput",f);d.unsubscribe("keypress",c);d.unsubscribe("focus",l);core.Async.destroyAll(G,a)};(function(){w=new odf.TextSerializer;w.filter=new odf.OdfNodeFilter;
d.subscribe("compositionstart",p);d.subscribe("compositionend",q);d.subscribe("textInput",f);d.subscribe("keypress",c);d.subscribe("focus",l);C.push(new g(d));G=C.map(function(a){return a.destroy});y=m.createElement("span");y.setAttribute("id","composer");u=core.Task.createTimeoutTask(l,1);G.push(u.destroy)})()};gui.InputMethodEditor.signalCompositionStart="input/compositionstart";gui.InputMethodEditor.signalCompositionEnd="input/compositionend"})();gui.MetadataController=function(g,k){function d(b){l.emit(gui.MetadataController.signalMetadataChanged,b)}function b(b){var c=-1===n.indexOf(b);c||runtime.log("Setting "+b+" is restricted.");return c}var c=g.getOdtDocument(),l=new core.EventNotifier([gui.MetadataController.signalMetadataChanged]),n=["dc:creator","dc:date","meta:editing-cycles","meta:editing-duration","meta:document-statistic"];this.setMetadata=function(c,d){var f={},h="",a;c&&Object.keys(c).filter(b).forEach(function(a){f[a]=c[a]});
d&&(h=d.filter(b).join(","));if(0<h.length||0<Object.keys(f).length)a=new ops.OpUpdateMetadata,a.init({memberid:k,setProperties:f,removedProperties:0<h.length?{attributes:h}:null}),g.enqueue([a])};this.getMetadata=function(b){var d;runtime.assert("string"===typeof b,"Property must be a string");d=b.split(":");runtime.assert(2===d.length,"Property must be a namespace-prefixed string");b=odf.Namespaces.lookupNamespaceURI(d[0]);runtime.assert(Boolean(b),"Prefix must be for an ODF namespace.");return c.getOdfCanvas().odfContainer().getMetadata(b,
d[1])};this.subscribe=function(b,c){l.subscribe(b,c)};this.unsubscribe=function(b,c){l.unsubscribe(b,c)};this.destroy=function(b){c.unsubscribe(ops.OdtDocument.signalMetadataUpdated,d);b()};c.subscribe(ops.OdtDocument.signalMetadataUpdated,d)};gui.MetadataController.signalMetadataChanged="metadata/changed";gui.PasteController=function(g,k,d,b){function c(){p=!0===k.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)?d.isLocalCursorWithinOwnAnnotation():!0}function l(a){a.getMemberId()===b&&c()}var n=g.getOdtDocument(),p=!1,q=odf.Namespaces.textns,f=core.StepDirection.NEXT,h=odf.OdfUtils;this.isEnabled=function(){return p};this.paste=function(a){if(p){var e=n.getCursorPosition(b),c=n.getCursor(b).getNode(),c=h.getParagraphElement(c),d=c.getAttributeNS(q,"style-name")||"",l=e,k=[],z=n.convertDomPointToCursorStep(c,
0,f);a.replace(/\r/g,"").split("\n").forEach(function(a){var e=new ops.OpInsertText,c=new ops.OpSplitParagraph;e.init({memberid:b,position:l,text:a,moveCursor:!0});k.push(e);l+=a.length;c.init({memberid:b,position:l,paragraphStyleName:d,sourceParagraphPosition:z,moveCursor:!0});k.push(c);z=l+=1});k.pop();g.enqueue(k)}};this.destroy=function(a){n.unsubscribe(ops.Document.signalCursorMoved,l);k.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,c);a()};n.subscribe(ops.Document.signalCursorMoved,l);
k.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,c);c()};gui.ClosestXOffsetScanner=function(g){function k(b){return null!==b&&void 0!==c?Math.abs(b-g)>c:!1}function d(b){null!==b&&!1===k(b)&&(c=Math.abs(b-g))}var b=this,c,l=gui.StepInfo.VisualDirection.LEFT_TO_RIGHT;this.token=void 0;this.process=function(c,g,q){var f,h;c.visualDirection===l?(f=g&&g.right,h=q&&q.left):(f=g&&g.left,h=q&&q.right);if(k(f)||k(h))return!0;if(g||q)d(f),d(h),b.token=c.token;return!1}};gui.LineBoundaryScanner=function(){var g=this,k=null;this.token=void 0;this.process=function(d,b,c){var l;if(l=c)if(k){var n=k;l=Math.min(n.bottom-n.top,c.bottom-c.top);var p=Math.max(n.top,c.top),n=Math.min(n.bottom,c.bottom)-p;l=0.4>=(0<l?n/l:0)}else l=!1;!b||c&&!l||(g.token=d.token);if(l)return!0;k=(d=k)&&b?{left:Math.min(d.left,b.left),right:Math.max(d.right,b.right),top:Math.min(d.top,b.top),bottom:Math.min(d.bottom,b.bottom)}:d||b;return!1}};gui.ParagraphBoundaryScanner=function(){var g=this,k=!1,d,b=odf.OdfUtils;this.token=void 0;this.process=function(c){var l=b.getParagraphElement(c.container());k||(d=l,k=!0);if(d!==l)return!0;g.token=c.token;return!1}};odf.WordBoundaryFilter=function(g,k){function d(a,b,e){for(var c=null,d=g.getRootNode(),f;a!==d&&null!==a&&null===c;)f=0>b?a.previousSibling:a.nextSibling,e(f)===NodeFilter.FILTER_ACCEPT&&(c=f),a=a.parentNode;return c}function b(a,b){var e;return null===a?r.NO_NEIGHBOUR:n.isCharacterElement(a)?r.SPACE_CHAR:a.nodeType===c||n.isTextSpan(a)||n.isHyperlink(a)?(e=a.textContent.charAt(b()),q.test(e)?r.SPACE_CHAR:p.test(e)?r.PUNCTUATION_CHAR:r.WORD_CHAR):r.OTHER}var c=Node.TEXT_NODE,l=Node.ELEMENT_NODE,
n=odf.OdfUtils,p=/[!-#%-*,-\/:-;?-@\[-\]_{}\u00a1\u00ab\u00b7\u00bb\u00bf;\u00b7\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0700-\u070d\u07f7-\u07f9\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u169b-\u169c\u16eb-\u16ed\u1735-\u1736\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u1944-\u1945\u19de-\u19df\u1a1e-\u1a1f\u1b5a-\u1b60\u1c3b-\u1c3f\u1c7e-\u1c7f\u2000-\u206e\u207d-\u207e\u208d-\u208e\u3008-\u3009\u2768-\u2775\u27c5-\u27c6\u27e6-\u27ef\u2983-\u2998\u29d8-\u29db\u29fc-\u29fd\u2cf9-\u2cfc\u2cfe-\u2cff\u2e00-\u2e7e\u3000-\u303f\u30a0\u30fb\ua60d-\ua60f\ua673\ua67e\ua874-\ua877\ua8ce-\ua8cf\ua92e-\ua92f\ua95f\uaa5c-\uaa5f\ufd3e-\ufd3f\ufe10-\ufe19\ufe30-\ufe52\ufe54-\ufe61\ufe63\ufe68\ufe6a-\ufe6b\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|\ud800[\udd00-\udd01\udf9f\udfd0]|\ud802[\udd1f\udd3f\ude50-\ude58]|\ud809[\udc00-\udc7e]/,
q=/\s/,f=core.PositionFilter.FilterResult.FILTER_ACCEPT,h=core.PositionFilter.FilterResult.FILTER_REJECT,a=odf.WordBoundaryFilter.IncludeWhitespace.TRAILING,e=odf.WordBoundaryFilter.IncludeWhitespace.LEADING,r={NO_NEIGHBOUR:0,SPACE_CHAR:1,PUNCTUATION_CHAR:2,WORD_CHAR:3,OTHER:4};this.acceptPosition=function(c){var g=c.container(),n=c.leftNode(),p=c.rightNode(),q=c.unfilteredDomOffset,s=function(){return c.unfilteredDomOffset()-1};g.nodeType===l&&(null===p&&(p=d(g,1,c.getNodeFilter())),null===n&&(n=
d(g,-1,c.getNodeFilter())));g!==p&&(q=function(){return 0});g!==n&&null!==n&&(s=function(){return n.textContent.length-1});g=b(n,s);p=b(p,q);return g===r.WORD_CHAR&&p===r.WORD_CHAR||g===r.PUNCTUATION_CHAR&&p===r.PUNCTUATION_CHAR||k===a&&g!==r.NO_NEIGHBOUR&&p===r.SPACE_CHAR||k===e&&g===r.SPACE_CHAR&&p!==r.NO_NEIGHBOUR?h:f}};odf.WordBoundaryFilter.IncludeWhitespace={None:0,TRAILING:1,LEADING:2};gui.SelectionController=function(g,k){function d(a){var b=a.spec();if(a.isEdit||b.memberid===k)G=void 0,B.cancel()}function b(){var a=u.getCursor(k).getNode();return u.createStepIterator(a,0,[s,w],u.getRootElement(a))}function c(a,b,e){e=new odf.WordBoundaryFilter(u,e);var c=u.getRootElement(a)||u.getRootNode(),d=u.createRootFilter(c);return u.createStepIterator(a,b,[s,d,e],c)}function l(a,b){return b?{anchorNode:a.startContainer,anchorOffset:a.startOffset,focusNode:a.endContainer,focusOffset:a.endOffset}:
{anchorNode:a.endContainer,anchorOffset:a.endOffset,focusNode:a.startContainer,focusOffset:a.startOffset}}function n(a,b,e){var c=new ops.OpMoveCursor;c.init({memberid:k,position:a,length:b||0,selectionType:e});return c}function p(a,b,e){var c;c=u.getCursor(k);c=l(c.getSelectedRange(),c.hasForwardSelection());c.focusNode=a;c.focusOffset=b;e||(c.anchorNode=c.focusNode,c.anchorOffset=c.focusOffset);a=u.convertDomToCursorRange(c);g.enqueue([n(a.position,a.length)])}function q(a){var b;b=c(a.startContainer,
a.startOffset,E);b.roundToPreviousStep()&&a.setStart(b.container(),b.offset());b=c(a.endContainer,a.endOffset,J);b.roundToNextStep()&&a.setEnd(b.container(),b.offset())}function f(a){var b=t.getParagraphElements(a),e=b[0],b=b[b.length-1];e&&a.setStart(e,0);b&&(t.isParagraph(a.endContainer)&&0===a.endOffset?a.setEndBefore(b):a.setEnd(b,b.childNodes.length))}function h(a,b,e,c){var d,f;c?(d=e.startContainer,f=e.startOffset):(d=e.endContainer,f=e.endOffset);z.containsNode(a,d)||(f=0>z.comparePoints(a,
0,d,f)?0:a.childNodes.length,d=a);a=u.createStepIterator(d,f,b,t.getParagraphElement(d)||a);a.roundToClosestStep()||runtime.assert(!1,"No step found in requested range");c?e.setStart(a.container(),a.offset()):e.setEnd(a.container(),a.offset())}function a(a,e){var c=b();c.advanceStep(a)&&p(c.container(),c.offset(),e)}function e(a,e){var c,d=G,f=[new gui.LineBoundaryScanner,new gui.ParagraphBoundaryScanner];void 0===d&&C&&(d=C());isNaN(d)||(c=b(),x.moveToFilteredStep(c,a,f)&&c.advanceStep(a)&&(f=[new gui.ClosestXOffsetScanner(d),
new gui.LineBoundaryScanner,new gui.ParagraphBoundaryScanner],x.moveToFilteredStep(c,a,f)&&(p(c.container(),c.offset(),e),G=d,B.restart())))}function r(a,e){var c=b(),d=[new gui.LineBoundaryScanner,new gui.ParagraphBoundaryScanner];x.moveToFilteredStep(c,a,d)&&p(c.container(),c.offset(),e)}function m(a,b){var e=u.getCursor(k),e=l(e.getSelectedRange(),e.hasForwardSelection()),e=c(e.focusNode,e.focusOffset,E);e.advanceStep(a)&&p(e.container(),e.offset(),b)}function y(a,b,e){var c=!1,d=u.getCursor(k),
d=l(d.getSelectedRange(),d.hasForwardSelection()),c=u.getRootElement(d.focusNode);runtime.assert(Boolean(c),"SelectionController: Cursor outside root");d=u.createStepIterator(d.focusNode,d.focusOffset,[s,w],c);d.roundToClosestStep();d.advanceStep(a)&&(e=e(d.container()))&&(a===I?(d.setPosition(e,0),c=d.roundToNextStep()):(d.setPosition(e,e.childNodes.length),c=d.roundToPreviousStep()),c&&p(d.container(),d.offset(),b))}var u=g.getOdtDocument(),z=core.DomUtils,t=odf.OdfUtils,s=u.getPositionFilter(),
x=new gui.GuiStepUtils,w=u.createRootFilter(k),C=null,G,B,E=odf.WordBoundaryFilter.IncludeWhitespace.TRAILING,J=odf.WordBoundaryFilter.IncludeWhitespace.LEADING,I=core.StepDirection.PREVIOUS,U=core.StepDirection.NEXT;this.selectionToRange=function(a){var b=0<=z.comparePoints(a.anchorNode,a.anchorOffset,a.focusNode,a.focusOffset),e=a.focusNode.ownerDocument.createRange();b?(e.setStart(a.anchorNode,a.anchorOffset),e.setEnd(a.focusNode,a.focusOffset)):(e.setStart(a.focusNode,a.focusOffset),e.setEnd(a.anchorNode,
a.anchorOffset));return{range:e,hasForwardSelection:b}};this.rangeToSelection=l;this.selectImage=function(a){var b=u.getRootElement(a),e=u.createRootFilter(b),b=u.createStepIterator(a,0,[e,u.getPositionFilter()],b),c;b.roundToPreviousStep()||runtime.assert(!1,"No walkable position before frame");e=b.container();c=b.offset();b.setPosition(a,a.childNodes.length);b.roundToNextStep()||runtime.assert(!1,"No walkable position after frame");a=u.convertDomToCursorRange({anchorNode:e,anchorOffset:c,focusNode:b.container(),
focusOffset:b.offset()});a=n(a.position,a.length,ops.OdtCursor.RegionSelection);g.enqueue([a])};this.expandToWordBoundaries=q;this.expandToParagraphBoundaries=f;this.selectRange=function(a,b,e){var c=u.getOdfCanvas().getElement(),d,m=[s];d=z.containsNode(c,a.startContainer);c=z.containsNode(c,a.endContainer);if(d||c)if(d&&c&&(2===e?q(a):3<=e&&f(a)),(e=b?u.getRootElement(a.startContainer):u.getRootElement(a.endContainer))||(e=u.getRootNode()),m.push(u.createRootFilter(e)),h(e,m,a,!0),h(e,m,a,!1),a=
l(a,b),b=u.convertDomToCursorRange(a),a=u.getCursorSelection(k),b.position!==a.position||b.length!==a.length)a=n(b.position,b.length,ops.OdtCursor.RangeSelection),g.enqueue([a])};this.moveCursorToLeft=function(){a(I,!1);return!0};this.moveCursorToRight=function(){a(U,!1);return!0};this.extendSelectionToLeft=function(){a(I,!0);return!0};this.extendSelectionToRight=function(){a(U,!0);return!0};this.setCaretXPositionLocator=function(a){C=a};this.moveCursorUp=function(){e(I,!1);return!0};this.moveCursorDown=
function(){e(U,!1);return!0};this.extendSelectionUp=function(){e(I,!0);return!0};this.extendSelectionDown=function(){e(U,!0);return!0};this.moveCursorBeforeWord=function(){m(I,!1);return!0};this.moveCursorPastWord=function(){m(U,!1);return!0};this.extendSelectionBeforeWord=function(){m(I,!0);return!0};this.extendSelectionPastWord=function(){m(U,!0);return!0};this.moveCursorToLineStart=function(){r(I,!1);return!0};this.moveCursorToLineEnd=function(){r(U,!1);return!0};this.extendSelectionToLineStart=
function(){r(I,!0);return!0};this.extendSelectionToLineEnd=function(){r(U,!0);return!0};this.extendSelectionToParagraphStart=function(){y(I,!0,t.getParagraphElement);return!0};this.extendSelectionToParagraphEnd=function(){y(U,!0,t.getParagraphElement);return!0};this.moveCursorToParagraphStart=function(){y(I,!1,t.getParagraphElement);return!0};this.moveCursorToParagraphEnd=function(){y(U,!1,t.getParagraphElement);return!0};this.moveCursorToDocumentStart=function(){y(I,!1,u.getRootElement);return!0};
this.moveCursorToDocumentEnd=function(){y(U,!1,u.getRootElement);return!0};this.extendSelectionToDocumentStart=function(){y(I,!0,u.getRootElement);return!0};this.extendSelectionToDocumentEnd=function(){y(U,!0,u.getRootElement);return!0};this.extendSelectionToEntireDocument=function(){var a=u.getCursor(k),a=u.getRootElement(a.getNode()),b,e,c;runtime.assert(Boolean(a),"SelectionController: Cursor outside root");c=u.createStepIterator(a,0,[s,w],a);c.roundToClosestStep();b=c.container();e=c.offset();
c.setPosition(a,a.childNodes.length);c.roundToClosestStep();a=u.convertDomToCursorRange({anchorNode:b,anchorOffset:e,focusNode:c.container(),focusOffset:c.offset()});g.enqueue([n(a.position,a.length)]);return!0};this.destroy=function(a){u.unsubscribe(ops.OdtDocument.signalOperationStart,d);core.Async.destroyAll([B.destroy],a)};(function(){B=core.Task.createTimeoutTask(function(){G=void 0},2E3);u.subscribe(ops.OdtDocument.signalOperationStart,d)})()};gui.TextController=function(g,k,d,b,c,l){function n(){y=!0===k.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)?d.isLocalCursorWithinOwnAnnotation():!0}function p(a){a.getMemberId()===b&&n()}function q(a,b,c){var d=[e.getPositionFilter()];c&&d.push(e.createRootFilter(a.startContainer));c=e.createStepIterator(a.startContainer,a.startOffset,d,b);c.roundToClosestStep()||runtime.assert(!1,"No walkable step found in paragraph element at range start");b=e.convertDomPointToCursorStep(c.container(),c.offset());
a.collapsed?a=b:(c.setPosition(a.endContainer,a.endOffset),c.roundToClosestStep()||runtime.assert(!1,"No walkable step found in paragraph element at range end"),a=e.convertDomPointToCursorStep(c.container(),c.offset()));return{position:b,length:a-b}}function f(a){var e,c,d,f=r.getParagraphElements(a),g=a.cloneRange(),h=[];e=f[0];1<f.length&&(r.hasNoODFContent(e)&&(e=f[f.length-1]),c=e.getAttributeNS(odf.Namespaces.textns,"style-name")||"");f.forEach(function(e,f){var l,k;g.setStart(e,0);g.collapse(!0);
l=q(g,e,!1).position;0<f&&(k=new ops.OpMergeParagraph,k.init({memberid:b,paragraphStyleName:c,destinationStartPosition:d,sourceStartPosition:l,moveCursor:1===f}),h.unshift(k));d=l;g.selectNodeContents(e);if(l=m.rangeIntersection(g,a))l=q(l,e,!0),0<l.length&&(k=new ops.OpRemoveText,k.init({memberid:b,position:l.position,length:l.length}),h.unshift(k))});return h}function h(a){0>a.length&&(a.position+=a.length,a.length=-a.length);return a}function a(a){if(!y)return!1;var c,d=e.getCursor(b).getSelectedRange().cloneRange(),
m=h(e.getCursorSelection(b)),l;if(0===m.length){m=void 0;c=e.getCursor(b).getNode();l=e.getRootElement(c);var k=[e.getPositionFilter(),e.createRootFilter(l)];l=e.createStepIterator(c,0,k,l);l.roundToClosestStep()&&(a?l.nextStep():l.previousStep())&&(m=h(e.convertDomToCursorRange({anchorNode:c,anchorOffset:0,focusNode:l.container(),focusOffset:l.offset()})),a?(d.setStart(c,0),d.setEnd(l.container(),l.offset())):(d.setStart(l.container(),l.offset()),d.setEnd(c,0)))}m&&g.enqueue(f(d));return void 0!==
m}var e=g.getOdtDocument(),r=odf.OdfUtils,m=core.DomUtils,y=!1,u=odf.Namespaces.textns,z=core.StepDirection.NEXT;this.isEnabled=function(){return y};this.enqueueParagraphSplittingOps=function(){if(!y)return!1;var a=e.getCursor(b),c=a.getSelectedRange(),d=h(e.getCursorSelection(b)),m=[],a=r.getParagraphElement(a.getNode()),k=a.getAttributeNS(u,"style-name")||"";0<d.length&&(m=m.concat(f(c)));c=new ops.OpSplitParagraph;c.init({memberid:b,position:d.position,paragraphStyleName:k,sourceParagraphPosition:e.convertDomPointToCursorStep(a,
0,z),moveCursor:!0});m.push(c);l&&(d=l(d.position+1),m=m.concat(d));g.enqueue(m);return!0};this.removeTextByBackspaceKey=function(){return a(!1)};this.removeTextByDeleteKey=function(){return a(!0)};this.removeCurrentSelection=function(){if(!y)return!1;var a=e.getCursor(b).getSelectedRange();g.enqueue(f(a));return!0};this.insertText=function(a){if(y){var d=e.getCursor(b).getSelectedRange(),m=h(e.getCursorSelection(b)),l=[],k=!1;0<m.length&&(l=l.concat(f(d)),k=!0);d=new ops.OpInsertText;d.init({memberid:b,
position:m.position,text:a,moveCursor:!0});l.push(d);c&&(a=c(m.position,a.length,k))&&l.push(a);g.enqueue(l)}};this.destroy=function(a){e.unsubscribe(ops.Document.signalCursorMoved,p);k.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,n);a()};e.subscribe(ops.Document.signalCursorMoved,p);k.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,n);n()};gui.UndoManager=function(){};gui.UndoManager.prototype.subscribe=function(g,k){};gui.UndoManager.prototype.unsubscribe=function(g,k){};gui.UndoManager.prototype.setDocument=function(g){};gui.UndoManager.prototype.setInitialState=function(){};gui.UndoManager.prototype.initialize=function(){};gui.UndoManager.prototype.purgeInitialState=function(){};gui.UndoManager.prototype.setPlaybackFunction=function(g){};gui.UndoManager.prototype.hasUndoStates=function(){};
gui.UndoManager.prototype.hasRedoStates=function(){};gui.UndoManager.prototype.moveForward=function(g){};gui.UndoManager.prototype.moveBackward=function(g){};gui.UndoManager.prototype.onOperationExecuted=function(g){};gui.UndoManager.prototype.isDocumentModified=function(){};gui.UndoManager.prototype.setDocumentModified=function(g){};gui.UndoManager.signalUndoStackChanged="undoStackChanged";gui.UndoManager.signalUndoStateCreated="undoStateCreated";gui.UndoManager.signalUndoStateModified="undoStateModified";
gui.UndoManager.signalDocumentModifiedChanged="documentModifiedChanged";gui.SessionControllerOptions=function(){this.annotationsEnabled=this.directParagraphStylingEnabled=this.directTextStylingEnabled=!1};
(function(){var g=core.PositionFilter.FilterResult.FILTER_ACCEPT;gui.SessionController=function(k,d,b,c){function l(a){return a.target||a.srcElement||null}function n(a,b){var e=v.getDOMDocument(),c=null;e.caretRangeFromPoint?(e=e.caretRangeFromPoint(a,b),c={container:e.startContainer,offset:e.startOffset}):e.caretPositionFromPoint&&(e=e.caretPositionFromPoint(a,b))&&e.offsetNode&&(c={container:e.offsetNode,offset:e.offset});return c}function p(a){var b=v.getCursor(d).getSelectedRange();b.collapsed?
a.preventDefault():$.setDataFromRange(a,b)?ha.removeCurrentSelection():runtime.log("Cut operation failed")}function q(){return!1!==v.getCursor(d).getSelectedRange().collapsed}function f(a){var b=v.getCursor(d).getSelectedRange();b.collapsed?a.preventDefault():$.setDataFromRange(a,b)||runtime.log("Copy operation failed")}function h(a){var b;S.clipboardData&&S.clipboardData.getData?b=S.clipboardData.getData("Text"):a.clipboardData&&a.clipboardData.getData&&(b=a.clipboardData.getData("text/plain"));
b&&(ha.removeCurrentSelection(),pa.paste(b));a.preventDefault?a.preventDefault():a.returnValue=!1}function a(){return!1}function e(a){if(R)R.onOperationExecuted(a)}function r(a){v.emit(ops.OdtDocument.signalUndoStackChanged,a)}function m(){var a;return R?(a=L.hasFocus(),R.moveBackward(1),a&&L.focus(),!0):!1}function y(){var a;return R?(a=L.hasFocus(),R.moveForward(1),a&&L.focus(),!0):!1}function u(a){var e=v.getCursor(d).getSelectedRange(),c=l(a).getAttribute("end");e&&c&&(a=n(a.clientX,a.clientY))&&
(ia.setUnfilteredPosition(a.container,a.offset),O.acceptPosition(ia)===g&&(e=e.cloneRange(),"left"===c?e.setStart(ia.container(),ia.unfilteredDomOffset()):e.setEnd(ia.container(),ia.unfilteredDomOffset()),b.setSelectedRange(e,"right"===c),v.emit(ops.Document.signalCursorMoved,b)))}function z(){X.selectRange(b.getSelectedRange(),b.hasForwardSelection(),1)}function t(){var a=S.getSelection(),e=0<a.rangeCount&&X.selectionToRange(a);ca&&e&&(W=!0,la.clearSelection(),ia.setUnfilteredPosition(a.focusNode,
a.focusOffset),O.acceptPosition(ia)===g&&(2===na?X.expandToWordBoundaries(e.range):3<=na&&X.expandToParagraphBoundaries(e.range),b.setSelectedRange(e.range,e.hasForwardSelection),v.emit(ops.Document.signalCursorMoved,b)))}function s(a){var b=l(a),e=v.getCursor(d);if(ca=null!==b&&P.containsNode(v.getOdfCanvas().getElement(),b))W=!1,b=v.getRootElement(b)||v.getRootNode(),O=v.createRootFilter(b),na=0===a.button?a.detail:0,e&&a.shiftKey?S.getSelection().collapse(e.getAnchorNode(),0):(a=S.getSelection(),
b=e.getSelectedRange(),a.extend?e.hasForwardSelection()?(a.collapse(b.startContainer,b.startOffset),a.extend(b.endContainer,b.endOffset)):(a.collapse(b.endContainer,b.endOffset),a.extend(b.startContainer,b.startOffset)):(a.removeAllRanges(),a.addRange(b.cloneRange()))),1<na&&t()}function x(a){var b=v.getRootElement(a),e=v.createRootFilter(b),b=v.createStepIterator(a,0,[e,v.getPositionFilter()],b);b.setPosition(a,a.childNodes.length);return b.roundToNextStep()?{container:b.container(),offset:b.offset()}:
null}function w(a){var b;b=(b=S.getSelection())?{anchorNode:b.anchorNode,anchorOffset:b.anchorOffset,focusNode:b.focusNode,focusOffset:b.focusOffset}:null;var e=S.getSelection().isCollapsed,c,d;b.anchorNode||b.focusNode||!(c=n(a.clientX,a.clientY))||(b.anchorNode=c.container,b.anchorOffset=c.offset,b.focusNode=b.anchorNode,b.focusOffset=b.anchorOffset);if(F.isImage(b.focusNode)&&0===b.focusOffset&&F.isCharacterFrame(b.focusNode.parentNode)){if(d=b.focusNode.parentNode,c=d.getBoundingClientRect(),
a.clientX>c.left&&(c=x(d)))b.focusNode=c.container,b.focusOffset=c.offset,e&&(b.anchorNode=b.focusNode,b.anchorOffset=b.focusOffset)}else F.isImage(b.focusNode.firstChild)&&1===b.focusOffset&&F.isCharacterFrame(b.focusNode)&&(c=x(b.focusNode))&&(b.anchorNode=b.focusNode=c.container,b.anchorOffset=b.focusOffset=c.offset);b.anchorNode&&b.focusNode&&(b=X.selectionToRange(b),X.selectRange(b.range,b.hasForwardSelection,0===a.button?a.detail:0));L.focus()}function C(a){var b;if(b=n(a.clientX,a.clientY))a=
b.container,b=b.offset,a={anchorNode:a,anchorOffset:b,focusNode:a,focusOffset:b},a=X.selectionToRange(a),X.selectRange(a.range,a.hasForwardSelection,2),L.focus()}function G(a){var e=l(a),c,d,f;ja.processRequests();ca&&(F.isImage(e)&&F.isCharacterFrame(e.parentNode)&&S.getSelection().isCollapsed?(X.selectImage(e.parentNode),L.focus()):la.isSelectorElement(e)?L.focus():W?(e=b.getSelectedRange(),d=e.collapsed,F.isImage(e.endContainer)&&0===e.endOffset&&F.isCharacterFrame(e.endContainer.parentNode)&&
(f=e.endContainer.parentNode,f=x(f))&&(e.setEnd(f.container,f.offset),d&&e.collapse(!1)),X.selectRange(e,b.hasForwardSelection(),0===a.button?a.detail:0),L.focus()):ua?w(a):(c=P.cloneEvent(a),Y=runtime.setTimeout(function(){w(c)},0)),na=0,W=ca=!1)}function B(a){var b=v.getCursor(d).getSelectedRange();b.collapsed||N.exportRangeToDataTransfer(a.dataTransfer,b)}function E(){ca&&L.focus();na=0;W=ca=!1}function J(a){G(a)}function I(a){var b=l(a),e=null;"annotationRemoveButton"===b.className?(runtime.assert(ea,
"Remove buttons are displayed on annotations while annotation editing is disabled in the controller."),e=b.parentNode.getElementsByTagNameNS(odf.Namespaces.officens,"annotation").item(0),ga.removeAnnotation(e),L.focus()):"webodf-draggable"!==b.getAttribute("class")&&G(a)}function U(a){(a=a.data)&&(-1===a.indexOf("\n")?ha.insertText(a):pa.paste(a))}function Q(a){return function(){a();return!0}}function A(a){return function(b){return v.getCursor(d).getSelectionType()===ops.OdtCursor.RangeSelection?
a(b):!0}}function Z(a){L.unsubscribe("keydown",D.handleEvent);L.unsubscribe("keypress",V.handleEvent);L.unsubscribe("keyup",aa.handleEvent);L.unsubscribe("copy",f);L.unsubscribe("mousedown",s);L.unsubscribe("mousemove",ja.trigger);L.unsubscribe("mouseup",I);L.unsubscribe("contextmenu",J);L.unsubscribe("dragstart",B);L.unsubscribe("dragend",E);L.unsubscribe("click",oa.handleClick);L.unsubscribe("longpress",C);L.unsubscribe("drag",u);L.unsubscribe("dragstop",z);v.unsubscribe(ops.OdtDocument.signalOperationEnd,
fa.trigger);v.unsubscribe(ops.Document.signalCursorAdded,ka.registerCursor);v.unsubscribe(ops.Document.signalCursorRemoved,ka.removeCursor);v.unsubscribe(ops.OdtDocument.signalOperationEnd,e);a()}var S=runtime.getWindow(),v=k.getOdtDocument(),H=new gui.SessionConstraints,ba=new gui.SessionContext(k,d),P=core.DomUtils,F=odf.OdfUtils,N=new gui.MimeDataExporter,$=new gui.Clipboard(N),D=new gui.KeyboardHandler,V=new gui.KeyboardHandler,aa=new gui.KeyboardHandler,ca=!1,T=new odf.ObjectNameGenerator(v.getOdfCanvas().odfContainer(),
d),W=!1,O=null,Y,R=null,L=new gui.EventManager(v),ea=c.annotationsEnabled,ga=new gui.AnnotationController(k,H,d),da=new gui.DirectFormattingController(k,H,ba,d,T,c.directTextStylingEnabled,c.directParagraphStylingEnabled),ha=new gui.TextController(k,H,ba,d,da.createCursorStyleOp,da.createParagraphStyleOps),ma=new gui.ImageController(k,H,ba,d,T),la=new gui.ImageSelector(v.getOdfCanvas()),ia=v.createPositionIterator(v.getRootNode()),ja,fa,pa=new gui.PasteController(k,H,ba,d),ka=new gui.InputMethodEditor(d,
L),na=0,oa=new gui.HyperlinkClickHandler(v.getOdfCanvas().getElement,D,aa),qa=new gui.HyperlinkController(k,H,ba,d),va=new gui.BulletlistController(k,H,ba,d),X=new gui.SelectionController(k,d),ta=new gui.MetadataController(k,d),K=gui.KeyboardHandler.Modifier,M=gui.KeyboardHandler.KeyCode,ra=-1!==S.navigator.appVersion.toLowerCase().indexOf("mac"),ua=-1!==["iPad","iPod","iPhone"].indexOf(S.navigator.platform),sa;runtime.assert(null!==S,"Expected to be run in an environment which has a global window, like a browser.");
this.undo=m;this.redo=y;this.insertLocalCursor=function(){runtime.assert(void 0===k.getOdtDocument().getCursor(d),"Inserting local cursor a second time.");var a=new ops.OpAddCursor;a.init({memberid:d});k.enqueue([a]);L.focus()};this.removeLocalCursor=function(){runtime.assert(void 0!==k.getOdtDocument().getCursor(d),"Removing local cursor without inserting before.");var a=new ops.OpRemoveCursor;a.init({memberid:d});k.enqueue([a])};this.startEditing=function(){ka.subscribe(gui.InputMethodEditor.signalCompositionStart,
ha.removeCurrentSelection);ka.subscribe(gui.InputMethodEditor.signalCompositionEnd,U);L.subscribe("beforecut",q);L.subscribe("cut",p);L.subscribe("beforepaste",a);L.subscribe("paste",h);R&&R.initialize();L.setEditing(!0);oa.setModifier(ra?K.Meta:K.Ctrl);D.bind(M.Backspace,K.None,Q(ha.removeTextByBackspaceKey),!0);D.bind(M.Delete,K.None,ha.removeTextByDeleteKey);D.bind(M.Tab,K.None,A(function(){ha.insertText("\t");return!0}));ra?(D.bind(M.Clear,K.None,ha.removeCurrentSelection),D.bind(M.B,K.Meta,A(da.toggleBold)),
D.bind(M.I,K.Meta,A(da.toggleItalic)),D.bind(M.U,K.Meta,A(da.toggleUnderline)),D.bind(M.L,K.MetaShift,A(da.alignParagraphLeft)),D.bind(M.E,K.MetaShift,A(da.alignParagraphCenter)),D.bind(M.R,K.MetaShift,A(da.alignParagraphRight)),D.bind(M.J,K.MetaShift,A(da.alignParagraphJustified)),ea&&D.bind(M.C,K.MetaShift,ga.addAnnotation),D.bind(M.Z,K.Meta,m),D.bind(M.Z,K.MetaShift,y)):(D.bind(M.B,K.Ctrl,A(da.toggleBold)),D.bind(M.I,K.Ctrl,A(da.toggleItalic)),D.bind(M.U,K.Ctrl,A(da.toggleUnderline)),D.bind(M.L,
K.CtrlShift,A(da.alignParagraphLeft)),D.bind(M.E,K.CtrlShift,A(da.alignParagraphCenter)),D.bind(M.R,K.CtrlShift,A(da.alignParagraphRight)),D.bind(M.J,K.CtrlShift,A(da.alignParagraphJustified)),ea&&D.bind(M.C,K.CtrlAlt,ga.addAnnotation),D.bind(M.Z,K.Ctrl,m),D.bind(M.Z,K.CtrlShift,y));V.setDefault(A(function(a){var b;b=null===a.which||void 0===a.which?String.fromCharCode(a.keyCode):0!==a.which&&0!==a.charCode?String.fromCharCode(a.which):null;return!b||a.altKey||a.ctrlKey||a.metaKey?!1:(ha.insertText(b),
!0)}));V.bind(M.Enter,K.None,A(ha.enqueueParagraphSplittingOps))};this.endEditing=function(){ka.unsubscribe(gui.InputMethodEditor.signalCompositionStart,ha.removeCurrentSelection);ka.unsubscribe(gui.InputMethodEditor.signalCompositionEnd,U);L.unsubscribe("cut",p);L.unsubscribe("beforecut",q);L.unsubscribe("paste",h);L.unsubscribe("beforepaste",a);L.setEditing(!1);oa.setModifier(K.None);D.bind(M.Backspace,K.None,function(){return!0},!0);D.unbind(M.Delete,K.None);D.unbind(M.Tab,K.None);ra?(D.unbind(M.Clear,
K.None),D.unbind(M.B,K.Meta),D.unbind(M.I,K.Meta),D.unbind(M.U,K.Meta),D.unbind(M.L,K.MetaShift),D.unbind(M.E,K.MetaShift),D.unbind(M.R,K.MetaShift),D.unbind(M.J,K.MetaShift),ea&&D.unbind(M.C,K.MetaShift),D.unbind(M.Z,K.Meta),D.unbind(M.Z,K.MetaShift)):(D.unbind(M.B,K.Ctrl),D.unbind(M.I,K.Ctrl),D.unbind(M.U,K.Ctrl),D.unbind(M.L,K.CtrlShift),D.unbind(M.E,K.CtrlShift),D.unbind(M.R,K.CtrlShift),D.unbind(M.J,K.CtrlShift),ea&&D.unbind(M.C,K.CtrlAlt),D.unbind(M.Z,K.Ctrl),D.unbind(M.Z,K.CtrlShift));V.setDefault(null);
V.unbind(M.Enter,K.None)};this.getInputMemberId=function(){return d};this.getSession=function(){return k};this.getSessionConstraints=function(){return H};this.setUndoManager=function(a){R&&R.unsubscribe(gui.UndoManager.signalUndoStackChanged,r);if(R=a)R.setDocument(v),R.setPlaybackFunction(k.enqueue),R.subscribe(gui.UndoManager.signalUndoStackChanged,r)};this.getUndoManager=function(){return R};this.getMetadataController=function(){return ta};this.getAnnotationController=function(){return ga};this.getDirectFormattingController=
function(){return da};this.getHyperlinkClickHandler=function(){return oa};this.getHyperlinkController=function(){return qa};this.getBulletlistController=function(){return va};this.getImageController=function(){return ma};this.getSelectionController=function(){return X};this.getTextController=function(){return ha};this.getEventManager=function(){return L};this.getKeyboardHandlers=function(){return{keydown:D,keypress:V}};this.destroy=function(a){var b=[ja.destroy,fa.destroy,da.destroy,ka.destroy,L.destroy,
oa.destroy,qa.destroy,ta.destroy,X.destroy,ha.destroy,Z];sa&&b.unshift(sa.destroy);runtime.clearTimeout(Y);core.Async.destroyAll(b,a)};ja=core.Task.createRedrawTask(t);fa=core.Task.createRedrawTask(function(){var a=v.getCursor(d);if(a&&a.getSelectionType()===ops.OdtCursor.RegionSelection&&(a=F.getImageElements(a.getSelectedRange())[0])){la.select(a.parentNode);return}la.clearSelection()});D.bind(M.Left,K.None,A(X.moveCursorToLeft));D.bind(M.Right,K.None,A(X.moveCursorToRight));D.bind(M.Up,K.None,
A(X.moveCursorUp));D.bind(M.Down,K.None,A(X.moveCursorDown));D.bind(M.Left,K.Shift,A(X.extendSelectionToLeft));D.bind(M.Right,K.Shift,A(X.extendSelectionToRight));D.bind(M.Up,K.Shift,A(X.extendSelectionUp));D.bind(M.Down,K.Shift,A(X.extendSelectionDown));D.bind(M.Home,K.None,A(X.moveCursorToLineStart));D.bind(M.End,K.None,A(X.moveCursorToLineEnd));D.bind(M.Home,K.Ctrl,A(X.moveCursorToDocumentStart));D.bind(M.End,K.Ctrl,A(X.moveCursorToDocumentEnd));D.bind(M.Home,K.Shift,A(X.extendSelectionToLineStart));
D.bind(M.End,K.Shift,A(X.extendSelectionToLineEnd));D.bind(M.Up,K.CtrlShift,A(X.extendSelectionToParagraphStart));D.bind(M.Down,K.CtrlShift,A(X.extendSelectionToParagraphEnd));D.bind(M.Home,K.CtrlShift,A(X.extendSelectionToDocumentStart));D.bind(M.End,K.CtrlShift,A(X.extendSelectionToDocumentEnd));ra?(D.bind(M.Left,K.Alt,A(X.moveCursorBeforeWord)),D.bind(M.Right,K.Alt,A(X.moveCursorPastWord)),D.bind(M.Left,K.Meta,A(X.moveCursorToLineStart)),D.bind(M.Right,K.Meta,A(X.moveCursorToLineEnd)),D.bind(M.Home,
K.Meta,A(X.moveCursorToDocumentStart)),D.bind(M.End,K.Meta,A(X.moveCursorToDocumentEnd)),D.bind(M.Left,K.AltShift,A(X.extendSelectionBeforeWord)),D.bind(M.Right,K.AltShift,A(X.extendSelectionPastWord)),D.bind(M.Left,K.MetaShift,A(X.extendSelectionToLineStart)),D.bind(M.Right,K.MetaShift,A(X.extendSelectionToLineEnd)),D.bind(M.Up,K.AltShift,A(X.extendSelectionToParagraphStart)),D.bind(M.Down,K.AltShift,A(X.extendSelectionToParagraphEnd)),D.bind(M.Up,K.MetaShift,A(X.extendSelectionToDocumentStart)),
D.bind(M.Down,K.MetaShift,A(X.extendSelectionToDocumentEnd)),D.bind(M.A,K.Meta,A(X.extendSelectionToEntireDocument))):(D.bind(M.Left,K.Ctrl,A(X.moveCursorBeforeWord)),D.bind(M.Right,K.Ctrl,A(X.moveCursorPastWord)),D.bind(M.Left,K.CtrlShift,A(X.extendSelectionBeforeWord)),D.bind(M.Right,K.CtrlShift,A(X.extendSelectionPastWord)),D.bind(M.A,K.Ctrl,A(X.extendSelectionToEntireDocument)));ua&&(sa=new gui.IOSSafariSupport(L));L.subscribe("keydown",D.handleEvent);L.subscribe("keypress",V.handleEvent);L.subscribe("keyup",
aa.handleEvent);L.subscribe("copy",f);L.subscribe("mousedown",s);L.subscribe("mousemove",ja.trigger);L.subscribe("mouseup",I);L.subscribe("contextmenu",J);L.subscribe("dragstart",B);L.subscribe("dragend",E);L.subscribe("click",oa.handleClick);L.subscribe("longpress",C);L.subscribe("drag",u);L.subscribe("dragstop",z);v.subscribe(ops.OdtDocument.signalOperationEnd,fa.trigger);v.subscribe(ops.Document.signalCursorAdded,ka.registerCursor);v.subscribe(ops.Document.signalCursorRemoved,ka.removeCursor);
v.subscribe(ops.OdtDocument.signalOperationEnd,e)}})();gui.CaretManager=function(g,k){function d(b){return l.hasOwnProperty(b)?l[b]:null}function b(){return Object.keys(l).map(function(b){return l[b]})}function c(b){var c=l[b];c&&(delete l[b],b===g.getInputMemberId()?(p.unsubscribe(ops.OdtDocument.signalProcessingBatchEnd,c.ensureVisible),p.unsubscribe(ops.Document.signalCursorMoved,c.refreshCursorBlinking),q.unsubscribe("compositionupdate",c.handleUpdate),q.unsubscribe("compositionend",c.handleUpdate),q.unsubscribe("focus",c.setFocus),q.unsubscribe("blur",
c.removeFocus),n.removeEventListener("focus",c.show,!1),n.removeEventListener("blur",c.hide,!1)):p.unsubscribe(ops.OdtDocument.signalProcessingBatchEnd,c.handleUpdate),c.destroy(function(){}))}var l={},n=runtime.getWindow(),p=g.getSession().getOdtDocument(),q=g.getEventManager();this.registerCursor=function(b,c,a){var e=b.getMemberId();b=new gui.Caret(b,k,c,a);l[e]=b;e===g.getInputMemberId()?(runtime.log("Starting to track input on new cursor of "+e),p.subscribe(ops.OdtDocument.signalProcessingBatchEnd,
b.ensureVisible),p.subscribe(ops.Document.signalCursorMoved,b.refreshCursorBlinking),q.subscribe("compositionupdate",b.handleUpdate),q.subscribe("compositionend",b.handleUpdate),q.subscribe("focus",b.setFocus),q.subscribe("blur",b.removeFocus),n.addEventListener("focus",b.show,!1),n.addEventListener("blur",b.hide,!1),b.setOverlayElement(q.getEventTrap())):p.subscribe(ops.OdtDocument.signalProcessingBatchEnd,b.handleUpdate);return b};this.getCaret=d;this.getCarets=b;this.destroy=function(d){var h=
b().map(function(a){return a.destroy});g.getSelectionController().setCaretXPositionLocator(null);p.unsubscribe(ops.Document.signalCursorRemoved,c);l={};core.Async.destroyAll(h,d)};g.getSelectionController().setCaretXPositionLocator(function(){var b=d(g.getInputMemberId()),c;b&&(c=b.getBoundingClientRect());return c?c.right:void 0});p.subscribe(ops.Document.signalCursorRemoved,c)};gui.EditInfoHandle=function(g){var k=[],d,b=g.ownerDocument,c=b.documentElement.namespaceURI;this.setEdits=function(g){k=g;var n,p,q,f;core.DomUtils.removeAllChildNodes(d);for(g=0;g<k.length;g+=1)n=b.createElementNS(c,"div"),n.className="editInfo",p=b.createElementNS(c,"span"),p.className="editInfoColor",p.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",k[g].memberid),q=b.createElementNS(c,"span"),q.className="editInfoAuthor",q.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",
k[g].memberid),f=b.createElementNS(c,"span"),f.className="editInfoTime",f.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",k[g].memberid),f.appendChild(b.createTextNode(k[g].time.toString())),n.appendChild(p),n.appendChild(q),n.appendChild(f),d.appendChild(n)};this.show=function(){d.style.display="block"};this.hide=function(){d.style.display="none"};this.destroy=function(b){g.removeChild(d);b()};d=b.createElementNS(c,"div");d.setAttribute("class","editInfoHandle");d.style.display="none";
g.appendChild(d)};ops.EditInfo=function(g,k){function d(){var b=[],d;for(d in c)c.hasOwnProperty(d)&&b.push({memberid:d,time:c[d].time});b.sort(function(b,c){return b.time-c.time});return b}var b,c={};this.getNode=function(){return b};this.getOdtDocument=function(){return k};this.getEdits=function(){return c};this.getSortedEdits=function(){return d()};this.addEdit=function(b,d){c[b]={time:d}};this.clearEdits=function(){c={}};this.destroy=function(c){g.parentNode&&g.removeChild(b);c()};b=k.getDOMDocument().createElementNS("urn:webodf:names:editinfo",
"editinfo");g.insertBefore(b,g.firstChild)};gui.EditInfoMarker=function(g,k){function d(b,a){return runtime.setTimeout(function(){n.style.opacity=b},a)}var b=this,c,l,n,p,q,f;this.addEdit=function(b,a){var e=Date.now()-a;g.addEdit(b,a);l.setEdits(g.getSortedEdits());n.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",b);runtime.clearTimeout(q);runtime.clearTimeout(f);1E4>e?(p=d(1,0),q=d(0.5,1E4-e),f=d(0.2,2E4-e)):1E4<=e&&2E4>e?(p=d(0.5,0),f=d(0.2,2E4-e)):p=d(0.2,0)};this.getEdits=function(){return g.getEdits()};this.clearEdits=
function(){g.clearEdits();l.setEdits([]);n.hasAttributeNS("urn:webodf:names:editinfo","editinfo:memberid")&&n.removeAttributeNS("urn:webodf:names:editinfo","editinfo:memberid")};this.getEditInfo=function(){return g};this.show=function(){n.style.display="block"};this.hide=function(){b.hideHandle();n.style.display="none"};this.showHandle=function(){l.show()};this.hideHandle=function(){l.hide()};this.destroy=function(b){runtime.clearTimeout(p);runtime.clearTimeout(q);runtime.clearTimeout(f);c.removeChild(n);
l.destroy(function(a){a?b(a):g.destroy(b)})};(function(){var d=g.getOdtDocument().getDOMDocument();n=d.createElementNS(d.documentElement.namespaceURI,"div");n.setAttribute("class","editInfoMarker");n.onmouseover=function(){b.showHandle()};n.onmouseout=function(){b.hideHandle()};c=g.getNode();c.appendChild(n);l=new gui.EditInfoHandle(c);k||b.hide()})()};gui.HyperlinkTooltipView=function(g,k){var d=core.DomUtils,b=odf.OdfUtils,c=runtime.getWindow(),l,n,p;runtime.assert(null!==c,"Expected to be run in an environment which has a global window, like a browser.");this.showTooltip=function(q){var f=q.target||q.srcElement,h=g.getSizer(),a=g.getZoomLevel(),e;a:{for(;f;){if(b.isHyperlink(f))break a;if(b.isParagraph(f)||b.isInlineRoot(f))break;f=f.parentNode}f=null}if(f){d.containsNode(h,p)||h.appendChild(p);e=n;var r;switch(k()){case gui.KeyboardHandler.Modifier.Ctrl:r=
runtime.tr("Ctrl-click to follow link");break;case gui.KeyboardHandler.Modifier.Meta:r=runtime.tr("\u2318-click to follow link");break;default:r=""}e.textContent=r;l.textContent=b.getHyperlinkTarget(f);p.style.display="block";e=c.innerWidth-p.offsetWidth-15;f=q.clientX>e?e:q.clientX+15;e=c.innerHeight-p.offsetHeight-10;q=q.clientY>e?e:q.clientY+10;h=h.getBoundingClientRect();f=(f-h.left)/a;q=(q-h.top)/a;p.style.left=f+"px";p.style.top=q+"px"}};this.hideTooltip=function(){p.style.display="none"};this.destroy=
function(b){p.parentNode&&p.parentNode.removeChild(p);b()};(function(){var b=g.getElement().ownerDocument;l=b.createElement("span");n=b.createElement("span");l.className="webodf-hyperlinkTooltipLink";n.className="webodf-hyperlinkTooltipText";p=b.createElement("div");p.className="webodf-hyperlinkTooltip";p.appendChild(l);p.appendChild(n);g.getElement().appendChild(p)})()};gui.OdfFieldView=function(g){function k(){var b=odf.OdfSchema.getFields().map(function(b){return b.replace(":","|")}),d=b.join(",\n")+"\n{ background-color: #D0D0D0; }\n",b=b.map(function(b){return b+":empty::after"}).join(",\n")+"\n{ content:' '; white-space: pre; }\n";return d+"\n"+b}var d,b=g.getElement().ownerDocument;this.showFieldHighlight=function(){d.appendChild(b.createTextNode(k()))};this.hideFieldHighlight=function(){for(var b=d.sheet,g=b.cssRules;g.length;)b.deleteRule(g.length-1)};this.destroy=
function(b){d.parentNode&&d.parentNode.removeChild(d);b()};d=function(){var c=b.getElementsByTagName("head").item(0),d=b.createElement("style"),g="";d.type="text/css";d.media="screen, print, handheld, projection";odf.Namespaces.forEachPrefix(function(b,c){g+="@namespace "+b+" url("+c+");\n"});d.appendChild(b.createTextNode(g));c.appendChild(d);return d}()};gui.ShadowCursor=function(g){var k=g.getDOMDocument().createRange(),d=!0;this.removeFromDocument=function(){};this.getMemberId=function(){return gui.ShadowCursor.ShadowCursorMemberId};this.getSelectedRange=function(){return k};this.setSelectedRange=function(b,c){k=b;d=!1!==c};this.hasForwardSelection=function(){return d};this.getDocument=function(){return g};this.getSelectionType=function(){return ops.OdtCursor.RangeSelection};k.setStart(g.getRootNode(),0)};gui.ShadowCursor.ShadowCursorMemberId="";gui.SelectionView=function(g){};gui.SelectionView.prototype.rerender=function(){};gui.SelectionView.prototype.show=function(){};gui.SelectionView.prototype.hide=function(){};gui.SelectionView.prototype.destroy=function(g){};gui.SelectionViewManager=function(g){function k(){return Object.keys(d).map(function(b){return d[b]})}var d={};this.getSelectionView=function(b){return d.hasOwnProperty(b)?d[b]:null};this.getSelectionViews=k;this.removeSelectionView=function(b){d.hasOwnProperty(b)&&(d[b].destroy(function(){}),delete d[b])};this.hideSelectionView=function(b){d.hasOwnProperty(b)&&d[b].hide()};this.showSelectionView=function(b){d.hasOwnProperty(b)&&d[b].show()};this.rerenderSelectionViews=function(){Object.keys(d).forEach(function(b){d[b].rerender()})};
this.registerCursor=function(b,c){var l=b.getMemberId(),k=new g(b);c?k.show():k.hide();return d[l]=k};this.destroy=function(b){function c(g,k){k?b(k):g<d.length?d[g].destroy(function(b){c(g+1,b)}):b()}var d=k();c(0,void 0)}};gui.SessionViewOptions=function(){this.caretBlinksOnRangeSelect=this.caretAvatarsInitiallyVisible=this.editInfoMarkersInitiallyVisible=!0};
(function(){gui.SessionView=function(g,k,d,b,c,l){function n(a){a.memberId===k&&G.getViewport().scrollIntoView(a.annotation.getBoundingClientRect())}function p(){var a=document.getElementsByTagName("head").item(0),b=document.createElement("style");b.type="text/css";b.media="screen, print, handheld, projection";a.appendChild(b);return b}function q(a,b,e){function c(b,e,d){e=b+'[editinfo|memberid="'+a+'"]'+d+e;a:{var g=t.firstChild;for(b=b+'[editinfo|memberid="'+a+'"]'+d+"{";g;){if(g.nodeType===Node.TEXT_NODE&&
0===g.data.indexOf(b)){b=g;break a}g=g.nextSibling}b=null}b?b.data=e:t.appendChild(document.createTextNode(e))}c("div.editInfoMarker","{ background-color: "+e+"; }","");c("span.editInfoColor","{ background-color: "+e+"; }","");c("span.editInfoAuthor",'{ content: "'+b+'"; }',":before");c("dc|creator","{ background-color: "+e+"; }","");c(".webodf-selectionOverlay","{ fill: "+e+"; stroke: "+e+";}","");a===k&&(c(".webodf-touchEnabled .webodf-selectionOverlay","{ display: block; }"," > .webodf-draggable"),
a=gui.ShadowCursor.ShadowCursorMemberId,c(".webodf-selectionOverlay","{ fill: "+e+"; stroke: "+e+";}",""),c(".webodf-touchEnabled .webodf-selectionOverlay","{ display: block; }"," > .webodf-draggable"))}function f(a){var b,e;for(e in w)w.hasOwnProperty(e)&&(b=w[e],a?b.show():b.hide())}function h(a){c.getCarets().forEach(function(b){a?b.showHandle():b.hideHandle()})}function a(a){var b=a.getMemberId();a=a.getProperties();q(b,a.fullName,a.color)}function e(a){var b=a.getMemberId(),e=d.getOdtDocument().getMember(b).getProperties();
c.registerCursor(a,J,I);l.registerCursor(a,!0);if(a=c.getCaret(b))a.setAvatarImageUrl(e.imageUrl),a.setColor(e.color);runtime.log("+++ View here +++ eagerly created an Caret for '"+b+"'! +++")}function r(a){a=a.getMemberId();var b=l.getSelectionView(k),e=l.getSelectionView(gui.ShadowCursor.ShadowCursorMemberId),d=c.getCaret(k);a===k?(e.hide(),b&&b.show(),d&&d.show()):a===gui.ShadowCursor.ShadowCursorMemberId&&(e.show(),b&&b.hide(),d&&d.hide())}function m(a){l.removeSelectionView(a)}function y(a){var b=
a.paragraphElement,e=a.memberId;a=a.timeStamp;var c,g="",f=b.getElementsByTagNameNS(x,"editinfo").item(0);f?(g=f.getAttributeNS(x,"id"),c=w[g]):(g=Math.random().toString(),c=new ops.EditInfo(b,d.getOdtDocument()),c=new gui.EditInfoMarker(c,E),f=b.getElementsByTagNameNS(x,"editinfo").item(0),f.setAttributeNS(x,"id",g),w[g]=c);c.addEdit(e,new Date(a));B.trigger()}function u(){var a;s.hasChildNodes()&&core.DomUtils.removeAllChildNodes(s);!0===b.getState(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN)&&
(a=d.getOdtDocument().getMember(k))&&(a=a.getProperties().fullName,s.appendChild(document.createTextNode(".annotationWrapper:not([creator = '"+a+"']) .annotationRemoveButton { display: none; }")))}function z(c){var d=Object.keys(w).map(function(a){return w[a]});C.unsubscribe(ops.Document.signalMemberAdded,a);C.unsubscribe(ops.Document.signalMemberUpdated,a);C.unsubscribe(ops.Document.signalCursorAdded,e);C.unsubscribe(ops.Document.signalCursorRemoved,m);C.unsubscribe(ops.OdtDocument.signalParagraphChanged,
y);C.unsubscribe(ops.Document.signalCursorMoved,r);C.unsubscribe(ops.OdtDocument.signalParagraphChanged,l.rerenderSelectionViews);C.unsubscribe(ops.OdtDocument.signalTableAdded,l.rerenderSelectionViews);C.unsubscribe(ops.OdtDocument.signalParagraphStyleModified,l.rerenderSelectionViews);b.unsubscribe(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN,u);C.unsubscribe(ops.Document.signalMemberAdded,u);C.unsubscribe(ops.Document.signalMemberUpdated,u);t.parentNode.removeChild(t);s.parentNode.removeChild(s);
(function Z(a,b){b?c(b):a<d.length?d[a].destroy(function(b){Z(a+1,b)}):c()})(0,void 0)}var t,s,x="urn:webodf:names:editinfo",w={},C,G,B,E=void 0!==g.editInfoMarkersInitiallyVisible?Boolean(g.editInfoMarkersInitiallyVisible):!0,J=void 0!==g.caretAvatarsInitiallyVisible?Boolean(g.caretAvatarsInitiallyVisible):!0,I=void 0!==g.caretBlinksOnRangeSelect?Boolean(g.caretBlinksOnRangeSelect):!0;this.showEditInfoMarkers=function(){E||(E=!0,f(E))};this.hideEditInfoMarkers=function(){E&&(E=!1,f(E))};this.showCaretAvatars=
function(){J||(J=!0,h(J))};this.hideCaretAvatars=function(){J&&(J=!1,h(J))};this.getSession=function(){return d};this.getCaret=function(a){return c.getCaret(a)};this.destroy=function(a){var b=[B.destroy,z];C.unsubscribe(ops.OdtDocument.signalAnnotationAdded,n);core.Async.destroyAll(b,a)};C=d.getOdtDocument();G=C.getOdfCanvas();C.subscribe(ops.OdtDocument.signalAnnotationAdded,n);C.subscribe(ops.Document.signalMemberAdded,a);C.subscribe(ops.Document.signalMemberUpdated,a);C.subscribe(ops.Document.signalCursorAdded,
e);C.subscribe(ops.Document.signalCursorRemoved,m);C.subscribe(ops.OdtDocument.signalParagraphChanged,y);C.subscribe(ops.Document.signalCursorMoved,r);C.subscribe(ops.OdtDocument.signalParagraphChanged,l.rerenderSelectionViews);C.subscribe(ops.OdtDocument.signalTableAdded,l.rerenderSelectionViews);C.subscribe(ops.OdtDocument.signalParagraphStyleModified,l.rerenderSelectionViews);b.subscribe(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN,u);C.subscribe(ops.Document.signalMemberAdded,u);C.subscribe(ops.Document.signalMemberUpdated,
u);t=p();t.appendChild(document.createTextNode("@namespace editinfo url(urn:webodf:names:editinfo);"));t.appendChild(document.createTextNode("@namespace dc url(http://purl.org/dc/elements/1.1/);"));s=p();u();B=core.Task.createRedrawTask(function(){var a=G.getAnnotationViewManager();a&&(a.rehighlightAnnotations(),C.fixCursorPositions())})}})();gui.SvgSelectionView=function(g){function k(){var a=e.getRootNode();r!==a&&(r=a,m=e.getCanvas().getSizer(),m.appendChild(u),u.setAttribute("class","webodf-selectionOverlay"),t.setAttribute("class","webodf-draggable"),s.setAttribute("class","webodf-draggable"),t.setAttribute("end","left"),s.setAttribute("end","right"),t.setAttribute("r",8),s.setAttribute("r",8),u.appendChild(z),u.appendChild(t),u.appendChild(s))}function d(a){a=a.getBoundingClientRect();return Boolean(a&&0!==a.height)}function b(a){var b=
x.getTextElements(a,!0,!1),e=a.cloneRange(),c=a.cloneRange();a=a.cloneRange();if(!b.length)return null;var g;a:{g=0;var f=b[g],h=e.startContainer===f?e.startOffset:0,m=h;e.setStart(f,h);for(e.setEnd(f,m);!d(e);){if(f.nodeType===Node.ELEMENT_NODE&&m<f.childNodes.length)m=f.childNodes.length;else if(f.nodeType===Node.TEXT_NODE&&m<f.length)m+=1;else if(b[g])f=b[g],g+=1,h=m=0;else{g=!1;break a}e.setStart(f,h);e.setEnd(f,m)}g=!0}if(!g)return null;a:{g=b.length-1;f=b[g];m=h=c.endContainer===f?c.endOffset:
f.nodeType===Node.TEXT_NODE?f.length:f.childNodes.length;c.setStart(f,h);for(c.setEnd(f,m);!d(c);){if(f.nodeType===Node.ELEMENT_NODE&&0<h)h=0;else if(f.nodeType===Node.TEXT_NODE&&0<h)h-=1;else if(b[g])f=b[g],g-=1,h=m=f.length||f.childNodes.length;else{b=!1;break a}c.setStart(f,h);c.setEnd(f,m)}b=!0}if(!b)return null;a.setStart(e.startContainer,e.startOffset);a.setEnd(c.endContainer,c.endOffset);return{firstRange:e,lastRange:c,fillerRange:a}}function c(a,b){var e={};e.top=Math.min(a.top,b.top);e.left=
Math.min(a.left,b.left);e.right=Math.max(a.right,b.right);e.bottom=Math.max(a.bottom,b.bottom);e.width=e.right-e.left;e.height=e.bottom-e.top;return e}function l(a,b){b&&0<b.width&&0<b.height&&(a=a?c(a,b):b);return a}function n(a){function b(a){B.setUnfilteredPosition(a,0);return u.acceptNode(a)===E&&s.acceptPosition(B)===E?E:J}function c(a){var e=null;b(a)===E&&(e=w.getBoundingClientRect(a));return e}var d=a.commonAncestorContainer,g=a.startContainer,f=a.endContainer,h=a.startOffset,m=a.endOffset,
k,n,r=null,p,q=y.createRange(),s,u=new odf.OdfNodeFilter,t;if(g===d||f===d)return q=a.cloneRange(),r=q.getBoundingClientRect(),q.detach(),r;for(a=g;a.parentNode!==d;)a=a.parentNode;for(n=f;n.parentNode!==d;)n=n.parentNode;s=e.createRootFilter(g);for(d=a.nextSibling;d&&d!==n;)p=c(d),r=l(r,p),d=d.nextSibling;if(x.isParagraph(a))r=l(r,w.getBoundingClientRect(a));else if(a.nodeType===Node.TEXT_NODE)d=a,q.setStart(d,h),q.setEnd(d,d===n?m:d.length),p=q.getBoundingClientRect(),r=l(r,p);else for(t=y.createTreeWalker(a,
NodeFilter.SHOW_TEXT,b,!1),d=t.currentNode=g;d&&d!==f;)q.setStart(d,h),q.setEnd(d,d.length),p=q.getBoundingClientRect(),r=l(r,p),k=d,h=0,d=t.nextNode();k||(k=g);if(x.isParagraph(n))r=l(r,w.getBoundingClientRect(n));else if(n.nodeType===Node.TEXT_NODE)d=n,q.setStart(d,d===a?h:0),q.setEnd(d,m),p=q.getBoundingClientRect(),r=l(r,p);else for(t=y.createTreeWalker(n,NodeFilter.SHOW_TEXT,b,!1),d=t.currentNode=f;d&&d!==k;)if(q.setStart(d,0),q.setEnd(d,m),p=q.getBoundingClientRect(),r=l(r,p),d=t.previousNode())m=
d.length;return r}function p(a,b){var e=a.getBoundingClientRect(),c={width:0};c.top=e.top;c.bottom=e.bottom;c.height=e.height;c.left=c.right=b?e.right:e.left;return c}function q(){var a=g.getSelectedRange(),e;if(e=G&&g.getSelectionType()===ops.OdtCursor.RangeSelection&&!a.collapsed){k();var d=w.getBoundingClientRect(m),f=C.getZoomLevel(),a=b(a),h,l,r,q,y,B;if(a){e=a.firstRange;h=a.lastRange;l=a.fillerRange;r=w.translateRect(p(e,!1),d,f);y=w.translateRect(p(h,!0),d,f);q=(q=n(l))?w.translateRect(q,
d,f):c(r,y);B=q.left;q=r.left+Math.max(0,q.width-(r.left-q.left));d=Math.min(r.top,y.top);f=y.top+y.height;B=[{x:r.left,y:d+r.height},{x:r.left,y:d},{x:q,y:d},{x:q,y:f-y.height},{x:y.right,y:f-y.height},{x:y.right,y:f},{x:B,y:f},{x:B,y:d+r.height},{x:r.left,y:d+r.height}];q="";var x;for(x=0;x<B.length;x+=1)q+=B[x].x+","+B[x].y+" ";z.setAttribute("points",q);t.setAttribute("cx",r.left);t.setAttribute("cy",d+r.height/2);s.setAttribute("cx",y.right);s.setAttribute("cy",f-y.height/2);e.detach();h.detach();
l.detach()}e=Boolean(a)}u.style.display=e?"block":"none"}function f(a){G&&a===g&&I.trigger()}function h(a){a=8/a;t.setAttribute("r",a);s.setAttribute("r",a)}function a(a){m.removeChild(u);m.classList.remove("webodf-virtualSelections");g.getDocument().unsubscribe(ops.Document.signalCursorMoved,f);C.unsubscribe(gui.ZoomHelper.signalZoomChanged,h);a()}var e=g.getDocument(),r,m,y=e.getDOMDocument(),u=y.createElementNS("http://www.w3.org/2000/svg","svg"),z=y.createElementNS("http://www.w3.org/2000/svg",
"polygon"),t=y.createElementNS("http://www.w3.org/2000/svg","circle"),s=y.createElementNS("http://www.w3.org/2000/svg","circle"),x=odf.OdfUtils,w=core.DomUtils,C=e.getCanvas().getZoomHelper(),G=!0,B=g.getDocument().createPositionIterator(e.getRootNode()),E=NodeFilter.FILTER_ACCEPT,J=NodeFilter.FILTER_REJECT,I;this.rerender=function(){G&&I.trigger()};this.show=function(){G=!0;I.trigger()};this.hide=function(){G=!1;I.trigger()};this.destroy=function(b){core.Async.destroyAll([I.destroy,a],b)};(function(){var a=
g.getMemberId();I=core.Task.createRedrawTask(q);k();u.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",a);m.classList.add("webodf-virtualSelections");g.getDocument().subscribe(ops.Document.signalCursorMoved,f);C.subscribe(gui.ZoomHelper.signalZoomChanged,h);h(C.getZoomLevel())})()};gui.UndoStateRules=function(){function g(b,d){var g=b.length;this.previous=function(){for(g-=1;0<=g;g-=1)if(d(b[g]))return b[g];return null}}function k(b){b=b.spec();var d;b.hasOwnProperty("position")&&(d=b.position);return d}function d(b){return b.isEdit}function b(b,d,g){if(!g)return g=k(b)-k(d),0===g||1===Math.abs(g);b=k(b);d=k(d);g=k(g);return b-d===d-g}this.isEditOperation=d;this.isPartOfOperationSet=function(c,k){var n=void 0!==c.group,p;if(!c.isEdit||0===k.length)return!0;p=k[k.length-1];if(n&&
c.group===p.group)return!0;a:switch(c.spec().optype){case "RemoveText":case "InsertText":p=!0;break a;default:p=!1}if(p&&k.some(d)){if(n){var q;n=c.spec().optype;p=new g(k,d);var f=p.previous(),h=null,a,e;runtime.assert(Boolean(f),"No edit operations found in state");e=f.group;runtime.assert(void 0!==e,"Operation has no group");for(a=1;f&&f.group===e;){if(n===f.spec().optype){q=f;break}f=p.previous()}if(q){for(f=p.previous();f;){if(f.group!==e){if(2===a)break;e=f.group;a+=1}if(n===f.spec().optype){h=
f;break}f=p.previous()}q=b(c,q,h)}else q=!1;return q}q=c.spec().optype;n=new g(k,d);p=n.previous();runtime.assert(Boolean(p),"No edit operations found in state");q=q===p.spec().optype?b(c,p,n.previous()):!1;return q}return!1}};(function(){function g(b,c){this.mainId=void 0!==b?b:-1;this.subId=void 0!==c?c:-1}function k(b,c,k){function n(c,a){return c+(b.isEditOperation(a)?1:0)}var p,q,f;this.addOperation=function(c){b.isEditOperation(c)&&(f+=1);q.push(c)};this.isNextStateId=function(b){return b.mainId===p&&b.subId===f};this.getNextStateId=function(){return new g(p,f)};this.getOperations=function(){return q};p=d+=1;q=c||[];f=c&&k?c.reduce(n,0):0}var d=0;gui.TrivialUndoManager=function(b){function c(){return!0!==w.isNextStateId(x)}
function d(a){a=a.getOperations();0<a.length&&(J=!0,t(a),J=!1)}function n(){B.emit(gui.UndoManager.signalUndoStackChanged,{undoAvailable:r.hasUndoStates(),redoAvailable:r.hasRedoStates()})}function p(a){var b=c();a!==b&&B.emit(gui.UndoManager.signalDocumentModifiedChanged,b)}function q(){w!==z&&w!==C[C.length-1]&&C.push(w)}function f(a){var b=a.previousSibling||a.nextSibling;a.parentNode.removeChild(a);y.normalizeTextNodes(b)}function h(a){return Object.keys(a).map(function(b){return a[b]})}function a(a){function b(a){var f=
a.spec();if(d[f.memberid])switch(f.optype){case "AddCursor":e[f.memberid]||(e[f.memberid]=a,delete d[f.memberid],g-=1);break;case "MoveCursor":c[f.memberid]||(c[f.memberid]=a)}}var e={},c={},d={},g,f;f=a.pop();s.getMemberIds().forEach(function(a){d[a]=!0});for(g=Object.keys(d).length;f&&0<g;)f=f.getOperations(),f.reverse(),f.forEach(b),f=a.pop();return new k(E,h(e).concat(h(c)))}function e(){var b=c(),e=u=s.cloneDocumentElement();y.getElementsByTagNameNS(e,m,"cursor").forEach(f);y.getElementsByTagNameNS(e,
m,"anchor").forEach(f);q();w=z=a([z].concat(C));C.length=0;G.length=0;b||(x=w.getNextStateId());n();p(b)}var r=this,m="urn:webodf:names:cursor",y=core.DomUtils,u,z,t,s,x,w,C=[],G=[],B=new core.EventNotifier([gui.UndoManager.signalUndoStackChanged,gui.UndoManager.signalUndoStateCreated,gui.UndoManager.signalUndoStateModified,gui.UndoManager.signalDocumentModifiedChanged,gui.TrivialUndoManager.signalDocumentRootReplaced]),E=b||new gui.UndoStateRules,J=!1;this.subscribe=function(a,b){B.subscribe(a,b)};
this.unsubscribe=function(a,b){B.unsubscribe(a,b)};this.isDocumentModified=c;this.setDocumentModified=function(a){c()!==a&&(x=a?new g:w.getNextStateId(),B.emit(gui.UndoManager.signalDocumentModifiedChanged,a))};this.hasUndoStates=function(){return 0<C.length};this.hasRedoStates=function(){return 0<G.length};this.setDocument=function(a){s=a};this.purgeInitialState=function(){var a=c();C.length=0;G.length=0;w=z=new k(E);x=w.getNextStateId();u=null;n();p(a)};this.setInitialState=e;this.initialize=function(){u||
e()};this.setPlaybackFunction=function(a){t=a};this.onOperationExecuted=function(a){if(!J){var b=c();E.isEditOperation(a)&&(w===z||0<G.length)||!E.isPartOfOperationSet(a,w.getOperations())?(G.length=0,q(),w=new k(E,[a],!0),C.push(w),B.emit(gui.UndoManager.signalUndoStateCreated,{operations:w.getOperations()}),n()):(w.addOperation(a),B.emit(gui.UndoManager.signalUndoStateModified,{operations:w.getOperations()}));p(b)}};this.moveForward=function(a){for(var b=0,e=c(),f;a&&G.length;)f=G.pop(),C.push(f),
d(f),a-=1,b+=1;b&&(w=C[C.length-1],n(),p(e));return b};this.moveBackward=function(a){for(var b=0,e=c();a&&C.length;)G.push(C.pop()),a-=1,b+=1;b&&(s.getMemberIds().forEach(function(a){s.removeCursor(a)}),s.setDocumentElement(u.cloneNode(!0)),B.emit(gui.TrivialUndoManager.signalDocumentRootReplaced,{}),d(z),C.forEach(d),w=C[C.length-1]||z,n(),p(e));return b};w=z=new k(E);x=w.getNextStateId()};gui.TrivialUndoManager.signalDocumentRootReplaced="documentRootReplaced"})();odf.GraphicProperties=function(g,k,d){var b=this,c=odf.Namespaces.stylens,l=odf.Namespaces.svgns;this.verticalPos=function(){return b.data.value("verticalPos")};this.verticalRel=function(){return b.data.value("verticalRel")};this.horizontalPos=function(){return b.data.value("horizontalPos")};this.horizontalRel=function(){return b.data.value("horizontalRel")};this.strokeWidth=function(){return b.data.value("strokeWidth")};b.data=new odf.LazyStyleProperties(void 0===d?void 0:d.data,{verticalPos:function(){var b=
g.getAttributeNS(c,"vertical-pos");return""===b?void 0:b},verticalRel:function(){var b=g.getAttributeNS(c,"vertical-rel");return""===b?void 0:b},horizontalPos:function(){var b=g.getAttributeNS(c,"horizontal-pos");return""===b?void 0:b},horizontalRel:function(){var b=g.getAttributeNS(c,"horizontal-rel");return""===b?void 0:b},strokeWidth:function(){var b=g.getAttributeNS(l,"stroke-width");return k.parseLength(b)}})};
odf.ComputedGraphicProperties=function(){var g;this.setGraphicProperties=function(k){g=k};this.verticalPos=function(){return g&&g.verticalPos()||"from-top"};this.verticalRel=function(){return g&&g.verticalRel()||"page"};this.horizontalPos=function(){return g&&g.horizontalPos()||"from-left"};this.horizontalRel=function(){return g&&g.horizontalRel()||"page"}};odf.PageLayoutProperties=function(g,k,d){var b=this,c=odf.Namespaces.fons;this.pageHeight=function(){return b.data.value("pageHeight")||1123};this.pageWidth=function(){return b.data.value("pageWidth")||794};b.data=new odf.LazyStyleProperties(void 0===d?void 0:d.data,{pageHeight:function(){var b;g&&(b=g.getAttributeNS(c,"page-height"),b=k.parseLength(b));return b},pageWidth:function(){var b;g&&(b=g.getAttributeNS(c,"page-width"),b=k.parseLength(b));return b}})};
odf.PageLayout=function(g,k,d){var b=null;g&&(b=k.getPropertiesElement("page-layout-properties",g));this.pageLayout=new odf.PageLayoutProperties(b,k,d&&d.pageLayout)};odf.PageLayoutCache=function(){};odf.PageLayoutCache.prototype.getPageLayout=function(g){};odf.PageLayoutCache.prototype.getDefaultPageLayout=function(){};odf.ParagraphProperties=function(g,k,d){var b=this,c=odf.Namespaces.fons;this.marginTop=function(){return b.data.value("marginTop")};b.data=new odf.LazyStyleProperties(void 0===d?void 0:d.data,{marginTop:function(){var b=g.getAttributeNS(c,"margin-top");return k.parsePositiveLengthOrPercent(b,"marginTop",d&&d.data)}})};
odf.ComputedParagraphProperties=function(){var g={},k=[];this.setStyleChain=function(d){k=d;g={}};this.marginTop=function(){var d,b;if(g.hasOwnProperty("marginTop"))d=g.marginTop;else{for(b=0;void 0===d&&b<k.length;b+=1)d=k[b].marginTop();g.marginTop=d}return d||0}};odf.TextProperties=function(g,k,d){var b=this,c=odf.Namespaces.fons;this.fontSize=function(){return b.data.value("fontSize")};b.data=new odf.LazyStyleProperties(void 0===d?void 0:d.data,{fontSize:function(){var b=g.getAttributeNS(c,"font-size");return k.parsePositiveLengthOrPercent(b,"fontSize",d&&d.data)}})};
odf.ComputedTextProperties=function(){var g={},k=[];this.setStyleChain=function(d){k=d;g={}};this.fontSize=function(){var d,b;if(g.hasOwnProperty("fontSize"))d=g.fontSize;else{for(b=0;void 0===d&&b<k.length;b+=1)d=k[b].fontSize();g.fontSize=d}return d||12}};odf.MasterPage=function(g,k){var d;g?(d=g.getAttributeNS(odf.Namespaces.stylens,"page-layout-name"),this.pageLayout=k.getPageLayout(d)):this.pageLayout=k.getDefaultPageLayout()};odf.MasterPageCache=function(){};odf.MasterPageCache.prototype.getMasterPage=function(g){};
odf.StylePileEntry=function(g,k,d,b){this.masterPage=function(){var b=g.getAttributeNS(odf.Namespaces.stylens,"master-page-name"),k=null;b&&(k=d.getMasterPage(b));return k};(function(c){var d=g.getAttributeNS(odf.Namespaces.stylens,"family"),n=null;if("graphic"===d||"chart"===d)c.graphic=void 0===b?void 0:b.graphic,n=k.getPropertiesElement("graphic-properties",g,n),null!==n&&(c.graphic=new odf.GraphicProperties(n,k,c.graphic));if("paragraph"===d||"table-cell"===d||"graphic"===d||"presentation"===
d||"chart"===d)c.paragraph=void 0===b?void 0:b.paragraph,n=k.getPropertiesElement("paragraph-properties",g,n),null!==n&&(c.paragraph=new odf.ParagraphProperties(n,k,c.paragraph));if("text"===d||"paragraph"===d||"table-cell"===d||"graphic"===d||"presentation"===d||"chart"===d)c.text=void 0===b?void 0:b.text,n=k.getPropertiesElement("text-properties",g,n),null!==n&&(c.text=new odf.TextProperties(n,k,c.text))})(this)};
odf.StylePile=function(g,k){function d(c,a){var e,d;c.hasAttributeNS(b,"parent-style-name")&&(d=c.getAttributeNS(b,"parent-style-name"),-1===a.indexOf(d)&&(e=f(d,a)));return new odf.StylePileEntry(c,g,k,e)}var b=odf.Namespaces.stylens,c={},l={},n,p={},q={},f;f=function(b,a){var e=p[b],f;!e&&(f=c[b])&&(a.push(b),e=d(f,a),p[b]=e);return e};this.getStyle=function(b){var a=q[b]||p[b],e,f=[];a||(e=l[b],e||(e=c[b])&&f.push(b),e&&(a=d(e,f)));return a};this.addCommonStyle=function(d){var a;d.hasAttributeNS(b,
"name")&&(a=d.getAttributeNS(b,"name"),c.hasOwnProperty(a)||(c[a]=d))};this.addAutomaticStyle=function(c){var a;c.hasAttributeNS(b,"name")&&(a=c.getAttributeNS(b,"name"),l.hasOwnProperty(a)||(l[a]=c))};this.setDefaultStyle=function(b){void 0===n&&(n=d(b,[]))};this.getDefaultStyle=function(){return n}};odf.ComputedGraphicStyle=function(){this.text=new odf.ComputedTextProperties;this.paragraph=new odf.ComputedParagraphProperties;this.graphic=new odf.ComputedGraphicProperties};
odf.ComputedParagraphStyle=function(){this.text=new odf.ComputedTextProperties;this.paragraph=new odf.ComputedParagraphProperties};odf.ComputedTextStyle=function(){this.text=new odf.ComputedTextProperties};
odf.StyleCache=function(g){function k(a,b,e,c){b=e.getAttributeNS(b,"class-names");var d;if(b)for(b=b.split(" "),d=0;d<b.length;d+=1)if(e=b[d])c.push(a),c.push(e)}function d(a,b){var e=u.getStyleName("paragraph",a);void 0!==e&&(b.push("paragraph"),b.push(e));a.namespaceURI!==m||"h"!==a.localName&&"p"!==a.localName||k("paragraph",m,a,b);return b}function b(a,b,e){var c=[],d,f,g,h;for(d=0;d<a.length;d+=2)g=a[d],h=a[d+1],g=p[g],h=g.getStyle(h),void 0!==h&&(h=h[b],void 0!==h&&h!==f&&(c.push(h),f=h));
g=p[e];if(h=g.getDefaultStyle())h=h[b],void 0!==h&&h!==f&&c.push(h);return c}function c(a,b){var e=u.getStyleName("text",a),f=a.parentNode;void 0!==e&&(b.push("text"),b.push(e));"span"===a.localName&&a.namespaceURI===m&&k("text",m,a,b);if(!f||f===g)return b;f.namespaceURI!==m||"p"!==f.localName&&"h"!==f.localName?c(f,b):d(f,b);return b}function l(a){a=a.getAttributeNS(y,"family");return p[a]}var n=this,p,q,f,h,a,e,r,m=odf.Namespaces.textns,y=odf.Namespaces.stylens,u=new odf.StyleInfo,z=new odf.StyleParseUtils,
t,s,x,w,C,G;this.getComputedGraphicStyle=function(a){var e=[];a=u.getStyleName("graphic",a);void 0!==a&&(e.push("graphic"),e.push(a));a=e.join("/");var c=h[a];runtime.assert(0===e.length%2,"Invalid style chain.");void 0===c&&(c=new odf.ComputedGraphicStyle,c.graphic.setGraphicProperties(b(e,"graphic","graphic")[0]),c.text.setStyleChain(b(e,"text","graphic")),c.paragraph.setStyleChain(b(e,"paragraph","graphic")),h[a]=c);return c};this.getComputedParagraphStyle=function(a){a=d(a,[]);var e=a.join("/"),
c=f[e];runtime.assert(0===a.length%2,"Invalid style chain.");void 0===c&&(c=new odf.ComputedParagraphStyle,c.text.setStyleChain(b(a,"text","paragraph")),c.paragraph.setStyleChain(b(a,"paragraph","paragraph")),f[e]=c);return c};this.getComputedTextStyle=function(a){a=c(a,[]);var e=a.join("/"),d=q[e];runtime.assert(0===a.length%2,"Invalid style chain.");void 0===d&&(d=new odf.ComputedTextStyle,d.text.setStyleChain(b(a,"text","text")),q[e]=d);return d};this.getPageLayout=function(a){var b=G[a];b||((b=
C[a])?(b=new odf.PageLayout(b,z,w),G[a]=b):b=w);return b};this.getDefaultPageLayout=function(){return w};this.getMasterPage=function(a){var b=s[a];void 0===b&&((b=t[a])?(b=new odf.MasterPage(b,n),s[a]=b):b=null);return b};this.getDefaultMasterPage=function(){return x};this.update=function(){var b,c,d=null,m=null;q={};f={};h={};t={};s={};G={};C={};a=new odf.StylePile(z,n);e=new odf.StylePile(z,n);r=new odf.StylePile(z,n);p={text:a,paragraph:e,graphic:r};for(b=g.styles.firstElementChild;b;)b.namespaceURI===
y&&((c=l(b))?"style"===b.localName?c.addCommonStyle(b):"default-style"===b.localName&&c.setDefaultStyle(b):"default-page-layout"===b.localName&&(d=b)),b=b.nextElementSibling;w=new odf.PageLayout(d,z);for(b=g.automaticStyles.firstElementChild;b;)b.namespaceURI===y&&((c=l(b))&&"style"===b.localName?c.addAutomaticStyle(b):"page-layout"===b.localName&&(C[b.getAttributeNS(y,"name")]=b)),b=b.nextElementSibling;for(b=g.masterStyles.firstElementChild;b;)b.namespaceURI===y&&"master-page"===b.localName&&(m=
m||b,c=b,d=c.getAttributeNS(y,"name"),0<d.length&&!t.hasOwnProperty(d)&&(t[d]=c)),b=b.nextElementSibling;x=new odf.MasterPage(m,n)}};ops.OperationTransformMatrix=function(){function g(a){a.position+=a.length;a.length*=-1}function k(a){var b=0>a.length;b&&g(a);return b}function d(a,b){function c(f){a[f]===b&&d.push(f)}var d=[];a&&["style:parent-style-name","style:next-style-name"].forEach(c);return d}function b(a,b){function c(d){a[d]===b&&delete a[d]}a&&["style:parent-style-name","style:next-style-name"].forEach(c)}function c(a){var b={};Object.keys(a).forEach(function(d){b[d]="object"===typeof a[d]?c(a[d]):a[d]});return b}function l(a,
b,c,d){var f,g=!1,h=!1,k,l=[];d&&d.attributes&&(l=d.attributes.split(","));a&&(c||0<l.length)&&Object.keys(a).forEach(function(b){var e=a[b],d;"object"!==typeof e&&(c&&(d=c[b]),void 0!==d?(delete a[b],h=!0,d===e&&(delete c[b],g=!0)):-1!==l.indexOf(b)&&(delete a[b],h=!0))});if(b&&b.attributes&&(c||0<l.length)){k=b.attributes.split(",");for(d=0;d<k.length;d+=1)if(f=k[d],c&&void 0!==c[f]||l&&-1!==l.indexOf(f))k.splice(d,1),d-=1,h=!0;0<k.length?b.attributes=k.join(","):delete b.attributes}return{majorChanged:g,
minorChanged:h}}function n(a){for(var b in a)if(a.hasOwnProperty(b))return!0;return!1}function p(a){for(var b in a)if(a.hasOwnProperty(b)&&("attributes"!==b||0<a.attributes.length))return!0;return!1}function q(a,b,c,d,f){var g=a?a[f]:null,h=b?b[f]:null,k=c?c[f]:null,q=d?d[f]:null,x;x=l(g,h,k,q);g&&!n(g)&&delete a[f];h&&!p(h)&&delete b[f];k&&!n(k)&&delete c[f];q&&!p(q)&&delete d[f];return x}function f(a,b){return{opSpecsA:[a],opSpecsB:[b]}}var h;h={AddAnnotation:{AddAnnotation:function(a,b,c){var d;
a.position<b.position?(d=a,c=b):b.position<a.position?(d=b,c=a):(d=c?a:b,c=c?b:a);c.position<d.position+d.length&&(d.length+=2);c.position+=2;return{opSpecsA:[a],opSpecsB:[b]}},AddCursor:f,AddMember:f,AddStyle:f,ApplyDirectStyling:function(a,b){a.position<=b.position?b.position+=2:a.position<=b.position+b.length&&(b.length+=2);return{opSpecsA:[a],opSpecsB:[b]}},InsertText:function(a,b){b.position<=a.position?a.position+=b.text.length:(void 0!==a.length&&b.position<=a.position+a.length&&(a.length+=
b.text.length),b.position+=2);return{opSpecsA:[a],opSpecsB:[b]}},MergeParagraph:function(a,b){b.sourceStartPosition<=a.position?a.position-=1:(void 0!==a.length&&b.sourceStartPosition<=a.position+a.length&&(a.length-=1),b.sourceStartPosition+=2,a.position<b.destinationStartPosition&&(b.destinationStartPosition+=2));return{opSpecsA:[a],opSpecsB:[b]}},MoveCursor:function(a,b){var c=k(b);a.position<b.position?b.position+=2:a.position<b.position+b.length&&(b.length+=2);c&&g(b);return{opSpecsA:[a],opSpecsB:[b]}},
RemoveAnnotation:function(a,b){a.position<b.position?(b.position<a.position+a.length&&(a.length-=b.length+2),b.position+=2):a.position-=b.length+2;return{opSpecsA:[a],opSpecsB:[b]}},RemoveCursor:f,RemoveMember:f,RemoveStyle:f,RemoveText:function(a,b){var c=b.position,d=b.position+b.length,f,g=[a],h=[b];a.position<=b.position?b.position+=2:a.position<d&&(b.length=a.position-b.position,f={optype:"RemoveText",memberid:b.memberid,timestamp:b.timestamp,position:a.position+2,length:d-a.position},h.unshift(f));
b.position+b.length<=a.position?(a.position-=b.length,void 0!==a.length&&f&&(a.length=f.length>=a.length?0:a.length-f.length)):void 0!==a.length&&(f=a.position+a.length,d<=f?a.length-=b.length:c<f&&(a.length=c-a.position));return{opSpecsA:g,opSpecsB:h}},SetParagraphStyle:function(a,b){a.position<b.position&&(b.position+=2);return{opSpecsA:[a],opSpecsB:[b]}},SplitParagraph:function(a,b){a.position<b.sourceParagraphPosition&&(b.sourceParagraphPosition+=2);b.position<=a.position?a.position+=1:(void 0!==
a.length&&b.position<=a.position+a.length&&(a.length+=1),b.position+=2);return{opSpecsA:[a],opSpecsB:[b]}},UpdateMember:f,UpdateMetadata:f,UpdateParagraphStyle:f},AddCursor:{AddCursor:f,AddMember:f,AddStyle:f,ApplyDirectStyling:f,InsertText:f,MergeParagraph:f,MoveCursor:f,RemoveAnnotation:f,RemoveCursor:f,RemoveMember:f,RemoveStyle:f,RemoveText:f,SetParagraphStyle:f,SplitParagraph:f,UpdateMember:f,UpdateMetadata:f,UpdateParagraphStyle:f},AddMember:{AddStyle:f,ApplyDirectStyling:f,InsertText:f,MergeParagraph:f,
MoveCursor:f,RemoveAnnotation:f,RemoveCursor:f,RemoveStyle:f,RemoveText:f,SetParagraphStyle:f,SplitParagraph:f,UpdateMetadata:f,UpdateParagraphStyle:f},AddStyle:{AddStyle:f,ApplyDirectStyling:f,InsertText:f,MergeParagraph:f,MoveCursor:f,RemoveAnnotation:f,RemoveCursor:f,RemoveMember:f,RemoveStyle:function(a,e){var c,f=[a],g=[e];a.styleFamily===e.styleFamily&&(c=d(a.setProperties,e.styleName),0<c.length&&(c={optype:"UpdateParagraphStyle",memberid:e.memberid,timestamp:e.timestamp,styleName:a.styleName,
removedProperties:{attributes:c.join(",")}},g.unshift(c)),b(a.setProperties,e.styleName));return{opSpecsA:f,opSpecsB:g}},RemoveText:f,SetParagraphStyle:f,SplitParagraph:f,UpdateMember:f,UpdateMetadata:f,UpdateParagraphStyle:f},ApplyDirectStyling:{ApplyDirectStyling:function(a,b,d){var f,g,h,k,l,p,x,w;k=[a];h=[b];if(!(a.position+a.length<=b.position||a.position>=b.position+b.length)){f=d?a:b;g=d?b:a;if(a.position!==b.position||a.length!==b.length)p=c(f),x=c(g);b=q(g.setProperties,null,f.setProperties,
null,"style:text-properties");if(b.majorChanged||b.minorChanged)h=[],a=[],k=f.position+f.length,l=g.position+g.length,g.position<f.position?b.minorChanged&&(w=c(x),w.length=f.position-g.position,a.push(w),g.position=f.position,g.length=l-g.position):f.position<g.position&&b.majorChanged&&(w=c(p),w.length=g.position-f.position,h.push(w),f.position=g.position,f.length=k-f.position),l>k?b.minorChanged&&(p=x,p.position=k,p.length=l-k,a.push(p),g.length=k-g.position):k>l&&b.majorChanged&&(p.position=l,
p.length=k-l,h.push(p),f.length=l-f.position),f.setProperties&&n(f.setProperties)&&h.push(f),g.setProperties&&n(g.setProperties)&&a.push(g),d?(k=h,h=a):k=a}return{opSpecsA:k,opSpecsB:h}},InsertText:function(a,b){b.position<=a.position?a.position+=b.text.length:b.position<=a.position+a.length&&(a.length+=b.text.length);return{opSpecsA:[a],opSpecsB:[b]}},MergeParagraph:function(a,b){var c=a.position,d=a.position+a.length;c>=b.sourceStartPosition&&(c-=1);d>=b.sourceStartPosition&&(d-=1);a.position=c;
a.length=d-c;return{opSpecsA:[a],opSpecsB:[b]}},MoveCursor:f,RemoveAnnotation:function(a,b){var c=a.position,d=a.position+a.length,f=b.position+b.length,g=[a],h=[b];b.position<=c&&d<=f?g=[]:(f<c&&(c-=b.length+2),f<d&&(d-=b.length+2),a.position=c,a.length=d-c);return{opSpecsA:g,opSpecsB:h}},RemoveCursor:f,RemoveMember:f,RemoveStyle:f,RemoveText:function(a,b){var c=a.position+a.length,d=b.position+b.length,f=[a],g=[b];d<=a.position?a.position-=b.length:b.position<c&&(a.position<b.position?a.length=
d<c?a.length-b.length:b.position-a.position:(a.position=b.position,d<c?a.length=c-d:f=[]));return{opSpecsA:f,opSpecsB:g}},SetParagraphStyle:f,SplitParagraph:function(a,b){b.position<a.position?a.position+=1:b.position<a.position+a.length&&(a.length+=1);return{opSpecsA:[a],opSpecsB:[b]}},UpdateMember:f,UpdateMetadata:f,UpdateParagraphStyle:f},InsertText:{InsertText:function(a,b,c){a.position<b.position?b.position+=a.text.length:a.position>b.position?a.position+=b.text.length:c?b.position+=a.text.length:
a.position+=b.text.length;return{opSpecsA:[a],opSpecsB:[b]}},MergeParagraph:function(a,b){a.position>=b.sourceStartPosition?a.position-=1:(a.position<b.sourceStartPosition&&(b.sourceStartPosition+=a.text.length),a.position<b.destinationStartPosition&&(b.destinationStartPosition+=a.text.length));return{opSpecsA:[a],opSpecsB:[b]}},MoveCursor:function(a,b){var c=k(b);a.position<b.position?b.position+=a.text.length:a.position<b.position+b.length&&(b.length+=a.text.length);c&&g(b);return{opSpecsA:[a],
opSpecsB:[b]}},RemoveAnnotation:function(a,b){var c=a.position,d=b.position+b.length,f=[a],g=[b];b.position<=c&&c<=d?(f=[],b.length+=a.text.length):d<a.position?a.position-=b.length+2:b.position+=a.text.length;return{opSpecsA:f,opSpecsB:g}},RemoveCursor:f,RemoveMember:f,RemoveStyle:f,RemoveText:function(a,b){var c;c=b.position+b.length;var d=[a],f=[b];c<=a.position?a.position-=b.length:a.position<=b.position?b.position+=a.text.length:(b.length=a.position-b.position,c={optype:"RemoveText",memberid:b.memberid,
timestamp:b.timestamp,position:a.position+a.text.length,length:c-a.position},f.unshift(c),a.position=b.position);return{opSpecsA:d,opSpecsB:f}},SetParagraphStyle:function(a,b){b.position>a.position&&(b.position+=a.text.length);return{opSpecsA:[a],opSpecsB:[b]}},SplitParagraph:function(a,b){a.position<b.sourceParagraphPosition&&(b.sourceParagraphPosition+=a.text.length);a.position<=b.position?b.position+=a.text.length:a.position+=1;return{opSpecsA:[a],opSpecsB:[b]}},UpdateMember:f,UpdateMetadata:f,
UpdateParagraphStyle:f},MergeParagraph:{MergeParagraph:function(a,b,c){var d=[a],f=[b],g;a.destinationStartPosition===b.destinationStartPosition?(d=[],f=[],a.moveCursor&&(g={optype:"MoveCursor",memberid:a.memberid,timestamp:a.timestamp,position:a.sourceStartPosition-1},d.push(g)),b.moveCursor&&(g={optype:"MoveCursor",memberid:b.memberid,timestamp:b.timestamp,position:b.sourceStartPosition-1},f.push(g)),a=c?a:b,a={optype:"SetParagraphStyle",memberid:a.memberid,timestamp:a.timestamp,position:a.destinationStartPosition,
styleName:a.paragraphStyleName},c?d.push(a):f.push(a)):b.sourceStartPosition===a.destinationStartPosition?(a.destinationStartPosition=b.destinationStartPosition,a.sourceStartPosition-=1,a.paragraphStyleName=b.paragraphStyleName):a.sourceStartPosition===b.destinationStartPosition?(b.destinationStartPosition=a.destinationStartPosition,b.sourceStartPosition-=1,b.paragraphStyleName=a.paragraphStyleName):a.destinationStartPosition<b.destinationStartPosition?(b.destinationStartPosition-=1,b.sourceStartPosition-=
1):(a.destinationStartPosition-=1,a.sourceStartPosition-=1);return{opSpecsA:d,opSpecsB:f}},MoveCursor:function(a,b){var c=b.position,d=b.position+b.length,f=Math.min(c,d),c=Math.max(c,d);f>=a.sourceStartPosition&&(f-=1);c>=a.sourceStartPosition&&(c-=1);0<=b.length?(b.position=f,b.length=c-f):(b.position=c,b.length=f-c);return{opSpecsA:[a],opSpecsB:[b]}},RemoveAnnotation:function(a,b){var c=b.position+b.length,d=[a],f=[b];b.position<=a.destinationStartPosition&&a.sourceStartPosition<=c?(d=[],b.length-=
1):a.sourceStartPosition<b.position?b.position-=1:(c<a.destinationStartPosition&&(a.destinationStartPosition-=b.length+2),c<a.sourceStartPosition&&(a.sourceStartPosition-=b.length+2));return{opSpecsA:d,opSpecsB:f}},RemoveCursor:f,RemoveMember:f,RemoveStyle:f,RemoveText:function(a,b){b.position>=a.sourceStartPosition?b.position-=1:(b.position<a.destinationStartPosition&&(a.destinationStartPosition-=b.length),b.position<a.sourceStartPosition&&(a.sourceStartPosition-=b.length));return{opSpecsA:[a],opSpecsB:[b]}},
SetParagraphStyle:function(a,b){var c=[a],d=[b];if(b.position>a.sourceStartPosition)b.position-=1;else if(b.position===a.destinationStartPosition||b.position===a.sourceStartPosition)b.position=a.destinationStartPosition,a.paragraphStyleName=b.styleName;return{opSpecsA:c,opSpecsB:d}},SplitParagraph:function(a,b){var c,d=[a],f=[b];b.position<a.destinationStartPosition?(a.destinationStartPosition+=1,a.sourceStartPosition+=1):b.position>=a.destinationStartPosition&&b.position<a.sourceStartPosition?(b.paragraphStyleName=
a.paragraphStyleName,c={optype:"SetParagraphStyle",memberid:a.memberid,timestamp:a.timestamp,position:a.destinationStartPosition,styleName:a.paragraphStyleName},d.push(c),b.position===a.sourceStartPosition-1&&a.moveCursor&&(c={optype:"MoveCursor",memberid:a.memberid,timestamp:a.timestamp,position:b.position,length:0},d.push(c)),a.destinationStartPosition=b.position+1,a.sourceStartPosition+=1):b.position>=a.sourceStartPosition&&(b.position-=1,b.sourceParagraphPosition-=1);return{opSpecsA:d,opSpecsB:f}},
UpdateMember:f,UpdateMetadata:f,UpdateParagraphStyle:f},MoveCursor:{MoveCursor:f,RemoveAnnotation:function(a,b){var c=k(a),d=a.position+a.length,f=b.position+b.length;b.position<=a.position&&d<=f?(a.position=b.position-1,a.length=0):(f<a.position?a.position-=b.length+2:f<d&&(a.length-=b.length+2),c&&g(a));return{opSpecsA:[a],opSpecsB:[b]}},RemoveCursor:function(a,b){return{opSpecsA:a.memberid===b.memberid?[]:[a],opSpecsB:[b]}},RemoveMember:f,RemoveStyle:f,RemoveText:function(a,b){var c=k(a),d=a.position+
a.length,f=b.position+b.length;f<=a.position?a.position-=b.length:b.position<d&&(a.position<b.position?a.length=f<d?a.length-b.length:b.position-a.position:(a.position=b.position,a.length=f<d?d-f:0));c&&g(a);return{opSpecsA:[a],opSpecsB:[b]}},SetParagraphStyle:f,SplitParagraph:function(a,b){var c=k(a);b.position<a.position?a.position+=1:b.position<a.position+a.length&&(a.length+=1);c&&g(a);return{opSpecsA:[a],opSpecsB:[b]}},UpdateMember:f,UpdateMetadata:f,UpdateParagraphStyle:f},RemoveAnnotation:{RemoveAnnotation:function(a,
b){var c=[a],d=[b];a.position===b.position&&a.length===b.length?(c=[],d=[]):a.position<b.position?b.position-=a.length+2:a.position-=b.length+2;return{opSpecsA:c,opSpecsB:d}},RemoveCursor:f,RemoveMember:f,RemoveStyle:f,RemoveText:function(a,b){var c=a.position+a.length,d=b.position+b.length,f=[a],g=[b];a.position<=b.position&&d<=c?(g=[],a.length-=b.length):d<a.position?a.position-=b.length:b.position<a.position?(a.position=b.position+1,b.length-=a.length+2):b.position-=a.length+2;return{opSpecsA:f,
opSpecsB:g}},SetParagraphStyle:function(a,b){var c=b.position,d=a.position+a.length,f=[a],g=[b];a.position<=c&&c<=d?g=[]:d<c&&(b.position-=a.length+2);return{opSpecsA:f,opSpecsB:g}},SplitParagraph:function(a,b){var c=b.position,d=a.position+a.length,f=[a],g=[b];a.position<=c&&c<=d?(g=[],a.length+=1):(d<b.sourceParagraphPosition&&(b.sourceParagraphPosition-=a.length+2),d<c?b.position-=a.length+2:a.position+=1);return{opSpecsA:f,opSpecsB:g}},UpdateMember:f,UpdateMetadata:f,UpdateParagraphStyle:f},RemoveCursor:{RemoveCursor:function(a,
b){var c=a.memberid===b.memberid;return{opSpecsA:c?[]:[a],opSpecsB:c?[]:[b]}},RemoveMember:f,RemoveStyle:f,RemoveText:f,SetParagraphStyle:f,SplitParagraph:f,UpdateMember:f,UpdateMetadata:f,UpdateParagraphStyle:f},RemoveMember:{RemoveStyle:f,RemoveText:f,SetParagraphStyle:f,SplitParagraph:f,UpdateMetadata:f,UpdateParagraphStyle:f},RemoveStyle:{RemoveStyle:function(a,b){var c=a.styleName===b.styleName&&a.styleFamily===b.styleFamily;return{opSpecsA:c?[]:[a],opSpecsB:c?[]:[b]}},RemoveText:f,SetParagraphStyle:function(a,
b){var c,d=[a],f=[b];"paragraph"===a.styleFamily&&a.styleName===b.styleName&&(c={optype:"SetParagraphStyle",memberid:a.memberid,timestamp:a.timestamp,position:b.position,styleName:""},d.unshift(c),b.styleName="");return{opSpecsA:d,opSpecsB:f}},SplitParagraph:f,UpdateMember:f,UpdateMetadata:f,UpdateParagraphStyle:function(a,c){var f,g=[a],h=[c];"paragraph"===a.styleFamily&&(f=d(c.setProperties,a.styleName),0<f.length&&(f={optype:"UpdateParagraphStyle",memberid:a.memberid,timestamp:a.timestamp,styleName:c.styleName,
removedProperties:{attributes:f.join(",")}},g.unshift(f)),a.styleName===c.styleName?h=[]:b(c.setProperties,a.styleName));return{opSpecsA:g,opSpecsB:h}}},RemoveText:{RemoveText:function(a,b){var c=a.position+a.length,d=b.position+b.length,f=[a],g=[b];d<=a.position?a.position-=b.length:c<=b.position?b.position-=a.length:b.position<c&&(a.position<b.position?(a.length=d<c?a.length-b.length:b.position-a.position,c<d?(b.position=a.position,b.length=d-c):g=[]):(c<d?b.length-=a.length:b.position<a.position?
b.length=a.position-b.position:g=[],d<c?(a.position=b.position,a.length=c-d):f=[]));return{opSpecsA:f,opSpecsB:g}},SetParagraphStyle:function(a,b){a.position<b.position&&(b.position-=a.length);return{opSpecsA:[a],opSpecsB:[b]}},SplitParagraph:function(a,b){var c=a.position+a.length,d=[a],f=[b];b.position<=a.position?a.position+=1:b.position<c&&(a.length=b.position-a.position,c={optype:"RemoveText",memberid:a.memberid,timestamp:a.timestamp,position:b.position+1,length:c-b.position},d.unshift(c));a.position+
a.length<=b.position?b.position-=a.length:a.position<b.position&&(b.position=a.position);a.position+a.length<b.sourceParagraphPosition&&(b.sourceParagraphPosition-=a.length);return{opSpecsA:d,opSpecsB:f}},UpdateMember:f,UpdateMetadata:f,UpdateParagraphStyle:f},SetParagraphStyle:{SetParagraphStyle:function(a,b,c){a.position===b.position&&(c?b.styleName=a.styleName:a.styleName=b.styleName);return{opSpecsA:[a],opSpecsB:[b]}},SplitParagraph:function(a,b){var d=[a],f=[b],g;a.position>b.position?a.position+=
1:a.position===b.sourceParagraphPosition&&(b.paragraphStyleName=a.styleName,g=c(a),g.position=b.position+1,d.push(g));return{opSpecsA:d,opSpecsB:f}},UpdateMember:f,UpdateMetadata:f,UpdateParagraphStyle:f},SplitParagraph:{SplitParagraph:function(a,b,c){var d,f;a.position<b.position?d=!0:b.position<a.position?f=!0:a.position===b.position&&(c?d=!0:f=!0);d?(b.position+=1,b.sourceParagraphPosition=a.position<b.sourceParagraphPosition?b.sourceParagraphPosition+1:a.position+1):f&&(a.position+=1,a.sourceParagraphPosition=
b.position<b.sourceParagraphPosition?a.sourceParagraphPosition+1:b.position+1);return{opSpecsA:[a],opSpecsB:[b]}},UpdateMember:f,UpdateMetadata:f,UpdateParagraphStyle:f},UpdateMember:{UpdateMetadata:f,UpdateParagraphStyle:f},UpdateMetadata:{UpdateMetadata:function(a,b,c){var d,f=[a],g=[b];d=c?a:b;a=c?b:a;l(a.setProperties||null,a.removedProperties||null,d.setProperties||null,d.removedProperties||null);d.setProperties&&n(d.setProperties)||d.removedProperties&&p(d.removedProperties)||(c?f=[]:g=[]);
a.setProperties&&n(a.setProperties)||a.removedProperties&&p(a.removedProperties)||(c?g=[]:f=[]);return{opSpecsA:f,opSpecsB:g}},UpdateParagraphStyle:f},UpdateParagraphStyle:{UpdateParagraphStyle:function(a,b,c){var d,f=[a],g=[b];a.styleName===b.styleName&&(d=c?a:b,a=c?b:a,q(a.setProperties,a.removedProperties,d.setProperties,d.removedProperties,"style:paragraph-properties"),q(a.setProperties,a.removedProperties,d.setProperties,d.removedProperties,"style:text-properties"),l(a.setProperties||null,a.removedProperties||
null,d.setProperties||null,d.removedProperties||null),d.setProperties&&n(d.setProperties)||d.removedProperties&&p(d.removedProperties)||(c?f=[]:g=[]),a.setProperties&&n(a.setProperties)||a.removedProperties&&p(a.removedProperties)||(c?g=[]:f=[]));return{opSpecsA:f,opSpecsB:g}}}};this.passUnchanged=f;this.extendTransformations=function(a){Object.keys(a).forEach(function(b){var c=a[b],d,f=h.hasOwnProperty(b);runtime.log((f?"Extending":"Adding")+" map for optypeA: "+b);f||(h[b]={});d=h[b];Object.keys(c).forEach(function(a){var f=
d.hasOwnProperty(a);runtime.assert(b<=a,"Wrong order:"+b+", "+a);runtime.log("  "+(f?"Overwriting":"Adding")+" entry for optypeB: "+a);d[a]=c[a]})})};this.transformOpspecVsOpspec=function(a,b){var c=a.optype<=b.optype,d;runtime.log("Crosstransforming:");runtime.log(runtime.toJson(a));runtime.log(runtime.toJson(b));c||(d=a,a=b,b=d);(d=(d=h[a.optype])&&d[b.optype])?(d=d(a,b,!c),c||null===d||(d={opSpecsA:d.opSpecsB,opSpecsB:d.opSpecsA})):d=null;runtime.log("result:");d?(runtime.log(runtime.toJson(d.opSpecsA)),
runtime.log(runtime.toJson(d.opSpecsB))):runtime.log("null");return d}};ops.OperationTransformer=function(){function g(d,b){for(var c,l,n=[],p=[];0<d.length&&b;){c=d.shift();c=k.transformOpspecVsOpspec(c,b);if(!c)return null;n=n.concat(c.opSpecsA);if(0===c.opSpecsB.length){n=n.concat(d);b=null;break}for(;1<c.opSpecsB.length;){l=g(d,c.opSpecsB.shift());if(!l)return null;p=p.concat(l.opSpecsB);d=l.opSpecsA}b=c.opSpecsB.pop()}b&&p.push(b);return{opSpecsA:n,opSpecsB:p}}var k=new ops.OperationTransformMatrix;this.getOperationTransformMatrix=function(){return k};this.transform=
function(d,b){for(var c,k=[];0<b.length;){c=g(d,b.shift());if(!c)return null;d=c.opSpecsA;k=k.concat(c.opSpecsB)}return{opSpecsA:d,opSpecsB:k}}};var webodf_css='@namespace draw url(urn:oasis:names:tc:opendocument:xmlns:drawing:1.0);@namespace fo url(urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0);@namespace office url(urn:oasis:names:tc:opendocument:xmlns:office:1.0);@namespace presentation url(urn:oasis:names:tc:opendocument:xmlns:presentation:1.0);@namespace style url(urn:oasis:names:tc:opendocument:xmlns:style:1.0);@namespace svg url(urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0);@namespace table url(urn:oasis:names:tc:opendocument:xmlns:table:1.0);@namespace text url(urn:oasis:names:tc:opendocument:xmlns:text:1.0);@namespace webodfhelper url(urn:webodf:names:helper);@namespace cursor url(urn:webodf:names:cursor);@namespace editinfo url(urn:webodf:names:editinfo);@namespace annotation url(urn:webodf:names:annotation);@namespace dc url(http://purl.org/dc/elements/1.1/);@namespace svgns url(http://www.w3.org/2000/svg);office|document > *, office|document-content > * {display: none;}office|body, office|document {display: inline-block;position: relative;}text|p, text|h {display: block;padding: 0;margin: 0;line-height: normal;position: relative;}text|p::after, text|h::after {content: "\\200B";white-space: pre;}*[webodfhelper|containsparagraphanchor] {position: relative;}text|s {white-space: pre;}text|tab {display: inline;white-space: pre;}text|tracked-changes {display: none;}office|binary-data {display: none;}office|text {display: block;text-align: left;overflow: visible;word-wrap: break-word;}office|text::selection {background: transparent;}.webodf-virtualSelections *::selection {background: transparent;}.webodf-virtualSelections *::-moz-selection {background: transparent;}office|text * draw|text-box {display: block;border: 1px solid #d3d3d3;}office|text draw|frame {z-index: 1;}office|spreadsheet {display: block;border-collapse: collapse;empty-cells: show;font-family: sans-serif;font-size: 10pt;text-align: left;page-break-inside: avoid;overflow: hidden;}office|presentation {display: inline-block;text-align: left;}#shadowContent {display: inline-block;text-align: left;}draw|page {display: block;position: relative;overflow: hidden;}presentation|notes, presentation|footer-decl, presentation|date-time-decl {display: none;}@media print {draw|page {border: 1pt solid black;page-break-inside: avoid;}presentation|notes {}}office|spreadsheet text|p {border: 0px;padding: 1px;margin: 0px;}office|spreadsheet table|table {margin: 3px;}office|spreadsheet table|table:after {}office|spreadsheet table|table-row {counter-increment: row;}office|spreadsheet table|table-row:before {width: 3em;background: #cccccc;border: 1px solid black;text-align: center;content: counter(row);display: table-cell;}office|spreadsheet table|table-cell {border: 1px solid #cccccc;}table|table {display: table;}draw|frame table|table {width: 100%;height: 100%;background: white;}table|table-header-rows {display: table-header-group;}table|table-row {display: table-row;}table|table-column {display: table-column;}table|table-cell {width: 0.889in;display: table-cell;word-break: break-all;}draw|frame {display: block;}draw|image {display: block;width: 100%;height: 100%;top: 0px;left: 0px;background-repeat: no-repeat;background-size: 100% 100%;-moz-background-size: 100% 100%;}draw|frame > draw|image:nth-of-type(n+2) {display: none;}text|list:before {display: none;content:"";}text|list {display: block;}text|list-item {display: block;}text|number {display:none;}text|a {color: blue;text-decoration: underline;cursor: pointer;}.webodf-inactiveLinks text|a {cursor: text;}text|note-citation {vertical-align: super;font-size: smaller;}text|note-body {display: none;}text|note:hover text|note-citation {background: #dddddd;}text|note:hover text|note-body {display: block;left:1em;max-width: 80%;position: absolute;background: #ffffaa;}text|bibliography-source {display: none;}svg|title, svg|desc {display: none;}video {width: 100%;height: 100%}cursor|anchor {display: none;}cursor|cursor {display: none;}.webodf-caretOverlay {position: absolute;top: 5%;height: 1em;z-index: 10;padding-left: 1px;pointer-events: none;}.webodf-caretOverlay .caret {position: absolute;border-left: 2px solid black;top: 0;bottom: 0;right: 0;}.webodf-caretOverlay .handle {position: absolute;margin-top: 5px;padding-top: 3px;margin-left: auto;margin-right: auto;width: 64px;height: 68px;border-radius: 5px;opacity: 0.3;text-align: center;background-color: black;box-shadow: 0px 0px 5px rgb(90, 90, 90);border: 1px solid black;top: -85px;right: -32px;}.webodf-caretOverlay .handle > img {box-shadow: 0px 0px 5px rgb(90, 90, 90) inset;background-color: rgb(200, 200, 200);border-radius: 5px;border: 2px solid;height: 60px;width: 60px;display: block;margin: auto;}.webodf-caretOverlay .handle.active {opacity: 0.8;}.webodf-caretOverlay .handle:after {content: " ";position: absolute;width: 0px;height: 0px;border-style: solid;border-width: 8.7px 5px 0 5px;border-color: black transparent transparent transparent;top: 100%;left: 43%;}.webodf-caretSizer {display: inline-block;width: 0;visibility: hidden;}#eventTrap {display: block;position: absolute;bottom: 0;left: 0;outline: none;opacity: 0;color: rgba(255, 255, 255, 0);pointer-events: none;white-space: pre;overflow: hidden;}cursor|cursor > #composer {text-decoration: underline;}cursor|cursor[cursor|caret-sizer-active="true"],cursor|cursor[cursor|composing="true"] {display: inline;}editinfo|editinfo {display: inline-block;}.editInfoMarker {position: absolute;width: 10px;height: 100%;left: -20px;opacity: 0.8;top: 0;border-radius: 5px;background-color: transparent;box-shadow: 0px 0px 5px rgba(50, 50, 50, 0.75);}.editInfoMarker:hover {box-shadow: 0px 0px 8px rgba(0, 0, 0, 1);}.editInfoHandle {position: absolute;background-color: black;padding: 5px;border-radius: 5px;opacity: 0.8;box-shadow: 0px 0px 5px rgba(50, 50, 50, 0.75);bottom: 100%;margin-bottom: 10px;z-index: 3;left: -25px;}.editInfoHandle:after {content: " ";position: absolute;width: 0px;height: 0px;border-style: solid;border-width: 8.7px 5px 0 5px;border-color: black transparent transparent transparent;top: 100%;left: 5px;}.editInfo {font-family: sans-serif;font-weight: normal;font-style: normal;text-decoration: none;color: white;width: 100%;height: 12pt;}.editInfoColor {float: left;width: 10pt;height: 10pt;border: 1px solid white;}.editInfoAuthor {float: left;margin-left: 5pt;font-size: 10pt;text-align: left;height: 12pt;line-height: 12pt;}.editInfoTime {float: right;margin-left: 30pt;font-size: 8pt;font-style: italic;color: yellow;height: 12pt;line-height: 12pt;}.annotationWrapper {display: inline;position: relative;}.annotationRemoveButton:before {content: "\u00d7";color: white;padding: 5px;line-height: 1em;}.annotationRemoveButton {width: 20px;height: 20px;border-radius: 10px;background-color: black;box-shadow: 0px 0px 5px rgba(50, 50, 50, 0.75);position: absolute;top: -10px;left: -10px;z-index: 3;text-align: center;font-family: sans-serif;font-style: normal;font-weight: normal;text-decoration: none;font-size: 15px;}.annotationRemoveButton:hover {cursor: pointer;box-shadow: 0px 0px 5px rgba(0, 0, 0, 1);}.annotationNote {width: 4cm;position: absolute;display: inline;z-index: 10;top: 0;}.annotationNote > office|annotation {display: block;text-align: left;}.annotationConnector {position: absolute;display: inline;top: 0;z-index: 2;border-top: 1px dashed brown;}.annotationConnector.angular {-moz-transform-origin: left top;-webkit-transform-origin: left top;-ms-transform-origin: left top;transform-origin: left top;}.annotationConnector.horizontal {left: 0;}.annotationConnector.horizontal:before {content: "";display: inline;position: absolute;width: 0px;height: 0px;border-style: solid;border-width: 8.7px 5px 0 5px;border-color: brown transparent transparent transparent;top: -1px;left: -5px;}office|annotation {width: 100%;height: 100%;display: none;background: rgb(198, 238, 184);background: -moz-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: -webkit-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: -o-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: -ms-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: linear-gradient(180deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);box-shadow: 0 3px 4px -3px #ccc;}office|annotation > dc|creator {display: block;font-size: 10pt;font-weight: normal;font-style: normal;font-family: sans-serif;color: white;background-color: brown;padding: 4px;}office|annotation > dc|date {display: block;font-size: 10pt;font-weight: normal;font-style: normal;font-family: sans-serif;border: 4px solid transparent;color: black;}office|annotation > text|list {display: block;padding: 5px;}office|annotation text|p {font-size: 10pt;color: black;font-weight: normal;font-style: normal;text-decoration: none;font-family: sans-serif;}#annotationsPane {background-color: #EAEAEA;width: 4cm;height: 100%;display: none;position: absolute;outline: 1px solid #ccc;}.webodf-annotationHighlight {background-color: yellow;position: relative;}.webodf-selectionOverlay {position: absolute;pointer-events: none;top: 0;left: 0;top: 0;left: 0;width: 100%;height: 100%;z-index: 15;}.webodf-selectionOverlay > polygon {fill-opacity: 0.3;stroke-opacity: 0.8;stroke-width: 1;fill-rule: evenodd;}.webodf-selectionOverlay > .webodf-draggable {fill-opacity: 0.8;stroke-opacity: 0;stroke-width: 8;pointer-events: all;display: none;-moz-transform-origin: center center;-webkit-transform-origin: center center;-ms-transform-origin: center center;transform-origin: center center;}#imageSelector {display: none;position: absolute;border-style: solid;border-color: black;}#imageSelector > div {width: 5px;height: 5px;display: block;position: absolute;border: 1px solid black;background-color: #ffffff;}#imageSelector > .topLeft {top: -4px;left: -4px;}#imageSelector > .topRight {top: -4px;right: -4px;}#imageSelector > .bottomRight {right: -4px;bottom: -4px;}#imageSelector > .bottomLeft {bottom: -4px;left: -4px;}#imageSelector > .topMiddle {top: -4px;left: 50%;margin-left: -2.5px;}#imageSelector > .rightMiddle {top: 50%;right: -4px;margin-top: -2.5px;}#imageSelector > .bottomMiddle {bottom: -4px;left: 50%;margin-left: -2.5px;}#imageSelector > .leftMiddle {top: 50%;left: -4px;margin-top: -2.5px;}div.webodf-customScrollbars::-webkit-scrollbar{width: 8px;height: 8px;background-color: transparent;}div.webodf-customScrollbars::-webkit-scrollbar-track{background-color: transparent;}div.webodf-customScrollbars::-webkit-scrollbar-thumb{background-color: #444;border-radius: 4px;}.webodf-hyperlinkTooltip {display: none;color: white;background-color: black;border-radius: 5px;box-shadow: 2px 2px 5px gray;padding: 3px;position: absolute;max-width: 210px;text-align: left;word-break: break-all;z-index: 16;}.webodf-hyperlinkTooltipText {display: block;font-weight: bold;}';
