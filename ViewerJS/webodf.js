/*

 This is a generated file. DO NOT EDIT.

 Copyright (C) 2010-2015 KO GmbH <copyright@kogmbh.com>

 @licstart
 This file is the compiled version of the WebODF library.

 WebODF is free software: you can redistribute it and/or modify it
 under the terms of the GNU Affero General Public License (GNU AGPL)
 as published by the Free Software Foundation, either version 3 of
 the License, or (at your option) any later version.

 WebODF is distributed in the hope that it will be useful, but
 WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU Affero General Public License for more details.

 You should have received a copy of the GNU Affero General Public License
 along with WebODF.  If not, see <http://www.gnu.org/licenses/>.
 @licend

 @source: http://www.webodf.org/
 @source: https://github.com/kogmbh/WebODF/
*/
var webodf_version="0.5.7-33-g812e324-dirty";function Runtime(){}Runtime.prototype.getVariable=function(f){};Runtime.prototype.toJson=function(f){};Runtime.prototype.fromJson=function(f){};Runtime.prototype.byteArrayFromString=function(f,l){};Runtime.prototype.byteArrayToString=function(f,l){};Runtime.prototype.read=function(f,l,a,e){};Runtime.prototype.readFile=function(f,l,a){};Runtime.prototype.readFileSync=function(f,l){};Runtime.prototype.loadXML=function(f,l){};Runtime.prototype.writeFile=function(f,l,a){};
Runtime.prototype.deleteFile=function(f,l){};Runtime.prototype.log=function(f,l){};Runtime.prototype.setTimeout=function(f,l){};Runtime.prototype.clearTimeout=function(f){};Runtime.prototype.libraryPaths=function(){};Runtime.prototype.currentDirectory=function(){};Runtime.prototype.setCurrentDirectory=function(f){};Runtime.prototype.type=function(){};Runtime.prototype.getDOMImplementation=function(){};Runtime.prototype.parseXML=function(f){};Runtime.prototype.exit=function(f){};
Runtime.prototype.getWindow=function(){};Runtime.prototype.requestAnimationFrame=function(f){};Runtime.prototype.cancelAnimationFrame=function(f){};Runtime.prototype.assert=function(f,l){};var IS_COMPILED_CODE=!0;
Runtime.byteArrayToString=function(f,l){function a(a){var c="",e,p=a.length;for(e=0;e<p;e+=1)c+=String.fromCharCode(a[e]&255);return c}function e(a){var c="",e,p=a.length,g=[],h,b,d,r;for(e=3<=p&&239===a[0]&&187===a[1]&&191===a[2]?3:0;e<p;e+=1)h=a[e],128>h?g.push(h):(e+=1,b=a[e],194<=h&&224>h?g.push((h&31)<<6|b&63):(e+=1,d=a[e],224<=h&&240>h?g.push((h&15)<<12|(b&63)<<6|d&63):(e+=1,r=a[e],240<=h&&245>h&&(h=(h&7)<<18|(b&63)<<12|(d&63)<<6|r&63,h-=65536,g.push((h>>10)+55296,(h&1023)+56320))))),1E3<=g.length&&
(c+=String.fromCharCode.apply(null,g),g.length=0);return c+String.fromCharCode.apply(null,g)}var c;"utf8"===l?c=e(f):("binary"!==l&&this.log("Unsupported encoding: "+l),c=a(f));return c};Runtime.getVariable=function(f){try{return eval(f)}catch(l){}};Runtime.toJson=function(f){return JSON.stringify(f)};Runtime.fromJson=function(f){return JSON.parse(f)};Runtime.getFunctionName=function(f){return void 0===f.name?(f=/function\s+(\w+)/.exec(f))&&f[1]:f.name};
Runtime.assert=function(f,l){if(!f)throw this.log("alert","ASSERTION FAILED:\n"+l),Error(l);};
function BrowserRuntime(){function f(a){var g=a.length,h,b,d=0;for(h=0;h<g;h+=1)b=a.charCodeAt(h),d+=1+(128<b)+(2048<b),55040<b&&57344>b&&(d+=1,h+=1);return d}function l(a,g,h){var b=a.length,d,r;g=new Uint8Array(new ArrayBuffer(g));h?(g[0]=239,g[1]=187,g[2]=191,r=3):r=0;for(h=0;h<b;h+=1)d=a.charCodeAt(h),128>d?(g[r]=d,r+=1):2048>d?(g[r]=192|d>>>6,g[r+1]=128|d&63,r+=2):55040>=d||57344<=d?(g[r]=224|d>>>12&15,g[r+1]=128|d>>>6&63,g[r+2]=128|d&63,r+=3):(h+=1,d=(d-55296<<10|a.charCodeAt(h)-56320)+65536,
g[r]=240|d>>>18&7,g[r+1]=128|d>>>12&63,g[r+2]=128|d>>>6&63,g[r+3]=128|d&63,r+=4);return g}function a(a){var g=a.length,h=new Uint8Array(new ArrayBuffer(g)),b;for(b=0;b<g;b+=1)h[b]=a.charCodeAt(b)&255;return h}function e(a,g){var h;void 0!==g?h=a:g=a;console.log(g);n.enableAlerts&&"alert"===h&&alert(g)}function c(e,g,h){if(0!==h.status||h.responseText)if(200===h.status||0===h.status){if(h.response&&"string"!==typeof h.response)"binary"===g?(h=h.response,h=new Uint8Array(h)):h=String(h.response);else if("binary"===
g)if(null!==h.responseBody&&"undefined"!==String(typeof VBArray)){h=(new VBArray(h.responseBody)).toArray();var b=h.length;g=new Uint8Array(new ArrayBuffer(b));for(e=0;e<b;e+=1)g[e]=h[e];h=g}else{(e=h.getResponseHeader("Content-Length"))&&(e=parseInt(e,10));if(e&&e!==h.responseText.length)a:{b=h.responseText;g=!1;var d=f(b);if("number"===typeof e){if(e!==d&&e!==d+3){b=void 0;break a}g=d+3===e;d=e}b=l(b,d,g)}void 0===b&&(b=a(h.responseText));h=b}else h=h.responseText;h={err:null,data:h}}else h={err:h.responseText||
h.statusText,data:null};else h={err:"File "+e+" is empty.",data:null};return h}function k(a,e,h){var b=new XMLHttpRequest;b.open("GET",a,h);b.overrideMimeType&&("binary"!==e?b.overrideMimeType("text/plain; charset="+e):b.overrideMimeType("text/plain; charset=x-user-defined"));return b}function q(e,a,h){var b=k(e,a,!0);b.onreadystatechange=function(){var d;4===b.readyState&&(d=c(e,a,b),h(d.err,d.data))};try{b.send(null)}catch(d){h(d.message,null)}}var n=this;this.byteArrayFromString=function(e,g){var h;
"utf8"===g?h=l(e,f(e),!1):("binary"!==g&&n.log("unknown encoding: "+g),h=a(e));return h};this.byteArrayToString=Runtime.byteArrayToString;this.getVariable=Runtime.getVariable;this.fromJson=Runtime.fromJson;this.toJson=Runtime.toJson;this.readFile=q;this.read=function(e,a,h,b){q(e,"binary",function(d,r){var m=null;if(r){if("string"===typeof r)throw"This should not happen.";m=r.subarray(a,a+h)}b(d,m)})};this.readFileSync=function(e,a){var h=k(e,a,!1),b;try{h.send(null);b=c(e,a,h);if(b.err)throw b.err;
if(null===b.data)throw"No data read from "+e+".";}catch(d){throw d;}return b.data};this.writeFile=function(e,a,h){var b=new XMLHttpRequest,d;b.open("PUT",e,!0);b.onreadystatechange=function(){4===b.readyState&&(0!==b.status||b.responseText?200<=b.status&&300>b.status||0===b.status?h(null):h("Status "+String(b.status)+": "+b.responseText||b.statusText):h("File "+e+" is empty."))};d=a.buffer&&!b.sendAsBinary?a.buffer:n.byteArrayToString(a,"binary");try{b.sendAsBinary?b.sendAsBinary(d):b.send(d)}catch(r){n.log("HUH? "+
r+" "+a),h(r.message)}};this.deleteFile=function(e,a){var h=new XMLHttpRequest;h.open("DELETE",e,!0);h.onreadystatechange=function(){4===h.readyState&&(200>h.status&&300<=h.status?a(h.responseText):a(null))};h.send(null)};this.loadXML=function(e,a){var h=new XMLHttpRequest;h.open("GET",e,!0);h.overrideMimeType&&h.overrideMimeType("text/xml");h.onreadystatechange=function(){4===h.readyState&&(0!==h.status||h.responseText?200===h.status||0===h.status?a(null,h.responseXML):a(h.responseText,null):a("File "+
e+" is empty.",null))};try{h.send(null)}catch(b){a(b.message,null)}};this.log=e;this.enableAlerts=!0;this.assert=Runtime.assert;this.setTimeout=function(a,e){return setTimeout(function(){a()},e)};this.clearTimeout=function(a){clearTimeout(a)};this.libraryPaths=function(){return["lib"]};this.setCurrentDirectory=function(){};this.currentDirectory=function(){return""};this.type=function(){return"BrowserRuntime"};this.getDOMImplementation=function(){return window.document.implementation};this.parseXML=
function(a){return(new DOMParser).parseFromString(a,"text/xml")};this.exit=function(a){e("Calling exit with code "+String(a)+", but exit() is not implemented.")};this.getWindow=function(){return window};this.requestAnimationFrame=function(a){var e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,h=0;if(e)e.bind(window),h=e(a);else return setTimeout(a,15);return h};this.cancelAnimationFrame=function(a){var e=window.cancelAnimationFrame||
window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame;e?(e.bind(window),e(a)):clearTimeout(a)}}
function NodeJSRuntime(){function f(a){var e=a.length,h,b=new Uint8Array(new ArrayBuffer(e));for(h=0;h<e;h+=1)b[h]=a[h];return b}function l(a,g,h){function b(b,r){if(b)return h(b,null);if(!r)return h("No data for "+a+".",null);if("string"===typeof r)return h(b,r);h(b,f(r))}a=c.resolve(k,a);"binary"!==g?e.readFile(a,g,b):e.readFile(a,null,b)}var a=this,e=require("fs"),c=require("path"),k="",q,n;this.byteArrayFromString=function(a,e){var h=new Buffer(a,e),b,d=h.length,r=new Uint8Array(new ArrayBuffer(d));
for(b=0;b<d;b+=1)r[b]=h[b];return r};this.byteArrayToString=Runtime.byteArrayToString;this.getVariable=Runtime.getVariable;this.fromJson=Runtime.fromJson;this.toJson=Runtime.toJson;this.readFile=l;this.loadXML=function(e,c){l(e,"utf-8",function(h,b){if(h)return c(h,null);if(!b)return c("No data for "+e+".",null);c(null,a.parseXML(b))})};this.writeFile=function(a,g,h){g=new Buffer(g);a=c.resolve(k,a);e.writeFile(a,g,"binary",function(b){h(b||null)})};this.deleteFile=function(a,g){a=c.resolve(k,a);
e.unlink(a,g)};this.read=function(a,g,h,b){a=c.resolve(k,a);e.open(a,"r+",666,function(d,r){if(d)b(d,null);else{var m=new Buffer(h);e.read(r,m,0,h,g,function(d){e.close(r);b(d,f(m))})}})};this.readFileSync=function(a,c){var h;h=e.readFileSync(a,"binary"===c?null:c);if(null===h)throw"File "+a+" could not be read.";"binary"===c&&(h=f(h));return h};this.log=function(a,e){var h;void 0!==e?h=a:e=a;"alert"===h&&process.stderr.write("\n!!!!! ALERT !!!!!\n");process.stderr.write(e+"\n");"alert"===h&&process.stderr.write("!!!!! ALERT !!!!!\n")};
this.assert=Runtime.assert;this.setTimeout=function(a,e){return setTimeout(function(){a()},e)};this.clearTimeout=function(a){clearTimeout(a)};this.libraryPaths=function(){return[__dirname]};this.setCurrentDirectory=function(a){k=a};this.currentDirectory=function(){return k};this.type=function(){return"NodeJSRuntime"};this.getDOMImplementation=function(){return n};this.parseXML=function(a){return q.parseFromString(a,"text/xml")};this.exit=process.exit;this.getWindow=function(){return null};this.requestAnimationFrame=
function(a){return setTimeout(a,15)};this.cancelAnimationFrame=function(a){clearTimeout(a)};q=new (require("xmldom").DOMParser);n=a.parseXML("<a/>").implementation}
function RhinoRuntime(){var f=this,l={},a=l.javax.xml.parsers.DocumentBuilderFactory.newInstance(),e,c,k="";a.setValidating(!1);a.setNamespaceAware(!0);a.setExpandEntityReferences(!1);a.setSchema(null);c=l.org.xml.sax.EntityResolver({resolveEntity:function(a,e){var c=new l.java.io.FileReader(e);return new l.org.xml.sax.InputSource(c)}});e=a.newDocumentBuilder();e.setEntityResolver(c);this.byteArrayFromString=function(a,e){var c,g=a.length,h=new Uint8Array(new ArrayBuffer(g));for(c=0;c<g;c+=1)h[c]=
a.charCodeAt(c)&255;return h};this.byteArrayToString=Runtime.byteArrayToString;this.getVariable=Runtime.getVariable;this.fromJson=Runtime.fromJson;this.toJson=Runtime.toJson;this.loadXML=function(a,c){var k=new l.java.io.File(a),g=null;try{g=e.parse(k)}catch(h){return print(h),c(h,null)}c(null,g)};this.readFile=function(a,e,c){k&&(a=k+"/"+a);var g=new l.java.io.File(a),h="binary"===e?"latin1":e;g.isFile()?((a=readFile(a,h))&&"binary"===e&&(a=f.byteArrayFromString(a,"binary")),c(null,a)):c(a+" is not a file.",
null)};this.writeFile=function(a,e,c){k&&(a=k+"/"+a);a=new l.java.io.FileOutputStream(a);var g,h=e.length;for(g=0;g<h;g+=1)a.write(e[g]);a.close();c(null)};this.deleteFile=function(a,e){k&&(a=k+"/"+a);var c=new l.java.io.File(a),g=a+Math.random(),g=new l.java.io.File(g);c.rename(g)?(g.deleteOnExit(),e(null)):e("Could not delete "+a)};this.read=function(a,e,c,g){k&&(a=k+"/"+a);var h;h=a;var b="binary";(new l.java.io.File(h)).isFile()?("binary"===b&&(b="latin1"),h=readFile(h,b)):h=null;h?g(null,this.byteArrayFromString(h.substring(e,
e+c),"binary")):g("Cannot read "+a,null)};this.readFileSync=function(a,e){if(!e)return"";var c=readFile(a,e);if(null===c)throw"File could not be read.";return c};this.log=function(a,e){var c;void 0!==e?c=a:e=a;"alert"===c&&print("\n!!!!! ALERT !!!!!");print(e);"alert"===c&&print("!!!!! ALERT !!!!!")};this.assert=Runtime.assert;this.setTimeout=function(a){a();return 0};this.clearTimeout=function(){};this.libraryPaths=function(){return["lib"]};this.setCurrentDirectory=function(a){k=a};this.currentDirectory=
function(){return k};this.type=function(){return"RhinoRuntime"};this.getDOMImplementation=function(){return e.getDOMImplementation()};this.parseXML=function(a){a=new l.java.io.StringReader(a);a=new l.org.xml.sax.InputSource(a);return e.parse(a)};this.exit=quit;this.getWindow=function(){return null};this.requestAnimationFrame=function(a){a();return 0};this.cancelAnimationFrame=function(){}}
Runtime.create=function(){return"undefined"!==String(typeof window)?new BrowserRuntime:"undefined"!==String(typeof require)?new NodeJSRuntime:new RhinoRuntime};var runtime=Runtime.create(),core={},gui={},xmldom={},odf={},ops={},webodf={};(function(){webodf.Version="undefined"!==String(typeof webodf_version)?webodf_version:"From Source"})();
(function(){function f(a,e,c){var h=a+"/manifest.json",b,d;runtime.log("Loading manifest: "+h);try{b=runtime.readFileSync(h,"utf-8")}catch(r){if(c)runtime.log("No loadable manifest found.");else throw console.log(String(r)),r;return}c=JSON.parse(b);for(d in c)c.hasOwnProperty(d)&&(e[d]={dir:a,deps:c[d]})}function l(a,e,c){function h(m){if(!r[m]&&!c(m)){if(d[m])throw"Circular dependency detected for "+m+".";d[m]=!0;if(!e[m])throw"Missing dependency information for class "+m+".";var a=e[m],k=a.deps,
n,q=k.length;for(n=0;n<q;n+=1)h(k[n]);d[m]=!1;r[m]=!0;b.push(a.dir+"/"+m.replace(".","/")+".js")}}var b=[],d={},r={};a.forEach(h);return b}function a(a,e){return e+("\n//# sourceURL="+a)}function e(e){var c,g;for(c=0;c<e.length;c+=1)g=runtime.readFileSync(e[c],"utf-8"),g=a(e[c],g),eval(g)}function c(a){a=a.split(".");var e,c=q,h=a.length;for(e=0;e<h;e+=1){if(!c.hasOwnProperty(a[e]))return!1;c=c[a[e]]}return!0}var k,q={core:core,gui:gui,xmldom:xmldom,odf:odf,ops:ops};runtime.loadClasses=function(a,
q){if(IS_COMPILED_CODE||0===a.length)return q&&q();var g;if(!(g=k)){g=[];var h=runtime.libraryPaths(),b;runtime.currentDirectory()&&-1===h.indexOf(runtime.currentDirectory())&&f(runtime.currentDirectory(),g,!0);for(b=0;b<h.length;b+=1)f(h[b],g)}k=g;a=l(a,k,c);if(0===a.length)return q&&q();if("BrowserRuntime"===runtime.type()&&q){g=a;h=document.currentScript||document.documentElement.lastChild;b=document.createDocumentFragment();var d,r;for(r=0;r<g.length;r+=1)d=document.createElement("script"),d.type=
"text/javascript",d.charset="utf-8",d.async=!1,d.setAttribute("src",g[r]),b.appendChild(d);q&&(d.onload=q);h.parentNode.insertBefore(b,h)}else e(a),q&&q()};runtime.loadClass=function(a,e){runtime.loadClasses([a],e)}})();(function(){var f=function(f){return f};runtime.getTranslator=function(){return f};runtime.setTranslator=function(l){f=l};runtime.tr=function(l){var a=f(l);return a&&"string"===String(typeof a)?a:l}})();
(function(f){function l(a){if(a.length){var e=a[0];runtime.readFile(e,"utf8",function(c,k){function q(){var a;(a=eval(f))&&runtime.exit(a)}var n="",n=e.lastIndexOf("/"),f=k,n=-1!==n?e.substring(0,n):".";runtime.setCurrentDirectory(n);c?(runtime.log(c),runtime.exit(1)):null===f?(runtime.log("No code found for "+e),runtime.exit(1)):q.apply(null,a)})}}f=f?Array.prototype.slice.call(f):[];"NodeJSRuntime"===runtime.type()?l(process.argv.slice(2)):"RhinoRuntime"===runtime.type()?l(f):l(f.slice(1))})("undefined"!==
String(typeof arguments)&&arguments);(function(){core.Async=function(){return{forEach:function(f,l,a){function e(e){q!==k&&(e?(q=k,a(e)):(q+=1,q===k&&a(null)))}var c,k=f.length,q=0;for(c=0;c<k;c+=1)l(f[c],e)},destroyAll:function(f,l){function a(e,c){if(c)l(c);else if(e<f.length)f[e](function(c){a(e+1,c)});else l()}a(0,void 0)}}}()})();function makeBase64(){function f(b){var d,m=b.length,r=new Uint8Array(new ArrayBuffer(m));for(d=0;d<m;d+=1)r[d]=b.charCodeAt(d)&255;return r}function l(b){var d,m="",r,a=b.length-2;for(r=0;r<a;r+=3)d=b[r]<<16|b[r+1]<<8|b[r+2],m+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d>>>18],m+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d>>>12&63],m+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d>>>6&63],m+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d&
63];r===a+1?(d=b[r]<<4,m+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d>>>6],m+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d&63],m+="=="):r===a&&(d=b[r]<<10|b[r+1]<<2,m+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d>>>12],m+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d>>>6&63],m+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d&63],m+="=");return m}function a(b){b=b.replace(/[^A-Za-z0-9+\/]+/g,
"");var d=b.length,r=new Uint8Array(new ArrayBuffer(3*d)),a=b.length%4,e=0,c,J;for(c=0;c<d;c+=4)J=(m[b.charAt(c)]||0)<<18|(m[b.charAt(c+1)]||0)<<12|(m[b.charAt(c+2)]||0)<<6|(m[b.charAt(c+3)]||0),r[e]=J>>16,r[e+1]=J>>8&255,r[e+2]=J&255,e+=3;d=3*d-[0,0,2,1][a];return r.subarray(0,d)}function e(b){var d,m,r=b.length,a=0,e=new Uint8Array(new ArrayBuffer(3*r));for(d=0;d<r;d+=1)m=b[d],128>m?e[a++]=m:(2048>m?e[a++]=192|m>>>6:(e[a++]=224|m>>>12&15,e[a++]=128|m>>>6&63),e[a++]=128|m&63);return e.subarray(0,
a)}function c(b){var d,m,r,a,e=b.length,c=new Uint8Array(new ArrayBuffer(e)),h=0;for(d=0;d<e;d+=1)m=b[d],128>m?c[h++]=m:(d+=1,r=b[d],224>m?c[h++]=(m&31)<<6|r&63:(d+=1,a=b[d],c[h++]=(m&15)<<12|(r&63)<<6|a&63));return c.subarray(0,h)}function k(b){return l(f(b))}function q(b){return String.fromCharCode.apply(String,a(b))}function n(b){return c(f(b))}function p(b){b=c(b);for(var d="",m=0;m<b.length;)d+=String.fromCharCode.apply(String,b.subarray(m,m+45E3)),m+=45E3;return d}function g(b,d,m){var r,a,
e,c="";for(e=d;e<m;e+=1)d=b.charCodeAt(e)&255,128>d?c+=String.fromCharCode(d):(e+=1,r=b.charCodeAt(e)&255,224>d?c+=String.fromCharCode((d&31)<<6|r&63):(e+=1,a=b.charCodeAt(e)&255,c+=String.fromCharCode((d&15)<<12|(r&63)<<6|a&63)));return c}function h(b,d){function m(){var e=a+1E5;e>b.length&&(e=b.length);r+=g(b,a,e);a=e;e=a===b.length;d(r,e)&&!e&&runtime.setTimeout(m,0)}var r="",a=0;1E5>b.length?d(g(b,0,b.length),!0):("string"!==typeof b&&(b=b.slice()),m())}function b(b){return e(f(b))}function d(b){return String.fromCharCode.apply(String,
e(b))}function r(b){return String.fromCharCode.apply(String,e(f(b)))}var m=function(b){var d={},m,r;m=0;for(r=b.length;m<r;m+=1)d[b.charAt(m)]=m;return d}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),x,t,y=runtime.getWindow(),v,s;y&&y.btoa?(v=y.btoa,x=function(b){return v(r(b))}):(v=k,x=function(d){return l(b(d))});y&&y.atob?(s=y.atob,t=function(b){b=s(b);return g(b,0,b.length)}):(s=q,t=function(b){return p(a(b))});core.Base64=function(){this.convertByteArrayToBase64=this.convertUTF8ArrayToBase64=
l;this.convertBase64ToByteArray=this.convertBase64ToUTF8Array=a;this.convertUTF16ArrayToByteArray=this.convertUTF16ArrayToUTF8Array=e;this.convertByteArrayToUTF16Array=this.convertUTF8ArrayToUTF16Array=c;this.convertUTF8StringToBase64=k;this.convertBase64ToUTF8String=q;this.convertUTF8StringToUTF16Array=n;this.convertByteArrayToUTF16String=this.convertUTF8ArrayToUTF16String=p;this.convertUTF8StringToUTF16String=h;this.convertUTF16StringToByteArray=this.convertUTF16StringToUTF8Array=b;this.convertUTF16ArrayToUTF8String=
d;this.convertUTF16StringToUTF8String=r;this.convertUTF16StringToBase64=x;this.convertBase64ToUTF16String=t;this.fromBase64=q;this.toBase64=k;this.atob=s;this.btoa=v;this.utob=r;this.btou=h;this.encode=x;this.encodeURI=function(b){return x(b).replace(/[+\/]/g,function(b){return"+"===b?"-":"_"}).replace(/\\=+$/,"")};this.decode=function(b){return t(b.replace(/[\-_]/g,function(b){return"-"===b?"+":"/"}))};return this};return core.Base64}core.Base64=makeBase64();core.ByteArray=function(f){this.pos=0;this.data=f;this.readUInt32LE=function(){this.pos+=4;var f=this.data,a=this.pos;return f[--a]<<24|f[--a]<<16|f[--a]<<8|f[--a]};this.readUInt16LE=function(){this.pos+=2;var f=this.data,a=this.pos;return f[--a]<<8|f[--a]}};core.ByteArrayWriter=function(f){function l(a){a>c-e&&(c=Math.max(2*c,e+a),a=new Uint8Array(new ArrayBuffer(c)),a.set(k),k=a)}var a=this,e=0,c=1024,k=new Uint8Array(new ArrayBuffer(c));this.appendByteArrayWriter=function(e){a.appendByteArray(e.getByteArray())};this.appendByteArray=function(a){var c=a.length;l(c);k.set(a,e);e+=c};this.appendArray=function(a){var c=a.length;l(c);k.set(a,e);e+=c};this.appendUInt16LE=function(e){a.appendArray([e&255,e>>8&255])};this.appendUInt32LE=function(e){a.appendArray([e&
255,e>>8&255,e>>16&255,e>>24&255])};this.appendString=function(e){a.appendByteArray(runtime.byteArrayFromString(e,f))};this.getLength=function(){return e};this.getByteArray=function(){var a=new Uint8Array(new ArrayBuffer(e));a.set(k.subarray(0,e));return a}};core.CSSUnits=function(){var f=this,l={"in":1,cm:2.54,mm:25.4,pt:72,pc:12,px:96};this.convert=function(a,e,c){return a*l[c]/l[e]};this.convertMeasure=function(a,e){var c,k;a&&e&&(c=parseFloat(a),k=a.replace(c.toString(),""),c=f.convert(c,k,e));return c};this.getUnits=function(a){return a.substr(a.length-2,a.length)}};(function(){function f(){var e,c,k,f,n,l,g,h,b;void 0===a&&(c=(e=runtime.getWindow())&&e.document,l=c.documentElement,g=c.body,a={rangeBCRIgnoresElementBCR:!1,unscaledRangeClientRects:!1,elementBCRIgnoresBodyScroll:!1},c&&(f=c.createElement("div"),f.style.position="absolute",f.style.left="-99999px",f.style.transform="scale(2)",f.style["-webkit-transform"]="scale(2)",n=c.createElement("div"),f.appendChild(n),g.appendChild(f),e=c.createRange(),e.selectNode(n),a.rangeBCRIgnoresElementBCR=0===e.getClientRects().length,
n.appendChild(c.createTextNode("Rect transform test")),c=n.getBoundingClientRect(),k=e.getBoundingClientRect(),a.unscaledRangeClientRects=2<Math.abs(c.height-k.height),f.style.transform="",f.style["-webkit-transform"]="",c=l.style.overflow,k=g.style.overflow,h=g.style.height,b=g.scrollTop,l.style.overflow="visible",g.style.overflow="visible",g.style.height="200%",g.scrollTop=g.scrollHeight,a.elementBCRIgnoresBodyScroll=e.getBoundingClientRect().top!==n.getBoundingClientRect().top,g.scrollTop=b,g.style.height=
h,g.style.overflow=k,l.style.overflow=c,e.detach(),g.removeChild(f),e=Object.keys(a).map(function(b){return b+":"+String(a[b])}).join(", "),runtime.log("Detected browser quirks - "+e)));return a}function l(a,c,k){for(a=a?a.firstElementChild:null;a;){if(a.localName===k&&a.namespaceURI===c)return a;a=a.nextElementSibling}return null}var a;core.DomUtilsImpl=function(){function a(b,d){for(var e=0,c;b.parentNode!==d;)runtime.assert(null!==b.parentNode,"parent is null"),b=b.parentNode;for(c=d.firstChild;c!==
b;)e+=1,c=c.nextSibling;return e}function c(b,d){return 0>=b.compareBoundaryPoints(Range.START_TO_START,d)&&0<=b.compareBoundaryPoints(Range.END_TO_END,d)}function k(b,d){return 0>=b.compareBoundaryPoints(Range.END_TO_START,d)&&0<=b.compareBoundaryPoints(Range.START_TO_END,d)}function q(b,d){var a=null;b.nodeType===Node.TEXT_NODE&&(0===b.length?(b.parentNode.removeChild(b),d.nodeType===Node.TEXT_NODE&&(a=d)):(d.nodeType===Node.TEXT_NODE&&(b.appendData(d.data),d.parentNode.removeChild(d)),a=b));return a}
function n(b){for(var d=b.parentNode;b.firstChild;)d.insertBefore(b.firstChild,b);d.removeChild(b);return d}function p(b,d){var a=b.parentNode,e=b.firstChild,c=d(b),h;if(c===NodeFilter.FILTER_SKIP)return a;for(;e;)h=e.nextSibling,p(e,d),e=h;a&&c===NodeFilter.FILTER_REJECT&&n(b);return a}function g(b,d){return b===d||Boolean(b.compareDocumentPosition(d)&Node.DOCUMENT_POSITION_CONTAINED_BY)}function h(b,d){return f().unscaledRangeClientRects?b:b/d}function b(d,m,a){Object.keys(m).forEach(function(e){var c=
e.split(":"),h=c[1],g=a(c[0]),c=m[e],k=typeof c;"object"===k?Object.keys(c).length&&(e=g?d.getElementsByTagNameNS(g,h)[0]||d.ownerDocument.createElementNS(g,e):d.getElementsByTagName(h)[0]||d.ownerDocument.createElement(e),d.appendChild(e),b(e,c,a)):g&&(runtime.assert("number"===k||"string"===k,"attempting to map unsupported type '"+k+"' (key: "+e+")"),d.setAttributeNS(g,e,String(c)))})}var d=null;this.splitBoundaries=function(b){var d,c=[],h,g,k;if(b.startContainer.nodeType===Node.TEXT_NODE||b.endContainer.nodeType===
Node.TEXT_NODE){h=b.endContainer;g=b.endContainer.nodeType!==Node.TEXT_NODE?b.endOffset===b.endContainer.childNodes.length:!1;k=b.endOffset;d=b.endContainer;if(k<d.childNodes.length)for(d=d.childNodes.item(k),k=0;d.firstChild;)d=d.firstChild;else for(;d.lastChild;)d=d.lastChild,k=d.nodeType===Node.TEXT_NODE?d.textContent.length:d.childNodes.length;d===h&&(h=null);b.setEnd(d,k);k=b.endContainer;0!==b.endOffset&&k.nodeType===Node.TEXT_NODE&&(d=k,b.endOffset!==d.length&&(c.push(d.splitText(b.endOffset)),
c.push(d)));k=b.startContainer;0!==b.startOffset&&k.nodeType===Node.TEXT_NODE&&(d=k,b.startOffset!==d.length&&(k=d.splitText(b.startOffset),c.push(d),c.push(k),b.setStart(k,0)));if(null!==h){for(k=b.endContainer;k.parentNode&&k.parentNode!==h;)k=k.parentNode;g=g?h.childNodes.length:a(k,h);b.setEnd(h,g)}}return c};this.containsRange=c;this.rangesIntersect=k;this.rangeIntersection=function(b,d){var a;k(b,d)&&(a=b.cloneRange(),-1===b.compareBoundaryPoints(Range.START_TO_START,d)&&a.setStart(d.startContainer,
d.startOffset),1===b.compareBoundaryPoints(Range.END_TO_END,d)&&a.setEnd(d.endContainer,d.endOffset));return a};this.getNodesInRange=function(b,d,a){var e=[],c=b.commonAncestorContainer,c=c.nodeType===Node.TEXT_NODE?c.parentNode:c;a=b.startContainer.ownerDocument.createTreeWalker(c,a,d,!1);var h,k;b.endContainer.childNodes[b.endOffset-1]?(h=b.endContainer.childNodes[b.endOffset-1],k=Node.DOCUMENT_POSITION_PRECEDING|Node.DOCUMENT_POSITION_CONTAINED_BY):(h=b.endContainer,k=Node.DOCUMENT_POSITION_PRECEDING);
b.startContainer.childNodes[b.startOffset]?(b=b.startContainer.childNodes[b.startOffset],a.currentNode=b):b.startOffset===(b.startContainer.nodeType===Node.TEXT_NODE?b.startContainer.length:b.startContainer.childNodes.length)?(b=b.startContainer,a.currentNode=b,a.lastChild(),b=a.nextNode()):(b=b.startContainer,a.currentNode=b);if(b){b=a.currentNode;if(b!==c)for(b=b.parentNode;b&&b!==c;)d(b)===NodeFilter.FILTER_REJECT&&(a.currentNode=b),b=b.parentNode;b=a.currentNode;switch(d(b)){case NodeFilter.FILTER_REJECT:for(b=
a.nextSibling();!b&&a.parentNode();)b=a.nextSibling();break;case NodeFilter.FILTER_SKIP:b=a.nextNode()}for(;b;){d=h.compareDocumentPosition(b);if(0!==d&&0===(d&k))break;e.push(b);b=a.nextNode()}}return e};this.normalizeTextNodes=function(b){b&&b.nextSibling&&(b=q(b,b.nextSibling));b&&b.previousSibling&&q(b.previousSibling,b)};this.rangeContainsNode=function(b,d){var a=d.ownerDocument.createRange(),e=d.ownerDocument.createRange(),h;a.setStart(b.startContainer,b.startOffset);a.setEnd(b.endContainer,
b.endOffset);e.selectNodeContents(d);h=c(a,e);a.detach();e.detach();return h};this.mergeIntoParent=n;this.removeUnwantedNodes=p;this.removeAllChildNodes=function(b){for(;b.firstChild;)b.removeChild(b.firstChild)};this.getElementsByTagNameNS=function(b,d,a){var e=[];b=b.getElementsByTagNameNS(d,a);e.length=a=b.length;for(d=0;d<a;d+=1)e[d]=b.item(d);return e};this.getElementsByTagName=function(b,d){var a=[],e,c,h;e=b.getElementsByTagName(d);a.length=h=e.length;for(c=0;c<h;c+=1)a[c]=e.item(c);return a};
this.containsNode=function(b,d){return b===d||b.contains(d)};this.comparePoints=function(b,d,c,h){if(b===c)return h-d;var k=b.compareDocumentPosition(c);2===k?k=-1:4===k?k=1:10===k?(d=a(b,c),k=d<h?1:-1):(h=a(c,b),k=h<d?-1:1);return k};this.adaptRangeDifferenceToZoomLevel=h;this.translateRect=function(b,d,a){return{top:h(b.top-d.top,a),left:h(b.left-d.left,a),bottom:h(b.bottom-d.top,a),right:h(b.right-d.left,a),width:h(b.width,a),height:h(b.height,a)}};this.getBoundingClientRect=function(b){var a=
b.ownerDocument,e=f(),c=a.body;if((!1===e.unscaledRangeClientRects||e.rangeBCRIgnoresElementBCR)&&b.nodeType===Node.ELEMENT_NODE)return b=b.getBoundingClientRect(),e.elementBCRIgnoresBodyScroll?{left:b.left+c.scrollLeft,right:b.right+c.scrollLeft,top:b.top+c.scrollTop,bottom:b.bottom+c.scrollTop,width:b.width,height:b.height}:b;var h;d?h=d:d=h=a.createRange();e=h;e.selectNode(b);return e.getBoundingClientRect()};this.mapKeyValObjOntoNode=function(b,d,a){Object.keys(d).forEach(function(e){var c=e.split(":"),
h=c[1],c=a(c[0]),k=d[e];c?(h=b.getElementsByTagNameNS(c,h)[0],h||(h=b.ownerDocument.createElementNS(c,e),b.appendChild(h)),h.textContent=k):runtime.log("Key ignored: "+e)})};this.removeKeyElementsFromNode=function(b,d,a){d.forEach(function(d){var m=d.split(":"),e=m[1];(m=a(m[0]))?(e=b.getElementsByTagNameNS(m,e)[0])?e.parentNode.removeChild(e):runtime.log("Element for "+d+" not found."):runtime.log("Property Name ignored: "+d)})};this.getKeyValRepresentationOfNode=function(b,d){for(var a={},e=b.firstElementChild,
c;e;){if(c=d(e.namespaceURI))a[c+":"+e.localName]=e.textContent;e=e.nextElementSibling}return a};this.mapObjOntoNode=b;this.cloneEvent=function(b){var d=Object.create(null);Object.keys(b).forEach(function(a){d[a]=b[a]});d.prototype=b.constructor.prototype;return d};this.getDirectChild=l;(function(b){var d,a;a=runtime.getWindow();null!==a&&(d=a.navigator.appVersion.toLowerCase(),a=-1===d.indexOf("chrome")&&(-1!==d.indexOf("applewebkit")||-1!==d.indexOf("safari")),d=-1!==d.indexOf("msie")||-1!==d.indexOf("trident"),
a||d)&&(b.containsNode=g)})(this)};core.DomUtils=new core.DomUtilsImpl})();core.Cursor=function(f,l){function a(b){b.parentNode&&(n.push(b.previousSibling),n.push(b.nextSibling),b.parentNode.removeChild(b))}function e(b,d,a){if(d.nodeType===Node.TEXT_NODE){runtime.assert(Boolean(d),"putCursorIntoTextNode: invalid container");var e=d.parentNode;runtime.assert(Boolean(e),"putCursorIntoTextNode: container without parent");runtime.assert(0<=a&&a<=d.length,"putCursorIntoTextNode: offset is out of bounds");0===a?e.insertBefore(b,d):(a!==d.length&&d.splitText(a),e.insertBefore(b,
d.nextSibling))}else d.nodeType===Node.ELEMENT_NODE&&d.insertBefore(b,d.childNodes.item(a));n.push(b.previousSibling);n.push(b.nextSibling)}var c=f.createElementNS("urn:webodf:names:cursor","cursor"),k=f.createElementNS("urn:webodf:names:cursor","anchor"),q,n=[],p=f.createRange(),g,h=core.DomUtils;this.getNode=function(){return c};this.getAnchorNode=function(){return k.parentNode?k:c};this.getSelectedRange=function(){g?(p.setStartBefore(c),p.collapse(!0)):(p.setStartAfter(q?k:c),p.setEndBefore(q?
c:k));return p};this.setSelectedRange=function(b,d){p&&p!==b&&p.detach();p=b;q=!1!==d;(g=b.collapsed)?(a(k),a(c),e(c,b.startContainer,b.startOffset)):(a(k),a(c),e(q?c:k,b.endContainer,b.endOffset),e(q?k:c,b.startContainer,b.startOffset));n.forEach(h.normalizeTextNodes);n.length=0};this.hasForwardSelection=function(){return q};this.remove=function(){a(c);n.forEach(h.normalizeTextNodes);n.length=0};c.setAttributeNS("urn:webodf:names:cursor","memberId",l);k.setAttributeNS("urn:webodf:names:cursor","memberId",
l)};core.Destroyable=function(){};core.Destroyable.prototype.destroy=function(f){};core.EventSource=function(){};core.EventSource.prototype.subscribe=function(f,l){};core.EventSource.prototype.unsubscribe=function(f,l){};core.EventNotifier=function(f){function l(e){runtime.assert(!a.hasOwnProperty(e),'Duplicated event ids: "'+e+'" registered more than once.');a[e]=[]}var a={};this.emit=function(e,c){var k,f;runtime.assert(a.hasOwnProperty(e),'unknown event fired "'+e+'"');f=a[e];for(k=0;k<f.length;k+=1)f[k](c)};this.subscribe=function(e,c){runtime.assert(a.hasOwnProperty(e),'tried to subscribe to unknown event "'+e+'"');a[e].push(c)};this.unsubscribe=function(e,c){var k;runtime.assert(a.hasOwnProperty(e),'tried to unsubscribe from unknown event "'+
e+'"');k=a[e].indexOf(c);runtime.assert(-1!==k,'tried to unsubscribe unknown callback from event "'+e+'"');-1!==k&&a[e].splice(k,1)};this.register=l;f&&f.forEach(l)};core.ScheduledTask=function(f,l,a){function e(){q&&(a(k),q=!1)}function c(){e();f.apply(void 0,n);n=null}var k,q=!1,n=[],p=!1;this.trigger=function(){runtime.assert(!1===p,"Can't trigger destroyed ScheduledTask instance");n=Array.prototype.slice.call(arguments);q||(q=!0,k=l(c))};this.triggerImmediate=function(){runtime.assert(!1===p,"Can't trigger destroyed ScheduledTask instance");n=Array.prototype.slice.call(arguments);c()};this.processRequests=function(){q&&c()};this.cancel=e;this.restart=function(){runtime.assert(!1===
p,"Can't trigger destroyed ScheduledTask instance");e();q=!0;k=l(c)};this.destroy=function(a){e();p=!0;a()}};(function(){var f;core.Task={};core.Task.SUPPRESS_MANUAL_PROCESSING=!1;core.Task.processTasks=function(){core.Task.SUPPRESS_MANUAL_PROCESSING||f.performRedraw()};core.Task.createRedrawTask=function(l){return new core.ScheduledTask(l,f.requestRedrawTask,f.cancelRedrawTask)};core.Task.createTimeoutTask=function(f,a){return new core.ScheduledTask(f,function(e){return runtime.setTimeout(e,a)},runtime.clearTimeout)};f=new function(){var f={};this.requestRedrawTask=function(a){var e=runtime.requestAnimationFrame(function(){a();
delete f[e]});f[e]=a;return e};this.performRedraw=function(){Object.keys(f).forEach(function(a){f[a]();runtime.cancelAnimationFrame(parseInt(a,10))});f={}};this.cancelRedrawTask=function(a){runtime.cancelAnimationFrame(a);delete f[a]}}})();core.EventSubscriptions=function(){function f(e,c,k){e.subscribe(c,k);a.push({eventSource:e,eventid:c,callback:k})}function l(){var k=[];a.forEach(function(a){a.eventSource.unsubscribe(a.eventid,a.callback)});a.length=0;Object.keys(c).forEach(function(a){c[a].forEach(function(a){k.push(a.task.destroy)});delete c[a]});core.Async.destroyAll(k,function(){});e=new core.EventNotifier}var a=[],e=new core.EventNotifier,c={},k=0;this.addSubscription=f;this.addFrameSubscription=function(a,n,l){var g,h,b,d;
c.hasOwnProperty(n)||(c[n]=[]);b=c[n];for(d=0;d<b.length;d+=1)if(b[d].eventSource===a){g=b[d];break}g||(h="s"+k,k+=1,e.register(h),g={frameEventId:h,eventSource:a,task:core.Task.createRedrawTask(function(){e.emit(h,void 0)})},b.push(g),f(a,n,g.task.trigger));e.subscribe(g.frameEventId,l)};this.unsubscribeAll=l;this.destroy=function(a){l();a()}};core.LazyProperty=function(f){var l,a=!1;this.value=function(){a||(l=f(),a=!0);return l};this.reset=function(){a=!1}};core.LoopWatchDog=function(f,l){var a=Date.now(),e=0;this.check=function(){var c;if(f&&(c=Date.now(),c-a>f))throw runtime.log("alert","watchdog timeout"),"timeout!";if(0<l&&(e+=1,e>l))throw runtime.log("alert","watchdog loop overflow"),"loop overflow";}};core.NodeFilterChain=function(f){var l=NodeFilter.FILTER_REJECT,a=NodeFilter.FILTER_ACCEPT;this.acceptNode=function(e){var c;for(c=0;c<f.length;c+=1)if(f[c].acceptNode(e)===l)return l;return a}};core.PositionIterator=function(f,l,a,e){function c(){this.acceptNode=function(b){return!b||b.nodeType===r&&0===b.length?t:x}}function k(b){this.acceptNode=function(d){return!d||d.nodeType===r&&0===d.length?t:b.acceptNode(d)}}function q(){var d=h.currentNode,a=d.nodeType;b=a===r?d.length-1:a===m?1:0}function n(){if(null===h.previousSibling()){if(!h.parentNode()||h.currentNode===f)return h.firstChild(),!1;b=0}else q();return!0}function p(){var a=h.currentNode,e;e=d(a);if(a!==f)for(a=a.parentNode;a&&
a!==f;)d(a)===t&&(h.currentNode=a,e=t),a=a.parentNode;e===t?(b=h.currentNode.nodeType===r?a.length:1,a=g.nextPosition()):a=e===x?!0:g.nextPosition();a&&runtime.assert(d(h.currentNode)===x,"moveToAcceptedNode did not result in walker being on an accepted node");return a}var g=this,h,b,d,r=Node.TEXT_NODE,m=Node.ELEMENT_NODE,x=NodeFilter.FILTER_ACCEPT,t=NodeFilter.FILTER_REJECT;this.nextPosition=function(){var d=h.currentNode,a=d.nodeType;if(d===f)return!1;if(0===b&&a===m)null===h.firstChild()&&(b=1);
else if(a===r&&b+1<d.length)b+=1;else if(null!==h.nextSibling())b=0;else if(h.parentNode())b=1;else return!1;return!0};this.previousPosition=function(){var d=!0,a=h.currentNode;0===b?d=n():a.nodeType===r?b-=1:null!==h.lastChild()?q():a===f?d=!1:b=0;return d};this.previousNode=n;this.container=function(){var d=h.currentNode,a=d.nodeType;0===b&&a!==r&&(d=d.parentNode);return d};this.rightNode=function(){var a=h.currentNode,e=a.nodeType;if(e===r&&b===a.length)for(a=a.nextSibling;a&&d(a)!==x;)a=a.nextSibling;
else e===m&&1===b&&(a=null);return a};this.leftNode=function(){var a=h.currentNode;if(0===b)for(a=a.previousSibling;a&&d(a)!==x;)a=a.previousSibling;else if(a.nodeType===m)for(a=a.lastChild;a&&d(a)!==x;)a=a.previousSibling;return a};this.getCurrentNode=function(){return h.currentNode};this.unfilteredDomOffset=function(){if(h.currentNode.nodeType===r)return b;for(var d=0,a=h.currentNode,a=1===b?a.lastChild:a.previousSibling;a;)d+=1,a=a.previousSibling;return d};this.getPreviousSibling=function(){var b=
h.currentNode,d=h.previousSibling();h.currentNode=b;return d};this.getNextSibling=function(){var b=h.currentNode,d=h.nextSibling();h.currentNode=b;return d};this.setPositionBeforeElement=function(d){runtime.assert(Boolean(d),"setPositionBeforeElement called without element");h.currentNode=d;b=0;return p()};this.setUnfilteredPosition=function(d,a){runtime.assert(Boolean(d),"PositionIterator.setUnfilteredPosition called without container");h.currentNode=d;d.nodeType===r?(b=a,runtime.assert(a<=d.length,
"Error in setPosition: "+a+" > "+d.length),runtime.assert(0<=a,"Error in setPosition: "+a+" < 0"),a===d.length&&(h.nextSibling()?b=0:h.parentNode()?b=1:runtime.assert(!1,"Error in setUnfilteredPosition: position not valid."))):a<d.childNodes.length?(h.currentNode=d.childNodes.item(a),b=0):b=1;return p()};this.moveToEnd=function(){h.currentNode=f;b=1};this.moveToEndOfNode=function(d){d.nodeType===r?g.setUnfilteredPosition(d,d.length):(h.currentNode=d,b=1)};this.isBeforeNode=function(){return 0===b};
this.getNodeFilter=function(){return d};d=(a?new k(a):new c).acceptNode;d.acceptNode=d;l=l||NodeFilter.SHOW_ALL;runtime.assert(f.nodeType!==Node.TEXT_NODE,"Internet Explorer doesn't allow tree walker roots to be text nodes");h=f.ownerDocument.createTreeWalker(f,l,d,e);b=0;null===h.firstChild()&&(b=1)};core.PositionFilter=function(){};core.PositionFilter.FilterResult={FILTER_ACCEPT:1,FILTER_REJECT:2,FILTER_SKIP:3};core.PositionFilter.prototype.acceptPosition=function(f){};core.PositionFilterChain=function(){var f=[],l=core.PositionFilter.FilterResult.FILTER_ACCEPT,a=core.PositionFilter.FilterResult.FILTER_REJECT;this.acceptPosition=function(e){var c;for(c=0;c<f.length;c+=1)if(f[c].acceptPosition(e)===a)return a;return l};this.addFilter=function(a){f.push(a)}};(function(){core.RawInflate=function(){var f;(function(l){f=l()})(function(){return function a(e,c,k){function f(n,g){if(!c[n]){if(!e[n])throw Error("Cannot find module '"+n+"'");var h=c[n]={exports:{}};e[n][0].call(h.exports,function(b){var d=e[n][1][b];return f(d?d:b)},h,h.exports,a,e,c,k)}return c[n].exports}for(var n=0;n<k.length;n++)f(k[n]);return f}({1:[function(a,e,c){function k(b,d){var a=new r(d);a.push(b,!0);if(a.err)throw a.msg;return a.result}var f=a("./zlib/inflate.js"),n=a("./utils/common"),
p=a("./utils/strings"),g=a("./zlib/constants"),h=a("./zlib/messages"),b=a("./zlib/zstream"),d=a("./zlib/gzheader"),r=function(a){var e=this.options=n.assign({chunkSize:16384,windowBits:0,to:""},a||{});e.raw&&0<=e.windowBits&&16>e.windowBits&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15));!(0<=e.windowBits&&16>e.windowBits)||a&&a.windowBits||(e.windowBits+=32);15<e.windowBits&&48>e.windowBits&&0===(e.windowBits&15)&&(e.windowBits|=15);this.err=0;this.msg="";this.ended=!1;this.chunks=
[];this.strm=new b;this.strm.avail_out=0;a=f.inflateInit2(this.strm,e.windowBits);if(a!==g.Z_OK)throw Error(h[a]);this.header=new d;f.inflateGetHeader(this.strm,this.header)};r.prototype.push=function(b,d){var a=this.strm,e=this.options.chunkSize,c,h,r,k,A;if(this.ended)return!1;h=d===~~d?d:!0===d?g.Z_FINISH:g.Z_NO_FLUSH;a.input="string"===typeof b?p.binstring2buf(b):b;a.next_in=0;a.avail_in=a.input.length;do{0===a.avail_out&&(a.output=new n.Buf8(e),a.next_out=0,a.avail_out=e);c=f.inflate(a,g.Z_NO_FLUSH);
if(c!==g.Z_STREAM_END&&c!==g.Z_OK)return this.onEnd(c),this.ended=!0,!1;if(a.next_out&&(0===a.avail_out||c===g.Z_STREAM_END||0===a.avail_in&&h===g.Z_FINISH))if("string"===this.options.to)r=p.utf8border(a.output,a.next_out),k=a.next_out-r,A=p.buf2string(a.output,r),a.next_out=k,a.avail_out=e-k,k&&n.arraySet(a.output,a.output,r,k,0),this.onData(A);else this.onData(n.shrinkBuf(a.output,a.next_out))}while((0<a.avail_in||0===a.avail_out)&&c!==g.Z_STREAM_END);c===g.Z_STREAM_END&&(h=g.Z_FINISH);return h===
g.Z_FINISH?(c=f.inflateEnd(this.strm),this.onEnd(c),this.ended=!0,c===g.Z_OK):!0};r.prototype.onData=function(b){this.chunks.push(b)};r.prototype.onEnd=function(b){b===g.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):n.flattenChunks(this.chunks));this.chunks=[];this.err=b;this.msg=this.strm.msg};c.Inflate=r;c.inflate=k;c.inflateRaw=function(b,d){d=d||{};d.raw=!0;return k(b,d)};c.ungzip=k},{"./utils/common":2,"./utils/strings":3,"./zlib/constants":5,"./zlib/gzheader":7,"./zlib/inflate.js":9,
"./zlib/messages":11,"./zlib/zstream":12}],2:[function(a,e,c){a="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Int32Array;c.assign=function(a){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var c=e.shift();if(c){if("object"!==typeof c)throw new TypeError(c+"must be non-object");for(var h in c)c.hasOwnProperty(h)&&(a[h]=c[h])}}return a};c.shrinkBuf=function(a,e){if(a.length===e)return a;if(a.subarray)return a.subarray(0,e);a.length=e;return a};
var k={arraySet:function(a,e,c,h,b){if(e.subarray&&a.subarray)a.set(e.subarray(c,c+h),b);else for(var d=0;d<h;d++)a[b+d]=e[c+d]},flattenChunks:function(a){var e,c,h,b,d;e=h=0;for(c=a.length;e<c;e++)h+=a[e].length;d=new Uint8Array(h);e=h=0;for(c=a.length;e<c;e++)b=a[e],d.set(b,h),h+=b.length;return d}},f={arraySet:function(a,e,c,h,b){for(var d=0;d<h;d++)a[b+d]=e[c+d]},flattenChunks:function(a){return[].concat.apply([],a)}};c.setTyped=function(a){a?(c.Buf8=Uint8Array,c.Buf16=Uint16Array,c.Buf32=Int32Array,
c.assign(c,k)):(c.Buf8=Array,c.Buf16=Array,c.Buf32=Array,c.assign(c,f))};c.setTyped(a)},{}],3:[function(a,e,c){function k(b,a){if(65537>a&&(b.subarray&&p||!b.subarray&&n))return String.fromCharCode.apply(null,f.shrinkBuf(b,a));for(var e="",c=0;c<a;c++)e+=String.fromCharCode(b[c]);return e}var f=a("./common"),n=!0,p=!0;try{String.fromCharCode.apply(null,[0])}catch(g){n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(h){p=!1}var b=new f.Buf8(256);for(a=0;256>a;a++)b[a]=252<=a?6:248<=
a?5:240<=a?4:224<=a?3:192<=a?2:1;b[254]=b[254]=1;c.string2buf=function(b){var a,e,c,h,k,g=b.length,n=0;for(h=0;h<g;h++)e=b.charCodeAt(h),55296===(e&64512)&&h+1<g&&(c=b.charCodeAt(h+1),56320===(c&64512)&&(e=65536+(e-55296<<10)+(c-56320),h++)),n+=128>e?1:2048>e?2:65536>e?3:4;a=new f.Buf8(n);for(h=k=0;k<n;h++)e=b.charCodeAt(h),55296===(e&64512)&&h+1<g&&(c=b.charCodeAt(h+1),56320===(c&64512)&&(e=65536+(e-55296<<10)+(c-56320),h++)),128>e?a[k++]=e:(2048>e?a[k++]=192|e>>>6:(65536>e?a[k++]=224|e>>>12:(a[k++]=
240|e>>>18,a[k++]=128|e>>>12&63),a[k++]=128|e>>>6&63),a[k++]=128|e&63);return a};c.buf2binstring=function(b){return k(b,b.length)};c.binstring2buf=function(b){for(var a=new f.Buf8(b.length),e=0,c=a.length;e<c;e++)a[e]=b.charCodeAt(e);return a};c.buf2string=function(d,a){var e,c,h,g,f=a||d.length,n=Array(2*f);for(e=c=0;e<f;)if(h=d[e++],128>h)n[c++]=h;else if(g=b[h],4<g)n[c++]=65533,e+=g-1;else{for(h&=2===g?31:3===g?15:7;1<g&&e<f;)h=h<<6|d[e++]&63,g--;1<g?n[c++]=65533:65536>h?n[c++]=h:(h-=65536,n[c++]=
55296|h>>10&1023,n[c++]=56320|h&1023)}return k(n,c)};c.utf8border=function(d,a){var e;a=a||d.length;a>d.length&&(a=d.length);for(e=a-1;0<=e&&128===(d[e]&192);)e--;return 0>e||0===e?a:e+b[d[e]]>a?e:a}},{"./common":2}],4:[function(a,e,c){e.exports=function(a,e,c,f){var g=a&65535|0;a=a>>>16&65535|0;for(var h=0;0!==c;){h=2E3<c?2E3:c;c-=h;do g=g+e[f++]|0,a=a+g|0;while(--h);g%=65521;a%=65521}return g|a<<16|0}},{}],5:[function(a,e,c){e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,
Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],6:[function(a,e,c){var k=function(){for(var a,e=[],c=0;256>c;c++){a=c;for(var k=0;8>k;k++)a=a&1?3988292384^a>>>1:a>>>1;e[c]=a}return e}();e.exports=function(a,e,c,g){c=g+c;for(a^=
-1;g<c;g++)a=a>>>8^k[(a^e[g])&255];return a^-1}},{}],7:[function(a,e,c){e.exports=function(){this.os=this.xflags=this.time=this.text=0;this.extra=null;this.extra_len=0;this.comment=this.name="";this.hcrc=0;this.done=!1}},{}],8:[function(a,e,c){e.exports=function(a,e){var c,f,g,h,b,d,r,m,x,t,y,v,s,w,u,A,F,B,E,J,H,Q,N,z;c=a.state;f=a.next_in;N=a.input;g=f+(a.avail_in-5);h=a.next_out;z=a.output;b=h-(e-a.avail_out);d=h+(a.avail_out-257);r=c.dmax;m=c.wsize;x=c.whave;t=c.wnext;y=c.window;v=c.hold;s=c.bits;
w=c.lencode;u=c.distcode;A=(1<<c.lenbits)-1;F=(1<<c.distbits)-1;a:do b:for(15>s&&(v+=N[f++]<<s,s+=8,v+=N[f++]<<s,s+=8),B=w[v&A];;){E=B>>>24;v>>>=E;s-=E;E=B>>>16&255;if(0===E)z[h++]=B&65535;else if(E&16){J=B&65535;if(E&=15)s<E&&(v+=N[f++]<<s,s+=8),J+=v&(1<<E)-1,v>>>=E,s-=E;15>s&&(v+=N[f++]<<s,s+=8,v+=N[f++]<<s,s+=8);B=u[v&F];c:for(;;){E=B>>>24;v>>>=E;s-=E;E=B>>>16&255;if(E&16){B&=65535;E&=15;s<E&&(v+=N[f++]<<s,s+=8,s<E&&(v+=N[f++]<<s,s+=8));B+=v&(1<<E)-1;if(B>r){a.msg="invalid distance too far back";
c.mode=30;break a}v>>>=E;s-=E;E=h-b;if(B>E){E=B-E;if(E>x&&c.sane){a.msg="invalid distance too far back";c.mode=30;break a}H=0;Q=y;if(0===t){if(H+=m-E,E<J){J-=E;do z[h++]=y[H++];while(--E);H=h-B;Q=z}}else if(t<E){if(H+=m+t-E,E-=t,E<J){J-=E;do z[h++]=y[H++];while(--E);H=0;if(t<J){E=t;J-=E;do z[h++]=y[H++];while(--E);H=h-B;Q=z}}}else if(H+=t-E,E<J){J-=E;do z[h++]=y[H++];while(--E);H=h-B;Q=z}for(;2<J;)z[h++]=Q[H++],z[h++]=Q[H++],z[h++]=Q[H++],J-=3;J&&(z[h++]=Q[H++],1<J&&(z[h++]=Q[H++]))}else{H=h-B;do z[h++]=
z[H++],z[h++]=z[H++],z[h++]=z[H++],J-=3;while(2<J);J&&(z[h++]=z[H++],1<J&&(z[h++]=z[H++]))}}else if(0===(E&64)){B=u[(B&65535)+(v&(1<<E)-1)];continue c}else{a.msg="invalid distance code";c.mode=30;break a}break}}else if(0===(E&64)){B=w[(B&65535)+(v&(1<<E)-1)];continue b}else{E&32?c.mode=12:(a.msg="invalid literal/length code",c.mode=30);break a}break}while(f<g&&h<d);J=s>>3;f-=J;s-=J<<3;a.next_in=f;a.next_out=h;a.avail_in=f<g?5+(g-f):5-(f-g);a.avail_out=h<d?257+(d-h):257-(h-d);c.hold=v&(1<<s)-1;c.bits=
s}},{}],9:[function(a,e,c){function k(b){return(b>>>24&255)+(b>>>8&65280)+((b&65280)<<8)+((b&255)<<24)}function f(){this.mode=0;this.last=!1;this.wrap=0;this.havedict=!1;this.total=this.check=this.dmax=this.flags=0;this.head=null;this.wnext=this.whave=this.wsize=this.wbits=0;this.window=null;this.extra=this.offset=this.length=this.bits=this.hold=0;this.distcode=this.lencode=null;this.have=this.ndist=this.nlen=this.ncode=this.distbits=this.lenbits=0;this.next=null;this.lens=new b.Buf16(320);this.work=
new b.Buf16(288);this.distdyn=this.lendyn=null;this.was=this.back=this.sane=0}function n(d){var a;if(!d||!d.state)return y;a=d.state;d.total_in=d.total_out=a.total=0;d.msg="";a.wrap&&(d.adler=a.wrap&1);a.mode=v;a.last=0;a.havedict=0;a.dmax=32768;a.head=null;a.hold=0;a.bits=0;a.lencode=a.lendyn=new b.Buf32(s);a.distcode=a.distdyn=new b.Buf32(w);a.sane=1;a.back=-1;return t}function p(b){var d;if(!b||!b.state)return y;d=b.state;d.wsize=0;d.whave=0;d.wnext=0;return n(b)}function g(b,d){var a,e;if(!b||
!b.state)return y;e=b.state;0>d?(a=0,d=-d):(a=(d>>4)+1,48>d&&(d&=15));if(d&&(8>d||15<d))return y;null!==e.window&&e.wbits!==d&&(e.window=null);e.wrap=a;e.wbits=d;return p(b)}function h(b,d){var a;if(!b)return y;a=new f;b.state=a;a.window=null;a=g(b,d);a!==t&&(b.state=null);return a}var b=a("../utils/common"),d=a("./adler32"),r=a("./crc32"),m=a("./inffast"),x=a("./inftrees"),t=0,y=-2,v=1,s=852,w=592,u=!0,A,F;c.inflateReset=p;c.inflateReset2=g;c.inflateResetKeep=n;c.inflateInit=function(b){return h(b,
15)};c.inflateInit2=h;c.inflate=function(a,e){var c,h,f,g,z,n,q,p,s,w,T,D,O,$;D=0;var C,V,aa,ca,U,W=new b.Buf8(4),P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!a||!a.state||!a.output||!a.input&&0!==a.avail_in)return y;c=a.state;12===c.mode&&(c.mode=13);z=a.next_out;f=a.output;q=a.avail_out;g=a.next_in;h=a.input;n=a.avail_in;p=c.hold;s=c.bits;w=n;T=q;U=t;a:for(;;)switch(c.mode){case v:if(0===c.wrap){c.mode=13;break}for(;16>s;){if(0===n)break a;n--;p+=h[g++]<<s;s+=8}if(c.wrap&2&&35615===p){c.check=
0;W[0]=p&255;W[1]=p>>>8&255;c.check=r(c.check,W,2,0);s=p=0;c.mode=2;break}c.flags=0;c.head&&(c.head.done=!1);if(!(c.wrap&1)||(((p&255)<<8)+(p>>8))%31){a.msg="incorrect header check";c.mode=30;break}if(8!==(p&15)){a.msg="unknown compression method";c.mode=30;break}p>>>=4;s-=4;O=(p&15)+8;if(0===c.wbits)c.wbits=O;else if(O>c.wbits){a.msg="invalid window size";c.mode=30;break}c.dmax=1<<O;a.adler=c.check=1;c.mode=p&512?10:12;s=p=0;break;case 2:for(;16>s;){if(0===n)break a;n--;p+=h[g++]<<s;s+=8}c.flags=
p;if(8!==(c.flags&255)){a.msg="unknown compression method";c.mode=30;break}if(c.flags&57344){a.msg="unknown header flags set";c.mode=30;break}c.head&&(c.head.text=p>>8&1);c.flags&512&&(W[0]=p&255,W[1]=p>>>8&255,c.check=r(c.check,W,2,0));s=p=0;c.mode=3;case 3:for(;32>s;){if(0===n)break a;n--;p+=h[g++]<<s;s+=8}c.head&&(c.head.time=p);c.flags&512&&(W[0]=p&255,W[1]=p>>>8&255,W[2]=p>>>16&255,W[3]=p>>>24&255,c.check=r(c.check,W,4,0));s=p=0;c.mode=4;case 4:for(;16>s;){if(0===n)break a;n--;p+=h[g++]<<s;s+=
8}c.head&&(c.head.xflags=p&255,c.head.os=p>>8);c.flags&512&&(W[0]=p&255,W[1]=p>>>8&255,c.check=r(c.check,W,2,0));s=p=0;c.mode=5;case 5:if(c.flags&1024){for(;16>s;){if(0===n)break a;n--;p+=h[g++]<<s;s+=8}c.length=p;c.head&&(c.head.extra_len=p);c.flags&512&&(W[0]=p&255,W[1]=p>>>8&255,c.check=r(c.check,W,2,0));s=p=0}else c.head&&(c.head.extra=null);c.mode=6;case 6:if(c.flags&1024&&(D=c.length,D>n&&(D=n),D&&(c.head&&(O=c.head.extra_len-c.length,c.head.extra||(c.head.extra=Array(c.head.extra_len)),b.arraySet(c.head.extra,
h,g,D,O)),c.flags&512&&(c.check=r(c.check,h,D,g)),n-=D,g+=D,c.length-=D),c.length))break a;c.length=0;c.mode=7;case 7:if(c.flags&2048){if(0===n)break a;D=0;do O=h[g+D++],c.head&&O&&65536>c.length&&(c.head.name+=String.fromCharCode(O));while(O&&D<n);c.flags&512&&(c.check=r(c.check,h,D,g));n-=D;g+=D;if(O)break a}else c.head&&(c.head.name=null);c.length=0;c.mode=8;case 8:if(c.flags&4096){if(0===n)break a;D=0;do O=h[g+D++],c.head&&O&&65536>c.length&&(c.head.comment+=String.fromCharCode(O));while(O&&D<
n);c.flags&512&&(c.check=r(c.check,h,D,g));n-=D;g+=D;if(O)break a}else c.head&&(c.head.comment=null);c.mode=9;case 9:if(c.flags&512){for(;16>s;){if(0===n)break a;n--;p+=h[g++]<<s;s+=8}if(p!==(c.check&65535)){a.msg="header crc mismatch";c.mode=30;break}s=p=0}c.head&&(c.head.hcrc=c.flags>>9&1,c.head.done=!0);a.adler=c.check=0;c.mode=12;break;case 10:for(;32>s;){if(0===n)break a;n--;p+=h[g++]<<s;s+=8}a.adler=c.check=k(p);s=p=0;c.mode=11;case 11:if(0===c.havedict)return a.next_out=z,a.avail_out=q,a.next_in=
g,a.avail_in=n,c.hold=p,c.bits=s,2;a.adler=c.check=1;c.mode=12;case 12:if(5===e||6===e)break a;case 13:if(c.last){p>>>=s&7;s-=s&7;c.mode=27;break}for(;3>s;){if(0===n)break a;n--;p+=h[g++]<<s;s+=8}c.last=p&1;p>>>=1;s-=1;switch(p&3){case 0:c.mode=14;break;case 1:D=c;if(u){O=void 0;A=new b.Buf32(512);F=new b.Buf32(32);for(O=0;144>O;)D.lens[O++]=8;for(;256>O;)D.lens[O++]=9;for(;280>O;)D.lens[O++]=7;for(;288>O;)D.lens[O++]=8;x(1,D.lens,0,288,A,0,D.work,{bits:9});for(O=0;32>O;)D.lens[O++]=5;x(2,D.lens,
0,32,F,0,D.work,{bits:5});u=!1}D.lencode=A;D.lenbits=9;D.distcode=F;D.distbits=5;c.mode=20;if(6===e){p>>>=2;s-=2;break a}break;case 2:c.mode=17;break;case 3:a.msg="invalid block type",c.mode=30}p>>>=2;s-=2;break;case 14:p>>>=s&7;for(s-=s&7;32>s;){if(0===n)break a;n--;p+=h[g++]<<s;s+=8}if((p&65535)!==(p>>>16^65535)){a.msg="invalid stored block lengths";c.mode=30;break}c.length=p&65535;s=p=0;c.mode=15;if(6===e)break a;case 15:c.mode=16;case 16:if(D=c.length){D>n&&(D=n);D>q&&(D=q);if(0===D)break a;b.arraySet(f,
h,g,D,z);n-=D;g+=D;q-=D;z+=D;c.length-=D;break}c.mode=12;break;case 17:for(;14>s;){if(0===n)break a;n--;p+=h[g++]<<s;s+=8}c.nlen=(p&31)+257;p>>>=5;s-=5;c.ndist=(p&31)+1;p>>>=5;s-=5;c.ncode=(p&15)+4;p>>>=4;s-=4;if(286<c.nlen||30<c.ndist){a.msg="too many length or distance symbols";c.mode=30;break}c.have=0;c.mode=18;case 18:for(;c.have<c.ncode;){for(;3>s;){if(0===n)break a;n--;p+=h[g++]<<s;s+=8}c.lens[P[c.have++]]=p&7;p>>>=3;s-=3}for(;19>c.have;)c.lens[P[c.have++]]=0;c.lencode=c.lendyn;c.lenbits=7;
D={bits:c.lenbits};U=x(0,c.lens,0,19,c.lencode,0,c.work,D);c.lenbits=D.bits;if(U){a.msg="invalid code lengths set";c.mode=30;break}c.have=0;c.mode=19;case 19:for(;c.have<c.nlen+c.ndist;){for(;;){D=c.lencode[p&(1<<c.lenbits)-1];C=D>>>24;V=D>>>16&255;aa=D&65535;if(C<=s)break;if(0===n)break a;n--;p+=h[g++]<<s;s+=8}if(16>aa)p>>>=C,s-=C,c.lens[c.have++]=aa;else{if(16===aa){for(D=C+2;s<D;){if(0===n)break a;n--;p+=h[g++]<<s;s+=8}p>>>=C;s-=C;if(0===c.have){a.msg="invalid bit length repeat";c.mode=30;break}O=
c.lens[c.have-1];D=3+(p&3);p>>>=2;s-=2}else if(17===aa){for(D=C+3;s<D;){if(0===n)break a;n--;p+=h[g++]<<s;s+=8}p>>>=C;s-=C;O=0;D=3+(p&7);p>>>=3;s-=3}else{for(D=C+7;s<D;){if(0===n)break a;n--;p+=h[g++]<<s;s+=8}p>>>=C;s-=C;O=0;D=11+(p&127);p>>>=7;s-=7}if(c.have+D>c.nlen+c.ndist){a.msg="invalid bit length repeat";c.mode=30;break}for(;D--;)c.lens[c.have++]=O}}if(30===c.mode)break;if(0===c.lens[256]){a.msg="invalid code -- missing end-of-block";c.mode=30;break}c.lenbits=9;D={bits:c.lenbits};U=x(1,c.lens,
0,c.nlen,c.lencode,0,c.work,D);c.lenbits=D.bits;if(U){a.msg="invalid literal/lengths set";c.mode=30;break}c.distbits=6;c.distcode=c.distdyn;D={bits:c.distbits};U=x(2,c.lens,c.nlen,c.ndist,c.distcode,0,c.work,D);c.distbits=D.bits;if(U){a.msg="invalid distances set";c.mode=30;break}c.mode=20;if(6===e)break a;case 20:c.mode=21;case 21:if(6<=n&&258<=q){a.next_out=z;a.avail_out=q;a.next_in=g;a.avail_in=n;c.hold=p;c.bits=s;m(a,T);z=a.next_out;f=a.output;q=a.avail_out;g=a.next_in;h=a.input;n=a.avail_in;
p=c.hold;s=c.bits;12===c.mode&&(c.back=-1);break}for(c.back=0;;){D=c.lencode[p&(1<<c.lenbits)-1];C=D>>>24;V=D>>>16&255;aa=D&65535;if(C<=s)break;if(0===n)break a;n--;p+=h[g++]<<s;s+=8}if(V&&0===(V&240)){O=C;$=V;for(ca=aa;;){D=c.lencode[ca+((p&(1<<O+$)-1)>>O)];C=D>>>24;V=D>>>16&255;aa=D&65535;if(O+C<=s)break;if(0===n)break a;n--;p+=h[g++]<<s;s+=8}p>>>=O;s-=O;c.back+=O}p>>>=C;s-=C;c.back+=C;c.length=aa;if(0===V){c.mode=26;break}if(V&32){c.back=-1;c.mode=12;break}if(V&64){a.msg="invalid literal/length code";
c.mode=30;break}c.extra=V&15;c.mode=22;case 22:if(c.extra){for(D=c.extra;s<D;){if(0===n)break a;n--;p+=h[g++]<<s;s+=8}c.length+=p&(1<<c.extra)-1;p>>>=c.extra;s-=c.extra;c.back+=c.extra}c.was=c.length;c.mode=23;case 23:for(;;){D=c.distcode[p&(1<<c.distbits)-1];C=D>>>24;V=D>>>16&255;aa=D&65535;if(C<=s)break;if(0===n)break a;n--;p+=h[g++]<<s;s+=8}if(0===(V&240)){O=C;$=V;for(ca=aa;;){D=c.distcode[ca+((p&(1<<O+$)-1)>>O)];C=D>>>24;V=D>>>16&255;aa=D&65535;if(O+C<=s)break;if(0===n)break a;n--;p+=h[g++]<<
s;s+=8}p>>>=O;s-=O;c.back+=O}p>>>=C;s-=C;c.back+=C;if(V&64){a.msg="invalid distance code";c.mode=30;break}c.offset=aa;c.extra=V&15;c.mode=24;case 24:if(c.extra){for(D=c.extra;s<D;){if(0===n)break a;n--;p+=h[g++]<<s;s+=8}c.offset+=p&(1<<c.extra)-1;p>>>=c.extra;s-=c.extra;c.back+=c.extra}if(c.offset>c.dmax){a.msg="invalid distance too far back";c.mode=30;break}c.mode=25;case 25:if(0===q)break a;D=T-q;if(c.offset>D){D=c.offset-D;if(D>c.whave&&c.sane){a.msg="invalid distance too far back";c.mode=30;break}D>
c.wnext?(D-=c.wnext,O=c.wsize-D):O=c.wnext-D;D>c.length&&(D=c.length);$=c.window}else $=f,O=z-c.offset,D=c.length;D>q&&(D=q);q-=D;c.length-=D;do f[z++]=$[O++];while(--D);0===c.length&&(c.mode=21);break;case 26:if(0===q)break a;f[z++]=c.length;q--;c.mode=21;break;case 27:if(c.wrap){for(;32>s;){if(0===n)break a;n--;p|=h[g++]<<s;s+=8}T-=q;a.total_out+=T;c.total+=T;T&&(a.adler=c.check=c.flags?r(c.check,f,T,z-T):d(c.check,f,T,z-T));T=q;if((c.flags?p:k(p))!==c.check){a.msg="incorrect data check";c.mode=
30;break}s=p=0}c.mode=28;case 28:if(c.wrap&&c.flags){for(;32>s;){if(0===n)break a;n--;p+=h[g++]<<s;s+=8}if(p!==(c.total&4294967295)){a.msg="incorrect length check";c.mode=30;break}s=p=0}c.mode=29;case 29:U=1;break a;case 30:U=-3;break a;case 31:return-4;default:return y}a.next_out=z;a.avail_out=q;a.next_in=g;a.avail_in=n;c.hold=p;c.bits=s;if(c.wsize||T!==a.avail_out&&30>c.mode&&(27>c.mode||4!==e))h=a.output,g=a.next_out,z=T-a.avail_out,q=a.state,null===q.window&&(q.wsize=1<<q.wbits,q.wnext=0,q.whave=
0,q.window=new b.Buf8(q.wsize)),z>=q.wsize?(b.arraySet(q.window,h,g-q.wsize,q.wsize,0),q.wnext=0,q.whave=q.wsize):(n=q.wsize-q.wnext,n>z&&(n=z),b.arraySet(q.window,h,g-z,n,q.wnext),(z-=n)?(b.arraySet(q.window,h,g-z,z,0),q.wnext=z,q.whave=q.wsize):(q.wnext+=n,q.wnext===q.wsize&&(q.wnext=0),q.whave<q.wsize&&(q.whave+=n)));w-=a.avail_in;T-=a.avail_out;a.total_in+=w;a.total_out+=T;c.total+=T;c.wrap&&T&&(a.adler=c.check=c.flags?r(c.check,f,T,a.next_out-T):d(c.check,f,T,a.next_out-T));a.data_type=c.bits+
(c.last?64:0)+(12===c.mode?128:0)+(20===c.mode||15===c.mode?256:0);(0===w&&0===T||4===e)&&U===t&&(U=-5);return U};c.inflateEnd=function(b){if(!b||!b.state)return y;var d=b.state;d.window&&(d.window=null);b.state=null;return t};c.inflateGetHeader=function(b,d){var a;if(!b||!b.state)return y;a=b.state;if(0===(a.wrap&2))return y;a.head=d;d.done=!1;return t};c.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":2,"./adler32":4,"./crc32":6,"./inffast":8,"./inftrees":10}],10:[function(a,
e,c){var k=a("../utils/common"),f=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],n=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],p=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],g=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(a,b,d,c,e,x,t,y){for(var v=y.bits,s=0,w=
0,u=0,A=0,F=0,B=0,E=0,J=0,H=0,Q=0,N,z,Z=null,R=0,I,G=new k.Buf16(16),B=new k.Buf16(16),ba=null,T=0,D,O,$,s=0;15>=s;s++)G[s]=0;for(w=0;w<c;w++)G[b[d+w]]++;F=v;for(A=15;1<=A&&0===G[A];A--);F>A&&(F=A);if(0===A)return e[x++]=20971520,e[x++]=20971520,y.bits=1,0;for(u=1;u<A&&0===G[u];u++);F<u&&(F=u);for(s=J=1;15>=s;s++)if(J<<=1,J-=G[s],0>J)return-1;if(0<J&&(0===a||1!==A))return-1;B[1]=0;for(s=1;15>s;s++)B[s+1]=B[s]+G[s];for(w=0;w<c;w++)0!==b[d+w]&&(t[B[b[d+w]]++]=w);switch(a){case 0:Z=ba=t;I=19;break;case 1:Z=
f;R-=257;ba=n;T-=257;I=256;break;default:Z=p,ba=g,I=-1}w=Q=0;s=u;v=x;B=F;E=0;z=-1;H=1<<F;c=H-1;if(1===a&&852<H||2===a&&592<H)return 1;for(var C=0;;){C++;D=s-E;t[w]<I?(O=0,$=t[w]):t[w]>I?(O=ba[T+t[w]],$=Z[R+t[w]]):(O=96,$=0);J=1<<s-E;u=N=1<<B;do N-=J,e[v+(Q>>E)+N]=D<<24|O<<16|$|0;while(0!==N);for(J=1<<s-1;Q&J;)J>>=1;0!==J?(Q&=J-1,Q+=J):Q=0;w++;if(0===--G[s]){if(s===A)break;s=b[d+t[w]]}if(s>F&&(Q&c)!==z){0===E&&(E=F);v+=u;B=s-E;for(J=1<<B;B+E<A;){J-=G[B+E];if(0>=J)break;B++;J<<=1}H+=1<<B;if(1===a&&
852<H||2===a&&592<H)return 1;z=Q&c;e[z]=F<<24|B<<16|v-x|0}}0!==Q&&(e[v+Q]=s-E<<24|4194304);y.bits=F;return 0}},{"../utils/common":2}],11:[function(a,e,c){e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],12:[function(a,e,c){e.exports=function(){this.input=null;this.total_in=this.avail_in=this.next_in=0;this.output=null;this.total_out=this.avail_out=this.next_out=
0;this.msg="";this.state=null;this.data_type=2;this.adler=0}},{}]},{},[1])(1)});return{inflate:function(l,a){return f.inflateRaw(l)}}}()})();core.StepDirection={PREVIOUS:1,NEXT:2};core.StepIterator=function(f,l){function a(){b=null;r=d=void 0}function e(){void 0===r&&(r=f.acceptPosition(l)===g);return r}function c(b,d){a();return l.setUnfilteredPosition(b,d)}function k(){b||(b=l.container());return b}function q(){void 0===d&&(d=l.unfilteredDomOffset());return d}function n(){for(a();l.nextPosition();)if(a(),e())return!0;return!1}function p(){for(a();l.previousPosition();)if(a(),e())return!0;return!1}var g=core.PositionFilter.FilterResult.FILTER_ACCEPT,h=core.StepDirection.NEXT,
b,d,r;this.isStep=e;this.setPosition=c;this.container=k;this.offset=q;this.nextStep=n;this.previousStep=p;this.advanceStep=function(b){return b===h?n():p()};this.roundToClosestStep=function(){var b,d,a=e();a||(b=k(),d=q(),a=p(),a||(c(b,d),a=n()));return a};this.roundToPreviousStep=function(){var b=e();b||(b=p());return b};this.roundToNextStep=function(){var b=e();b||(b=n());return b};this.leftNode=function(){return l.leftNode()};this.snapshot=function(){return new core.StepIterator.StepSnapshot(k(),
q())};this.restore=function(b){c(b.container,b.offset)}};core.StepIterator.StepSnapshot=function(f,l){this.container=f;this.offset=l};core.Utils=function(){function f(l,a){if(a&&Array.isArray(a)){l=l||[];if(!Array.isArray(l))throw"Destination is not an array.";l=l.concat(a.map(function(a){return f(null,a)}))}else if(a&&"object"===typeof a){l=l||{};if("object"!==typeof l)throw"Destination is not an object.";Object.keys(a).forEach(function(e){l[e]=f(l[e],a[e])})}else l=a;return l}this.hashString=function(f){var a=0,e,c;e=0;for(c=f.length;e<c;e+=1)a=(a<<5)-a+f.charCodeAt(e),a|=0;return a};this.mergeObjects=function(l,a){Object.keys(a).forEach(function(e){l[e]=
f(l[e],a[e])});return l}};core.Zip=function(f,l){function a(b,a,d){x?d(null,x.subarray(b,b+a)):d("File data not loaded",null)}function e(b){var a=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,
1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,
1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,
1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,
628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,
3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918E3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],d,c,e=b.length,h=0,h=0;d=-1;for(c=0;c<e;c+=1)h=(d^b[c])&255,h=a[h],d=d>>>8^h;return d^-1}function c(b){return new Date((b>>25&127)+1980,(b>>21&15)-1,b>>16&31,b>>11&15,
b>>5&63,(b&31)<<1)}function k(b){var d=b.getFullYear();return 1980>d?0:d-1980<<25|b.getMonth()+1<<21|b.getDate()<<16|b.getHours()<<11|b.getMinutes()<<5|b.getSeconds()>>1}function q(b,d){var e,h,m,r,g,k,f,n=this;this.load=function(d){if(null!==n.data)d(null,n.data);else{var c=g+34+h+m+256;c+f>t&&(c=t-f);a(f,c,function(a,c){if(a||null===c)d(a,c);else a:{var e=c,h=new core.ByteArray(e),m=h.readUInt32LE(),f;if(67324752!==m)d("File entry signature is wrong."+m.toString()+" "+e.length.toString(),null);
else{h.pos+=22;m=h.readUInt16LE();f=h.readUInt16LE();h.pos+=m+f;if(r){e=e.subarray(h.pos,h.pos+g);if(g!==e.length){d("The amount of compressed bytes read was "+e.length.toString()+" instead of "+g.toString()+" for "+n.filename+" in "+b+".",null);break a}e=v(e,k)}else e=e.subarray(h.pos,h.pos+k);k!==e.length?d("The amount of bytes read was "+e.length.toString()+" instead of "+k.toString()+" for "+n.filename+" in "+b+".",null):(n.data=e,d(null,e))}}})}};this.set=function(b,d,a,c){n.filename=b;n.data=
d;n.compressed=a;n.date=c};this.error=null;d&&(e=d.readUInt32LE(),33639248!==e?this.error="Central directory entry has wrong signature at position "+(d.pos-4).toString()+' for file "'+b+'": '+d.data.length.toString():(d.pos+=6,r=d.readUInt16LE(),this.date=c(d.readUInt32LE()),d.readUInt32LE(),g=d.readUInt32LE(),k=d.readUInt32LE(),h=d.readUInt16LE(),m=d.readUInt16LE(),e=d.readUInt16LE(),d.pos+=8,f=d.readUInt32LE(),this.filename=runtime.byteArrayToString(d.data.subarray(d.pos,d.pos+h),"utf8"),this.data=
null,d.pos+=h+m+e))}function n(b,d){if(22!==b.length)d("Central directory length should be 22.",s);else{var c=new core.ByteArray(b),e;e=c.readUInt32LE();101010256!==e?d("Central directory signature is wrong: "+e.toString(),s):(e=c.readUInt16LE(),0!==e?d("Zip files with non-zero disk numbers are not supported.",s):(e=c.readUInt16LE(),0!==e?d("Zip files with non-zero disk numbers are not supported.",s):(e=c.readUInt16LE(),y=c.readUInt16LE(),e!==y?d("Number of entries is inconsistent.",s):(e=c.readUInt32LE(),
c=c.readUInt16LE(),c=t-22-e,a(c,t-c,function(b,a){if(b||null===a)d(b,s);else a:{var c=new core.ByteArray(a),e,h;m=[];for(e=0;e<y;e+=1){h=new q(f,c);if(h.error){d(h.error,s);break a}m[m.length]=h}d(null,s)}})))))}}function p(b,d){var a=null,c,e;for(e=0;e<m.length;e+=1)if(c=m[e],c.filename===b){a=c;break}a?a.data?d(null,a.data):a.load(d):d(b+" not found.",null)}function g(b){var d=new core.ByteArrayWriter("utf8"),a=0;d.appendArray([80,75,3,4,20,0,0,0,0,0]);b.data&&(a=b.data.length);d.appendUInt32LE(k(b.date));
d.appendUInt32LE(b.data?e(b.data):0);d.appendUInt32LE(a);d.appendUInt32LE(a);d.appendUInt16LE(b.filename.length);d.appendUInt16LE(0);d.appendString(b.filename);b.data&&d.appendByteArray(b.data);return d}function h(b,d){var a=new core.ByteArrayWriter("utf8"),c=0;a.appendArray([80,75,1,2,20,0,20,0,0,0,0,0]);b.data&&(c=b.data.length);a.appendUInt32LE(k(b.date));a.appendUInt32LE(b.data?e(b.data):0);a.appendUInt32LE(c);a.appendUInt32LE(c);a.appendUInt16LE(b.filename.length);a.appendArray([0,0,0,0,0,0,
0,0,0,0,0,0]);a.appendUInt32LE(d);a.appendString(b.filename);return a}function b(d,a){if(d===m.length)a(null);else{var c=m[d];null!==c.data?b(d+1,a):c.load(function(c){c?a(c):b(d+1,a)})}}function d(d,a){b(0,function(b){if(b)a(b);else{var c,e,r=new core.ByteArrayWriter("utf8"),k=[0];for(c=0;c<m.length;c+=1)r.appendByteArrayWriter(g(m[c])),k.push(r.getLength());b=r.getLength();for(c=0;c<m.length;c+=1)e=m[c],r.appendByteArrayWriter(h(e,k[c]));c=r.getLength()-b;r.appendArray([80,75,5,6,0,0,0,0]);r.appendUInt16LE(m.length);
r.appendUInt16LE(m.length);r.appendUInt32LE(c);r.appendUInt32LE(b);r.appendArray([0,0]);d(r.getByteArray())}})}function r(b,a){d(function(d){runtime.writeFile(b,d,function(b){b||(x=d,t=x.length);a(b)})},a)}var m,x,t,y,v=core.RawInflate.inflate,s=this,w=new core.Base64;this.load=p;this.save=function(b,d,a,c){var e,h;for(e=0;e<m.length;e+=1)if(h=m[e],h.filename===b){h.set(b,d,a,c);return}h=new q(f);h.set(b,d,a,c);m.push(h)};this.remove=function(b){var d,a;for(d=0;d<m.length;d+=1)if(a=m[d],a.filename===
b)return m.splice(d,1),!0;return!1};this.write=function(b){r(f,b)};this.writeAs=r;this.createByteArray=d;this.loadContentXmlAsFragments=function(b,d){s.loadAsString(b,function(b,a){if(b)return d.rootElementReady(b);d.rootElementReady(null,a,!0)})};this.loadAsString=function(b,d){p(b,function(b,a){if(b||null===a)return d(b,null);var c=runtime.byteArrayToString(a,"utf8");d(null,c)})};this.loadAsDOM=function(b,d){s.loadAsString(b,function(b,a){if(b||null===a)d(b,null);else{var c=(new DOMParser).parseFromString(a,
"text/xml");d(null,c)}})};this.loadAsDataURL=function(b,d,a){p(b,function(b,c){if(b||!c)return a(b,null);var e=0,h;d||(d=80===c[1]&&78===c[2]&&71===c[3]?"image/png":255===c[0]&&216===c[1]&&255===c[2]?"image/jpeg":71===c[0]&&73===c[1]&&70===c[2]?"image/gif":"");for(h="data:"+d+";base64,";e<c.length;)h+=w.convertUTF8ArrayToBase64(c.subarray(e,Math.min(e+45E3,c.length))),e+=45E3;a(null,h)})};this.getEntries=function(){return m.slice()};t=-1;null===l?m=[]:runtime.readFile(f,"binary",function(b,d){"string"===
typeof d&&(b="file was read as a string. Should be Uint8Array.");b||!d||0===d.length?l("File '"+f+"' cannot be read. Err: "+(b||"[none]"),s):(x=d,t=x.length,a(t-22,22,function(b,d){b||null===d?l(b,s):n(d,l)}))})};core.SimpleClientRect=null;gui.CommonConstraints={EDIT:{ANNOTATIONS:{ONLY_DELETE_OWN:"onlyDeleteOwn"},REVIEW_MODE:"reviewMode"}};gui.SessionConstraints=function(){function f(e){l.hasOwnProperty(e)||(l[e]=!1,a.register(e))}var l={},a=new core.EventNotifier;this.registerConstraint=f;this.subscribe=function(e,c){f(e);a.subscribe(e,c)};this.unsubscribe=function(e,c){a.unsubscribe(e,c)};this.setState=function(e,c){runtime.assert(!0===l.hasOwnProperty(e),"No such constraint");l[e]!==c&&(l[e]=c,a.emit(e,c))};this.getState=function(a){runtime.assert(!0===l.hasOwnProperty(a),"No such constraint");return l[a]}};gui.BlacklistNamespaceNodeFilter=function(f){var l={},a=NodeFilter.FILTER_REJECT,e=NodeFilter.FILTER_ACCEPT;this.acceptNode=function(c){return!c||l.hasOwnProperty(c.namespaceURI)?a:e};(function(){f.forEach(function(a){l[a]=!0})})()};odf.Namespaces={namespaceMap:{config:"urn:oasis:names:tc:opendocument:xmlns:config:1.0",db:"urn:oasis:names:tc:opendocument:xmlns:database:1.0",dc:"http://purl.org/dc/elements/1.1/",dr3d:"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0",draw:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",chart:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",fo:"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0",form:"urn:oasis:names:tc:opendocument:xmlns:form:1.0",math:"http://www.w3.org/1998/Math/MathML",
meta:"urn:oasis:names:tc:opendocument:xmlns:meta:1.0",number:"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0",office:"urn:oasis:names:tc:opendocument:xmlns:office:1.0",presentation:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",style:"urn:oasis:names:tc:opendocument:xmlns:style:1.0",svg:"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0",table:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",text:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",xforms:"http://www.w3.org/2002/xforms",
xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"},prefixMap:{},configns:"urn:oasis:names:tc:opendocument:xmlns:config:1.0",dbns:"urn:oasis:names:tc:opendocument:xmlns:database:1.0",dcns:"http://purl.org/dc/elements/1.1/",dr3dns:"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0",drawns:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",chartns:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",fons:"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0",formns:"urn:oasis:names:tc:opendocument:xmlns:form:1.0",
mathns:"http://www.w3.org/1998/Math/MathML",metans:"urn:oasis:names:tc:opendocument:xmlns:meta:1.0",numberns:"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0",officens:"urn:oasis:names:tc:opendocument:xmlns:office:1.0",presentationns:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",stylens:"urn:oasis:names:tc:opendocument:xmlns:style:1.0",svgns:"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0",tablens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",textns:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",
xformsns:"http://www.w3.org/2002/xforms",xlinkns:"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/XML/1998/namespace"};(function(){var f=odf.Namespaces.namespaceMap,l=odf.Namespaces.prefixMap,a;for(a in f)f.hasOwnProperty(a)&&(l[f[a]]=a)})();odf.Namespaces.forEachPrefix=function(f){var l=odf.Namespaces.namespaceMap,a;for(a in l)l.hasOwnProperty(a)&&f(a,l[a])};
odf.Namespaces.lookupNamespaceURI=function(f){var l=null;odf.Namespaces.namespaceMap.hasOwnProperty(f)&&(l=odf.Namespaces.namespaceMap[f]);return l};odf.Namespaces.lookupPrefix=function(f){var l=odf.Namespaces.prefixMap;return l.hasOwnProperty(f)?l[f]:null};odf.Namespaces.lookupNamespaceURI.lookupNamespaceURI=odf.Namespaces.lookupNamespaceURI;(function(){odf.OdfSchemaImpl=function(){var f=[["config:config-item","uncategorized"],["form:item","object"],["form:option","uncategorized"],["math:math","field"],["meta:user-defined","uncategorized"],["number:currency-symbol","uncategorized"],["number:embedded-text","uncategorized"],["number:text","uncategorized"],["presentation:date-time-decl","uncategorized"],["presentation:footer-decl","uncategorized"],["presentation:header-decl","uncategorized"],["svg:desc","text"],["svg:title","text"],["table:desc",
"uncategorized"],["table:title","uncategorized"],["text:a","text"],["text:author-initials","field"],["text:author-name","field"],["text:bibliography-mark","field"],["text:bookmark-ref","field"],["text:chapter","field"],["text:character-count","field"],["text:conditional-text","field"],["text:creation-date","field"],["text:creation-time","field"],["text:creator","field"],["text:database-display","field"],["text:database-name","field"],["text:database-row-number","field"],["text:date","field"],["text:dde-connection",
"field"],["text:description","field"],["text:editing-cycles","field"],["text:editing-duration","field"],["text:execute-macro","uncategorized"],["text:expression","uncategorized"],["text:file-name","field"],["text:h","text"],["text:hidden-paragraph","text"],["text:hidden-text","text"],["text:image-count","field"],["text:index-entry-span","uncategorized"],["text:index-title-template","uncategorized"],["text:initial-creator","field"],["text:keywords","field"],["text:linenumbering-separator","style"],
["text:measure","uncategorized"],["text:meta","uncategorized"],["text:meta-field","uncategorized"],["text:modification-date","field"],["text:modification-time","field"],["text:note-citation","field"],["text:note-continuation-notice-backward","style"],["text:note-continuation-notice-forward","style"],["text:note-ref","field"],["text:object-count","field"],["text:p","text"],["text:page-continuation","uncategorized"],["text:page-count","field"],["text:page-number","field"],["text:page-variable-get",
"field"],["text:page-variable-set","field"],["text:paragraph-count","field"],["text:placeholder","field"],["text:print-date","field"],["text:print-time","field"],["text:printed-by","field"],["text:reference-ref","field"],["text:ruby-base","text"],["text:ruby-text","text"],["text:script","text"],["text:sender-city","field"],["text:sender-company","field"],["text:sender-country","field"],["text:sender-email","field"],["text:sender-fax","field"],["text:sender-firstname","field"],["text:sender-initials",
"field"],["text:sender-lastname","field"],["text:sender-phone-private","field"],["text:sender-phone-work","field"],["text:sender-position","field"],["text:sender-postal-code","field"],["text:sender-state-or-province","field"],["text:sender-street","field"],["text:sender-title","field"],["text:sequence","uncategorized"],["text:sequence-ref","uncategorized"],["text:sheet-name","uncategorized"],["text:span","text"],["text:subject","field"],["text:table-count","field"],["text:table-formula","deprecated"],
["text:template-name","uncategorized"],["text:text-input","field"],["text:time","field"],["text:title","field"],["text:user-defined","field"],["text:user-field-get","field"],["text:user-field-input","field"],["text:variable-get","field"],["text:variable-input","field"],["text:variable-set","field"],["text:word-count","field"],["xforms:model","uncategorized"]],l={};this.isTextContainer=function(a,e){return"text"===l[a+":"+e]};this.isField=function(a,e){return"field"===l[a+":"+e]};this.getFields=function(){return f.filter(function(a){return"field"===
a[1]}).map(function(a){return a[0]})};(function(){f.forEach(function(a){var e=a[1],c=a[0].split(":");a=c[0];var c=c[1],k=odf.Namespaces.lookupNamespaceURI(a);k?l[k+":"+c]=e:runtime.log("DEBUG: OdfSchema - unknown prefix '"+a+"'")})})()};odf.OdfSchema=new odf.OdfSchemaImpl})();odf.OdfUtilsImpl=function(){function f(b){return"image"===(b&&b.localName)&&b.namespaceURI===R}function l(b){return null!==b&&b.nodeType===Node.ELEMENT_NODE&&"frame"===b.localName&&b.namespaceURI===R&&"as-char"===b.getAttributeNS(Z,"anchor-type")}function a(b){var d;(d="annotation"===(b&&b.localName)&&b.namespaceURI===odf.Namespaces.officens)||(d="div"===(b&&b.localName)&&"annotationWrapper"===b.className);return d}function e(b){return"a"===(b&&b.localName)&&b.namespaceURI===Z}function c(b){var d=
b&&b.localName;return("p"===d||"h"===d)&&b.namespaceURI===Z}function k(b,d){for(b&&void 0!==d&&!c(b)&&b.childNodes.item(d)&&(b=b.childNodes.item(d));b&&!c(b);)b=b.parentNode;return b}function q(b,d){for(;b&&b!==d;){if(b.namespaceURI===odf.Namespaces.officens&&"annotation"===b.localName)return b;b=b.parentNode}return null}function n(b){return/^[ \t\r\n]+$/.test(b)}function p(b){if(null===b||b.nodeType!==Node.ELEMENT_NODE)return!1;var d=b.localName;return T.isTextContainer(b.namespaceURI,d)||"span"===
d&&"webodf-annotationHighlight"===b.className}function g(b){return null===b||b.nodeType!==Node.ELEMENT_NODE?!1:T.isField(b.namespaceURI,b.localName)}function h(b){var d=b&&b.localName,a=!1;d&&(b=b.namespaceURI,b===Z&&(a="s"===d||"tab"===d||"line-break"===d));return a}function b(b){return h(b)||g(b)||l(b)||a(b)}function d(b){var d=b&&b.localName,a=!1;d&&(b=b.namespaceURI,b===Z&&(a="s"===d));return a}function r(b){return-1!==ba.indexOf(b.namespaceURI)}function m(b){if(h(b)||g(b))return!1;if(p(b.parentNode)&&
b.nodeType===Node.TEXT_NODE)return 0===b.textContent.length;for(b=b.firstChild;b;){if(r(b)||!m(b))return!1;b=b.nextSibling}return!0}function x(b){for(;null!==b.firstChild&&p(b);)b=b.firstChild;return b}function t(b){for(;null!==b.lastChild&&p(b);)b=b.lastChild;return b}function y(b){for(;!c(b)&&null===b.previousSibling;)b=b.parentNode;return c(b)?null:t(b.previousSibling)}function v(b){for(;!c(b)&&null===b.nextSibling;)b=b.parentNode;return c(b)?null:x(b.nextSibling)}function s(a){for(var c=!1;a;)if(a.nodeType===
Node.TEXT_NODE)if(0===a.length)a=y(a);else return!n(a.data.substr(a.length-1,1));else b(a)?(c=!1===d(a),a=null):a=y(a);return c}function w(d){var a=!1,c;for(d=d&&x(d);d;){c=d.nodeType===Node.TEXT_NODE?d.length:0;if(0<c&&!n(d.data)){a=!0;break}if(b(d)){a=!0;break}d=v(d)}return a}function u(b,d){return n(b.data.substr(d))?!w(v(b)):!1}function A(d,a){var c=d.data,e;if(!n(c[a])||b(d.parentNode))return!1;0<a?n(c[a-1])||(e=!0):s(y(d))&&(e=!0);return!0===e?u(d,a)?!1:!0:!1}function F(b){return(b=/(-?[0-9]*[0-9][0-9]*(\.[0-9]*)?|0+\.[0-9]*[1-9][0-9]*|\.[0-9]*[1-9][0-9]*)((cm)|(mm)|(in)|(pt)|(pc)|(px)|(%))/.exec(b))?
{value:parseFloat(b[1]),unit:b[3]}:null}function B(b){return(b=F(b))&&(0>b.value||"%"===b.unit)?null:b}function E(b){return(b=F(b))&&"%"!==b.unit?null:b}function J(b){switch(b.namespaceURI){case odf.Namespaces.drawns:case odf.Namespaces.svgns:case odf.Namespaces.dr3dns:return!1;case odf.Namespaces.textns:switch(b.localName){case "note-body":case "ruby-text":return!1}break;case odf.Namespaces.officens:switch(b.localName){case "annotation":case "binary-data":case "event-listeners":return!1}break;default:switch(b.localName){case "cursor":case "editinfo":return!1}}return!0}
function H(b,d){for(;0<d.length&&!G.rangeContainsNode(b,d[0]);)d.shift();for(;0<d.length&&!G.rangeContainsNode(b,d[d.length-1]);)d.pop()}function Q(d,c,e){var m;m=G.getNodesInRange(d,function(d){var c=NodeFilter.FILTER_REJECT;if(h(d.parentNode)||g(d.parentNode)||a(d))c=NodeFilter.FILTER_REJECT;else if(d.nodeType===Node.TEXT_NODE){if(e||Boolean(k(d)&&(!n(d.textContent)||A(d,0))))c=NodeFilter.FILTER_ACCEPT}else if(b(d))c=NodeFilter.FILTER_ACCEPT;else if(J(d)||p(d))c=NodeFilter.FILTER_SKIP;return c},
NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT);c||H(d,m);return m}function N(b,d,c){for(;b;){if(c(b)){d[0]!==b&&d.unshift(b);break}if(a(b))break;b=b.parentNode}}function z(b,d){var a=b;if(d<a.childNodes.length-1)a=a.childNodes[d+1];else{for(;!a.nextSibling;)a=a.parentNode;a=a.nextSibling}for(;a.firstChild;)a=a.firstChild;return a}var Z=odf.Namespaces.textns,R=odf.Namespaces.drawns,I=odf.Namespaces.xlinkns,G=core.DomUtils,ba=[odf.Namespaces.dbns,odf.Namespaces.dcns,odf.Namespaces.dr3dns,odf.Namespaces.drawns,
odf.Namespaces.chartns,odf.Namespaces.formns,odf.Namespaces.numberns,odf.Namespaces.officens,odf.Namespaces.presentationns,odf.Namespaces.stylens,odf.Namespaces.svgns,odf.Namespaces.tablens,odf.Namespaces.textns],T=odf.OdfSchema;this.isImage=f;this.isCharacterFrame=l;this.isInlineRoot=a;this.isTextSpan=function(b){return"span"===(b&&b.localName)&&b.namespaceURI===Z};this.isHyperlink=e;this.getHyperlinkTarget=function(b){return b.getAttributeNS(I,"href")||""};this.isParagraph=c;this.getParagraphElement=
k;this.getParentAnnotation=q;this.isWithinAnnotation=function(b,d){return Boolean(q(b,d))};this.getAnnotationCreator=function(b){return b.getElementsByTagNameNS(odf.Namespaces.dcns,"creator")[0].textContent};this.isListItem=function(b){return"list-item"===(b&&b.localName)&&b.namespaceURI===Z};this.isLineBreak=function(b){return"line-break"===(b&&b.localName)&&b.namespaceURI===Z};this.isODFWhitespace=n;this.isGroupingElement=p;this.isFieldElement=g;this.isCharacterElement=h;this.isAnchoredAsCharacterElement=
b;this.isSpaceElement=d;this.isODFNode=r;this.hasNoODFContent=m;this.firstChild=x;this.lastChild=t;this.previousNode=y;this.nextNode=v;this.scanLeftForNonSpace=s;this.lookLeftForCharacter=function(d){var a,c=a=0;d.nodeType===Node.TEXT_NODE&&(c=d.length);0<c?(a=d.data,a=n(a.substr(c-1,1))?1===c?s(y(d))?2:0:n(a.substr(c-2,1))?0:2:1):b(d)&&(a=1);return a};this.lookRightForCharacter=function(d){var a=!1,c=0;d&&d.nodeType===Node.TEXT_NODE&&(c=d.length);0<c?a=!n(d.data.substr(0,1)):b(d)&&(a=!0);return a};
this.scanLeftForAnyCharacter=function(d){var a=!1,c;for(d=d&&t(d);d;){c=d.nodeType===Node.TEXT_NODE?d.length:0;if(0<c&&!n(d.data)){a=!0;break}if(b(d)){a=!0;break}d=y(d)}return a};this.scanRightForAnyCharacter=w;this.isTrailingWhitespace=u;this.isSignificantWhitespace=A;this.isDowngradableSpaceElement=function(b){return d(b)?s(y(b))&&w(v(b)):!1};this.parseLength=F;this.parseNonNegativeLength=B;this.parseFoFontSize=function(b){var d;d=(d=F(b))&&(0>=d.value||"%"===d.unit)?null:d;return d||E(b)};this.parseFoLineHeight=
function(b){return B(b)||E(b)};this.isTextContentContainingNode=J;this.getTextNodes=function(b,d){var a;a=G.getNodesInRange(b,function(b){var d=NodeFilter.FILTER_REJECT;b.nodeType===Node.TEXT_NODE?Boolean(k(b)&&(!n(b.textContent)||A(b,0)))&&(d=NodeFilter.FILTER_ACCEPT):J(b)&&(d=NodeFilter.FILTER_SKIP);return d},NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT);d||H(b,a);return a};this.getTextElements=Q;this.getParagraphElements=function(b){var d;d=G.getNodesInRange(b,function(b){var d=NodeFilter.FILTER_REJECT;
if(c(b))d=NodeFilter.FILTER_ACCEPT;else if(J(b)||p(b))d=NodeFilter.FILTER_SKIP;return d},NodeFilter.SHOW_ELEMENT);N(b.startContainer,d,c);return d};this.getImageElements=function(b){var d;d=G.getNodesInRange(b,function(b){var d=NodeFilter.FILTER_SKIP;f(b)&&(d=NodeFilter.FILTER_ACCEPT);return d},NodeFilter.SHOW_ELEMENT);N(b.startContainer,d,f);return d};this.getHyperlinkElements=function(b){var d=[],a=b.cloneRange();b.collapsed&&b.endContainer.nodeType===Node.ELEMENT_NODE&&(b=z(b.endContainer,b.endOffset),
b.nodeType===Node.TEXT_NODE&&a.setEnd(b,1));Q(a,!0,!1).forEach(function(b){for(b=b.parentNode;!c(b);){if(e(b)&&-1===d.indexOf(b)){d.push(b);break}b=b.parentNode}});a.detach();return d};this.getNormalizedFontFamilyName=function(b){/^(["'])(?:.|[\n\r])*?\1$/.test(b)||(b=b.replace(/^[ \t\r\n\f]*((?:.|[\n\r])*?)[ \t\r\n\f]*$/,"$1"),/[ \t\r\n\f]/.test(b)&&(b="'"+b.replace(/[ \t\r\n\f]+/g," ")+"'"));return b}};odf.OdfUtils=new odf.OdfUtilsImpl;gui.OdfTextBodyNodeFilter=function(){var f=odf.OdfUtils,l=Node.TEXT_NODE,a=NodeFilter.FILTER_REJECT,e=NodeFilter.FILTER_ACCEPT,c=odf.Namespaces.textns;this.acceptNode=function(k){if(k.nodeType===l){if(!f.isGroupingElement(k.parentNode))return a}else if(k.namespaceURI===c&&"tracked-changes"===k.localName)return a;return e}};xmldom.LSSerializerFilter=function(){};xmldom.LSSerializerFilter.prototype.acceptNode=function(f){};odf.OdfNodeFilter=function(){this.acceptNode=function(f){return"http://www.w3.org/1999/xhtml"===f.namespaceURI?NodeFilter.FILTER_SKIP:f.namespaceURI&&f.namespaceURI.match(/^urn:webodf:/)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}};xmldom.XPathIterator=function(){};xmldom.XPathIterator.prototype.next=function(){};xmldom.XPathIterator.prototype.reset=function(){};
function createXPathSingleton(){function f(a,b,d){return-1!==a&&(a<b||-1===b)&&(a<d||-1===d)}function l(a){for(var b=[],d=0,c=a.length,e;d<c;){var k=a,n=c,p=b,q="",l=[],w=k.indexOf("[",d),u=k.indexOf("/",d),A=k.indexOf("=",d);f(u,w,A)?(q=k.substring(d,u),d=u+1):f(w,u,A)?(q=k.substring(d,w),d=g(k,w,l)):f(A,u,w)?(q=k.substring(d,A),d=A):(q=k.substring(d,n),d=n);p.push({location:q,predicates:l});if(d<c&&"="===a[d]){e=a.substring(d+1,c);if(2<e.length&&("'"===e[0]||'"'===e[0]))e=e.slice(1,e.length-1);
else try{e=parseInt(e,10)}catch(F){}d=c}}return{steps:b,value:e}}function a(){var a=null,b=!1;this.setNode=function(b){a=b};this.reset=function(){b=!1};this.next=function(){var d=b?null:a;b=!0;return d}}function e(a,b,d){this.reset=function(){a.reset()};this.next=function(){for(var c=a.next();c;){c.nodeType===Node.ELEMENT_NODE&&(c=c.getAttributeNodeNS(b,d));if(c)break;c=a.next()}return c}}function c(a,b){var d=a.next(),c=null;this.reset=function(){a.reset();d=a.next();c=null};this.next=function(){for(;d;){if(c)if(b&&
c.firstChild)c=c.firstChild;else{for(;!c.nextSibling&&c!==d;)c=c.parentNode;c===d?d=a.next():c=c.nextSibling}else{do(c=d.firstChild)||(d=a.next());while(d&&!c)}if(c&&c.nodeType===Node.ELEMENT_NODE)return c}return null}}function k(a,b){this.reset=function(){a.reset()};this.next=function(){for(var d=a.next();d&&!b(d);)d=a.next();return d}}function q(a,b,d){b=b.split(":",2);var c=d(b[0]),e=b[1];return new k(a,function(b){return b.localName===e&&b.namespaceURI===c})}function n(c,b,d){var e=new a,m=p(e,
b,d),g=b.value;return void 0===g?new k(c,function(b){e.setNode(b);m.reset();return null!==m.next()}):new k(c,function(b){e.setNode(b);m.reset();return(b=m.next())?b.nodeValue===g:!1})}var p,g;g=function(a,b,d){for(var c=b,e=a.length,g=0;c<e;)"]"===a[c]?(g-=1,0>=g&&d.push(l(a.substring(b,c)))):"["===a[c]&&(0>=g&&(b=c+1),g+=1),c+=1;return c};p=function(a,b,d){var g,m,k,f;for(g=0;g<b.steps.length;g+=1){k=b.steps[g];m=k.location;if(""===m)a=new c(a,!1);else if("@"===m[0]){m=m.substr(1).split(":",2);f=
d(m[0]);if(!f)throw"No namespace associated with the prefix "+m[0];a=new e(a,f,m[1])}else"."!==m&&(a=new c(a,!1),-1!==m.indexOf(":")&&(a=q(a,m,d)));for(m=0;m<k.predicates.length;m+=1)f=k.predicates[m],a=n(a,f,d)}return a};return{getODFElementsWithXPath:function(c,b,d){var e=c.ownerDocument,m=[],g=null;if(e&&"function"===typeof e.evaluate)for(d=e.evaluate(b,c,d,XPathResult.UNORDERED_NODE_ITERATOR_TYPE,null),g=d.iterateNext();null!==g;)g.nodeType===Node.ELEMENT_NODE&&m.push(g),g=d.iterateNext();else{m=
new a;m.setNode(c);c=l(b);m=p(m,c,d);c=[];for(d=m.next();d;)c.push(d),d=m.next();m=c}return m}}}xmldom.XPath=createXPathSingleton();odf.StyleInfo=function(){function f(b,d){var a,c,e,h,m,g=0;if(a=B[b.localName])if(e=a[b.namespaceURI])g=e.length;for(a=0;a<g;a+=1)c=e[a],h=c.ns,m=c.localname,(c=b.getAttributeNS(h,m))&&b.setAttributeNS(h,A[h]+m,d+c);for(e=b.firstElementChild;e;)f(e,d),e=e.nextElementSibling}function l(b,d){var a,c,e,h,m,g=0;if(a=B[b.localName])if(e=a[b.namespaceURI])g=e.length;for(a=0;a<g;a+=1)if(c=e[a],h=c.ns,m=c.localname,c=b.getAttributeNS(h,m))c=c.replace(d,""),b.setAttributeNS(h,A[h]+m,c);for(e=b.firstElementChild;e;)l(e,
d),e=e.nextElementSibling}function a(b,d){var a,c,e,h,m,g=0;if(a=B[b.localName])if(e=a[b.namespaceURI])g=e.length;for(a=0;a<g;a+=1)if(h=e[a],c=h.ns,m=h.localname,c=b.getAttributeNS(c,m))d=d||{},h=h.keyname,d.hasOwnProperty(h)?d[h][c]=1:(m={},m[c]=1,d[h]=m);return d}function e(b,d){var c,h;a(b,d);for(c=b.firstChild;c;)c.nodeType===Node.ELEMENT_NODE&&(h=c,e(h,d)),c=c.nextSibling}function c(b,d,a){this.key=b;this.name=d;this.family=a;this.requires={}}function k(b,d,a){var e=b+'"'+d,h=a[e];h||(h=a[e]=
new c(e,b,d));return h}function q(b,d,a){var c,e,h,m,g,r=0;c=b.getAttributeNS(s,"name");m=b.getAttributeNS(s,"family");c&&m&&(d=k(c,m,a));if(d){if(c=B[b.localName])if(h=c[b.namespaceURI])r=h.length;for(c=0;c<r;c+=1)if(m=h[c],e=m.ns,g=m.localname,e=b.getAttributeNS(e,g))m=m.keyname,m=k(e,m,a),d.requires[m.key]=m}for(b=b.firstElementChild;b;)q(b,d,a),b=b.nextElementSibling;return a}function n(b,d){var a=d[b.family];a||(a=d[b.family]={});a[b.name]=1;Object.keys(b.requires).forEach(function(a){n(b.requires[a],
d)})}function p(b,d){var a=q(b,null,{});Object.keys(a).forEach(function(b){b=a[b];var c=d[b.family];c&&c.hasOwnProperty(b.name)&&n(b,d)})}function g(b,d){function a(d){(d=h.getAttributeNS(s,d))&&(b[d]=!0)}var c=["font-name","font-name-asian","font-name-complex"],e,h;for(e=d&&d.firstElementChild;e;)h=e,c.forEach(a),g(b,h),e=e.nextElementSibling}function h(b,d){function a(b){var c=m.getAttributeNS(s,b);c&&d.hasOwnProperty(c)&&m.setAttributeNS(s,"style:"+b,d[c])}var c=["font-name","font-name-asian",
"font-name-complex"],e,m;for(e=b&&b.firstElementChild;e;)m=e,c.forEach(a),h(m,d),e=e.nextElementSibling}var b=odf.Namespaces.chartns,d=odf.Namespaces.dbns,r=odf.Namespaces.dr3dns,m=odf.Namespaces.drawns,x=odf.Namespaces.formns,t=odf.Namespaces.numberns,y=odf.Namespaces.officens,v=odf.Namespaces.presentationns,s=odf.Namespaces.stylens,w=odf.Namespaces.tablens,u=odf.Namespaces.textns,A={"urn:oasis:names:tc:opendocument:xmlns:chart:1.0":"chart:","urn:oasis:names:tc:opendocument:xmlns:database:1.0":"db:",
"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0":"dr3d:","urn:oasis:names:tc:opendocument:xmlns:drawing:1.0":"draw:","urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0":"fo:","urn:oasis:names:tc:opendocument:xmlns:form:1.0":"form:","urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0":"number:","urn:oasis:names:tc:opendocument:xmlns:office:1.0":"office:","urn:oasis:names:tc:opendocument:xmlns:presentation:1.0":"presentation:","urn:oasis:names:tc:opendocument:xmlns:style:1.0":"style:","urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0":"svg:",
"urn:oasis:names:tc:opendocument:xmlns:table:1.0":"table:","urn:oasis:names:tc:opendocument:xmlns:text:1.0":"chart:","http://www.w3.org/XML/1998/namespace":"xml:"},F={text:[{ens:s,en:"tab-stop",ans:s,a:"leader-text-style"},{ens:s,en:"drop-cap",ans:s,a:"style-name"},{ens:u,en:"notes-configuration",ans:u,a:"citation-body-style-name"},{ens:u,en:"notes-configuration",ans:u,a:"citation-style-name"},{ens:u,en:"a",ans:u,a:"style-name"},{ens:u,en:"alphabetical-index",ans:u,a:"style-name"},{ens:u,en:"linenumbering-configuration",
ans:u,a:"style-name"},{ens:u,en:"list-level-style-number",ans:u,a:"style-name"},{ens:u,en:"ruby-text",ans:u,a:"style-name"},{ens:u,en:"span",ans:u,a:"style-name"},{ens:u,en:"a",ans:u,a:"visited-style-name"},{ens:s,en:"text-properties",ans:s,a:"text-line-through-text-style"},{ens:u,en:"alphabetical-index-source",ans:u,a:"main-entry-style-name"},{ens:u,en:"index-entry-bibliography",ans:u,a:"style-name"},{ens:u,en:"index-entry-chapter",ans:u,a:"style-name"},{ens:u,en:"index-entry-link-end",ans:u,a:"style-name"},
{ens:u,en:"index-entry-link-start",ans:u,a:"style-name"},{ens:u,en:"index-entry-page-number",ans:u,a:"style-name"},{ens:u,en:"index-entry-span",ans:u,a:"style-name"},{ens:u,en:"index-entry-tab-stop",ans:u,a:"style-name"},{ens:u,en:"index-entry-text",ans:u,a:"style-name"},{ens:u,en:"index-title-template",ans:u,a:"style-name"},{ens:u,en:"list-level-style-bullet",ans:u,a:"style-name"},{ens:u,en:"outline-level-style",ans:u,a:"style-name"}],paragraph:[{ens:m,en:"caption",ans:m,a:"text-style-name"},{ens:m,
en:"circle",ans:m,a:"text-style-name"},{ens:m,en:"connector",ans:m,a:"text-style-name"},{ens:m,en:"control",ans:m,a:"text-style-name"},{ens:m,en:"custom-shape",ans:m,a:"text-style-name"},{ens:m,en:"ellipse",ans:m,a:"text-style-name"},{ens:m,en:"frame",ans:m,a:"text-style-name"},{ens:m,en:"line",ans:m,a:"text-style-name"},{ens:m,en:"measure",ans:m,a:"text-style-name"},{ens:m,en:"path",ans:m,a:"text-style-name"},{ens:m,en:"polygon",ans:m,a:"text-style-name"},{ens:m,en:"polyline",ans:m,a:"text-style-name"},
{ens:m,en:"rect",ans:m,a:"text-style-name"},{ens:m,en:"regular-polygon",ans:m,a:"text-style-name"},{ens:y,en:"annotation",ans:m,a:"text-style-name"},{ens:x,en:"column",ans:x,a:"text-style-name"},{ens:s,en:"style",ans:s,a:"next-style-name"},{ens:w,en:"body",ans:w,a:"paragraph-style-name"},{ens:w,en:"even-columns",ans:w,a:"paragraph-style-name"},{ens:w,en:"even-rows",ans:w,a:"paragraph-style-name"},{ens:w,en:"first-column",ans:w,a:"paragraph-style-name"},{ens:w,en:"first-row",ans:w,a:"paragraph-style-name"},
{ens:w,en:"last-column",ans:w,a:"paragraph-style-name"},{ens:w,en:"last-row",ans:w,a:"paragraph-style-name"},{ens:w,en:"odd-columns",ans:w,a:"paragraph-style-name"},{ens:w,en:"odd-rows",ans:w,a:"paragraph-style-name"},{ens:u,en:"notes-configuration",ans:u,a:"default-style-name"},{ens:u,en:"alphabetical-index-entry-template",ans:u,a:"style-name"},{ens:u,en:"bibliography-entry-template",ans:u,a:"style-name"},{ens:u,en:"h",ans:u,a:"style-name"},{ens:u,en:"illustration-index-entry-template",ans:u,a:"style-name"},
{ens:u,en:"index-source-style",ans:u,a:"style-name"},{ens:u,en:"object-index-entry-template",ans:u,a:"style-name"},{ens:u,en:"p",ans:u,a:"style-name"},{ens:u,en:"table-index-entry-template",ans:u,a:"style-name"},{ens:u,en:"table-of-content-entry-template",ans:u,a:"style-name"},{ens:u,en:"table-index-entry-template",ans:u,a:"style-name"},{ens:u,en:"user-index-entry-template",ans:u,a:"style-name"},{ens:s,en:"page-layout-properties",ans:s,a:"register-truth-ref-style-name"}],chart:[{ens:b,en:"axis",ans:b,
a:"style-name"},{ens:b,en:"chart",ans:b,a:"style-name"},{ens:b,en:"data-label",ans:b,a:"style-name"},{ens:b,en:"data-point",ans:b,a:"style-name"},{ens:b,en:"equation",ans:b,a:"style-name"},{ens:b,en:"error-indicator",ans:b,a:"style-name"},{ens:b,en:"floor",ans:b,a:"style-name"},{ens:b,en:"footer",ans:b,a:"style-name"},{ens:b,en:"grid",ans:b,a:"style-name"},{ens:b,en:"legend",ans:b,a:"style-name"},{ens:b,en:"mean-value",ans:b,a:"style-name"},{ens:b,en:"plot-area",ans:b,a:"style-name"},{ens:b,en:"regression-curve",
ans:b,a:"style-name"},{ens:b,en:"series",ans:b,a:"style-name"},{ens:b,en:"stock-gain-marker",ans:b,a:"style-name"},{ens:b,en:"stock-loss-marker",ans:b,a:"style-name"},{ens:b,en:"stock-range-line",ans:b,a:"style-name"},{ens:b,en:"subtitle",ans:b,a:"style-name"},{ens:b,en:"title",ans:b,a:"style-name"},{ens:b,en:"wall",ans:b,a:"style-name"}],section:[{ens:u,en:"alphabetical-index",ans:u,a:"style-name"},{ens:u,en:"bibliography",ans:u,a:"style-name"},{ens:u,en:"illustration-index",ans:u,a:"style-name"},
{ens:u,en:"index-title",ans:u,a:"style-name"},{ens:u,en:"object-index",ans:u,a:"style-name"},{ens:u,en:"section",ans:u,a:"style-name"},{ens:u,en:"table-of-content",ans:u,a:"style-name"},{ens:u,en:"table-index",ans:u,a:"style-name"},{ens:u,en:"user-index",ans:u,a:"style-name"}],ruby:[{ens:u,en:"ruby",ans:u,a:"style-name"}],table:[{ens:d,en:"query",ans:d,a:"style-name"},{ens:d,en:"table-representation",ans:d,a:"style-name"},{ens:w,en:"background",ans:w,a:"style-name"},{ens:w,en:"table",ans:w,a:"style-name"}],
"table-column":[{ens:d,en:"column",ans:d,a:"style-name"},{ens:w,en:"table-column",ans:w,a:"style-name"}],"table-row":[{ens:d,en:"query",ans:d,a:"default-row-style-name"},{ens:d,en:"table-representation",ans:d,a:"default-row-style-name"},{ens:w,en:"table-row",ans:w,a:"style-name"}],"table-cell":[{ens:d,en:"column",ans:d,a:"default-cell-style-name"},{ens:w,en:"table-column",ans:w,a:"default-cell-style-name"},{ens:w,en:"table-row",ans:w,a:"default-cell-style-name"},{ens:w,en:"body",ans:w,a:"style-name"},
{ens:w,en:"covered-table-cell",ans:w,a:"style-name"},{ens:w,en:"even-columns",ans:w,a:"style-name"},{ens:w,en:"covered-table-cell",ans:w,a:"style-name"},{ens:w,en:"even-columns",ans:w,a:"style-name"},{ens:w,en:"even-rows",ans:w,a:"style-name"},{ens:w,en:"first-column",ans:w,a:"style-name"},{ens:w,en:"first-row",ans:w,a:"style-name"},{ens:w,en:"last-column",ans:w,a:"style-name"},{ens:w,en:"last-row",ans:w,a:"style-name"},{ens:w,en:"odd-columns",ans:w,a:"style-name"},{ens:w,en:"odd-rows",ans:w,a:"style-name"},
{ens:w,en:"table-cell",ans:w,a:"style-name"}],graphic:[{ens:r,en:"cube",ans:m,a:"style-name"},{ens:r,en:"extrude",ans:m,a:"style-name"},{ens:r,en:"rotate",ans:m,a:"style-name"},{ens:r,en:"scene",ans:m,a:"style-name"},{ens:r,en:"sphere",ans:m,a:"style-name"},{ens:m,en:"caption",ans:m,a:"style-name"},{ens:m,en:"circle",ans:m,a:"style-name"},{ens:m,en:"connector",ans:m,a:"style-name"},{ens:m,en:"control",ans:m,a:"style-name"},{ens:m,en:"custom-shape",ans:m,a:"style-name"},{ens:m,en:"ellipse",ans:m,a:"style-name"},
{ens:m,en:"frame",ans:m,a:"style-name"},{ens:m,en:"g",ans:m,a:"style-name"},{ens:m,en:"line",ans:m,a:"style-name"},{ens:m,en:"measure",ans:m,a:"style-name"},{ens:m,en:"page-thumbnail",ans:m,a:"style-name"},{ens:m,en:"path",ans:m,a:"style-name"},{ens:m,en:"polygon",ans:m,a:"style-name"},{ens:m,en:"polyline",ans:m,a:"style-name"},{ens:m,en:"rect",ans:m,a:"style-name"},{ens:m,en:"regular-polygon",ans:m,a:"style-name"},{ens:y,en:"annotation",ans:m,a:"style-name"}],presentation:[{ens:r,en:"cube",ans:v,
a:"style-name"},{ens:r,en:"extrude",ans:v,a:"style-name"},{ens:r,en:"rotate",ans:v,a:"style-name"},{ens:r,en:"scene",ans:v,a:"style-name"},{ens:r,en:"sphere",ans:v,a:"style-name"},{ens:m,en:"caption",ans:v,a:"style-name"},{ens:m,en:"circle",ans:v,a:"style-name"},{ens:m,en:"connector",ans:v,a:"style-name"},{ens:m,en:"control",ans:v,a:"style-name"},{ens:m,en:"custom-shape",ans:v,a:"style-name"},{ens:m,en:"ellipse",ans:v,a:"style-name"},{ens:m,en:"frame",ans:v,a:"style-name"},{ens:m,en:"g",ans:v,a:"style-name"},
{ens:m,en:"line",ans:v,a:"style-name"},{ens:m,en:"measure",ans:v,a:"style-name"},{ens:m,en:"page-thumbnail",ans:v,a:"style-name"},{ens:m,en:"path",ans:v,a:"style-name"},{ens:m,en:"polygon",ans:v,a:"style-name"},{ens:m,en:"polyline",ans:v,a:"style-name"},{ens:m,en:"rect",ans:v,a:"style-name"},{ens:m,en:"regular-polygon",ans:v,a:"style-name"},{ens:y,en:"annotation",ans:v,a:"style-name"}],"drawing-page":[{ens:m,en:"page",ans:m,a:"style-name"},{ens:v,en:"notes",ans:m,a:"style-name"},{ens:s,en:"handout-master",
ans:m,a:"style-name"},{ens:s,en:"master-page",ans:m,a:"style-name"}],"list-style":[{ens:u,en:"list",ans:u,a:"style-name"},{ens:u,en:"numbered-paragraph",ans:u,a:"style-name"},{ens:u,en:"list-item",ans:u,a:"style-override"},{ens:s,en:"style",ans:s,a:"list-style-name"}],data:[{ens:s,en:"style",ans:s,a:"data-style-name"},{ens:s,en:"style",ans:s,a:"percentage-data-style-name"},{ens:v,en:"date-time-decl",ans:s,a:"data-style-name"},{ens:u,en:"creation-date",ans:s,a:"data-style-name"},{ens:u,en:"creation-time",
ans:s,a:"data-style-name"},{ens:u,en:"database-display",ans:s,a:"data-style-name"},{ens:u,en:"date",ans:s,a:"data-style-name"},{ens:u,en:"editing-duration",ans:s,a:"data-style-name"},{ens:u,en:"expression",ans:s,a:"data-style-name"},{ens:u,en:"meta-field",ans:s,a:"data-style-name"},{ens:u,en:"modification-date",ans:s,a:"data-style-name"},{ens:u,en:"modification-time",ans:s,a:"data-style-name"},{ens:u,en:"print-date",ans:s,a:"data-style-name"},{ens:u,en:"print-time",ans:s,a:"data-style-name"},{ens:u,
en:"table-formula",ans:s,a:"data-style-name"},{ens:u,en:"time",ans:s,a:"data-style-name"},{ens:u,en:"user-defined",ans:s,a:"data-style-name"},{ens:u,en:"user-field-get",ans:s,a:"data-style-name"},{ens:u,en:"user-field-input",ans:s,a:"data-style-name"},{ens:u,en:"variable-get",ans:s,a:"data-style-name"},{ens:u,en:"variable-input",ans:s,a:"data-style-name"},{ens:u,en:"variable-set",ans:s,a:"data-style-name"}],"page-layout":[{ens:v,en:"notes",ans:s,a:"page-layout-name"},{ens:s,en:"handout-master",ans:s,
a:"page-layout-name"},{ens:s,en:"master-page",ans:s,a:"page-layout-name"}]},B,E=xmldom.XPath;this.collectUsedFontFaces=g;this.changeFontFaceNames=h;this.UsedStyleList=function(b,d){var a={};this.uses=function(b){var d=b.localName,c=b.getAttributeNS(m,"name")||b.getAttributeNS(s,"name");b="style"===d?b.getAttributeNS(s,"family"):b.namespaceURI===t?"data":d;return(b=a[b])?0<b[c]:!1};e(b,a);d&&p(d,a)};this.getStyleName=function(b,d){var a,c,e=B[d.localName];if(e&&(e=e[d.namespaceURI]))for(c=0;c<e.length;c+=
1)if(e[c].keyname===b&&(e=e[c],d.hasAttributeNS(e.ns,e.localname))){a=d.getAttributeNS(e.ns,e.localname);break}return a};this.hasDerivedStyles=function(b,d,a){var c=a.getAttributeNS(s,"name");a=a.getAttributeNS(s,"family");return E.getODFElementsWithXPath(b,'//style:*[@style:parent-style-name="'+c+'"][@style:family="'+a+'"]',d).length?!0:!1};this.prefixStyleNames=function(b,d,a){var c;if(b){for(c=b.firstChild;c;){if(c.nodeType===Node.ELEMENT_NODE){var e=c,h=d,g=e.getAttributeNS(m,"name"),k=void 0;
g?k=m:(g=e.getAttributeNS(s,"name"))&&(k=s);k&&e.setAttributeNS(k,A[k]+"name",h+g)}c=c.nextSibling}f(b,d);a&&f(a,d)}};this.removePrefixFromStyleNames=function(b,d,a){var c=RegExp("^"+d);if(b){for(d=b.firstChild;d;){if(d.nodeType===Node.ELEMENT_NODE){var e=d,h=c,g=e.getAttributeNS(m,"name"),k=void 0;g?k=m:(g=e.getAttributeNS(s,"name"))&&(k=s);k&&(g=g.replace(h,""),e.setAttributeNS(k,A[k]+"name",g))}d=d.nextSibling}l(b,c);a&&l(a,c)}};this.determineStylesForNode=a;B=function(){var b,d,a,c,e,h={},m,g,
k,r;for(a in F)if(F.hasOwnProperty(a))for(c=F[a],d=c.length,b=0;b<d;b+=1)e=c[b],k=e.en,r=e.ens,h.hasOwnProperty(k)?m=h[k]:h[k]=m={},m.hasOwnProperty(r)?g=m[r]:m[r]=g=[],g.push({ns:e.ans,localname:e.a,keyname:a});return h}()};"function"!==typeof Object.create&&(Object.create=function(f){var l=function(){};l.prototype=f;return new l});
xmldom.LSSerializer=function(){function f(a){var e=a||{},f=function(a){var b={},d;for(d in a)a.hasOwnProperty(d)&&(b[a[d]]=d);return b}(a),n=[e],p=[f],g=0;this.push=function(){g+=1;e=n[g]=Object.create(e);f=p[g]=Object.create(f)};this.pop=function(){n.pop();p.pop();g-=1;e=n[g];f=p[g]};this.getLocalNamespaceDefinitions=function(){return f};this.getQName=function(a){var b=a.namespaceURI,d=0,c;if(!b)return a.localName;if(c=f[b])return c+":"+a.localName;do{c||!a.prefix?(c="ns"+d,d+=1):c=a.prefix;if(e[c]===
b)break;if(!e[c]){e[c]=b;f[b]=c;break}c=null}while(null===c);return c+":"+a.localName}}function l(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;")}function a(c,k){var f="",n=e.filter?e.filter.acceptNode(k):NodeFilter.FILTER_ACCEPT,p;if(n===NodeFilter.FILTER_ACCEPT&&k.nodeType===Node.ELEMENT_NODE){c.push();p=c.getQName(k);var g,h=k.attributes,b,d,r,m="",x;g="<"+p;b=h.length;for(d=0;d<b;d+=1)r=h.item(d),"http://www.w3.org/2000/xmlns/"!==
r.namespaceURI&&(x=e.filter?e.filter.acceptNode(r):NodeFilter.FILTER_ACCEPT,x===NodeFilter.FILTER_ACCEPT&&(x=c.getQName(r),r="string"===typeof r.value?l(r.value):r.value,m+=" "+(x+'="'+r+'"')));b=c.getLocalNamespaceDefinitions();for(d in b)b.hasOwnProperty(d)&&((h=b[d])?"xmlns"!==h&&(g+=" xmlns:"+b[d]+'="'+d+'"'):g+=' xmlns="'+d+'"');f+=g+(m+">")}if(n===NodeFilter.FILTER_ACCEPT||n===NodeFilter.FILTER_SKIP){for(n=k.firstChild;n;)f+=a(c,n),n=n.nextSibling;k.nodeValue&&(f+=l(k.nodeValue))}p&&(f+="</"+
p+">",c.pop());return f}var e=this;this.filter=null;this.writeToString=function(c,e){if(!c)return"";var q=new f(e);return a(q,c)}};(function(){function f(a){var b,d=n.length;for(b=0;b<d;b+=1)if("urn:oasis:names:tc:opendocument:xmlns:office:1.0"===a.namespaceURI&&a.localName===n[b])return b;return-1}function l(a,b){var d=new c.UsedStyleList(a,b),e=new odf.OdfNodeFilter;this.acceptNode=function(a){var c=e.acceptNode(a);c===NodeFilter.FILTER_ACCEPT&&a.parentNode===b&&a.nodeType===Node.ELEMENT_NODE&&(c=d.uses(a)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT);return c}}function a(a,b){var d=new l(a,b);this.acceptNode=function(b){var a=
d.acceptNode(b);a!==NodeFilter.FILTER_ACCEPT||!b.parentNode||b.parentNode.namespaceURI!==odf.Namespaces.textns||"s"!==b.parentNode.localName&&"tab"!==b.parentNode.localName||(a=NodeFilter.FILTER_REJECT);return a}}function e(a,b){if(b){var d=f(b),c,e=a.firstChild;if(-1!==d){for(;e;){c=f(e);if(-1!==c&&c>d)break;e=e.nextSibling}a.insertBefore(b,e)}}}var c=new odf.StyleInfo,k=core.DomUtils,q=odf.Namespaces.stylens,n="meta settings scripts font-face-decls styles automatic-styles master-styles body".split(" "),
p=Date.now()+"_webodf_",g=new core.Base64;odf.ODFElement=function(){};odf.ODFDocumentElement=function(){};odf.ODFDocumentElement.prototype=new odf.ODFElement;odf.ODFDocumentElement.prototype.constructor=odf.ODFDocumentElement;odf.ODFDocumentElement.prototype.fontFaceDecls=null;odf.ODFDocumentElement.prototype.manifest=null;odf.ODFDocumentElement.prototype.settings=null;odf.ODFDocumentElement.namespaceURI="urn:oasis:names:tc:opendocument:xmlns:office:1.0";odf.ODFDocumentElement.localName="document";
odf.AnnotationElement=function(){};odf.OdfPart=function(a,b,d,c){var e=this;this.size=0;this.type=null;this.name=a;this.container=d;this.url=null;this.mimetype=b;this.onstatereadychange=this.document=null;this.EMPTY=0;this.LOADING=1;this.DONE=2;this.state=this.EMPTY;this.data="";this.load=function(){null!==c&&(this.mimetype=b,c.loadAsDataURL(a,b,function(b,d){b&&runtime.log(b);e.url=d;if(e.onchange)e.onchange(e);if(e.onstatereadychange)e.onstatereadychange(e)}))}};odf.OdfPart.prototype.load=function(){};
odf.OdfPart.prototype.getUrl=function(){return this.data?"data:;base64,"+g.toBase64(this.data):null};odf.OdfContainer=function b(d,f){function m(b){for(var d=b.firstChild,a;d;)a=d.nextSibling,d.nodeType===Node.ELEMENT_NODE?m(d):d.nodeType===Node.PROCESSING_INSTRUCTION_NODE&&b.removeChild(d),d=a}function n(b){var d={},a,c,e=b.ownerDocument.createNodeIterator(b,NodeFilter.SHOW_ELEMENT,null,!1);for(b=e.nextNode();b;)"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===b.namespaceURI&&("annotation"===
b.localName?(a=b.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","name"))&&(d.hasOwnProperty(a)?runtime.log("Warning: annotation name used more than once with <office:annotation/>: '"+a+"'"):d[a]=b):"annotation-end"===b.localName&&((a=b.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","name"))?d.hasOwnProperty(a)?(c=d[a],c.annotationEndElement?runtime.log("Warning: annotation name used more than once with <office:annotation-end/>: '"+a+"'"):c.annotationEndElement=
b):runtime.log("Warning: annotation end without an annotation start, name: '"+a+"'"):runtime.log("Warning: annotation end without a name found"))),b=e.nextNode()}function t(b,d){for(var a=b&&b.firstChild;a;)a.nodeType===Node.ELEMENT_NODE&&a.setAttributeNS("urn:webodf:names:scope","scope",d),a=a.nextSibling}function y(b,d){for(var a=U.rootElement.meta,a=a&&a.firstChild;a&&(a.namespaceURI!==b||a.localName!==d);)a=a.nextSibling;for(a=a&&a.firstChild;a&&a.nodeType!==Node.TEXT_NODE;)a=a.nextSibling;return a?
a.data:null}function v(b){var d={},a;for(b=b.firstChild;b;)b.nodeType===Node.ELEMENT_NODE&&b.namespaceURI===q&&"font-face"===b.localName&&(a=b.getAttributeNS(q,"name"),d[a]=b),b=b.nextSibling;return d}function s(b,d){var a=null,c,e,m;if(b)for(a=b.cloneNode(!0),c=a.firstElementChild;c;)e=c.nextElementSibling,(m=c.getAttributeNS("urn:webodf:names:scope","scope"))&&m!==d&&a.removeChild(c),c=e;return a}function w(b,d){var a,e,m,g=null,k={};if(b)for(d.forEach(function(b){c.collectUsedFontFaces(k,b)}),
g=b.cloneNode(!0),a=g.firstElementChild;a;)e=a.nextElementSibling,m=a.getAttributeNS(q,"name"),k[m]||g.removeChild(a),a=e;return g}function u(b){var a=U.rootElement.ownerDocument,d;if(b){m(b.documentElement);try{d=a.importNode(b.documentElement,!0)}catch(c){}}return d}function A(b){U.state=b;if(U.onchange)U.onchange(U);if(U.onstatereadychange)U.onstatereadychange(U)}function F(b){Y=null;U.rootElement=b;b.fontFaceDecls=k.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","font-face-decls");
b.styles=k.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","styles");b.automaticStyles=k.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles");b.masterStyles=k.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","master-styles");b.body=k.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","body");b.meta=k.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","meta");b.settings=k.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0",
"settings");b.scripts=k.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","scripts");n(b)}function B(a){var d=u(a),m=U.rootElement,g;d&&"document-styles"===d.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===d.namespaceURI?(m.fontFaceDecls=k.getDirectChild(d,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","font-face-decls"),e(m,m.fontFaceDecls),g=k.getDirectChild(d,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","styles"),m.styles=g||a.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0",
"styles"),e(m,m.styles),g=k.getDirectChild(d,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles"),m.automaticStyles=g||a.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles"),t(m.automaticStyles,"document-styles"),e(m,m.automaticStyles),d=k.getDirectChild(d,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","master-styles"),m.masterStyles=d||a.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","master-styles"),e(m,m.masterStyles),
c.prefixStyleNames(m.automaticStyles,p,m.masterStyles)):A(b.INVALID)}function E(d){d=u(d);var a,m,g,f;if(d&&"document-content"===d.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===d.namespaceURI){a=U.rootElement;g=k.getDirectChild(d,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","font-face-decls");if(a.fontFaceDecls&&g){f=a.fontFaceDecls;var r,n,p,l,z={};m=v(f);l=v(g);for(g=g.firstElementChild;g;){r=g.nextElementSibling;if(g.namespaceURI===q&&"font-face"===g.localName)if(n=g.getAttributeNS(q,
"name"),m.hasOwnProperty(n)){if(!g.isEqualNode(m[n])){p=n;for(var s=m,Q=l,x=0,Z=void 0,Z=p=p.replace(/\d+$/,"");s.hasOwnProperty(Z)||Q.hasOwnProperty(Z);)x+=1,Z=p+x;p=Z;g.setAttributeNS(q,"style:name",p);f.appendChild(g);m[p]=g;delete l[n];z[n]=p}}else f.appendChild(g),m[n]=g,delete l[n];g=r}f=z}else g&&(a.fontFaceDecls=g,e(a,g));m=k.getDirectChild(d,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles");t(m,"document-content");for(l=0;l<m.childNodes.length;l++)"text:list-style"==
m.childNodes[l].nodeName&&m.childNodes[l].firstChild.setAttributeNS(odf.Namespaces.textns,"text:bullet-char","\u2022");f&&c.changeFontFaceNames(m,f);if(a.automaticStyles&&m)for(f=m.firstChild;f;)a.automaticStyles.appendChild(f),f=m.firstChild;else m&&(a.automaticStyles=m,e(a,m));d=k.getDirectChild(d,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","body");if(null===d)throw"<office:body/> tag is mising.";a.body=d;e(a,a.body)}else A(b.INVALID)}function J(b){b=u(b);var d;b&&"document-meta"===b.localName&&
"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===b.namespaceURI&&(d=U.rootElement,d.meta=k.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","meta"),e(d,d.meta))}function H(b){b=u(b);var d;b&&"document-settings"===b.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===b.namespaceURI&&(d=U.rootElement,d.settings=k.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","settings"),e(d,d.settings))}function Q(b){b=u(b);var d;if(b&&"manifest"===b.localName&&
"urn:oasis:names:tc:opendocument:xmlns:manifest:1.0"===b.namespaceURI)for(d=U.rootElement,d.manifest=b,b=d.manifest.firstElementChild;b;)"file-entry"===b.localName&&"urn:oasis:names:tc:opendocument:xmlns:manifest:1.0"===b.namespaceURI&&(P[b.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","full-path")]=b.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","media-type")),b=b.nextElementSibling}function N(b,d,a){b=k.getElementsByTagName(b,d);var c;for(c=0;c<b.length;c+=
1)d=b[c],a.hasOwnProperty(d.namespaceURI)||d.parentNode.removeChild(d)}function z(b){N(b,"script",{"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:office:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:table:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:text:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0":!0});N(b,"style",{"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0":!0,
"urn:oasis:names:tc:opendocument:xmlns:style:1.0":!0})}function Z(b){var d=b.firstElementChild,a=[],c,e,m,g=b.attributes,f=g.length;for(c=0;c<f;c+=1)m=g.item(c),e=m.localName.substr(0,2).toLowerCase(),null===m.namespaceURI&&"on"===e&&a.push(m);f=a.length;for(c=0;c<f;c+=1)b.removeAttributeNode(a[c]);for(;d;)Z(d),d=d.nextElementSibling}function R(d){var a=d.shift();a?W.loadAsDOM(a.path,function(c,e){e&&(z(e),Z(e.documentElement));a.handler(e);U.state===b.INVALID?c?runtime.log("ERROR: Unable to load "+
a.path+" - "+c):runtime.log("ERROR: Unable to load "+a.path):(c&&runtime.log("DEBUG: Unable to load "+a.path+" - "+c),R(d))}):(n(U.rootElement),A(b.DONE))}function I(b){var d="";odf.Namespaces.forEachPrefix(function(b,a){d+=" xmlns:"+b+'="'+a+'"'});return'<?xml version="1.0" encoding="UTF-8"?><office:'+b+" "+d+' office:version="1.2">'}function G(){var b=new xmldom.LSSerializer,d=I("document-meta");b.filter=new odf.OdfNodeFilter;d+=b.writeToString(U.rootElement.meta,odf.Namespaces.namespaceMap);return d+
"</office:document-meta>"}function ba(b,d){var a=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","manifest:file-entry");a.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","manifest:full-path",b);a.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","manifest:media-type",d);return a}function T(){var b=runtime.parseXML('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2"></manifest:manifest>'),
d=b.documentElement,a=new xmldom.LSSerializer,c;for(c in P)P.hasOwnProperty(c)&&d.appendChild(ba(c,P[c]));a.filter=new odf.OdfNodeFilter;return'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n'+a.writeToString(b,odf.Namespaces.namespaceMap)}function D(){var b,d,a,e=odf.Namespaces.namespaceMap,m=new xmldom.LSSerializer,g=I("document-styles");d=s(U.rootElement.automaticStyles,"document-styles");a=U.rootElement.masterStyles.cloneNode(!0);b=w(U.rootElement.fontFaceDecls,[a,U.rootElement.styles,
d]);c.removePrefixFromStyleNames(d,p,a);m.filter=new l(a,d);g+=m.writeToString(b,e);g+=m.writeToString(U.rootElement.styles,e);g+=m.writeToString(d,e);g+=m.writeToString(a,e);return g+"</office:document-styles>"}function O(){var b,d,c=odf.Namespaces.namespaceMap,e=new xmldom.LSSerializer,m=I("document-content");d=s(U.rootElement.automaticStyles,"document-content");b=w(U.rootElement.fontFaceDecls,[d]);e.filter=new a(U.rootElement.body,d);m+=e.writeToString(b,c);m+=e.writeToString(d,c);m+=e.writeToString(U.rootElement.body,
c);return m+"</office:document-content>"}function $(d,a){runtime.loadXML(d,function(d,c){if(d)a(d);else if(c){z(c);Z(c.documentElement);var e=u(c);e&&"document"===e.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===e.namespaceURI?(F(e),A(b.DONE)):A(b.INVALID)}else a("No DOM was loaded.")})}function C(b,d){var a;a=U.rootElement;var c=a.meta;c||(a.meta=c=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","meta"),e(a,c));a=c;b&&k.mapKeyValObjOntoNode(a,b,odf.Namespaces.lookupNamespaceURI);
d&&k.removeKeyElementsFromNode(a,d,odf.Namespaces.lookupNamespaceURI)}function V(d,a){function c(b,d){var a;d||(d=b);a=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0",d);f[b]=a;f.appendChild(a)}var e=new core.Zip("",null),m="application/vnd.oasis.opendocument."+d+(!0===a?"-template":""),g=runtime.byteArrayFromString(m,"utf8"),f=U.rootElement,k=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0",d);e.save("mimetype",g,!1,new Date);c("meta");c("settings");
c("scripts");c("fontFaceDecls","font-face-decls");c("styles");c("automaticStyles","automatic-styles");c("masterStyles","master-styles");c("body");f.body.appendChild(k);P["/"]=m;P["settings.xml"]="text/xml";P["meta.xml"]="text/xml";P["styles.xml"]="text/xml";P["content.xml"]="text/xml";A(b.DONE);return e}function aa(){var b,d=new Date,a="";U.rootElement.settings&&U.rootElement.settings.firstElementChild&&(b=new xmldom.LSSerializer,a=I("document-settings"),b.filter=new odf.OdfNodeFilter,a+=b.writeToString(U.rootElement.settings,
odf.Namespaces.namespaceMap),a+="</office:document-settings>");(b=a)?(b=runtime.byteArrayFromString(b,"utf8"),W.save("settings.xml",b,!0,d)):W.remove("settings.xml");a=runtime.getWindow();b="WebODF/"+webodf.Version;a&&(b=b+" "+a.navigator.userAgent);C({"meta:generator":b},null);b=runtime.byteArrayFromString(G(),"utf8");W.save("meta.xml",b,!0,d);b=runtime.byteArrayFromString(D(),"utf8");W.save("styles.xml",b,!0,d);b=runtime.byteArrayFromString(O(),"utf8");W.save("content.xml",b,!0,d);b=runtime.byteArrayFromString(T(),
"utf8");W.save("META-INF/manifest.xml",b,!0,d)}function ca(b,d){aa();W.writeAs(b,function(b){d(b)})}var U=this,W,P={},Y,S="";this.onstatereadychange=f;this.state=this.onchange=null;this.getMetadata=y;this.setRootElement=F;this.getContentElement=function(){var b;Y||(b=U.rootElement.body,Y=k.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","text")||k.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","presentation")||k.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0",
"spreadsheet"));if(!Y)throw"Could not find content element in <office:body/>.";return Y};this.getDocumentType=function(){var b=U.getContentElement();return b&&b.localName};this.isTemplate=function(){return"-template"===P["/"].substr(-9)};this.setIsTemplate=function(b){var d=P["/"],a="-template"===d.substr(-9);b!==a&&(d=b?d+"-template":d.substr(0,d.length-9),P["/"]=d,b=runtime.byteArrayFromString(d,"utf8"),W.save("mimetype",b,!1,new Date))};this.getPart=function(b){return new odf.OdfPart(b,P[b],U,
W)};this.getPartData=function(b,d){W.load(b,d)};this.setMetadata=C;this.incrementEditingCycles=function(){var b=y(odf.Namespaces.metans,"editing-cycles"),b=b?parseInt(b,10):0;isNaN(b)&&(b=0);C({"meta:editing-cycles":b+1},null);return b+1};this.createByteArray=function(b,d){aa();W.createByteArray(b,d)};this.saveAs=ca;this.save=function(b){ca(S,b)};this.getUrl=function(){return S};this.setBlob=function(b,d,a){a=g.convertBase64ToByteArray(a);W.save(b,a,!1,new Date);P.hasOwnProperty(b)&&runtime.log(b+
" has been overwritten.");P[b]=d};this.removeBlob=function(b){var d=W.remove(b);runtime.assert(d,"file is not found: "+b);delete P[b]};this.state=b.LOADING;this.rootElement=function(b){var d=document.createElementNS(b.namespaceURI,b.localName),a;b=new b.Type;for(a in b)b.hasOwnProperty(a)&&(d[a]=b[a]);return d}({Type:odf.ODFDocumentElement,namespaceURI:odf.ODFDocumentElement.namespaceURI,localName:odf.ODFDocumentElement.localName});d===odf.OdfContainer.DocumentType.TEXT?W=V("text"):d===odf.OdfContainer.DocumentType.TEXT_TEMPLATE?
W=V("text",!0):d===odf.OdfContainer.DocumentType.PRESENTATION?W=V("presentation"):d===odf.OdfContainer.DocumentType.PRESENTATION_TEMPLATE?W=V("presentation",!0):d===odf.OdfContainer.DocumentType.SPREADSHEET?W=V("spreadsheet"):d===odf.OdfContainer.DocumentType.SPREADSHEET_TEMPLATE?W=V("spreadsheet",!0):(S=d,W=new core.Zip(S,function(d,a){W=a;d?$(S,function(a){d&&(W.error=d+"\n"+a,A(b.INVALID))}):R([{path:"styles.xml",handler:B},{path:"content.xml",handler:E},{path:"meta.xml",handler:J},{path:"settings.xml",
handler:H},{path:"META-INF/manifest.xml",handler:Q}])}))};odf.OdfContainer.EMPTY=0;odf.OdfContainer.LOADING=1;odf.OdfContainer.DONE=2;odf.OdfContainer.INVALID=3;odf.OdfContainer.SAVING=4;odf.OdfContainer.MODIFIED=5;odf.OdfContainer.getContainer=function(b){return new odf.OdfContainer(b,null)}})();odf.OdfContainer.DocumentType={TEXT:1,TEXT_TEMPLATE:2,PRESENTATION:3,PRESENTATION_TEMPLATE:4,SPREADSHEET:5,SPREADSHEET_TEMPLATE:6};gui.AnnotatableCanvas=function(){};gui.AnnotatableCanvas.prototype.refreshSize=function(){};gui.AnnotatableCanvas.prototype.getZoomLevel=function(){};gui.AnnotatableCanvas.prototype.getSizer=function(){};
gui.AnnotationViewManager=function(f,l,a,e){function c(d){var a=d.annotationEndElement,c=h.createRange(),e=d.getAttributeNS(odf.Namespaces.officens,"name");a&&(c.setStart(d,d.childNodes.length),c.setEnd(a,0),d=b.getTextNodes(c,!1),d.forEach(function(b){var d;a:{for(d=b.parentNode;d.namespaceURI!==odf.Namespaces.officens||"body"!==d.localName;){if(d.namespaceURI===r&&"webodf-annotationHighlight"===d.className&&d.getAttribute("annotation")===e){d=!0;break a}d=d.parentNode}d=!1}d||(d=h.createElement("span"),
d.className="webodf-annotationHighlight",d.setAttribute("annotation",e),b.parentNode.replaceChild(d,b),d.appendChild(b))}));c.detach()}function k(b){var c=f.getSizer();b?(a.style.display="inline-block",c.style.paddingRight=d.getComputedStyle(a).width):(a.style.display="none",c.style.paddingRight=0);f.refreshSize()}function q(){g.sort(function(b,d){return 0!==(b.compareDocumentPosition(d)&Node.DOCUMENT_POSITION_FOLLOWING)?-1:1})}function n(){var b;for(b=0;b<g.length;b+=1){var d=g[b],c=d.parentNode,
e=c.nextElementSibling,h=e.nextElementSibling,k=c.parentNode,r=0,r=g[g.indexOf(d)-1],n=void 0,d=f.getZoomLevel();c.style.left=(a.getBoundingClientRect().left-k.getBoundingClientRect().left)/d+"px";c.style.width=a.getBoundingClientRect().width/d+"px";e.style.width=parseFloat(c.style.left)-30+"px";r?(n=r.parentNode.getBoundingClientRect(),20>=(k.getBoundingClientRect().top-n.bottom)/d?c.style.top=Math.abs(k.getBoundingClientRect().top-n.bottom)/d+20+"px":c.style.top="0px"):c.style.top="0px";h.style.left=
e.getBoundingClientRect().width/d+"px";var e=h.style,k=h.getBoundingClientRect().left/d,r=h.getBoundingClientRect().top/d,n=c.getBoundingClientRect().left/d,p=c.getBoundingClientRect().top/d,q=0,l=0,q=n-k,q=q*q,l=p-r,l=l*l,k=Math.sqrt(q+l);e.width=k+"px";r=Math.asin((c.getBoundingClientRect().top-h.getBoundingClientRect().top)/(d*parseFloat(h.style.width)));h.style.transform="rotate("+r+"rad)";h.style.MozTransform="rotate("+r+"rad)";h.style.WebkitTransform="rotate("+r+"rad)";h.style.msTransform="rotate("+
r+"rad)"}}function p(b){var d=g.indexOf(b),a=b.parentNode.parentNode;"div"===a.localName&&(a.parentNode.insertBefore(b,a),a.parentNode.removeChild(a));b=b.getAttributeNS(odf.Namespaces.officens,"name");b=h.querySelectorAll('span.webodf-annotationHighlight[annotation="'+b+'"]');for(var c,a=0;a<b.length;a+=1){for(c=b.item(a);c.firstChild;)c.parentNode.insertBefore(c.firstChild,c);c.parentNode.removeChild(c)}-1!==d&&g.splice(d,1);0===g.length&&k(!1)}var g=[],h=l.ownerDocument,b=odf.OdfUtils,d=runtime.getWindow(),
r="http://www.w3.org/1999/xhtml";runtime.assert(Boolean(d),"Expected to be run in an environment which has a global window, like a browser.");this.rerenderAnnotations=n;this.rehighlightAnnotations=function(){g.forEach(function(b){c(b)})};this.getMinimumHeightForAnnotationPane=function(){return"none"!==a.style.display&&0<g.length?(g[g.length-1].parentNode.getBoundingClientRect().bottom-a.getBoundingClientRect().top)/f.getZoomLevel()+"px":null};this.addAnnotations=function(d){0!==d.length&&(k(!0),d.forEach(function(d){g.push(d);
var a=h.createElement("div"),m=h.createElement("div"),f=h.createElement("div"),k=h.createElement("div"),r;a.className="annotationWrapper";a.setAttribute("creator",b.getAnnotationCreator(d));d.parentNode.insertBefore(a,d);m.className="annotationNote";m.appendChild(d);e&&(r=h.createElement("div"),r.className="annotationRemoveButton",m.appendChild(r));f.className="annotationConnector horizontal";k.className="annotationConnector angular";a.appendChild(m);a.appendChild(f);a.appendChild(k);d.annotationEndElement&&
c(d)}),q(),n())};this.forgetAnnotation=p;this.forgetAnnotations=function(){for(;g.length;)p(g[0])}};gui.Viewport=function(){};gui.Viewport.prototype.scrollIntoView=function(f,l){};gui.SingleScrollViewport=function(f){this.scrollIntoView=function(l,a){var e,c,k,q;q=f.offsetHeight-f.clientHeight;k=f.offsetWidth-f.clientWidth;var n=f.getBoundingClientRect();if(l&&n){e=n.left+5;c=n.top+5;k=n.right-(k+5);q=n.bottom-(q+5);if(a||l.top<c)f.scrollTop-=c-l.top;else if(l.top>q||l.bottom>q)f.scrollTop=l.bottom-l.top<=q-c?f.scrollTop+(l.bottom-q):f.scrollTop+(l.top-c);l.left<e?f.scrollLeft-=e-l.left:l.right>k&&(f.scrollLeft=l.right-l.left<=k-e?f.scrollLeft+(l.right-k):f.scrollLeft-(e-l.left))}}};(function(){function f(a,k,q,n,p){var g,h=0,b;for(b in a)if(a.hasOwnProperty(b)){if(h===q){g=b;break}h+=1}g?k.getPartData(a[g].href,function(b,h){if(b)runtime.log(b);else if(h){var m="@font-face { font-family: "+(a[g].family||g)+"; src: url(data:application/x-font-ttf;charset=binary;base64,"+e.convertUTF8ArrayToBase64(h)+') format("truetype"); }';try{n.insertRule(m,n.cssRules.length)}catch(l){runtime.log("Problem inserting rule in CSS: "+runtime.toJson(l)+"\nRule: "+m)}}else runtime.log("missing font data for "+
a[g].href);f(a,k,q+1,n,p)}):p&&p()}var l=xmldom.XPath,a=odf.OdfUtils,e=new core.Base64;odf.FontLoader=function(){this.loadFonts=function(c,e){for(var q=c.rootElement.fontFaceDecls;e.cssRules.length;)e.deleteRule(e.cssRules.length-1);if(q){var n={},p,g,h,b;if(q)for(q=l.getODFElementsWithXPath(q,"style:font-face[svg:font-face-src]",odf.Namespaces.lookupNamespaceURI),p=0;p<q.length;p+=1)g=q[p],h=g.getAttributeNS(odf.Namespaces.stylens,"name"),b=a.getNormalizedFontFamilyName(g.getAttributeNS(odf.Namespaces.svgns,
"font-family")),g=l.getODFElementsWithXPath(g,"svg:font-face-src/svg:font-face-uri",odf.Namespaces.lookupNamespaceURI),0<g.length&&(g=g[0].getAttributeNS(odf.Namespaces.xlinkns,"href"),n[h]={href:g,family:b});f(n,c,0,e)}}}})();odf.Formatting=function(){function f(b){return(b=A[b])?w.mergeObjects({},b):{}}function l(){for(var d=b.rootElement.fontFaceDecls,a={},c,e,d=d&&d.firstElementChild;d;){if(c=d.getAttributeNS(m,"name"))if((e=d.getAttributeNS(r,"font-family"))||0<d.getElementsByTagNameNS(r,"font-face-uri").length)a[c]=e;d=d.nextElementSibling}return a}function a(d){for(var a=b.rootElement.styles.firstElementChild;a;){if(a.namespaceURI===m&&"default-style"===a.localName&&a.getAttributeNS(m,"family")===d)return a;a=a.nextElementSibling}return null}
function e(d,a,c){var e,h,g;c=c||[b.rootElement.automaticStyles,b.rootElement.styles];for(g=0;g<c.length;g+=1)for(e=c[g],e=e.firstElementChild;e;){h=e.getAttributeNS(m,"name");if(e.namespaceURI===m&&"style"===e.localName&&e.getAttributeNS(m,"family")===a&&h===d||"list-style"===a&&e.namespaceURI===x&&"list-style"===e.localName&&h===d||"data"===a&&e.namespaceURI===t&&h===d)return e;e=e.nextElementSibling}return null}function c(b){for(var d,a,c,e,h={},g=b.firstElementChild;g;){if(g.namespaceURI===m)for(c=
h[g.nodeName]={},a=g.attributes,d=0;d<a.length;d+=1)e=a.item(d),c[e.name]=e.value;g=g.nextElementSibling}a=b.attributes;for(d=0;d<a.length;d+=1)e=a.item(d),h[e.name]=e.value;return h}function k(d,h){for(var g=b.rootElement.styles,k,r={},n=d.getAttributeNS(m,"family"),p=d;p;)k=c(p),r=w.mergeObjects(k,r),p=(k=p.getAttributeNS(m,"parent-style-name"))?e(k,n,[g]):null;if(p=a(n))k=c(p),r=w.mergeObjects(k,r);!1!==h&&(k=f(n),r=w.mergeObjects(k,r));return r}function q(a,c){function e(b){Object.keys(b).forEach(function(d){Object.keys(b[d]).forEach(function(b){k+=
"|"+d+":"+b+"|"})})}for(var h=a.nodeType===Node.TEXT_NODE?a.parentNode:a,m,g=[],k="",f=!1;h&&!v.isInlineRoot(h)&&h.parentNode!==b.rootElement;)!f&&v.isGroupingElement(h)&&(f=!0),(m=d.determineStylesForNode(h))&&g.push(m),h=h.parentNode;f&&(g.forEach(e),c&&(c[k]=g));return f?g:void 0}function n(d){var a={orderedStyles:[],styleProperties:{}};d.forEach(function(d){Object.keys(d).forEach(function(c){var h=Object.keys(d[c])[0],g={name:h,family:c,displayName:void 0,isCommonStyle:!1},f;(f=e(h,c))?(c=k(f),
a.styleProperties=w.mergeObjects(c,a.styleProperties),g.displayName=f.getAttributeNS(m,"display-name")||void 0,g.isCommonStyle=f.parentNode===b.rootElement.styles):runtime.log("No style element found for '"+h+"' of family '"+c+"'");a.orderedStyles.push(g)})});return a}function p(b,d){var a={},c=[];d||(d={});b.forEach(function(b){q(b,a)});Object.keys(a).forEach(function(b){d[b]||(d[b]=n(a[b]));c.push(d[b])});return c}function g(d){for(var a=b.rootElement.masterStyles.firstElementChild;a&&(a.namespaceURI!==
m||"master-page"!==a.localName||a.getAttributeNS(m,"name")!==d);)a=a.nextElementSibling;return a}function h(b,d){var a;b&&(a=u.convertMeasure(b,"px"));void 0===a&&d&&(a=u.convertMeasure(d,"px"));return a}var b,d=new odf.StyleInfo,r=odf.Namespaces.svgns,m=odf.Namespaces.stylens,x=odf.Namespaces.textns,t=odf.Namespaces.numberns,y=odf.Namespaces.fons,v=odf.OdfUtils,s=core.DomUtils,w=new core.Utils,u=new core.CSSUnits,A={paragraph:{"style:paragraph-properties":{"fo:text-align":"left"}}};this.getSystemDefaultStyleAttributes=
f;this.setOdfContainer=function(d){b=d};this.getFontMap=l;this.getAvailableParagraphStyles=function(){for(var d=b.rootElement.styles,a,c,e=[],d=d&&d.firstElementChild;d;)"style"===d.localName&&d.namespaceURI===m&&(a=d.getAttributeNS(m,"family"),"paragraph"===a&&(a=d.getAttributeNS(m,"name"),c=d.getAttributeNS(m,"display-name")||a,a&&c&&e.push({name:a,displayName:c}))),d=d.nextElementSibling;return e};this.isStyleUsed=function(a){var c,e=b.rootElement;c=d.hasDerivedStyles(e,odf.Namespaces.lookupNamespaceURI,
a);a=(new d.UsedStyleList(e.styles)).uses(a)||(new d.UsedStyleList(e.automaticStyles)).uses(a)||(new d.UsedStyleList(e.body)).uses(a);return c||a};this.getDefaultStyleElement=a;this.getStyleElement=e;this.getStyleAttributes=c;this.getInheritedStyleAttributes=k;this.getFirstCommonParentStyleNameOrSelf=function(d){var a=b.rootElement.styles,c;if(c=e(d,"paragraph",[b.rootElement.automaticStyles]))if(d=c.getAttributeNS(m,"parent-style-name"),!d)return null;return(c=e(d,"paragraph",[a]))?d:null};this.hasParagraphStyle=
function(b){return Boolean(e(b,"paragraph"))};this.getAppliedStyles=p;this.getAppliedStylesForElement=function(b,d){return p([b],d)[0]};this.updateStyle=function(d,a){var c,e;s.mapObjOntoNode(d,a,odf.Namespaces.lookupNamespaceURI);(c=(c=a["style:text-properties"])&&c["style:font-name"])&&!l().hasOwnProperty(c)&&(e=d.ownerDocument.createElementNS(m,"style:font-face"),e.setAttributeNS(m,"style:name",c),e.setAttributeNS(r,"svg:font-family",c),b.rootElement.fontFaceDecls.appendChild(e))};this.createDerivedStyleObject=
function(d,a,h){var m=e(d,a);runtime.assert(Boolean(m),"No style element found for '"+d+"' of family '"+a+"'");d=m.parentNode===b.rootElement.styles?{"style:parent-style-name":d}:c(m);d["style:family"]=a;w.mergeObjects(d,h);return d};this.getDefaultTabStopDistance=function(){for(var b=a("paragraph"),b=b&&b.firstElementChild,d;b;)b.namespaceURI===m&&"paragraph-properties"===b.localName&&(d=b.getAttributeNS(m,"tab-stop-distance")),b=b.nextElementSibling;d||(d="1.25cm");return v.parseNonNegativeLength(d)};
this.getMasterPageElement=g;this.getContentSize=function(d,a){var c,f,k,r,n,p,q,l,x,t;a:{f=e(d,a);runtime.assert("paragraph"===a||"table"===a,"styleFamily must be either paragraph or table");if(f){if(f=f.getAttributeNS(m,"master-page-name"))(c=g(f))||runtime.log("WARN: No master page definition found for "+f);c||(c=g("Standard"));c||(c=b.rootElement.masterStyles.getElementsByTagNameNS(m,"master-page")[0])||runtime.log("WARN: Document has no master pages defined");if(c)for(f=c.getAttributeNS(m,"page-layout-name"),
k=b.rootElement.automaticStyles.getElementsByTagNameNS(m,"page-layout"),r=0;r<k.length;r+=1)if(c=k.item(r),c.getAttributeNS(m,"name")===f)break a}c=null}c||(c=s.getDirectChild(b.rootElement.styles,m,"default-page-layout"));(c=s.getDirectChild(c,m,"page-layout-properties"))?("landscape"===c.getAttributeNS(m,"print-orientation")?(f="29.7cm",k="21.001cm"):(f="21.001cm",k="29.7cm"),f=h(c.getAttributeNS(y,"page-width"),f),k=h(c.getAttributeNS(y,"page-height"),k),r=h(c.getAttributeNS(y,"margin")),void 0===
r?(r=h(c.getAttributeNS(y,"margin-left"),"2cm"),n=h(c.getAttributeNS(y,"margin-right"),"2cm"),p=h(c.getAttributeNS(y,"margin-top"),"2cm"),q=h(c.getAttributeNS(y,"margin-bottom"),"2cm")):r=n=p=q=r,l=h(c.getAttributeNS(y,"padding")),void 0===l?(l=h(c.getAttributeNS(y,"padding-left"),"0cm"),x=h(c.getAttributeNS(y,"padding-right"),"0cm"),t=h(c.getAttributeNS(y,"padding-top"),"0cm"),c=h(c.getAttributeNS(y,"padding-bottom"),"0cm")):l=x=t=c=l):(f=h("21.001cm"),k=h("29.7cm"),r=n=p=q=r=h("2cm"),l=x=t=c=l=
h("0cm"));return{width:f-r-n-l-x,height:k-p-q-t-c}}};(function(){var f=odf.Namespaces.stylens,l=odf.Namespaces.textns,a={graphic:"draw","drawing-page":"draw",paragraph:"text",presentation:"presentation",ruby:"text",section:"text",table:"table","table-cell":"table","table-column":"table","table-row":"table",text:"text",list:"text",page:"office"};odf.StyleTreeNode=function(a){this.derivedStyles={};this.element=a};odf.StyleTree=function(e,c){function k(a){var b,d,c,e={};if(!a)return e;for(a=a.firstElementChild;a;){if(d=a.namespaceURI!==f||"style"!==a.localName&&
"default-style"!==a.localName?a.namespaceURI===l&&"list-style"===a.localName?"list":a.namespaceURI!==f||"page-layout"!==a.localName&&"default-page-layout"!==a.localName?void 0:"page":a.getAttributeNS(f,"family"))(b=a.getAttributeNS(f,"name"))||(b=""),e.hasOwnProperty(d)?c=e[d]:e[d]=c={},c[b]=a;a=a.nextElementSibling}return e}function q(a,b){if(a.hasOwnProperty(b))return a[b];var d=null,c=Object.keys(a),e;for(e=0;e<c.length&&!(d=q(a[c[e]].derivedStyles,b));e+=1);return d}function n(a,b,d){var c,e,
g;if(!b.hasOwnProperty(a))return null;c=new odf.StyleTreeNode(b[a]);e=c.element.getAttributeNS(f,"parent-style-name");g=null;e&&(g=q(d,e)||n(e,b,d));g?g.derivedStyles[a]=c:d[a]=c;delete b[a];return c}function p(a,b){a&&Object.keys(a).forEach(function(d){n(d,a,b)})}var g={};this.getStyleTree=function(){return g};(function(){var h,b,d;b=k(e);d=k(c);Object.keys(a).forEach(function(a){h=g[a]={};p(b[a],h);p(d[a],h)})})()}})();(function(){function f(a,c){try{a.insertRule(c,a.cssRules.length)}catch(e){runtime.log("cannot load rule: "+c+" - "+e)}}function l(a,c){this.listCounterCount=0;this.contentRules=a;this.counterIdStack=[];this.continuedCounterIdStack=c}function a(a){function c(d,e,h,n){var l=e.namespaceURI===k&&"list"===e.localName,q=e.namespaceURI===k&&"list-item"===e.localName;if(l||q){if(l){var l=h+=1,s,w,u;n.listCounterCount+=1;q=d+"-level"+l+"-"+n.listCounterCount;e.setAttributeNS("urn:webodf:names:helper","counter-id",
q);s=n.continuedCounterIdStack.shift();s||(s=q,b+=q+" 1 ",w='text|list[webodfhelper|counter-id="'+q+'"] > text|list-item:first-child > :not(text|list):first-child:before',w+="{",w+="counter-increment: "+s+" 0;",w+="}",f(a,w));for(;n.counterIdStack.length>=l;)n.counterIdStack.pop();n.counterIdStack.push(s);u=n.contentRules[l.toString()]||"";for(w=1;w<=l;w+=1)u=u.replace(w+"webodf-listLevel",n.counterIdStack[w-1]);w='text|list[webodfhelper|counter-id="'+q+'"] > text|list-item > :not(text|list):first-child:before';
w+="{";w+=u;w+="counter-increment: "+s+";";w+="}";f(a,w)}for(e=e.firstElementChild;e;)c(d,e,h,n),e=e.nextElementSibling}else n.continuedCounterIdStack=[]}var e=0,b="",d={};this.createCounterRules=function(b,a,f){var k=a.getAttributeNS(q,"id"),n=[];f&&(f=f.getAttributeNS("urn:webodf:names:helper","counter-id"),n=d[f].slice(0));b=new l(b,n);k?k="Y"+k:(e+=1,k="X"+e);c(k,a,0,b);d[k+"-level1-1"]=b.counterIdStack};this.initialiseCreatedCounters=function(){var d;d="office|document{"+("counter-reset: "+b+
";");d+="}";f(a,d)}}var e=odf.Namespaces.fons,c=odf.Namespaces.stylens,k=odf.Namespaces.textns,q=odf.Namespaces.xmlns,n={1:"decimal",a:"lower-latin",A:"upper-latin",i:"lower-roman",I:"upper-roman"};odf.ListStyleToCss=function(){function p(b){var a=r.parseLength(b);return a?d.convert(a.value,a.unit,"px"):(runtime.log("Could not parse value '"+b+"'."),0)}function g(b){return b.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function h(b,d){var a;b&&(a=b.getAttributeNS(k,"style-name"));return a===d}function b(b,
d,e){d=d.getElementsByTagNameNS(k,"list");b=new a(b);var f,r,p,l,u,A,F={},B;for(B=0;B<d.length;B+=1)if(f=d.item(B),A=f.getAttributeNS(k,"style-name")){p=f.getAttributeNS(k,"continue-numbering");l=f.getAttributeNS(k,"continue-list");(u=f.getAttributeNS(q,"id"))&&(F[u]=f);if(void 0===e[A])u={};else{u=e[A].element.firstElementChild;for(var E=void 0,J={};u;){var E=(E=u.getAttributeNS(k,"level"))&&parseInt(E,10),H=J,Q=u,N="",z=void 0,Z=void 0,R=z=void 0;if("list-level-style-number"===Q.localName){var I=
Q,N=I.getAttributeNS(c,"num-format"),z=I.getAttributeNS(c,"num-suffix")||"",Z=I.getAttributeNS(c,"num-prefix")||"",G="",ba=I.getAttributeNS(k,"level"),I=I.getAttributeNS(k,"display-levels");Z&&(G+='"'+g(Z)+'"\n');if(n.hasOwnProperty(N))for(ba=ba?parseInt(ba,10):1,I=I?parseInt(I,10):1;0<I;)G+=" counter("+(ba-I+1)+"webodf-listLevel,"+n[N]+")",1<I&&(G+='"."'),I-=1;else G=N?G+(' "'+N+'"'):G+' ""';N="content:"+G+' "'+g(z)+'"'}else"list-level-style-image"===Q.localName?N="content: none":"list-level-style-bullet"===
Q.localName&&(N=Q.getAttributeNS(k,"bullet-char"),N='content: "'+g(N)+'"');if(z=Q.getElementsByTagNameNS(c,"list-level-properties")[0])Z=z.getAttributeNS(k,"list-level-position-and-space-mode"),"label-alignment"===Z&&((z=z.getElementsByTagNameNS(c,"list-level-label-alignment")[0])&&(R=z.getAttributeNS(k,"label-followed-by")),"space"===R&&(N+=' "\\a0"'));H[E]="\n"+N+";\n";u=u.nextElementSibling}u=J}p&&!l&&h(r,A)?b.createCounterRules(u,f,r):l&&h(F[l],A)?b.createCounterRules(u,f,F[l]):b.createCounterRules(u,
f);r=f}b.initialiseCreatedCounters()}var d=new core.CSSUnits,r=odf.OdfUtils;this.applyListStyles=function(d,a,h){var g,r;(g=a.list)&&Object.keys(g).forEach(function(b){r=g[b];for(var a=r.element.firstElementChild;a;){if(a.namespaceURI===k){for(var h=d,n=a,l='text|list[text|style-name="'+b+'"]',q=n.getAttributeNS(k,"level"),x=void 0,t=void 0,H=t=void 0,Q=void 0,N=void 0,z=x=void 0,Z=void 0,R=void 0,I=void 0,Q=void 0,H=(t=n.getElementsByTagNameNS(c,"list-level-properties")[0])&&t.getAttributeNS(k,"list-level-position-and-space-mode"),
Q=t&&t.getElementsByTagNameNS(c,"list-level-label-alignment")[0],x=q=q&&parseInt(q,10);1<x;)l+=" > text|list-item > text|list",x-=1;x=t&&t.getAttributeNS(e,"text-align")||"left";switch(x){case "end":x="right";break;case "start":x="left"}"label-alignment"===H?(N=Q&&Q.getAttributeNS(e,"margin-left")||"0px",R=Q&&Q.getAttributeNS(e,"text-indent")||"0px",I=Q&&Q.getAttributeNS(k,"label-followed-by"),Q=p(N)):(N=t&&t.getAttributeNS(k,"space-before")||"0px",z=t&&t.getAttributeNS(k,"min-label-width")||"0px",
Z=t&&t.getAttributeNS(k,"min-label-distance")||"0px",Q=p(N)+p(z));t=l+" > text|list-item";t+="{";t+="margin-left: "+Q+"px;";t+="}";f(h,t);t=l+" > text|list-item > text|list";t+="{";t+="margin-left: "+-Q+"px;";t+="}";f(h,t);t=l+" > text|list-item > :not(text|list):first-child:before";t+="{";t+="text-align: "+x+";";t+="display: inline-block;";"label-alignment"===H?(t+="margin-left: "+R+";","listtab"===I&&(t+="padding-right: 0.2cm;")):(t+="min-width: "+z+";",t+="margin-left: "+(0===parseFloat(z)?"":
"-")+z+";",t+="padding-right: "+Z+";");t+="}";f(h,t)}a=a.nextElementSibling}});b(d,h,g)}}})();odf.LazyStyleProperties=function(f,l){var a={};this.value=function(e){var c;a.hasOwnProperty(e)?c=a[e]:(c=l[e](),void 0===c&&f&&(c=f.value(e)),a[e]=c);return c};this.reset=function(e){f=e;a={}}};
odf.StyleParseUtils=function(){function f(a){var e,c;a=(a=/(-?[0-9]*[0-9][0-9]*(\.[0-9]*)?|0+\.[0-9]*[1-9][0-9]*|\.[0-9]*[1-9][0-9]*)((cm)|(mm)|(in)|(pt)|(pc)|(px))/.exec(a))?{value:parseFloat(a[1]),unit:a[3]}:null;c=a&&a.unit;"px"===c?e=a.value:"cm"===c?e=96*(a.value/2.54):"mm"===c?e=96*(a.value/25.4):"in"===c?e=96*a.value:"pt"===c?e=a.value/0.75:"pc"===c&&(e=16*a.value);return e}var l=odf.Namespaces.stylens;this.parseLength=f;this.parsePositiveLengthOrPercent=function(a,e,c){var k;a&&(k=parseFloat(a.substr(0,
a.indexOf("%"))),isNaN(k)&&(k=void 0));var l;void 0!==k?(c&&(l=c.value(e)),k=void 0===l?void 0:k*(l/100)):k=f(a);return k};this.getPropertiesElement=function(a,e,c){for(e=c?c.nextElementSibling:e.firstElementChild;null!==e&&(e.localName!==a||e.namespaceURI!==l);)e=e.nextElementSibling;return e};this.parseAttributeList=function(a){a&&(a=a.replace(/^\s*(.*?)\s*$/g,"$1"));return a&&0<a.length?a.split(/\s+/):[]}};odf.Style2CSS=function(){function f(b,d,a){var c=[];a=a.derivedStyles;var e;var h=y[b],g;void 0===h?d=null:(g=d?"["+h+'|style-name="'+d+'"]':"","presentation"===h&&(h="draw",g=d?'[presentation|style-name="'+d+'"]':""),d=h+"|"+v[b].join(g+","+h+"|")+g);null!==d&&c.push(d);for(e in a)a.hasOwnProperty(e)&&(d=f(b,e,a[e]),c=c.concat(d));return c}function l(b){var d="",a="",d=null;if("default-style"===b.localName)return null;d=b.getAttributeNS(h,"parent-style-name");a=b.getAttributeNS(h,"family");return d=
T.getODFElementsWithXPath(G,d?"//style:*[@style:name='"+d+"'][@style:family='"+a+"']":"//style:default-style[@style:family='"+a+"']",odf.Namespaces.lookupNamespaceURI)[0]}function a(b,d){var a="",c,e,g;for(c=0;c<d.length;c+=1)if(e=d[c],g=b.getAttributeNS(e[0],e[1])){g=g.trim();if(N.hasOwnProperty(e[1])){var m=g,f=m.indexOf(" "),k=void 0;g=void 0;-1!==f?(k=m.substring(0,f),g=m.substring(f)):(k=m,g="");(k=R.parseLength(k))&&"pt"===k.unit&&0.75>k.value&&(m="0.75pt"+g);g=m}else if(z.hasOwnProperty(e[1])){var m=
b,f=e[0],k=e[1],r=R.parseLength(g),n=void 0,p=void 0,q=void 0,s=void 0,q=void 0;if(r&&"%"===r.unit){n=r.value/100;p=l(m.parentNode);for(s="0";p;){if(q=x.getDirectChild(p,h,"paragraph-properties"))if(q=R.parseLength(q.getAttributeNS(f,k))){if("%"!==q.unit){s=q.value*n+q.unit;break}n*=q.value/100}p=l(p)}g=s}}e[2]&&(a+=e[2]+":"+g+";")}return a}function e(b,d,a,c){return d+d+a+a+c+c}function c(b,d){var a=[b],e=d.derivedStyles;Object.keys(e).forEach(function(b){b=c(b,e[b]);a=a.concat(b)});return a}function k(b,
d,a,e){function h(d,a){var c=[],e;d.forEach(function(b){g.forEach(function(d){c.push('draw|page[webodfhelper|page-style-name="'+d+'"] draw|frame[presentation|class="'+b+'"]')})});0<c.length&&(e=c.join(",")+"{visibility:"+a+";}",b.insertRule(e,b.cssRules.length))}var g=c(d,e),f=[],k=[];["page-number","date-time","header","footer"].forEach(function(b){var d;d=a.getAttributeNS(m,"display-"+b);"true"===d?f.push(b):"false"===d&&k.push(b)});h(f,"visible");h(k,"hidden")}function q(b,c,z,N){var v,y;if("page"===
c){var G=N.element,T="",P,Y;Y=P="";z=x.getDirectChild(G,h,"page-layout-properties");var S;if(z)if(S=G.getAttributeNS(h,"name"),T+=a(z,H),(P=x.getDirectChild(z,h,"background-image"))&&(Y=P.getAttributeNS(r,"href"))&&(T=T+("background-image: url('odfkit:"+Y+"');")+a(P,w)),"presentation"===I)for(G=(G=x.getDirectChild(G.parentNode.parentNode,g,"master-styles"))&&G.firstElementChild;G;)G.namespaceURI===h&&"master-page"===G.localName&&G.getAttributeNS(h,"page-layout-name")===S&&(Y=G.getAttributeNS(h,"name"),
P='draw|page[draw|master-page-name="'+Y+'"] {'+T+"}",Y='office|body, draw|page[draw|master-page-name="'+Y+'"] {'+a(z,Q)+" }",b.insertRule(P,b.cssRules.length),b.insertRule(Y,b.cssRules.length)),G=G.nextElementSibling;else"text"===I&&(P="office|text {"+T+"}",Y="office|body {width: "+z.getAttributeNS(p,"page-width")+";}",b.insertRule(P,b.cssRules.length),b.insertRule(Y,b.cssRules.length))}else{T=f(c,z,N).join(",");S="";if(G=x.getDirectChild(N.element,h,"text-properties")){var K=G,ea=y="";P="";Y=1;G=
""+a(K,s);v=K.getAttributeNS(h,"text-underline-style");"solid"===v&&(y+=" underline");v=K.getAttributeNS(h,"text-line-through-style");"solid"===v&&(y+=" line-through");y.length&&(G=G+("text-decoration:"+y+";\n")+("text-decoration-line:"+y+";\n"),G+="-moz-text-decoration-line:"+y+";\n");v=K.getAttributeNS(h,"text-line-through-type");switch(v){case "double":ea+=" double";break;case "single":ea+=" single"}ea&&(G+="text-decoration-style:"+ea+";\n",G+="-moz-text-decoration-style:"+ea+";\n");if(y=K.getAttributeNS(h,
"font-name")||K.getAttributeNS(p,"font-family"))v=Z[y],G+="font-family: "+(v||y)+";";if(v=K.getAttributeNS(h,"text-position"))y=t.parseAttributeList(v),v=y[0],y=y[1],G+="vertical-align: "+v+"\n; ",y&&(Y=parseFloat(y)/100);if(K.hasAttributeNS(p,"font-size")||1!==Y){for(K=K.parentNode;K;){if(v=(v=x.getDirectChild(K,h,"text-properties"))?R.parseFoFontSize(v.getAttributeNS(p,"font-size")):null){if("%"!==v.unit){P="font-size: "+v.value*Y+v.unit+";";break}Y*=v.value/100}K=l(K)}P||(P="font-size: "+parseFloat(ba)*
Y+D.getUnits(ba)+";")}G+=P;S+=G}if(G=x.getDirectChild(N.element,h,"paragraph-properties"))P=G,G=""+a(P,u),(Y=x.getDirectChild(P,h,"background-image"))&&(K=Y.getAttributeNS(r,"href"))&&(G=G+("background-image: url('odfkit:"+K+"');")+a(Y,w)),(P=P.getAttributeNS(p,"line-height"))&&"normal"!==P&&(P=R.parseFoLineHeight(P),G="%"!==P.unit?G+("line-height: "+P.value+P.unit+";"):G+("line-height: "+P.value/100+";")),S+=G;if(G=x.getDirectChild(N.element,h,"graphic-properties"))K=G,G=""+a(K,A),P=K.getAttributeNS(n,
"opacity"),Y=K.getAttributeNS(n,"fill"),K=K.getAttributeNS(n,"fill-color"),"solid"===Y||"hatch"===Y?K&&"none"!==K?(P=isNaN(parseFloat(P))?1:parseFloat(P)/100,Y=K.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,e),(K=(Y=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(Y))?{r:parseInt(Y[1],16),g:parseInt(Y[2],16),b:parseInt(Y[3],16)}:null)&&(G+="background-color: rgba("+K.r+","+K.g+","+K.b+","+P+");")):G+="background: none;":"none"===Y&&(G+="background: none;"),S+=G;if(G=x.getDirectChild(N.element,h,"drawing-page-properties"))P=
G,Y=""+a(P,A),"true"===P.getAttributeNS(m,"background-visible")&&(Y+="background: none;"),S+=Y,k(b,z,G,N);if(G=x.getDirectChild(N.element,h,"table-cell-properties"))z=S,S=""+a(G,F),S=z+S;if(G=x.getDirectChild(N.element,h,"table-row-properties"))z=S,S=""+a(G,E),S=z+S;if(G=x.getDirectChild(N.element,h,"table-column-properties"))z=S,S=""+a(G,B),S=z+S;if(G=x.getDirectChild(N.element,h,"table-properties"))z=S,S=""+a(G,J),G=G.getAttributeNS(d,"border-model"),"collapsing"===G?S+="border-collapse:collapse;":
"separating"===G&&(S+="border-collapse:separate;"),S=z+S;0!==S.length&&b.insertRule(T+"{"+S+"}",b.cssRules.length)}for(var ga in N.derivedStyles)N.derivedStyles.hasOwnProperty(ga)&&q(b,c,ga,N.derivedStyles[ga])}var n=odf.Namespaces.drawns,p=odf.Namespaces.fons,g=odf.Namespaces.officens,h=odf.Namespaces.stylens,b=odf.Namespaces.svgns,d=odf.Namespaces.tablens,r=odf.Namespaces.xlinkns,m=odf.Namespaces.presentationns,x=core.DomUtils,t=new odf.StyleParseUtils,y={graphic:"draw","drawing-page":"draw",paragraph:"text",
presentation:"presentation",ruby:"text",section:"text",table:"table","table-cell":"table","table-column":"table","table-row":"table",text:"text",list:"text",page:"office"},v={graphic:"circle connected control custom-shape ellipse frame g line measure page page-thumbnail path polygon polyline rect regular-polygon".split(" "),paragraph:"alphabetical-index-entry-template h illustration-index-entry-template index-source-style object-index-entry-template p table-index-entry-template table-of-content-entry-template user-index-entry-template".split(" "),
presentation:"caption circle connector control custom-shape ellipse frame g line measure page-thumbnail path polygon polyline rect regular-polygon".split(" "),"drawing-page":"caption circle connector control page custom-shape ellipse frame g line measure page-thumbnail path polygon polyline rect regular-polygon".split(" "),ruby:["ruby","ruby-text"],section:"alphabetical-index bibliography illustration-index index-title object-index section table-of-content table-index user-index".split(" "),table:["background",
"table"],"table-cell":"body covered-table-cell even-columns even-rows first-column first-row last-column last-row odd-columns odd-rows table-cell".split(" "),"table-column":["table-column"],"table-row":["table-row"],text:"a index-entry-chapter index-entry-link-end index-entry-link-start index-entry-page-number index-entry-span index-entry-tab-stop index-entry-text index-title-template linenumbering-configuration list-level-style-number list-level-style-bullet outline-level-style span".split(" "),
list:["list-item"]},s=[[p,"color","color"],[p,"background-color","background-color"],[p,"font-weight","font-weight"],[p,"font-style","font-style"]],w=[[h,"repeat","background-repeat"]],u=[[p,"background-color","background-color"],[p,"text-align","text-align"],[p,"text-indent","text-indent"],[p,"padding","padding"],[p,"padding-left","padding-left"],[p,"padding-right","padding-right"],[p,"padding-top","padding-top"],[p,"padding-bottom","padding-bottom"],[p,"border-left","border-left"],[p,"border-right",
"border-right"],[p,"border-top","border-top"],[p,"border-bottom","border-bottom"],[p,"margin","margin"],[p,"margin-left","margin-left"],[p,"margin-right","margin-right"],[p,"margin-top","margin-top"],[p,"margin-bottom","margin-bottom"],[p,"border","border"]],A=[[p,"background-color","background-color"],[p,"min-height","min-height"],[n,"stroke","border"],[b,"stroke-color","border-color"],[b,"stroke-width","border-width"],[p,"border","border"],[p,"border-left","border-left"],[p,"border-right","border-right"],
[p,"border-top","border-top"],[p,"border-bottom","border-bottom"]],F=[[p,"background-color","background-color"],[p,"border-left","border-left"],[p,"border-right","border-right"],[p,"border-top","border-top"],[p,"border-bottom","border-bottom"],[p,"border","border"]],B=[[h,"column-width","width"]],E=[[h,"row-height","height"],[p,"keep-together",null]],J=[[h,"width","width"],[p,"margin-left","margin-left"],[p,"margin-right","margin-right"],[p,"margin-top","margin-top"],[p,"margin-bottom","margin-bottom"]],
H=[[p,"background-color","background-color"],[p,"padding","padding"],[p,"padding-left","padding-left"],[p,"padding-right","padding-right"],[p,"padding-top","padding-top"],[p,"padding-bottom","padding-bottom"],[p,"border","border"],[p,"border-left","border-left"],[p,"border-right","border-right"],[p,"border-top","border-top"],[p,"border-bottom","border-bottom"],[p,"margin","margin"],[p,"margin-left","margin-left"],[p,"margin-right","margin-right"],[p,"margin-top","margin-top"],[p,"margin-bottom","margin-bottom"]],
Q=[[p,"page-width","width"],[p,"page-height","height"]],N={border:!0,"border-left":!0,"border-right":!0,"border-top":!0,"border-bottom":!0,"stroke-width":!0},z={margin:!0,"margin-left":!0,"margin-right":!0,"margin-top":!0,"margin-bottom":!0},Z={},R=odf.OdfUtils,I,G,ba,T=xmldom.XPath,D=new core.CSSUnits;this.style2css=function(b,d,a,c,e){function h(b,d){g="@namespace "+b+" url("+d+");";try{a.insertRule(g,a.cssRules.length)}catch(c){}}var g,m,f;for(G=d;a.cssRules.length;)a.deleteRule(a.cssRules.length-
1);odf.Namespaces.forEachPrefix(h);h("webodfhelper","urn:webodf:names:helper");Z=c;I=b;ba=runtime.getWindow().getComputedStyle(document.body,null).getPropertyValue("font-size")||"12pt";for(f in y)if(y.hasOwnProperty(f))for(m in b=e[f],b)b.hasOwnProperty(m)&&q(a,f,m,b[m])}};(function(){function f(l,a){var e=this;this.getDistance=function(a){var f=e.x-a.x;a=e.y-a.y;return Math.sqrt(f*f+a*a)};this.getCenter=function(a){return new f((e.x+a.x)/2,(e.y+a.y)/2)};e.x=l;e.y=a}gui.ZoomHelper=function(){function l(b,a,c,e){b=e?"translate3d("+b+"px, "+a+"px, 0) scale3d("+c+", "+c+", 1)":"translate("+b+"px, "+a+"px) scale("+c+")";d.style.WebkitTransform=b;d.style.MozTransform=b;d.style.msTransform=b;d.style.OTransform=b;d.style.transform=b}function a(b){b?l(-r.x,-r.y,t,!0):(l(0,
0,t,!0),l(0,0,t,!1))}function e(b){if(s&&B){var d=s.style.overflow,a=s.classList.contains("webodf-customScrollbars");b&&a||!b&&!a||(b?(s.classList.add("webodf-customScrollbars"),s.style.overflow="hidden",runtime.requestAnimationFrame(function(){s.style.overflow=d})):s.classList.remove("webodf-customScrollbars"))}}function c(){l(-r.x,-r.y,t,!0);s.scrollLeft=0;s.scrollTop=0;E=w.style.overflow;w.style.overflow="visible";e(!1)}function k(){l(0,0,t,!0);s.scrollLeft=r.x;s.scrollTop=r.y;w.style.overflow=
E||"";e(!0)}function q(b){return new f(b.pageX-d.offsetLeft,b.pageY-d.offsetTop)}function n(b){m&&(r.x-=b.x-m.x,r.y-=b.y-m.y,r=new f(Math.min(Math.max(r.x,d.offsetLeft),(d.offsetLeft+d.offsetWidth)*t-s.clientWidth),Math.min(Math.max(r.y,d.offsetTop),(d.offsetTop+d.offsetHeight)*t-s.clientHeight)));m=b}function p(b){var d=b.touches.length,a=0<d?q(b.touches[0]):null;b=1<d?q(b.touches[1]):null;a&&b?(x=a.getDistance(b),y=t,m=a.getCenter(b),c(),F=A.PINCH):a&&(m=a,F=A.SCROLL)}function g(b){var e=b.touches.length,
h=0<e?q(b.touches[0]):null,e=1<e?q(b.touches[1]):null;if(h&&e)if(b.preventDefault(),F===A.SCROLL)F=A.PINCH,c(),x=h.getDistance(e);else{b=h.getCenter(e);h=h.getDistance(e)/x;n(b);var e=t,g=Math.min(v,d.offsetParent.clientWidth/d.offsetWidth);t=y*h;t=Math.min(Math.max(t,g),v);h=t/e;r.x+=(h-1)*(b.x+r.x);r.y+=(h-1)*(b.y+r.y);a(!0)}else h&&(F===A.PINCH?(F=A.SCROLL,k()):n(h))}function h(){F===A.PINCH&&(u.emit(gui.ZoomHelper.signalZoomChanged,t),k(),a(!1));F=A.NONE}function b(){s&&(s.removeEventListener("touchstart",
p,!1),s.removeEventListener("touchmove",g,!1),s.removeEventListener("touchend",h,!1))}var d,r,m,x,t,y,v=4,s,w,u=new core.EventNotifier([gui.ZoomHelper.signalZoomChanged]),A={NONE:0,SCROLL:1,PINCH:2},F=A.NONE,B=runtime.getWindow().hasOwnProperty("ontouchstart"),E="";this.subscribe=function(b,d){u.subscribe(b,d)};this.unsubscribe=function(b,d){u.unsubscribe(b,d)};this.getZoomLevel=function(){return t};this.setZoomLevel=function(b){d&&(t=b,a(!1),u.emit(gui.ZoomHelper.signalZoomChanged,t))};this.destroy=
function(d){b();e(!1);d()};this.setZoomableElement=function(c){b();d=c;s=d.offsetParent;w=d.parentNode;a(!1);s&&(s.addEventListener("touchstart",p,!1),s.addEventListener("touchmove",g,!1),s.addEventListener("touchend",h,!1));e(!0)};y=t=1;r=new f(0,0)};gui.ZoomHelper.signalZoomChanged="zoomChanged"})();ops.Canvas=function(){};ops.Canvas.prototype.getZoomLevel=function(){};ops.Canvas.prototype.getElement=function(){};ops.Canvas.prototype.getSizer=function(){};ops.Canvas.prototype.getZoomHelper=function(){};(function(){function f(){function b(c){a=!0;runtime.setTimeout(function(){try{c()}catch(e){runtime.log(String(e)+"\n"+e.stack)}a=!1;0<d.length&&b(d.pop())},10)}var d=[],a=!1;this.clearQueue=function(){d.length=0};this.addToQueue=function(c){if(0===d.length&&!a)return b(c);d.push(c)}}function l(b){function d(){for(;0<a.cssRules.length;)a.deleteRule(0);a.insertRule("#shadowContent draw|page {display:none;}",0);a.insertRule("office|presentation draw|page {display:none;}",1);a.insertRule("#shadowContent draw|page:nth-of-type("+
c+") {display:block;}",2);a.insertRule("office|presentation draw|page:nth-of-type("+c+") {display:block;}",3)}var a=b.sheet,c=1;this.showFirstPage=function(){c=1;d()};this.showNextPage=function(){c+=1;d()};this.showPreviousPage=function(){1<c&&(c-=1,d())};this.showPage=function(b){0<b&&(c=b,d())};this.css=b;this.destroy=function(d){b.parentNode.removeChild(b);d()}}function a(b){b=b.sheet;for(var d=b.cssRules;d.length;)b.deleteRule(d.length-1)}function e(b,d,a){var c=new odf.Style2CSS,e=new odf.ListStyleToCss;
a=a.sheet;var h=(new odf.StyleTree(b.rootElement.styles,b.rootElement.automaticStyles)).getStyleTree();c.style2css(b.getDocumentType(),b.rootElement,a,d.getFontMap(),h);e.applyListStyles(a,h,b.rootElement.body)}function c(b,d){(new odf.FontLoader).loadFonts(b,d.sheet)}function k(b,d,a){var c=null;b=b.rootElement.body.getElementsByTagNameNS(E,a+"-decl");a=d.getAttributeNS(E,"use-"+a+"-name");var e;if(a&&0<b.length)for(d=0;d<b.length;d+=1)if(e=b[d],e.getAttributeNS(E,"name")===a){c=e.textContent;break}return c}
function q(b,d,a,c){var e=b.ownerDocument;d=H.getElementsByTagNameNS(b,d,a);for(b=0;b<d.length;b+=1)H.removeAllChildNodes(d[b]),c&&(a=d[b],a.appendChild(e.createTextNode(c)))}function n(b,d,a){d.setAttributeNS("urn:webodf:names:helper","styleid",b);var c,e=d.getAttributeNS(F,"anchor-type"),h=d.getAttributeNS(u,"x"),g=d.getAttributeNS(u,"y"),m=d.getAttributeNS(u,"width"),f=d.getAttributeNS(u,"height"),k=d.getAttributeNS(v,"min-height"),r=d.getAttributeNS(v,"min-width");if("as-char"===e)c="display: inline-block;";
else if(e||h||g)c="position: absolute;";else if(m||f||k||r)c="display: block;";h&&(c+="left: "+h+";");g&&(c+="top: "+g+";");m&&(c+="width: "+m+";");f&&(c+="height: "+f+";");k&&(c+="min-height: "+k+";");r&&(c+="min-width: "+r+";");c&&(c="draw|"+d.localName+'[webodfhelper|styleid="'+b+'"] {'+c+"}",a.insertRule(c,a.cssRules.length))}function p(b){for(b=b.firstChild;b;){if(b.namespaceURI===s&&"binary-data"===b.localName)return"data:image/png;base64,"+b.textContent.replace(/[\r\n\s]/g,"");b=b.nextSibling}return""}
function g(b,d,a,c){function e(d){d&&(d='draw|image[webodfhelper|styleid="'+b+'"] {'+("background-image: url("+d+");")+"}",c.insertRule(d,c.cssRules.length))}function h(b){e(b.url)}a.setAttributeNS("urn:webodf:names:helper","styleid",b);var g=a.getAttributeNS(B,"href"),m;if(g)try{m=d.getPart(g),m.onchange=h,m.load()}catch(f){runtime.log("slight problem: "+String(f))}else g=p(a),e(g)}function h(b){var d=b.ownerDocument;H.getElementsByTagNameNS(b,F,"line-break").forEach(function(b){b.hasChildNodes()||
b.appendChild(d.createElement("br"))})}function b(b){var d=b.ownerDocument;H.getElementsByTagNameNS(b,F,"s").forEach(function(b){var a,c;H.removeAllChildNodes(b);b.appendChild(d.createTextNode(" "));c=parseInt(b.getAttributeNS(F,"c"),10);if(1<c)for(b.removeAttributeNS(F,"c"),a=1;a<c;a+=1)b.parentNode.insertBefore(b.cloneNode(!0),b)})}function d(b){H.getElementsByTagNameNS(b,F,"tab").forEach(function(b){b.textContent="\t"})}function r(b,d){function a(b,c){var g=m.documentElement.namespaceURI;"video/"===
c.substr(0,6)?(e=m.createElementNS(g,"video"),e.setAttribute("controls","controls"),h=m.createElementNS(g,"source"),b&&h.setAttribute("src",b),h.setAttribute("type",c),e.appendChild(h),d.parentNode.appendChild(e)):d.innerHtml="Unrecognised Plugin"}function c(b){a(b.url,b.mimetype)}var e,h,g,m=d.ownerDocument,f;if(g=d.getAttributeNS(B,"href"))try{f=b.getPart(g),f.onchange=c,f.load()}catch(k){runtime.log("slight problem: "+String(k))}else runtime.log("using MP4 data fallback"),g=p(d),a(g,"video/mp4")}
function m(b){var d=b.getElementsByTagName("head")[0],a,c;a=b.styleSheets.length;for(c=d.firstElementChild;c&&("style"!==c.localName||!c.hasAttribute("webodfcss"));)c=c.nextElementSibling;if(c)return a=parseInt(c.getAttribute("webodfcss"),10),c.setAttribute("webodfcss",a+1),c;"string"===String(typeof webodf_css)?a=webodf_css:(c="webodf.css",runtime.currentDirectory&&(c=runtime.currentDirectory(),0<c.length&&"/"!==c.substr(-1)&&(c+="/"),c+="../webodf.css"),a=runtime.readFileSync(c,"utf-8"));c=b.createElementNS(d.namespaceURI,
"style");c.setAttribute("media","screen, print, handheld, projection");c.setAttribute("type","text/css");c.setAttribute("webodfcss","1");c.appendChild(b.createTextNode(a));d.appendChild(c);return c}function x(b){var d=parseInt(b.getAttribute("webodfcss"),10);1===d?b.parentNode.removeChild(b):b.setAttribute("count",d-1)}function t(b){var d=b.getElementsByTagName("head")[0],a=b.createElementNS(d.namespaceURI,"style"),c="";a.setAttribute("type","text/css");a.setAttribute("media","screen, print, handheld, projection");
odf.Namespaces.forEachPrefix(function(b,d){c+="@namespace "+b+" url("+d+");\n"});c+="@namespace webodfhelper url(urn:webodf:names:helper);\n";a.appendChild(b.createTextNode(c));d.appendChild(a);return a}var y=odf.Namespaces.drawns,v=odf.Namespaces.fons,s=odf.Namespaces.officens,w=odf.Namespaces.stylens,u=odf.Namespaces.svgns,A=odf.Namespaces.tablens,F=odf.Namespaces.textns,B=odf.Namespaces.xlinkns,E=odf.Namespaces.presentationns,J=xmldom.XPath,H=core.DomUtils;odf.OdfCanvas=function(p,v){function z(b,
d,a){function c(b,d,a,e){ja.addToQueue(function(){g(b,d,a,e)})}var e,h;e=d.getElementsByTagNameNS(y,"image");for(d=0;d<e.length;d+=1)h=e.item(d),c("image"+String(d),b,h,a)}function Z(b,d){function a(b,d){ja.addToQueue(function(){r(b,d)})}var c,e,h;e=d.getElementsByTagNameNS(y,"plugin");for(c=0;c<e.length;c+=1)h=e.item(c),a(b,h)}function u(){var b;b=aa.firstChild;var d=fa.getZoomLevel();b&&(aa.style.WebkitTransformOrigin="0% 0%",aa.style.MozTransformOrigin="0% 0%",aa.style.msTransformOrigin="0% 0%",
aa.style.OTransformOrigin="0% 0%",aa.style.transformOrigin="0% 0%",P&&((b=P.getMinimumHeightForAnnotationPane())?aa.style.minHeight=b:aa.style.removeProperty("min-height")),p.style.width=Math.round(d*aa.offsetWidth)+"px",p.style.height=Math.round(d*aa.offsetHeight)+"px",p.style.display="inline-block")}function B(a,c){var e=ea.sheet;H.removeAllChildNodes(p);aa=O.createElementNS(p.namespaceURI,"div");aa.style.display="inline-block";aa.style.background="white";aa.style.setProperty("float","left","important");
aa.appendChild(c);p.appendChild(aa);ca=O.createElementNS(p.namespaceURI,"div");ca.id="annotationsPane";ga=O.createElementNS(p.namespaceURI,"div");ga.id="shadowContent";ga.style.position="absolute";ga.style.top=0;ga.style.left=0;a.getContentElement().appendChild(ga);var g=c.body,m,f=[],r;for(m=g.firstElementChild;m&&m!==g;)if(m.namespaceURI===y&&(f[f.length]=m),m.firstElementChild)m=m.firstElementChild;else{for(;m&&m!==g&&!m.nextElementSibling;)m=m.parentNode;m&&m.nextElementSibling&&(m=m.nextElementSibling)}for(r=
0;r<f.length;r+=1)m=f[r],n("frame"+String(r),m,e);f=J.getODFElementsWithXPath(g,".//*[*[@text:anchor-type='paragraph']]",odf.Namespaces.lookupNamespaceURI);for(m=0;m<f.length;m+=1)g=f[m],g.setAttributeNS&&g.setAttributeNS("urn:webodf:names:helper","containsparagraphanchor",!0);g=C;m=ga;var l,t,x,v,N=0,u;r=a.rootElement.ownerDocument;if((f=c.body.firstElementChild)&&f.namespaceURI===s&&("presentation"===f.localName||"drawing"===f.localName))for(f=f.firstElementChild;f;){if(l=(l=f.getAttributeNS(y,
"master-page-name"))?g.getMasterPageElement(l):null){t=f.getAttributeNS("urn:webodf:names:helper","styleid");x=r.createElementNS(y,"draw:page");u=l.firstElementChild;for(N=0;u;)"true"!==u.getAttributeNS(E,"placeholder")&&(v=u.cloneNode(!0),x.appendChild(v)),u=u.nextElementSibling,N+=1;u=v=N=void 0;for(var R=H.getElementsByTagNameNS(x,y,"frame"),N=0;N<R.length;N+=1)v=R[N],(u=v.getAttributeNS(E,"class"))&&!/^(date-time|footer|header|page-number)$/.test(u)&&v.parentNode.removeChild(v);v=H.getElementsByTagNameNS(x,
y,"*");for(N=0;N<v.length;N+=1)n(t+"_"+N,v[N],e);m.appendChild(x);N=String(m.getElementsByTagNameNS(y,"page").length);q(x,F,"page-number",N);q(x,E,"header",k(a,f,"header"));q(x,E,"footer",k(a,f,"footer"));n(t,x,e);x.setAttributeNS("urn:webodf:names:helper","page-style-name",f.getAttributeNS(y,"style-name"));x.setAttributeNS(y,"draw:master-page-name",l.getAttributeNS(w,"name"))}f=f.nextElementSibling}g=p.namespaceURI;f=H.getElementsByTagNameNS(c.body,A,"table-cell");for(m=0;m<f.length;m+=1)r=f[m],
r.hasAttributeNS(A,"number-columns-spanned")&&r.setAttributeNS(g,"colspan",r.getAttributeNS(A,"number-columns-spanned")),r.hasAttributeNS(A,"number-rows-spanned")&&r.setAttributeNS(g,"rowspan",r.getAttributeNS(A,"number-rows-spanned"));h(c.body);b(c.body);d(c.body);z(a,c.body,e);Z(a,c.body);aa.insertBefore(ga,aa.firstChild);fa.setZoomableElement(aa)}function G(b){U?(ca.parentNode||aa.appendChild(ca),P&&P.forgetAnnotations(),P=new gui.AnnotationViewManager(D,b.body,ca,W),b=H.getElementsByTagNameNS(b.body,
s,"annotation"),P.addAnnotations(b),u()):ca.parentNode&&(aa.removeChild(ca),P.forgetAnnotations(),u())}function ba(b){function d(){a(S);a(K);a(ea);H.removeAllChildNodes(p);p.style.display="inline-block";var h=$.rootElement;p.ownerDocument.importNode(h,!0);C.setOdfContainer($);c($,S);e($,C,K);B($,h);G(h);b||ja.addToQueue(function(){var b=[$];if(da.hasOwnProperty("statereadychange")){var d=da.statereadychange,a;for(a=0;a<d.length;a+=1)d[a].apply(null,b)}})}$.state===odf.OdfContainer.DONE?d():(runtime.log("WARNING: refreshOdf called but ODF was not DONE."),
ha=runtime.setTimeout(function qa(){$.state===odf.OdfContainer.DONE?d():(runtime.log("will be back later..."),ha=runtime.setTimeout(qa,500))},100))}function T(b){ja.clearQueue();H.removeAllChildNodes(p);p.appendChild(p.ownerDocument.createTextNode(runtime.tr("Loading")+b+"..."));p.removeAttribute("style");$=new odf.OdfContainer(b,function(b){$=b;ba(!1)})}runtime.assert(null!==p&&void 0!==p,"odf.OdfCanvas constructor needs DOM element");runtime.assert(null!==p.ownerDocument&&void 0!==p.ownerDocument,
"odf.OdfCanvas constructor needs DOM");var D=this,O=p.ownerDocument,$,C=new odf.Formatting,V,aa=null,ca=null,U=!1,W=!1,P=null,Y,S,K,ea,ga,da={},ha,ma,la=!1,ia=!1,ja=new f,fa=new gui.ZoomHelper,pa=v||new gui.SingleScrollViewport(p.parentNode);this.refreshCSS=function(){la=!0;ma.trigger()};this.refreshSize=function(){ma.trigger()};this.odfContainer=function(){return $};this.setOdfContainer=function(b,d){$=b;ba(!0===d)};this.load=this.load=T;this.save=function(b){$.save(b)};this.addListener=function(b,
d){switch(b){case "click":var a=p,c=b;a.addEventListener?a.addEventListener(c,d,!1):a.attachEvent?a.attachEvent("on"+c,d):a["on"+c]=d;break;default:a=da.hasOwnProperty(b)?da[b]:da[b]=[],d&&-1===a.indexOf(d)&&a.push(d)}};this.getFormatting=function(){return C};this.getAnnotationViewManager=function(){return P};this.refreshAnnotations=function(){G($.rootElement)};this.rerenderAnnotations=function(){P&&(ia=!0,ma.trigger())};this.getSizer=function(){return aa};this.enableAnnotations=function(b,d){b!==
U&&(U=b,W=d,$&&G($.rootElement))};this.addAnnotation=function(b){P&&(P.addAnnotations([b]),u())};this.forgetAnnotation=function(b){P&&(P.forgetAnnotation(b),u())};this.getZoomHelper=function(){return fa};this.setZoomLevel=function(b){fa.setZoomLevel(b)};this.getZoomLevel=function(){return fa.getZoomLevel()};this.fitToContainingElement=function(b,d){var a=fa.getZoomLevel(),c=p.offsetHeight/a,a=b/(p.offsetWidth/a);d/c<a&&(a=d/c);fa.setZoomLevel(a)};this.fitToWidth=function(b){var d=p.offsetWidth/fa.getZoomLevel();
fa.setZoomLevel(b/d)};this.fitSmart=function(b,d){var a,c;c=fa.getZoomLevel();a=p.offsetWidth/c;c=p.offsetHeight/c;a=b/a;void 0!==d&&d/c<a&&(a=d/c);fa.setZoomLevel(Math.min(1,a))};this.fitToHeight=function(b){var d=p.offsetHeight/fa.getZoomLevel();fa.setZoomLevel(b/d)};this.showFirstPage=function(){V.showFirstPage()};this.showNextPage=function(){V.showNextPage()};this.showPreviousPage=function(){V.showPreviousPage()};this.showPage=function(b){V.showPage(b);u()};this.getElement=function(){return p};
this.getViewport=function(){return pa};this.getStyleSheet=function(){return Y};this.addCssForFrameWithImage=function(b){var d=b.getAttributeNS(y,"name"),a=b.firstElementChild;n(d,b,ea.sheet);a&&g(d+"img",$,a,ea.sheet)};this.destroy=function(b){var d=O.getElementsByTagName("head")[0],a=[V.destroy,ma.destroy];runtime.clearTimeout(ha);ca&&ca.parentNode&&ca.parentNode.removeChild(ca);fa.destroy(function(){aa&&(p.removeChild(aa),aa=null)});x(Y);d.removeChild(S);d.removeChild(K);d.removeChild(ea);core.Async.destroyAll(a,
b)};Y=m(O);V=new l(t(O));S=t(O);K=t(O);ea=t(O);ma=core.Task.createRedrawTask(function(){la&&(e($,C,K),la=!1);ia&&(P&&P.rerenderAnnotations(),ia=!1);u()});fa.subscribe(gui.ZoomHelper.signalZoomChanged,u)}})();odf.StepUtils=function(){this.getContentBounds=function(f){var l=f.container(),a,e;runtime.assert(f.isStep(),"Step iterator must be on a step");l.nodeType===Node.TEXT_NODE&&0<f.offset()?a=f.offset():(l=f.leftNode())&&l.nodeType===Node.TEXT_NODE&&(a=l.length);l&&(l.nodeType===Node.TEXT_NODE?(runtime.assert(0<a,"Empty text node found"),e={container:l,startOffset:a-1,endOffset:a}):e={container:l,startOffset:0,endOffset:l.childNodes.length});return e}};ops.MemberProperties=function(){};
ops.Member=function(f,l){var a=new ops.MemberProperties;this.getMemberId=function(){return f};this.getProperties=function(){return a};this.setProperties=function(e){Object.keys(e).forEach(function(c){a[c]=e[c]})};this.removeProperties=function(e){Object.keys(e).forEach(function(c){"fullName"!==c&&"color"!==c&&"imageUrl"!==c&&a.hasOwnProperty(c)&&delete a[c]})};runtime.assert(Boolean(f),"No memberId was supplied!");l.fullName||(l.fullName=runtime.tr("Unknown Author"));l.color||(l.color="black");l.imageUrl||
(l.imageUrl="avatar-joe.png");a=l};ops.Document=function(){};ops.Document.prototype.getMemberIds=function(){};ops.Document.prototype.removeCursor=function(f){};ops.Document.prototype.getDocumentElement=function(){};ops.Document.prototype.getRootNode=function(){};ops.Document.prototype.getDOMDocument=function(){};ops.Document.prototype.cloneDocumentElement=function(){};ops.Document.prototype.setDocumentElement=function(f){};ops.Document.prototype.subscribe=function(f,l){};ops.Document.prototype.unsubscribe=function(f,l){};
ops.Document.prototype.getCanvas=function(){};ops.Document.prototype.createRootFilter=function(f){};ops.Document.prototype.createPositionIterator=function(f){};ops.Document.signalCursorAdded="cursor/added";ops.Document.signalCursorRemoved="cursor/removed";ops.Document.signalCursorMoved="cursor/moved";ops.Document.signalMemberAdded="member/added";ops.Document.signalMemberUpdated="member/updated";ops.Document.signalMemberRemoved="member/removed";ops.OdtCursor=function(f,l){var a=this,e={},c,k,q=new core.EventNotifier([ops.OdtCursor.signalCursorUpdated]);this.removeFromDocument=function(){k.remove()};this.subscribe=function(a,c){q.subscribe(a,c)};this.unsubscribe=function(a,c){q.unsubscribe(a,c)};this.getMemberId=function(){return f};this.getNode=function(){return k.getNode()};this.getAnchorNode=function(){return k.getAnchorNode()};this.getSelectedRange=function(){return k.getSelectedRange()};this.setSelectedRange=function(c,e){k.setSelectedRange(c,
e);q.emit(ops.OdtCursor.signalCursorUpdated,a)};this.hasForwardSelection=function(){return k.hasForwardSelection()};this.getDocument=function(){return l};this.getSelectionType=function(){return c};this.setSelectionType=function(a){e.hasOwnProperty(a)?c=a:runtime.log("Invalid selection type: "+a)};this.resetSelectionType=function(){a.setSelectionType(ops.OdtCursor.RangeSelection)};k=new core.Cursor(l.getDOMDocument(),f);e[ops.OdtCursor.RangeSelection]=!0;e[ops.OdtCursor.RegionSelection]=!0;a.resetSelectionType()};
ops.OdtCursor.RangeSelection="Range";ops.OdtCursor.RegionSelection="Region";ops.OdtCursor.signalCursorUpdated="cursorUpdated";(function(){var f=0;ops.StepsCache=function(l,a,e){function c(b,d){var a=this;this.nodeId=b;this.steps=-1;this.node=d;this.previousBookmark=this.nextBookmark=null;this.setIteratorPosition=function(b){b.setPositionBeforeElement(d);e(a.steps,b)}}function k(b,d,a){var c=this;this.nodeId=b;this.steps=d;this.node=a;this.previousBookmark=this.nextBookmark=null;this.setIteratorPosition=function(b){b.setUnfilteredPosition(a,0);e(c.steps,b)}}function q(b,d){var a="["+b.nodeId;d&&(a+=" => "+d.nodeId);return a+
"]"}function n(){for(var b=y,d,a,c,e=new core.LoopWatchDog(0,1E5),h={};b;){e.check();(d=b.previousBookmark)?runtime.assert(d.nextBookmark===b,"Broken bookmark link to previous @"+q(d,b)):(runtime.assert(b===y,"Broken bookmark link @"+q(b)),runtime.assert(void 0===v||y===y||y.steps<=v,"Base point is damaged @"+q(b)));(a=b.nextBookmark)&&runtime.assert(a.previousBookmark===b,"Broken bookmark link to next @"+q(b,a));if(void 0===v||b===y||b.steps<=v)runtime.assert(t.containsNode(l,b.node),"Disconnected node is being reported as undamaged @"+
q(b)),d&&(c=b.node.compareDocumentPosition(d.node),runtime.assert(0===c||0!==(c&w),"Bookmark order with previous does not reflect DOM order @"+q(d,b))),a&&t.containsNode(l,a.node)&&(c=b.node.compareDocumentPosition(a.node),runtime.assert(0===c||0!==(c&s),"Bookmark order with next does not reflect DOM order @"+q(b,a)));b=b.nextBookmark}Object.keys(m).forEach(function(b){var d=m[b];(void 0===v||b<=v)&&runtime.assert(d.steps<=b,"Bookmark step of "+d.steps+" exceeds cached step lookup for "+b+" @"+q(d));
runtime.assert(!1===h.hasOwnProperty(d.nodeId),"Bookmark "+q(d)+" appears twice in cached step lookup at steps "+h[d.nodeId]+" and "+b);h[d.nodeId]=b})}function p(b){var d="";b.nodeType===Node.ELEMENT_NODE&&(d=b.getAttributeNS(r,"nodeId")||"");return d}function g(b){var d=f.toString();b.setAttributeNS(r,"nodeId",d);f+=1;return d}function h(b){var d,c,e=new core.LoopWatchDog(0,1E4);void 0!==v&&b>v&&(b=v);for(d=Math.floor(b/a)*a;!c&&0<=d;)c=m[d],d-=a;for(c=c||y;c.nextBookmark&&c.nextBookmark.steps<=
b;)e.check(),c=c.nextBookmark;runtime.assert(-1===b||c.steps<=b,"Bookmark @"+q(c)+" at step "+c.steps+" exceeds requested step of "+b);return c}function b(b){b.previousBookmark&&(b.previousBookmark.nextBookmark=b.nextBookmark);b.nextBookmark&&(b.nextBookmark.previousBookmark=b.previousBookmark)}function d(b){for(var d,a=null;!a&&b&&b!==l;)(d=p(b))&&(a=x[d])&&a.node!==b&&(runtime.log("Cloned node detected. Creating new bookmark"),a=null,b.removeAttributeNS(r,"nodeId")),b=b.parentNode;return a}var r=
"urn:webodf:names:steps",m={},x={},t=core.DomUtils,y,v,s=Node.DOCUMENT_POSITION_FOLLOWING,w=Node.DOCUMENT_POSITION_PRECEDING,u;this.updateBookmark=function(d,e){var f,k=Math.ceil(d/a)*a,r,n,q;if(void 0!==v&&v<d){r=h(v);for(n=r.nextBookmark;n&&n.steps<=d;)f=n.nextBookmark,q=Math.ceil(n.steps/a)*a,m[q]===n&&delete m[q],t.containsNode(l,n.node)?n.steps=d+1:(b(n),delete x[n.nodeId]),n=f;v=d}else r=h(d);n=p(e)||g(e);f=x[n];f?f.node!==e&&(runtime.log("Cloned node detected. Creating new bookmark"),n=g(e),
f=x[n]=new c(n,e)):f=x[n]=new c(n,e);n=f;n.steps!==d&&(f=Math.ceil(n.steps/a)*a,f!==k&&m[f]===n&&delete m[f],n.steps=d);if(r!==n&&r.nextBookmark!==n){if(r.steps===n.steps)for(;0!==(n.node.compareDocumentPosition(r.node)&s)&&r!==y;)r=r.previousBookmark;r!==n&&r.nextBookmark!==n&&(b(n),f=r.nextBookmark,n.nextBookmark=r.nextBookmark,n.previousBookmark=r,r.nextBookmark=n,f&&(f.previousBookmark=n))}r=m[k];if(!r||n.steps>r.steps)m[k]=n;u()};this.setToClosestStep=function(b,d){var a;u();a=h(b);a.setIteratorPosition(d);
return a.steps};this.setToClosestDomPoint=function(b,a,c){var e,g;u();if(b===l&&0===a)e=y;else if(b===l&&a===l.childNodes.length)for(g in e=y,m)m.hasOwnProperty(g)&&(b=m[g],b.steps>e.steps&&(e=b));else if(e=d(b.childNodes.item(a)||b),!e)for(c.setUnfilteredPosition(b,a);!e&&c.previousNode();)e=d(c.getCurrentNode());e=e||y;void 0!==v&&e.steps>v&&(e=h(v));e.setIteratorPosition(c);return e.steps};this.damageCacheAfterStep=function(b){0>b&&(b=-1);void 0===v?v=b:b<v&&(v=b);u()};(function(){var b=p(l)||
g(l);y=new k(b,0,l);u=ops.StepsCache.ENABLE_CACHE_VERIFICATION?n:function(){}})()};ops.StepsCache.ENABLE_CACHE_VERIFICATION=!1;ops.StepsCache.Bookmark=function(){};ops.StepsCache.Bookmark.prototype.setIteratorPosition=function(f){}})();(function(){ops.OdtStepsTranslator=function(f,l,a,e){function c(b,a,c){var e=a.getCurrentNode();a.isBeforeNode()&&n.isParagraph(e)&&(c||(b+=1),q.updateBookmark(b,e))}function k(d,c){if(!c||a.acceptPosition(d)===g)return!0;for(;d.previousPosition();)if(a.acceptPosition(d)===g){if(c(h,d.container(),d.unfilteredDomOffset()))return!0;break}for(;d.nextPosition();)if(a.acceptPosition(d)===g){if(c(b,d.container(),d.unfilteredDomOffset()))return!0;break}return!1}var q,n=odf.OdfUtils,p=core.DomUtils,g=core.PositionFilter.FilterResult.FILTER_ACCEPT,
h=core.StepDirection.PREVIOUS,b=core.StepDirection.NEXT;this.convertStepsToDomPoint=function(b){var e,h;if(isNaN(b))throw new TypeError("Requested steps is not numeric ("+b+")");if(0>b)throw new RangeError("Requested steps is negative ("+b+")");for(e=q.setToClosestStep(b,l);e<b&&l.nextPosition();)(h=a.acceptPosition(l)===g)&&(e+=1),c(e,l,h);if(e!==b)throw new RangeError("Requested steps ("+b+") exceeds available steps ("+e+")");return{node:l.container(),offset:l.unfilteredDomOffset()}};this.convertDomPointToSteps=
function(b,e,h){var n;p.containsNode(f,b)||(e=0>p.comparePoints(f,0,b,e),b=f,e=e?0:f.childNodes.length);l.setUnfilteredPosition(b,e);k(l,h)||l.setUnfilteredPosition(b,e);h=l.container();e=l.unfilteredDomOffset();b=q.setToClosestDomPoint(h,e,l);if(0>p.comparePoints(l.container(),l.unfilteredDomOffset(),h,e))return 0<b?b-1:b;for(;(l.container()!==h||l.unfilteredDomOffset()!==e)&&l.nextPosition();)(n=a.acceptPosition(l)===g)&&(b+=1),c(b,l,n);return b+0};this.prime=function(){var b,e;for(b=q.setToClosestStep(0,
l);l.nextPosition();)(e=a.acceptPosition(l)===g)&&(b+=1),c(b,l,e)};this.handleStepsInserted=function(b){q.damageCacheAfterStep(b.position)};this.handleStepsRemoved=function(b){q.damageCacheAfterStep(b.position-1)};q=new ops.StepsCache(f,e,function(b,e){do{if(a.acceptPosition(e)===g){c(b,e,!0);break}c(b-1,e,!1)}while(e.nextPosition())})}})();ops.Operation=function(){};ops.Operation.prototype.init=function(f){};ops.Operation.prototype.execute=function(f){};ops.Operation.prototype.spec=function(){};ops.TextPositionFilter=function(){function f(a,c){for(;a&&c(a)!==k;)a=a.previousSibling;return a}function l(c,e,g,h){var b;if(e){if(a.isInlineRoot(e)&&a.isGroupingElement(g))return q;h=a.lookLeftForCharacter(e);if(1===h||2===h&&(a.scanRightForAnyCharacter(g)||a.scanRightForAnyCharacter(a.nextNode(c))))return k}else if(a.isGroupingElement(c)&&a.isInlineRoot(f(c.previousSibling,h)))return k;h=null===e&&a.isParagraph(c);b=a.lookRightForCharacter(g);if(h)return b?k:a.scanRightForAnyCharacter(g)?q:k;if(!b)return q;
e=e||a.previousNode(c);return a.scanLeftForAnyCharacter(e)?q:k}var a=odf.OdfUtils,e=Node.ELEMENT_NODE,c=Node.TEXT_NODE,k=core.PositionFilter.FilterResult.FILTER_ACCEPT,q=core.PositionFilter.FilterResult.FILTER_REJECT;this.acceptPosition=function(f){var p=f.container(),g=p.nodeType,h,b,d;if(g!==e&&g!==c)return q;if(g===c){g=f.unfilteredDomOffset();h=p.data;runtime.assert(g!==h.length,"Unexpected offset.");if(0<g){f=h[g-1];if(!a.isODFWhitespace(f))return k;if(1<g)if(f=h[g-2],!a.isODFWhitespace(f))d=
k;else{if(!a.isODFWhitespace(h.substr(0,g)))return q}else b=a.previousNode(p),a.scanLeftForNonSpace(b)&&(d=k);if(d===k)return a.isTrailingWhitespace(p,g)?q:k;f=h[g];return a.isODFWhitespace(f)?q:a.scanLeftForAnyCharacter(a.previousNode(p))?q:k}b=f.leftNode();d=p;p=p.parentNode;d=l(p,b,d,f.getNodeFilter())}else a.isGroupingElement(p)?(b=f.leftNode(),d=f.rightNode(),d=l(p,b,d,f.getNodeFilter())):d=q;return d}};ops.OdtDocument=function(f){function l(b){return new core.PositionIterator(b,J,N,!1)}function a(){var b=f.odfContainer().getContentElement(),a=b&&b.localName;runtime.assert("text"===a,"Unsupported content element type '"+a+"' for OdtDocument");return b}function e(){return d.getDocumentElement().ownerDocument}function c(b){for(;b&&!(b.namespaceURI===odf.Namespaces.officens&&"text"===b.localName||b.namespaceURI===odf.Namespaces.officens&&"annotation"===b.localName);)b=b.parentNode;return b}function k(b){this.acceptPosition=
function(a){a=a.container();var d;d="string"===typeof b?t[b].getNode():b;return c(a)===c(d)?s:w}}function q(b,a,d,c){c=l(c);var e;1===d.length?e=d[0]:(e=new core.PositionFilterChain,d.forEach(e.addFilter));d=new core.StepIterator(e,c);d.setPosition(b,a);return d}function n(b){var d=l(a());b=F.convertStepsToDomPoint(b);d.setUnfilteredPosition(b.node,b.offset);return d}function p(b){return b===u}function g(b){var a=b.spec(),c=a.memberid,e=(new Date(a.timestamp)).toISOString(),a=f.odfContainer();b.isEdit&&
(c=d.getMember(c).getProperties().fullName,a.setMetadata({"dc:creator":c,"dc:date":e},null),c={setProperties:{"dc:creator":c,"dc:date":e},removedProperties:[]},B||(c.setProperties["meta:editing-cycles"]=a.incrementEditingCycles(),E||a.setMetadata(null,["meta:editing-duration","meta:document-statistic"])),B=b,d.emit(ops.OdtDocument.signalMetadataUpdated,c))}function h(b){var a,d=[],c,e=2;runtime.assert(b.isStep(),"positionIterator is not at a step");do{if(a=r.getContentBounds(b))if(a=a.container,m.isDowngradableSpaceElement(a)){for(c=
a.lastChild;a.firstChild;)d.push(a.firstChild),a.parentNode.insertBefore(a.firstChild,a);a.parentNode.removeChild(a);b.setPosition(c,c.nodeType===Node.TEXT_NODE?c.length:c.childNodes.length);b.roundToPreviousStep()}e-=1}while(0<e&&b.nextStep());d.forEach(x.normalizeTextNodes)}function b(b,a,d){b=b.childNodes.item(a)||b;return(b=m.getParagraphElement(b))&&x.containsNode(d,b)?b:d}var d=this,r,m=odf.OdfUtils,x=core.DomUtils,t={},y={},v=new core.EventNotifier([ops.Document.signalMemberAdded,ops.Document.signalMemberUpdated,
ops.Document.signalMemberRemoved,ops.Document.signalCursorAdded,ops.Document.signalCursorRemoved,ops.Document.signalCursorMoved,ops.OdtDocument.signalParagraphChanged,ops.OdtDocument.signalParagraphStyleModified,ops.OdtDocument.signalCommonStyleCreated,ops.OdtDocument.signalCommonStyleDeleted,ops.OdtDocument.signalTableAdded,ops.OdtDocument.signalOperationStart,ops.OdtDocument.signalOperationEnd,ops.OdtDocument.signalProcessingBatchStart,ops.OdtDocument.signalProcessingBatchEnd,ops.OdtDocument.signalUndoStackChanged,
ops.OdtDocument.signalStepsInserted,ops.OdtDocument.signalStepsRemoved,ops.OdtDocument.signalMetadataUpdated,ops.OdtDocument.signalAnnotationAdded]),s=core.PositionFilter.FilterResult.FILTER_ACCEPT,w=core.PositionFilter.FilterResult.FILTER_REJECT,u=core.StepDirection.NEXT,A,F,B,E=!1,J=NodeFilter.SHOW_ALL,H=new gui.BlacklistNamespaceNodeFilter(["urn:webodf:names:cursor","urn:webodf:names:editinfo"]),Q=new gui.OdfTextBodyNodeFilter,N=new core.NodeFilterChain([H,Q]);this.createPositionIterator=l;this.getDocumentElement=
function(){return f.odfContainer().rootElement};this.cloneDocumentElement=function(){var b=d.getDocumentElement(),a=f.getAnnotationViewManager();a&&a.forgetAnnotations();b=b.cloneNode(!0);f.refreshAnnotations();d.fixCursorPositions();return b};this.setDocumentElement=function(b){var d=f.odfContainer();v.unsubscribe(ops.OdtDocument.signalStepsInserted,F.handleStepsInserted);v.unsubscribe(ops.OdtDocument.signalStepsRemoved,F.handleStepsRemoved);d.setRootElement(b);f.setOdfContainer(d,!0);f.refreshCSS();
b=a();F=new ops.OdtStepsTranslator(b,l(b),A,500);v.subscribe(ops.OdtDocument.signalStepsInserted,F.handleStepsInserted);v.subscribe(ops.OdtDocument.signalStepsRemoved,F.handleStepsRemoved)};this.getDOMDocument=e;this.getRootElement=c;this.createStepIterator=q;this.getIteratorAtPosition=n;this.convertCursorStepToDomPoint=function(b){return F.convertStepsToDomPoint(b)};this.convertDomPointToCursorStep=function(b,a,d){var c;d===u&&(c=p);return F.convertDomPointToSteps(b,a,c)};this.convertDomToCursorRange=
function(b){var a;a=F.convertDomPointToSteps(b.anchorNode,b.anchorOffset);b=b.anchorNode===b.focusNode&&b.anchorOffset===b.focusOffset?a:F.convertDomPointToSteps(b.focusNode,b.focusOffset);return{position:a,length:b-a}};this.convertCursorToDomRange=function(b,a){var d=e().createRange(),c,h;c=F.convertStepsToDomPoint(b);a?(h=F.convertStepsToDomPoint(b+a),0<a?(d.setStart(c.node,c.offset),d.setEnd(h.node,h.offset)):(d.setStart(h.node,h.offset),d.setEnd(c.node,c.offset))):d.setStart(c.node,c.offset);
return d};this.upgradeWhitespacesAtPosition=function(b){var a=n(b),a=new core.StepIterator(A,a),d,c=2;runtime.assert(a.isStep(),"positionIterator is not at a step (requested step: "+b+")");do{if(d=r.getContentBounds(a))if(b=d.container,d=d.startOffset,b.nodeType===Node.TEXT_NODE&&m.isSignificantWhitespace(b,d)){runtime.assert(" "===b.data[d],"upgradeWhitespaceToElement: textNode.data[offset] should be a literal space");var e=b.ownerDocument.createElementNS(odf.Namespaces.textns,"text:s"),h=b.parentNode,
g=b;e.appendChild(b.ownerDocument.createTextNode(" "));1===b.length?h.replaceChild(e,b):(b.deleteData(d,1),0<d&&(d<b.length&&b.splitText(d),g=b.nextSibling),h.insertBefore(e,g));b=e;a.setPosition(b,b.childNodes.length);a.roundToPreviousStep()}c-=1}while(0<c&&a.nextStep())};this.downgradeWhitespaces=h;this.downgradeWhitespacesAtPosition=function(b){b=n(b);b=new core.StepIterator(A,b);h(b)};this.getTextNodeAtStep=function(b,a){var c=n(b),h=c.container(),g,f=0,m=null;h.nodeType===Node.TEXT_NODE?(g=h,
f=c.unfilteredDomOffset(),0<g.length&&(0<f&&(g=g.splitText(f)),g.parentNode.insertBefore(e().createTextNode(""),g),g=g.previousSibling,f=0)):(g=e().createTextNode(""),f=0,h.insertBefore(g,c.rightNode()));if(a){if(t[a]&&d.getCursorPosition(a)===b){for(m=t[a].getNode();m.nextSibling&&"cursor"===m.nextSibling.localName;)m.parentNode.insertBefore(m.nextSibling,m);0<g.length&&g.nextSibling!==m&&(g=e().createTextNode(""),f=0);m.parentNode.insertBefore(g,m)}}else for(;g.nextSibling&&"cursor"===g.nextSibling.localName;)g.parentNode.insertBefore(g.nextSibling,
g);for(;g.previousSibling&&g.previousSibling.nodeType===Node.TEXT_NODE;)c=g.previousSibling,c.appendData(g.data),f=c.length,g=c,g.parentNode.removeChild(g.nextSibling);for(;g.nextSibling&&g.nextSibling.nodeType===Node.TEXT_NODE;)c=g.nextSibling,g.appendData(c.data),g.parentNode.removeChild(c);return{textNode:g,offset:f}};this.fixCursorPositions=function(){Object.keys(t).forEach(function(a){var e=t[a],g=c(e.getNode()),h=d.createRootFilter(g),f,m,k,r=!1;k=e.getSelectedRange();f=b(k.startContainer,k.startOffset,
g);m=q(k.startContainer,k.startOffset,[A,h],f);k.collapsed?g=m:(f=b(k.endContainer,k.endOffset,g),g=q(k.endContainer,k.endOffset,[A,h],f));m.isStep()&&g.isStep()?m.container()!==g.container()||m.offset()!==g.offset()||k.collapsed&&e.getAnchorNode()===e.getNode()||(r=!0,k.setStart(m.container(),m.offset()),k.collapse(!0)):(r=!0,runtime.assert(m.roundToClosestStep(),"No walkable step found for cursor owned by "+a),k.setStart(m.container(),m.offset()),runtime.assert(g.roundToClosestStep(),"No walkable step found for cursor owned by "+
a),k.setEnd(g.container(),g.offset()));r&&(e.setSelectedRange(k,e.hasForwardSelection()),d.emit(ops.Document.signalCursorMoved,e))})};this.getCursorPosition=function(b){return(b=t[b])?F.convertDomPointToSteps(b.getNode(),0):0};this.getCursorSelection=function(b){b=t[b];var a=0,d=0;b&&(a=F.convertDomPointToSteps(b.getNode(),0),d=F.convertDomPointToSteps(b.getAnchorNode(),0));return{position:d,length:a-d}};this.getPositionFilter=function(){return A};this.getOdfCanvas=function(){return f};this.getCanvas=
function(){return f};this.getRootNode=a;this.addMember=function(b){runtime.assert(void 0===y[b.getMemberId()],"This member already exists");y[b.getMemberId()]=b};this.getMember=function(b){return y.hasOwnProperty(b)?y[b]:null};this.removeMember=function(b){delete y[b]};this.getCursor=function(b){return t[b]};this.getMemberIds=function(){var b=[],a;for(a in t)t.hasOwnProperty(a)&&b.push(t[a].getMemberId());return b};this.addCursor=function(b){runtime.assert(Boolean(b),"OdtDocument::addCursor without cursor");
var a=b.getMemberId(),c=d.convertCursorToDomRange(0,0);runtime.assert("string"===typeof a,"OdtDocument::addCursor has cursor without memberid");runtime.assert(!t[a],"OdtDocument::addCursor is adding a duplicate cursor with memberid "+a);b.setSelectedRange(c,!0);t[a]=b};this.removeCursor=function(b){var a=t[b];return a?(a.removeFromDocument(),delete t[b],d.emit(ops.Document.signalCursorRemoved,b),!0):!1};this.moveCursor=function(b,a,c,e){b=t[b];a=d.convertCursorToDomRange(a,c);b&&(b.setSelectedRange(a,
0<=c),b.setSelectionType(e||ops.OdtCursor.RangeSelection))};this.getFormatting=function(){return f.getFormatting()};this.emit=function(b,a){v.emit(b,a)};this.subscribe=function(b,a){v.subscribe(b,a)};this.unsubscribe=function(b,a){v.unsubscribe(b,a)};this.createRootFilter=function(b){return new k(b)};this.close=function(b){b()};this.destroy=function(b){b()};(function(){var b=a();A=new ops.TextPositionFilter;r=new odf.StepUtils;F=new ops.OdtStepsTranslator(b,l(b),A,500);v.subscribe(ops.OdtDocument.signalStepsInserted,
F.handleStepsInserted);v.subscribe(ops.OdtDocument.signalStepsRemoved,F.handleStepsRemoved);v.subscribe(ops.OdtDocument.signalOperationEnd,g);v.subscribe(ops.OdtDocument.signalProcessingBatchEnd,core.Task.processTasks)})()};ops.OdtDocument.signalParagraphChanged="paragraph/changed";ops.OdtDocument.signalTableAdded="table/added";ops.OdtDocument.signalCommonStyleCreated="style/created";ops.OdtDocument.signalCommonStyleDeleted="style/deleted";ops.OdtDocument.signalParagraphStyleModified="paragraphstyle/modified";
ops.OdtDocument.signalOperationStart="operation/start";ops.OdtDocument.signalOperationEnd="operation/end";ops.OdtDocument.signalProcessingBatchStart="router/batchstart";ops.OdtDocument.signalProcessingBatchEnd="router/batchend";ops.OdtDocument.signalUndoStackChanged="undo/changed";ops.OdtDocument.signalStepsInserted="steps/inserted";ops.OdtDocument.signalStepsRemoved="steps/removed";ops.OdtDocument.signalMetadataUpdated="metadata/updated";ops.OdtDocument.signalAnnotationAdded="annotation/added";ops.OpAddAnnotation=function(){function f(a,c,e){var h=a.getTextNodeAtStep(e,l);h&&(a=h.textNode,e=a.parentNode,h.offset!==a.length&&a.splitText(h.offset),e.insertBefore(c,a.nextSibling),0===a.length&&e.removeChild(a))}var l,a,e,c,k,q;this.init=function(f){l=f.memberid;a=parseInt(f.timestamp,10);e=parseInt(f.position,10);c=void 0!==f.length?parseInt(f.length,10)||0:void 0;k=f.name};this.isEdit=!0;this.group=void 0;this.execute=function(n){var p=n.getCursor(l),g,h;q=n.getDOMDocument();var b=new Date(a),
d,r,m;d=q.createElementNS(odf.Namespaces.officens,"office:annotation");d.setAttributeNS(odf.Namespaces.officens,"office:name",k);g=q.createElementNS(odf.Namespaces.dcns,"dc:creator");g.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",l);g.textContent=n.getMember(l).getProperties().fullName;h=q.createElementNS(odf.Namespaces.dcns,"dc:date");h.appendChild(q.createTextNode(b.toISOString()));b=q.createElementNS(odf.Namespaces.textns,"text:list");r=q.createElementNS(odf.Namespaces.textns,
"text:list-item");m=q.createElementNS(odf.Namespaces.textns,"text:p");r.appendChild(m);b.appendChild(r);d.appendChild(g);d.appendChild(h);d.appendChild(b);void 0!==c&&(g=q.createElementNS(odf.Namespaces.officens,"office:annotation-end"),g.setAttributeNS(odf.Namespaces.officens,"office:name",k),d.annotationEndElement=g,f(n,g,e+c));f(n,d,e);n.emit(ops.OdtDocument.signalStepsInserted,{position:e});p&&(g=q.createRange(),h=d.getElementsByTagNameNS(odf.Namespaces.textns,"p")[0],g.selectNodeContents(h),
p.setSelectedRange(g,!1),p.setSelectionType(ops.OdtCursor.RangeSelection),n.emit(ops.Document.signalCursorMoved,p));n.getOdfCanvas().addAnnotation(d);n.fixCursorPositions();n.emit(ops.OdtDocument.signalAnnotationAdded,{memberId:l,annotation:d});return!0};this.spec=function(){return{optype:"AddAnnotation",memberid:l,timestamp:a,position:e,length:c,name:k}}};ops.OpAddCursor=function(){var f,l;this.init=function(a){f=a.memberid;l=a.timestamp};this.isEdit=!1;this.group=void 0;this.execute=function(a){var e=a.getCursor(f);if(e)return!1;e=new ops.OdtCursor(f,a);a.addCursor(e);a.emit(ops.Document.signalCursorAdded,e);return!0};this.spec=function(){return{optype:"AddCursor",memberid:f,timestamp:l}}};ops.OpAddMember=function(){var f,l,a;this.init=function(e){f=e.memberid;l=parseInt(e.timestamp,10);a=e.setProperties};this.isEdit=!1;this.group=void 0;this.execute=function(e){var c;if(e.getMember(f))return!1;c=new ops.Member(f,a);e.addMember(c);e.emit(ops.Document.signalMemberAdded,c);return!0};this.spec=function(){return{optype:"AddMember",memberid:f,timestamp:l,setProperties:a}}};ops.OpAddStyle=function(){var f,l,a,e,c,k,q=odf.Namespaces.stylens;this.init=function(n){f=n.memberid;l=n.timestamp;a=n.styleName;e=n.styleFamily;c="true"===n.isAutomaticStyle||!0===n.isAutomaticStyle;k=n.setProperties};this.isEdit=!0;this.group=void 0;this.execute=function(f){var p=f.getOdfCanvas().odfContainer(),g=f.getFormatting(),h=f.getDOMDocument().createElementNS(q,"style:style");if(!h)return!1;k&&g.updateStyle(h,k);h.setAttributeNS(q,"style:family",e);h.setAttributeNS(q,"style:name",a);c?
p.rootElement.automaticStyles.appendChild(h):p.rootElement.styles.appendChild(h);f.getOdfCanvas().refreshCSS();c||f.emit(ops.OdtDocument.signalCommonStyleCreated,{name:a,family:e});return!0};this.spec=function(){return{optype:"AddStyle",memberid:f,timestamp:l,styleName:a,styleFamily:e,isAutomaticStyle:c,setProperties:k}}};odf.ObjectNameGenerator=function(f,l){function a(b,a){var d={};this.generateName=function(){var c=a(),e=0,g;do g=b+e,e+=1;while(d[g]||c[g]);d[g]=!0;return g}}function e(){var b={};[f.rootElement.automaticStyles,f.rootElement.styles].forEach(function(a){for(a=a.firstElementChild;a;)a.namespaceURI===c&&"style"===a.localName&&(b[a.getAttributeNS(c,"name")]=!0),a=a.nextElementSibling});return b}var c=odf.Namespaces.stylens,k=odf.Namespaces.drawns,q=odf.Namespaces.xlinkns,n=(new core.Utils).hashString(l),
p=null,g=null,h=null,b={},d={};this.generateStyleName=function(){null===p&&(p=new a("auto"+n+"_",function(){return e()}));return p.generateName()};this.generateFrameName=function(){var d,c,e;if(null===g){c=f.rootElement.body.getElementsByTagNameNS(k,"frame");for(d=0;d<c.length;d+=1)e=c.item(d),b[e.getAttributeNS(k,"name")]=!0;g=new a("fr"+n+"_",function(){return b})}return g.generateName()};this.generateImageName=function(){var b,c,e;if(null===h){e=f.rootElement.body.getElementsByTagNameNS(k,"image");
for(b=0;b<e.length;b+=1)c=e.item(b),c=c.getAttributeNS(q,"href"),c=c.substring(9,c.lastIndexOf(".")),d[c]=!0;h=new a("img"+n+"_",function(){return d})}return h.generateName()}};odf.TextStyleApplicator=function(f,l,a){function e(a){function c(b,a){return"object"===typeof b&&"object"===typeof a?Object.keys(b).every(function(e){return c(b[e],a[e])}):b===a}var b={};this.isStyleApplied=function(d){d=l.getAppliedStylesForElement(d,b).styleProperties;return c(a,d)}}function c(c){var e={};this.applyStyleToContainer=function(b){var d;d=b.getAttributeNS(n,"style-name");var k=b.ownerDocument;d=d||"";if(!e.hasOwnProperty(d)){var m=d,q;q=d?l.createDerivedStyleObject(d,"text",c):c;k=
k.createElementNS(p,"style:style");l.updateStyle(k,q);k.setAttributeNS(p,"style:name",f.generateStyleName());k.setAttributeNS(p,"style:family","text");k.setAttributeNS("urn:webodf:names:scope","scope","document-content");a.appendChild(k);e[m]=k}d=e[d].getAttributeNS(p,"name");b.setAttributeNS(n,"text:style-name",d)}}function k(a,c){var b=a.ownerDocument,d=a.parentNode,e,f,k,p=new core.LoopWatchDog(1E4);f=[];f.push(a);for(k=a.nextSibling;k&&q.rangeContainsNode(c,k);)p.check(),f.push(k),k=k.nextSibling;
"span"!==d.localName||d.namespaceURI!==n?(e=b.createElementNS(n,"text:span"),d.insertBefore(e,a),b=!1):(a.previousSibling&&!q.rangeContainsNode(c,d.firstChild)?(e=d.cloneNode(!1),d.parentNode.insertBefore(e,d.nextSibling)):e=d,b=!0);f.forEach(function(b){b.parentNode!==e&&e.appendChild(b)});if(k&&b)for(f=e.cloneNode(!1),e.parentNode.insertBefore(f,e.nextSibling);k;)p.check(),b=k.nextSibling,f.appendChild(k),k=b;return e}var q=core.DomUtils,n=odf.Namespaces.textns,p=odf.Namespaces.stylens;this.applyStyle=
function(a,h,b){var d={},f,m,n,p;runtime.assert(b&&b.hasOwnProperty("style:text-properties"),"applyStyle without any text properties");d["style:text-properties"]=b["style:text-properties"];n=new c(d);p=new e(d);a.forEach(function(b){f=p.isStyleApplied(b);!1===f&&(m=k(b,h),n.applyStyleToContainer(m))})}};ops.OpApplyDirectStyling=function(){function f(a,c,e){var b=a.getOdfCanvas().odfContainer(),d=n.splitBoundaries(c),f=q.getTextNodes(c,!1);(new odf.TextStyleApplicator(new odf.ObjectNameGenerator(b,l),a.getFormatting(),b.rootElement.automaticStyles)).applyStyle(f,c,e);d.forEach(n.normalizeTextNodes)}var l,a,e,c,k,q=odf.OdfUtils,n=core.DomUtils;this.init=function(f){l=f.memberid;a=f.timestamp;e=parseInt(f.position,10);c=parseInt(f.length,10);k=f.setProperties};this.isEdit=!0;this.group=void 0;this.execute=
function(n){var g=n.convertCursorToDomRange(e,c),h=q.getParagraphElements(g);f(n,g,k);g.detach();n.getOdfCanvas().refreshCSS();n.fixCursorPositions();h.forEach(function(b){n.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:b,memberId:l,timeStamp:a})});n.getOdfCanvas().rerenderAnnotations();return!0};this.spec=function(){return{optype:"ApplyDirectStyling",memberid:l,timestamp:a,position:e,length:c,setProperties:k}}};ops.OpApplyHyperlink=function(){function f(a){for(;a;){if(n.isHyperlink(a))return!0;a=a.parentNode}return!1}var l,a,e,c,k,q=core.DomUtils,n=odf.OdfUtils;this.init=function(f){l=f.memberid;a=f.timestamp;e=f.position;c=f.length;k=f.hyperlink};this.isEdit=!0;this.group=void 0;this.execute=function(p){var g=p.getDOMDocument(),h=p.convertCursorToDomRange(e,c),b=q.splitBoundaries(h),d=[],r=n.getTextNodes(h,!1);if(0===r.length)return!1;r.forEach(function(b){var a=n.getParagraphElement(b);runtime.assert(!1===
f(b),"The given range should not contain any link.");var c=k,e=g.createElementNS(odf.Namespaces.textns,"text:a");e.setAttributeNS(odf.Namespaces.xlinkns,"xlink:type","simple");e.setAttributeNS(odf.Namespaces.xlinkns,"xlink:href",c);b.parentNode.insertBefore(e,b);e.appendChild(b);-1===d.indexOf(a)&&d.push(a)});b.forEach(q.normalizeTextNodes);h.detach();p.fixCursorPositions();p.getOdfCanvas().refreshSize();p.getOdfCanvas().rerenderAnnotations();d.forEach(function(b){p.emit(ops.OdtDocument.signalParagraphChanged,
{paragraphElement:b,memberId:l,timeStamp:a})});return!0};this.spec=function(){return{optype:"ApplyHyperlink",memberid:l,timestamp:a,position:e,length:c,hyperlink:k}}};ops.OpCreateBulletlist=function(){var f,l,a,e=odf.OdfUtils;this.init=function(c){f=c.memberid;l=c.timestamp;a=c.position};this.isEdit=!0;this.group=void 0;this.execute=function(c){var k,q=c.getDOMDocument();k=c.convertCursorToDomRange(a,0);var n=[],p=e.getTextNodes(k,!0),g=q.createElementNS(odf.Namespaces.textns,"text:list"),q=q.createElementNS(odf.Namespaces.textns,"text:list-item");g.setAttributeNS(odf.Namespaces.textns,"text:style-name","L1");g.setAttributeNS("urn:webodf:names:helper","counter-id",
"X1-level1-1");g.appendChild(q);0<p.length?(k=e.getParagraphElement(p[0]),k.parentNode.insertBefore(g,k),q.appendChild(k),-1===n.indexOf(k)&&n.push(k)):(k.startContainer.parentNode.insertBefore(g,k.startContainer),k.startOffset=0,q.appendChild(k.startContainer));c.fixCursorPositions();c.getOdfCanvas().refreshSize();c.getOdfCanvas().rerenderAnnotations();n.forEach(function(a){c.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:a,memberId:f,timeStamp:l})});gui.BulletlistController.setDefaultStyle(c,
f);n=c.getIteratorAtPosition(a);if(n=odf.OdfUtils.getParagraphElement(n.container()))c.getOdfCanvas().refreshSize(),c.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:n,timeStamp:void 0,memberId:f}),c.getOdfCanvas().rerenderAnnotations();return!0};this.spec=function(){return{optype:"CreateBulletlist",memberid:f,timestamp:l,position:a}}};ops.OpInsertImage=function(){var f,l,a,e,c,k,q,n,p=odf.Namespaces.drawns,g=odf.Namespaces.svgns,h=odf.Namespaces.textns,b=odf.Namespaces.xlinkns,d=odf.OdfUtils;this.init=function(b){f=b.memberid;l=b.timestamp;a=b.position;e=b.filename;c=b.frameWidth;k=b.frameHeight;q=b.frameStyleName;n=b.frameName};this.isEdit=!0;this.group=void 0;this.execute=function(r){var m=r.getOdfCanvas(),x=r.getTextNodeAtStep(a,f),t,y;if(!x)return!1;t=x.textNode;y=d.getParagraphElement(t);var x=x.offset!==t.length?t.splitText(x.offset):
t.nextSibling,v=r.getDOMDocument(),s=v.createElementNS(p,"draw:image"),v=v.createElementNS(p,"draw:frame");s.setAttributeNS(b,"xlink:href",e);s.setAttributeNS(b,"xlink:type","simple");s.setAttributeNS(b,"xlink:show","embed");s.setAttributeNS(b,"xlink:actuate","onLoad");v.setAttributeNS(p,"draw:style-name",q);v.setAttributeNS(p,"draw:name",n);v.setAttributeNS(h,"text:anchor-type","as-char");v.setAttributeNS(g,"svg:width",c);v.setAttributeNS(g,"svg:height",k);v.appendChild(s);t.parentNode.insertBefore(v,
x);r.emit(ops.OdtDocument.signalStepsInserted,{position:a});0===t.length&&t.parentNode.removeChild(t);m.addCssForFrameWithImage(v);m.refreshCSS();r.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:y,memberId:f,timeStamp:l});m.rerenderAnnotations();return!0};this.spec=function(){return{optype:"InsertImage",memberid:f,timestamp:l,filename:e,position:a,frameWidth:c,frameHeight:k,frameStyleName:q,frameName:n}}};ops.OpInsertTable=function(){function f(b,a){var f;if(1===g.length)f=g[0];else if(3===g.length)switch(b){case 0:f=g[0];break;case e-1:f=g[2];break;default:f=g[1]}else f=g[b];if(1===f.length)return f[0];if(3===f.length)switch(a){case 0:return f[0];case c-1:return f[2];default:return f[1]}return f[a]}var l,a,e,c,k,q,n,p,g,h=odf.OdfUtils;this.init=function(b){l=b.memberid;a=b.timestamp;k=b.position;e=b.initialRows;c=b.initialColumns;q=b.tableName;n=b.tableStyleName;p=b.tableColumnStyleName;g=b.tableCellStyleMatrix};
this.isEdit=!0;this.group=void 0;this.execute=function(b){var d=b.getTextNodeAtStep(k),g=b.getRootNode();if(d){var m=b.getDOMDocument(),x=m.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table"),t=m.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table-column"),y,v,s,w;n&&x.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:style-name",n);q&&x.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:name",q);t.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0",
"table:number-columns-repeated",c);p&&t.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:style-name",p);x.appendChild(t);for(s=0;s<e;s+=1){t=m.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table-row");for(w=0;w<c;w+=1)y=m.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table-cell"),(v=f(s,w))&&y.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:style-name",v),v=m.createElementNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0",
"text:p"),y.appendChild(v),t.appendChild(y);x.appendChild(t)}d=h.getParagraphElement(d.textNode);g.insertBefore(x,d.nextSibling);b.emit(ops.OdtDocument.signalStepsInserted,{position:k});b.getOdfCanvas().refreshSize();b.emit(ops.OdtDocument.signalTableAdded,{tableElement:x,memberId:l,timeStamp:a});b.getOdfCanvas().rerenderAnnotations();return!0}return!1};this.spec=function(){return{optype:"InsertTable",memberid:l,timestamp:a,position:k,initialRows:e,initialColumns:c,tableName:q,tableStyleName:n,tableColumnStyleName:p,
tableCellStyleMatrix:g}}};ops.OpInsertText=function(){var f,l,a,e,c,k=odf.OdfUtils;this.init=function(k){f=k.memberid;l=k.timestamp;a=k.position;c=k.text;e="true"===k.moveCursor||!0===k.moveCursor};this.isEdit=!0;this.group=void 0;this.execute=function(q){var n,p,g,h=null,b=q.getDOMDocument(),d,r=0,m,x=q.getCursor(f),t;q.upgradeWhitespacesAtPosition(a);if(n=q.getTextNodeAtStep(a)){p=n.textNode;h=p.nextSibling;g=p.parentNode;d=k.getParagraphElement(p);for(t=0;t<c.length;t+=1)if("\t"===c[t]||"\t"!==c[t]&&k.isODFWhitespace(c[t])&&
(0===t||t===c.length-1||"\t"!==c[t-1]&&k.isODFWhitespace(c[t-1])))0===r?(n.offset!==p.length&&(h=p.splitText(n.offset)),0<t&&p.appendData(c.substring(0,t))):r<t&&(r=c.substring(r,t),g.insertBefore(b.createTextNode(r),h)),r=t+1,"\t"===c[t]?(m=b.createElementNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","text:tab"),m.appendChild(b.createTextNode("\t"))):(" "!==c[t]&&runtime.log("WARN: InsertText operation contains non-tab, non-space whitespace character (character code "+c.charCodeAt(t)+")"),
m=b.createElementNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","text:s"),m.appendChild(b.createTextNode(" "))),g.insertBefore(m,h);0===r?p.insertData(n.offset,c):r<c.length&&(n=c.substring(r),g.insertBefore(b.createTextNode(n),h));g=p.parentNode;h=p.nextSibling;g.removeChild(p);g.insertBefore(p,h);0===p.length&&p.parentNode.removeChild(p);q.emit(ops.OdtDocument.signalStepsInserted,{position:a});x&&e&&(q.moveCursor(f,a+c.length,0),q.emit(ops.Document.signalCursorMoved,x));q.downgradeWhitespacesAtPosition(a);
q.downgradeWhitespacesAtPosition(a+c.length);q.getOdfCanvas().refreshSize();q.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:d,memberId:f,timeStamp:l});q.getOdfCanvas().rerenderAnnotations();return!0}return!1};this.spec=function(){return{optype:"InsertText",memberid:f,timestamp:l,position:a,text:c,moveCursor:e}}};odf.CollapsingRules=function(f){function l(a){return e.isODFNode(a)||"br"===a.localName&&e.isLineBreak(a.parentNode)||a.nodeType===Node.TEXT_NODE&&e.isODFNode(a.parentNode)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}function a(k){var q;k.nodeType===Node.TEXT_NODE?(q=k.parentNode,q.removeChild(k)):q=c.removeUnwantedNodes(k,l);return q&&!e.isParagraph(q)&&q!==f&&e.hasNoODFContent(q)?a(q):q}var e=odf.OdfUtils,c=core.DomUtils;this.mergeChildrenIntoParent=a};ops.OpMergeParagraph=function(){function f(b){return odf.OdfUtils.isInlineRoot(b)?NodeFilter.FILTER_SKIP:h.isGroupingElement(b)&&h.hasNoODFContent(b)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}function l(b){if(b.nodeType===Node.TEXT_NODE){if(0===b.length)return runtime.log("WARN: Empty text node found during merge operation"),!0;if(h.isODFWhitespace(b.data)&&!1===h.isSignificantWhitespace(b,0))return!0;b="#text"}else b=(b.prefix?b.prefix+":":"")+b.localName;runtime.log("WARN: Unexpected text element found near paragraph boundary ["+
b+"]");return!1}function a(a){a.collapsed||(b.splitBoundaries(a),a=h.getTextElements(a,!1,!0).filter(l),a.forEach(function(b){b.parentNode.removeChild(b)}))}function e(b,a,d){b=b.convertCursorStepToDomPoint(a);var c=h.getParagraphElement(b.node,b.offset);runtime.assert(Boolean(c),"Paragraph not found at step "+a);d&&d.setPosition(b.node,b.offset);return c}var c,k,q,n,p,g,h=odf.OdfUtils,b=core.DomUtils,d=odf.Namespaces.textns;this.init=function(b){c=b.memberid;k=b.timestamp;q=b.moveCursor;n=b.paragraphStyleName;
p=parseInt(b.sourceStartPosition,10);g=parseInt(b.destinationStartPosition,10)};this.isEdit=!0;this.group=void 0;this.execute=function(h){var m,l,t=h.getCursor(c);m=h.getRootNode();var y=new odf.CollapsingRules(m),v=h.createStepIterator(m,0,[h.getPositionFilter()],m),s;runtime.assert(g<p,"Destination paragraph ("+g+") must be before source paragraph ("+p+")");l=e(h,g);m=e(h,p,v);v.previousStep();runtime.assert(b.containsNode(l,v.container()),"Destination paragraph must be adjacent to the source paragraph");
s=l.ownerDocument.createRange();v.setPosition(l,l.childNodes.length);v.roundToPreviousStep();s.setStart(v.container(),v.offset());s.setEnd(l,l.childNodes.length);a(s);s=l.childNodes.length;var w=m.ownerDocument.createRange();v.setPosition(m,0);v.roundToNextStep();w.setStart(m,0);w.setEnd(v.container(),v.offset());a(w);for(w=m.firstChild;w;)"editinfo"===w.localName?m.removeChild(w):(l.appendChild(w),b.removeUnwantedNodes(w,f)),w=m.firstChild;runtime.assert(0===m.childNodes.length,"Source paragraph should be empty before it is removed");
y.mergeChildrenIntoParent(m);h.emit(ops.OdtDocument.signalStepsRemoved,{position:p-1});v.setPosition(l,s);v.roundToClosestStep();v.previousStep()||v.roundToNextStep();h.downgradeWhitespaces(v);n?l.setAttributeNS(d,"text:style-name",n):l.removeAttributeNS(d,"style-name");t&&q&&(h.moveCursor(c,p-1,0),h.emit(ops.Document.signalCursorMoved,t));h.fixCursorPositions();h.getOdfCanvas().refreshSize();h.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:l,memberId:c,timeStamp:k});h.getOdfCanvas().rerenderAnnotations();
return!0};this.spec=function(){return{optype:"MergeParagraph",memberid:c,timestamp:k,moveCursor:q,paragraphStyleName:n,sourceStartPosition:p,destinationStartPosition:g}}};ops.OpMoveCursor=function(){var f,l,a,e,c;this.init=function(k){f=k.memberid;l=k.timestamp;a=k.position;e=k.length||0;c=k.selectionType||ops.OdtCursor.RangeSelection};this.isEdit=!1;this.group=void 0;this.execute=function(k){var l=k.getCursor(f),n;if(!l)return!1;n=k.convertCursorToDomRange(a,e);l.setSelectedRange(n,0<=e);l.setSelectionType(c);k.emit(ops.Document.signalCursorMoved,l);return!0};this.spec=function(){return{optype:"MoveCursor",memberid:f,timestamp:l,position:a,length:e,selectionType:c}}};ops.OpRemoveAnnotation=function(){var f,l,a,e,c=core.DomUtils;this.init=function(c){f=c.memberid;l=c.timestamp;a=parseInt(c.position,10);e=parseInt(c.length,10)};this.isEdit=!0;this.group=void 0;this.execute=function(e){function f(a){l.parentNode.insertBefore(a,l)}for(var n=e.getIteratorAtPosition(a).container(),l;n.namespaceURI!==odf.Namespaces.officens||"annotation"!==n.localName;)n=n.parentNode;if(null===n)return!1;l=n;n=l.annotationEndElement;e.getOdfCanvas().forgetAnnotation(l);c.getElementsByTagNameNS(l,
"urn:webodf:names:cursor","cursor").forEach(f);c.getElementsByTagNameNS(l,"urn:webodf:names:cursor","anchor").forEach(f);l.parentNode.removeChild(l);n&&n.parentNode.removeChild(n);e.emit(ops.OdtDocument.signalStepsRemoved,{position:0<a?a-1:a});e.getOdfCanvas().rerenderAnnotations();e.fixCursorPositions();return!0};this.spec=function(){return{optype:"RemoveAnnotation",memberid:f,timestamp:l,position:a,length:e}}};ops.OpRemoveBlob=function(){var f,l,a;this.init=function(e){f=e.memberid;l=e.timestamp;a=e.filename};this.isEdit=!0;this.group=void 0;this.execute=function(e){e.getOdfCanvas().odfContainer().removeBlob(a);return!0};this.spec=function(){return{optype:"RemoveBlob",memberid:f,timestamp:l,filename:a}}};ops.OpRemoveCursor=function(){var f,l;this.init=function(a){f=a.memberid;l=a.timestamp};this.isEdit=!1;this.group=void 0;this.execute=function(a){return a.removeCursor(f)?!0:!1};this.spec=function(){return{optype:"RemoveCursor",memberid:f,timestamp:l}}};ops.OpRemoveHyperlink=function(){var f,l,a,e,c=core.DomUtils,k=odf.OdfUtils;this.init=function(c){f=c.memberid;l=c.timestamp;a=c.position;e=c.length};this.isEdit=!0;this.group=void 0;this.execute=function(q){var n=q.convertCursorToDomRange(a,e),p=k.getHyperlinkElements(n);runtime.assert(1===p.length,"The given range should only contain a single link.");p=c.mergeIntoParent(p[0]);n.detach();q.fixCursorPositions();q.getOdfCanvas().refreshSize();q.getOdfCanvas().rerenderAnnotations();q.emit(ops.OdtDocument.signalParagraphChanged,
{paragraphElement:k.getParagraphElement(p),memberId:f,timeStamp:l});return!0};this.spec=function(){return{optype:"RemoveHyperlink",memberid:f,timestamp:l,position:a,length:e}}};ops.OpRemoveMember=function(){var f,l;this.init=function(a){f=a.memberid;l=parseInt(a.timestamp,10)};this.isEdit=!1;this.group=void 0;this.execute=function(a){if(!a.getMember(f))return!1;a.removeMember(f);a.emit(ops.Document.signalMemberRemoved,f);return!0};this.spec=function(){return{optype:"RemoveMember",memberid:f,timestamp:l}}};ops.OpRemoveStyle=function(){var f,l,a,e;this.init=function(c){f=c.memberid;l=c.timestamp;a=c.styleName;e=c.styleFamily};this.isEdit=!0;this.group=void 0;this.execute=function(c){var f=c.getFormatting().getStyleElement(a,e);if(!f)return!1;f.parentNode.removeChild(f);c.getOdfCanvas().refreshCSS();c.emit(ops.OdtDocument.signalCommonStyleDeleted,{name:a,family:e});return!0};this.spec=function(){return{optype:"RemoveStyle",memberid:f,timestamp:l,styleName:a,styleFamily:e}}};ops.OpRemoveText=function(){var f,l,a,e,c=odf.OdfUtils,k=core.DomUtils;this.init=function(c){runtime.assert(0<=c.length,"OpRemoveText only supports positive lengths");f=c.memberid;l=c.timestamp;a=parseInt(c.position,10);e=parseInt(c.length,10)};this.isEdit=!0;this.group=void 0;this.execute=function(q){var n,p,g,h=q.getCursor(f),b=new odf.CollapsingRules(q.getRootNode());q.upgradeWhitespacesAtPosition(a);q.upgradeWhitespacesAtPosition(a+e);n=q.convertCursorToDomRange(a,e);k.splitBoundaries(n);p=c.getTextElements(n,
!1,!0);g=c.getParagraphElement(n.startContainer,n.startOffset);runtime.assert(void 0!==g,"Attempting to remove text outside a paragraph element");n.detach();p.forEach(function(a){a.parentNode?(runtime.assert(k.containsNode(g,a),"RemoveText only supports removing elements within the same paragraph"),b.mergeChildrenIntoParent(a)):runtime.log("WARN: text element has already been removed from it's container")});q.emit(ops.OdtDocument.signalStepsRemoved,{position:a});q.downgradeWhitespacesAtPosition(a);
q.fixCursorPositions();q.getOdfCanvas().refreshSize();q.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:g,memberId:f,timeStamp:l});h&&(h.resetSelectionType(),q.emit(ops.Document.signalCursorMoved,h));q.getOdfCanvas().rerenderAnnotations();return!0};this.spec=function(){return{optype:"RemoveText",memberid:f,timestamp:l,position:a,length:e}}};ops.OpSetBlob=function(){var f,l,a,e,c;this.init=function(k){f=k.memberid;l=k.timestamp;a=k.filename;e=k.mimetype;c=k.content};this.isEdit=!0;this.group=void 0;this.execute=function(f){f.getOdfCanvas().odfContainer().setBlob(a,e,c);return!0};this.spec=function(){return{optype:"SetBlob",memberid:f,timestamp:l,filename:a,mimetype:e,content:c}}};ops.OpSetParagraphStyle=function(){function f(a,c,e){var f=[a.getPositionFilter()],h=e.container();e=e.unfilteredDomOffset();return!1===a.createStepIterator(h,e,f,c).previousStep()}var l,a,e,c,k=odf.OdfUtils;this.init=function(f){l=f.memberid;a=f.timestamp;e=f.position;c=f.styleName};this.isEdit=!0;this.group=void 0;this.execute=function(q){var n,p;n=q.getIteratorAtPosition(e);return(p=k.getParagraphElement(n.container()))?(runtime.assert(f(q,p,n),"SetParagraphStyle position should be the first position in the paragraph"),
c?p.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","text:style-name",c):p.removeAttributeNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","style-name"),q.getOdfCanvas().refreshSize(),q.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:p,timeStamp:a,memberId:l}),q.getOdfCanvas().rerenderAnnotations(),!0):!1};this.spec=function(){return{optype:"SetParagraphStyle",memberid:l,timestamp:a,position:e,styleName:c}}};ops.OpSplitParagraph=function(){var f,l,a,e,c,k,q=odf.OdfUtils,n=odf.Namespaces.textns;this.init=function(n){f=n.memberid;l=n.timestamp;e=n.position;a=n.sourceParagraphPosition;k=n.paragraphStyleName;c="true"===n.moveCursor||!0===n.moveCursor};this.isEdit=!0;this.group=void 0;this.execute=function(a){var g,h,b,d,r,m,x,t=a.getCursor(f);a.upgradeWhitespacesAtPosition(e);g=a.getTextNodeAtStep(e);if(!g)return!1;h=q.getParagraphElement(g.textNode);if(!h)return!1;q.isListItem(h.parentNode)?(console.log("paragraphNode"),
console.log(h),b=h.parentNode):b=h;0===g.offset?(x=g.textNode.previousSibling,m=null):(x=g.textNode,m=g.offset>=g.textNode.length?null:g.textNode.splitText(g.offset));for(d=g.textNode;d!==b;){d=d.parentNode;r=d.cloneNode(!1);m&&r.appendChild(m);if(x)for(;x&&x.nextSibling;)r.appendChild(x.nextSibling);else for(;d.firstChild;)r.appendChild(d.firstChild);d.parentNode.insertBefore(r,d.nextSibling);x=d;m=r}q.isListItem(m)&&(m=m.childNodes.item(0));k?m.setAttributeNS(n,"text:style-name",k):m.removeAttributeNS(n,
"style-name");0===g.textNode.length&&g.textNode.parentNode.removeChild(g.textNode);a.emit(ops.OdtDocument.signalStepsInserted,{position:e});t&&c&&(a.moveCursor(f,e+1,0),a.emit(ops.Document.signalCursorMoved,t));a.fixCursorPositions();a.getOdfCanvas().refreshSize();a.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:h,memberId:f,timeStamp:l});a.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:m,memberId:f,timeStamp:l});a.getOdfCanvas().rerenderAnnotations();return!0};this.spec=
function(){return{optype:"SplitParagraph",memberid:f,timestamp:l,position:e,sourceParagraphPosition:a,paragraphStyleName:k,moveCursor:c}}};ops.OpUpdateMember=function(){function f(a){var c="//dc:creator[@editinfo:memberid='"+l+"']";a=xmldom.XPath.getODFElementsWithXPath(a.getRootNode(),c,function(a){return"editinfo"===a?"urn:webodf:names:editinfo":odf.Namespaces.lookupNamespaceURI(a)});for(c=0;c<a.length;c+=1)a[c].textContent=e.fullName}var l,a,e,c;this.init=function(f){l=f.memberid;a=parseInt(f.timestamp,10);e=f.setProperties;c=f.removedProperties};this.isEdit=!1;this.group=void 0;this.execute=function(a){var q=a.getMember(l);if(!q)return!1;
c&&q.removeProperties(c);e&&(q.setProperties(e),e.fullName&&f(a));a.emit(ops.Document.signalMemberUpdated,q);return!0};this.spec=function(){return{optype:"UpdateMember",memberid:l,timestamp:a,setProperties:e,removedProperties:c}}};ops.OpUpdateMetadata=function(){var f,l,a,e;this.init=function(c){f=c.memberid;l=parseInt(c.timestamp,10);a=c.setProperties;e=c.removedProperties};this.isEdit=!0;this.group=void 0;this.execute=function(c){var f=c.getOdfCanvas().odfContainer(),l=null;e&&(l=e.attributes.split(","));f.setMetadata(a,l);c.emit(ops.OdtDocument.signalMetadataUpdated,{setProperties:null!==a?a:{},removedProperties:null!==l?l:[]});return!0};this.spec=function(){return{optype:"UpdateMetadata",memberid:f,timestamp:l,setProperties:a,
removedProperties:e}}};ops.OpUpdateParagraphStyle=function(){function f(a,c){var e,f,b=c?c.split(","):[];for(e=0;e<b.length;e+=1)f=b[e].split(":"),a.removeAttributeNS(odf.Namespaces.lookupNamespaceURI(f[0]),f[1])}var l,a,e,c,k,q=odf.Namespaces.stylens;this.init=function(f){l=f.memberid;a=f.timestamp;e=f.styleName;c=f.setProperties;k=f.removedProperties};this.isEdit=!0;this.group=void 0;this.execute=function(a){var l=a.getFormatting(),g,h,b;return(g=""!==e?l.getStyleElement(e,"paragraph"):l.getDefaultStyleElement("paragraph"))?
(h=g.getElementsByTagNameNS(q,"paragraph-properties").item(0),b=g.getElementsByTagNameNS(q,"text-properties").item(0),c&&l.updateStyle(g,c),k&&(l=k["style:paragraph-properties"],h&&l&&(f(h,l.attributes),0===h.attributes.length&&g.removeChild(h)),l=k["style:text-properties"],b&&l&&(f(b,l.attributes),0===b.attributes.length&&g.removeChild(b)),f(g,k.attributes)),a.getOdfCanvas().refreshCSS(),a.emit(ops.OdtDocument.signalParagraphStyleModified,e),a.getOdfCanvas().rerenderAnnotations(),!0):!1};this.spec=
function(){return{optype:"UpdateParagraphStyle",memberid:l,timestamp:a,styleName:e,setProperties:c,removedProperties:k}}};ops.OperationFactory=function(){function f(a){return function(e){return new a}}var l;this.register=function(a,e){l[a]=e};this.create=function(a){var e=null,c=l[a.optype];c&&(e=c(a),e.init(a));return e};l={AddMember:f(ops.OpAddMember),UpdateMember:f(ops.OpUpdateMember),RemoveMember:f(ops.OpRemoveMember),AddCursor:f(ops.OpAddCursor),ApplyDirectStyling:f(ops.OpApplyDirectStyling),SetBlob:f(ops.OpSetBlob),RemoveBlob:f(ops.OpRemoveBlob),InsertImage:f(ops.OpInsertImage),InsertTable:f(ops.OpInsertTable),
InsertText:f(ops.OpInsertText),RemoveText:f(ops.OpRemoveText),MergeParagraph:f(ops.OpMergeParagraph),SplitParagraph:f(ops.OpSplitParagraph),SetParagraphStyle:f(ops.OpSetParagraphStyle),UpdateParagraphStyle:f(ops.OpUpdateParagraphStyle),AddStyle:f(ops.OpAddStyle),RemoveStyle:f(ops.OpRemoveStyle),MoveCursor:f(ops.OpMoveCursor),RemoveCursor:f(ops.OpRemoveCursor),AddAnnotation:f(ops.OpAddAnnotation),RemoveAnnotation:f(ops.OpRemoveAnnotation),UpdateMetadata:f(ops.OpUpdateMetadata),ApplyHyperlink:f(ops.OpApplyHyperlink),
CreateBulletlist:f(ops.OpCreateBulletlist),RemoveHyperlink:f(ops.OpRemoveHyperlink)}};ops.OperationRouter=function(){};ops.OperationRouter.prototype.setOperationFactory=function(f){};ops.OperationRouter.prototype.setPlaybackFunction=function(f){};ops.OperationRouter.prototype.push=function(f){};ops.OperationRouter.prototype.close=function(f){};ops.OperationRouter.prototype.subscribe=function(f,l){};ops.OperationRouter.prototype.unsubscribe=function(f,l){};ops.OperationRouter.prototype.hasLocalUnsyncedOps=function(){};ops.OperationRouter.prototype.hasSessionHostConnection=function(){};
ops.OperationRouter.signalProcessingBatchStart="router/batchstart";ops.OperationRouter.signalProcessingBatchEnd="router/batchend";ops.TrivialOperationRouter=function(){var f=new core.EventNotifier([ops.OperationRouter.signalProcessingBatchStart,ops.OperationRouter.signalProcessingBatchEnd]),l,a,e=0;this.setOperationFactory=function(a){l=a};this.setPlaybackFunction=function(c){a=c};this.push=function(c){e+=1;f.emit(ops.OperationRouter.signalProcessingBatchStart,{});c.forEach(function(c){c=c.spec();c.timestamp=Date.now();c=l.create(c);c.group="g"+e;a(c)});f.emit(ops.OperationRouter.signalProcessingBatchEnd,{})};this.close=function(a){a()};
this.subscribe=function(a,e){f.subscribe(a,e)};this.unsubscribe=function(a,e){f.unsubscribe(a,e)};this.hasLocalUnsyncedOps=function(){return!1};this.hasSessionHostConnection=function(){return!0}};ops.Session=function(f){function l(a){c.emit(ops.OdtDocument.signalProcessingBatchStart,a)}function a(a){c.emit(ops.OdtDocument.signalProcessingBatchEnd,a)}var e=new ops.OperationFactory,c=new ops.OdtDocument(f),k=null;this.setOperationFactory=function(a){e=a;k&&k.setOperationFactory(e)};this.setOperationRouter=function(f){k&&(k.unsubscribe(ops.OperationRouter.signalProcessingBatchStart,l),k.unsubscribe(ops.OperationRouter.signalProcessingBatchEnd,a));k=f;k.subscribe(ops.OperationRouter.signalProcessingBatchStart,
l);k.subscribe(ops.OperationRouter.signalProcessingBatchEnd,a);f.setPlaybackFunction(function(a){c.emit(ops.OdtDocument.signalOperationStart,a);return a.execute(c)?(c.emit(ops.OdtDocument.signalOperationEnd,a),!0):!1});f.setOperationFactory(e)};this.getOperationFactory=function(){return e};this.getOdtDocument=function(){return c};this.enqueue=function(a){k.push(a)};this.close=function(a){k.close(function(e){e?a(e):c.close(a)})};this.destroy=function(a){c.destroy(a)};this.setOperationRouter(new ops.TrivialOperationRouter);
gui.BulletlistController.setDefaultStyle(this.getOdtDocument(),void 0)};gui.AnnotationController=function(f,l,a){function e(){var b=n.getCursor(a),b=b&&b.getNode(),c=!1;b&&(c=!h.isWithinAnnotation(b,n.getRootNode()));c!==p&&(p=c,g.emit(gui.AnnotationController.annotatableChanged,p))}function c(b){b.getMemberId()===a&&e()}function k(b){b===a&&e()}function q(b){b.getMemberId()===a&&e()}var n=f.getOdtDocument(),p=!1,g=new core.EventNotifier([gui.AnnotationController.annotatableChanged]),h=odf.OdfUtils,b=core.StepDirection.NEXT;this.isAnnotatable=function(){return p};this.addAnnotation=
function(){var b=new ops.OpAddAnnotation,c=n.getCursorSelection(a),e=c.length,c=c.position;p&&(0===e?e=void 0:(c=0<=e?c:c+e,e=Math.abs(e)),b.init({memberid:a,position:c,length:e,name:a+Date.now()}),f.enqueue([b]))};this.removeAnnotation=function(d){var c,e;c=n.getMember(a).getProperties().fullName;if(!0!==l.getState(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN)||c===h.getAnnotationCreator(d))c=n.convertDomPointToCursorStep(d,0,b),e=n.convertDomPointToCursorStep(d,d.childNodes.length),d=
new ops.OpRemoveAnnotation,d.init({memberid:a,position:c,length:e-c}),e=new ops.OpMoveCursor,e.init({memberid:a,position:0<c?c-1:c,length:0}),f.enqueue([d,e])};this.subscribe=function(b,a){g.subscribe(b,a)};this.unsubscribe=function(b,a){g.unsubscribe(b,a)};this.destroy=function(b){n.unsubscribe(ops.Document.signalCursorAdded,c);n.unsubscribe(ops.Document.signalCursorRemoved,k);n.unsubscribe(ops.Document.signalCursorMoved,q);b()};l.registerConstraint(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN);
n.subscribe(ops.Document.signalCursorAdded,c);n.subscribe(ops.Document.signalCursorRemoved,k);n.subscribe(ops.Document.signalCursorMoved,q);e()};gui.AnnotationController.annotatableChanged="annotatable/changed";gui.Avatar=function(f,l){var a=this,e,c,k;this.setColor=function(a){c.style.borderColor=a};this.setImageUrl=function(e){a.isVisible()?c.src=e:k=e};this.isVisible=function(){return"block"===e.style.display};this.show=function(){k&&(c.src=k,k=void 0);e.style.display="block"};this.hide=function(){e.style.display="none"};this.markAsFocussed=function(a){a?e.classList.add("active"):e.classList.remove("active")};this.destroy=function(a){f.removeChild(e);a()};(function(){var a=f.ownerDocument;e=a.createElement("div");
c=a.createElement("img");e.appendChild(c);e.style.display=l?"block":"none";e.className="handle";f.appendChild(e)})()};gui.SessionContext=function(f,l){var a=f.getOdtDocument(),e=odf.OdfUtils;this.isLocalCursorWithinOwnAnnotation=function(){var c=a.getCursor(l),f;if(!c)return!1;f=c&&c.getNode();c=a.getMember(l).getProperties().fullName;return(f=e.getParentAnnotation(f,a.getRootNode()))&&e.getAnnotationCreator(f)===c?!0:!1}};gui.BulletlistController=function(f,l,a,e,c){function k(){var b=!0;!0===a.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)&&(b=e.isLocalCursorWithinOwnAnnotation());b!==h&&(h=b,g.emit(gui.BulletlistController.enabledChanged,h))}function q(b){b.getMemberId()===c&&k()}var n=odf.OdfUtils,p=f.getOdtDocument(),g=new core.EventNotifier([gui.BulletlistController.enabledChanged]),h=!1;gui.BulletlistController.session=f;gui.BulletlistController.memberid=c;this.isEnabled=function(){return h};this.subscribe=
function(b,a){g.subscribe(b,a)};this.unsubscribe=function(b,a){g.unsubscribe(b,a)};this.addBulletlist=function(){if(h){var b=p.getCursorSelection(c),a=p.getCursor(c);n.getParagraphElement(a.getNode()).getAttributeNS(odf.Namespaces.textns,"style-name");var a=[],e=new ops.OpCreateBulletlist;e.init({memberid:c,length:b.length,position:b.position});a.push(e);f.enqueue(a);l.focus()}};this.removeBulletlist=function(){};this.destroy=function(b){p.unsubscribe(ops.Document.signalCursorMoved,q);a.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,
k);b()};p.subscribe(ops.Document.signalCursorMoved,q);a.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,k);k()};gui.BulletlistController.enabledChanged="enabled/changed";gui.BulletlistController.memberid=null;
gui.BulletlistController.setDefaultStyle=function(f,l){var a=f.getDOMDocument(),e=f.getOdfCanvas().getStyleSheet().sheet,c;c='text|list > text|list-item > :not(text|list):first-child::before{   content: "\u2022";';c+="   counter-increment: X1-level1-1 1;";c+="   text-align: left;";c+="   display: inline-block;";c+="   margin-left: 0.635cm;";c+="   padding-right: 0.2cm;";c+="}";e.insertRule(c,e.cssRules.length);void 0===l&&(l="localuser");if(!f.getOdfCanvas().getFormatting().getStyleElement("L1","list-style")){e=
a.createElementNS(odf.Namespaces.textns,"text:list-style");e.setAttributeNS(odf.Namespaces.stylens,"style:name","L1");var k=a.createElementNS(odf.Namespaces.textns,"text:list-level-style-bullet");k.setAttributeNS(odf.Namespaces.textns,"text:bullet-char","\u2022");k.setAttributeNS(odf.Namespaces.textns,"text:level","1");k.setAttributeNS(odf.Namespaces.textns,"text:style-name","Bullet_20_Symbols");e.appendChild(k);c=a.createElementNS(odf.Namespaces.stylens,"style:list-level-properties");c.setAttributeNS(odf.Namespaces.textns,
"text:list-level-position-and-space-mode","label-alignment");k.appendChild(c);a=a.createElementNS(odf.Namespaces.stylens,"style:list-level-label-alignment");a.setAttributeNS(odf.Namespaces.fons,"fo:margin-left","1.27cm");a.setAttributeNS(odf.Namespaces.fons,"fo:text-indent","-0.635cm");a.setAttributeNS(odf.Namespaces.textns,"text:label-followed-by","listtab");a.setAttributeNS(odf.Namespaces.textns,"text:list-tab-stop-position","1.27cm");c.appendChild(a);f.getOdfCanvas().odfContainer().rootElement.automaticStyles.appendChild(e);
gui.BulletlistController.session&&(a=new ops.OpAddStyle,a.init({memberid:l,styleName:"P1",styleFamily:"paragraph",isAutomaticStyle:!0,setProperties:{"style:list-style-name":"L1","style:list-parent-name":"Standard"}}),gui.BulletlistController.session.enqueue([a]))}};gui.StepInfo=function(){};gui.StepInfo.VisualDirection={LEFT_TO_RIGHT:0,RIGHT_TO_LEFT:1};gui.StepInfo.prototype.container=function(){};gui.StepInfo.prototype.offset=function(){};gui.VisualStepScanner=function(){};gui.VisualStepScanner.prototype.process=function(f,l,a){};gui.GuiStepUtils=function(){function f(c){c=a.getContentBounds(c);var f,g=null;if(c)if(c.container.nodeType===Node.TEXT_NODE)f=c.container.ownerDocument.createRange(),f.setStart(c.container,c.startOffset),f.setEnd(c.container,c.endOffset),(g=0<f.getClientRects().length?f.getBoundingClientRect():null)&&" "===c.container.data.substring(c.startOffset,c.endOffset)&&1>=g.width&&(g=null),f.detach();else if(l.isCharacterElement(c.container)||l.isCharacterFrame(c.container))g=e.getBoundingClientRect(c.container);
return g}var l=odf.OdfUtils,a=new odf.StepUtils,e=core.DomUtils,c=core.StepDirection.NEXT,k=gui.StepInfo.VisualDirection.LEFT_TO_RIGHT,q=gui.StepInfo.VisualDirection.RIGHT_TO_LEFT;this.getContentRect=f;this.moveToFilteredStep=function(a,e,g){function h(b,a){a.process(v,m,x)&&(b=!0,!t&&a.token&&(t=a.token));return b}var b=e===c,d,l,m,x,t,y=a.snapshot();d=!1;var v;do d=f(a),v={token:a.snapshot(),container:a.container,offset:a.offset,direction:e,visualDirection:e===c?k:q},l=a.nextStep()?f(a):null,a.restore(v.token),
b?(m=d,x=l):(m=l,x=d),d=g.reduce(h,!1);while(!d&&a.advanceStep(e));d||g.forEach(function(b){!t&&b.token&&(t=b.token)});a.restore(t||y);return Boolean(t)}};gui.Caret=function(f,l,a,e){function c(){h.style.opacity="0"===h.style.opacity?"1":"0";w.trigger()}function k(){m.selectNodeContents(r);return m.getBoundingClientRect()}function q(){Object.keys(B).forEach(function(b){E[b]=B[b]})}function n(){if(!1===B.isShown||f.getSelectionType()!==ops.OdtCursor.RangeSelection||!e&&!f.getSelectedRange().collapsed)B.visibility="hidden",h.style.visibility="hidden",w.cancel();else if(B.visibility="visible",h.style.visibility="visible",!1===B.isFocused)h.style.opacity=
"1",w.cancel();else{if(u||E.visibility!==B.visibility)h.style.opacity="1",w.cancel();w.trigger()}if(F||A){var a;a=f.getNode();var c,m,n=t.getBoundingClientRect(x.getSizer()),p=!1,r=0;a.removeAttributeNS("urn:webodf:names:cursor","caret-sizer-active");if(0<a.getClientRects().length)m=k(),r=m.left-t.getBoundingClientRect(a).left,p=!0;else if(v.setPosition(a,0),m=y.getContentRect(v),!m&&v.nextStep()&&(c=y.getContentRect(v))&&(m=c,p=!0),m||(a.setAttributeNS("urn:webodf:names:cursor","caret-sizer-active",
"true"),m=k(),p=!0),!m)for(runtime.log("WARN: No suitable client rectangle found for visual caret for "+f.getMemberId());a;){if(0<a.getClientRects().length){m=t.getBoundingClientRect(a);p=!0;break}a=a.parentNode}m=t.translateRect(m,n,x.getZoomLevel());a={top:m.top,height:m.height,right:p?m.left:m.right,width:t.adaptRangeDifferenceToZoomLevel(r,x.getZoomLevel())};8>a.height&&(a={top:a.top-(8-a.height)/2,height:8,right:a.right});g.style.height=a.height+"px";g.style.top=a.top+"px";g.style.left=a.right-
a.width+"px";g.style.width=a.width?a.width+"px":"";d&&(a=runtime.getWindow().getComputedStyle(f.getNode(),null),a.font?d.style.font=a.font:(d.style.fontStyle=a.fontStyle,d.style.fontVariant=a.fontVariant,d.style.fontWeight=a.fontWeight,d.style.fontSize=a.fontSize,d.style.lineHeight=a.lineHeight,d.style.fontFamily=a.fontFamily))}B.isShown&&A&&l.scrollIntoView(h.getBoundingClientRect());E.isFocused!==B.isFocused&&b.markAsFocussed(B.isFocused);q();F=A=u=!1}function p(b){g.parentNode.removeChild(g);r.parentNode.removeChild(r);
b()}var g,h,b,d,r,m,x=f.getDocument().getCanvas(),t=core.DomUtils,y=new gui.GuiStepUtils,v,s,w,u=!1,A=!1,F=!1,B={isFocused:!1,isShown:!0,visibility:"hidden"},E={isFocused:!B.isFocused,isShown:!B.isShown,visibility:"hidden"};this.handleUpdate=function(){F=!0;s.trigger()};this.refreshCursorBlinking=function(){u=!0;s.trigger()};this.setFocus=function(){B.isFocused=!0;s.trigger()};this.removeFocus=function(){B.isFocused=!1;s.trigger()};this.show=function(){B.isShown=!0;s.trigger()};this.hide=function(){B.isShown=
!1;s.trigger()};this.setAvatarImageUrl=function(a){b.setImageUrl(a)};this.setColor=function(a){h.style.borderColor=a;b.setColor(a)};this.getCursor=function(){return f};this.getFocusElement=function(){return h};this.toggleHandleVisibility=function(){b.isVisible()?b.hide():b.show()};this.showHandle=function(){b.show()};this.hideHandle=function(){b.hide()};this.setOverlayElement=function(b){d=b;g.appendChild(b);F=!0;s.trigger()};this.ensureVisible=function(){A=!0;s.trigger()};this.getBoundingClientRect=
function(){return t.getBoundingClientRect(g)};this.destroy=function(a){core.Async.destroyAll([s.destroy,w.destroy,b.destroy,p],a)};(function(){var d=f.getDocument(),e=[d.createRootFilter(f.getMemberId()),d.getPositionFilter()],k=d.getDOMDocument();m=k.createRange();r=k.createElement("span");r.className="webodf-caretSizer";r.textContent="|";f.getNode().appendChild(r);g=k.createElement("div");g.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",f.getMemberId());g.className="webodf-caretOverlay";
h=k.createElement("div");h.className="caret";g.appendChild(h);b=new gui.Avatar(g,a);x.getSizer().appendChild(g);v=d.createStepIterator(f.getNode(),0,e,d.getRootNode());s=core.Task.createRedrawTask(n);w=core.Task.createTimeoutTask(c,500);s.triggerImmediate()})()};odf.TextSerializer=function(){function f(e){var c="",k=l.filter?l.filter.acceptNode(e):NodeFilter.FILTER_ACCEPT,q=e.nodeType,n;if((k===NodeFilter.FILTER_ACCEPT||k===NodeFilter.FILTER_SKIP)&&a.isTextContentContainingNode(e))for(n=e.firstChild;n;)c+=f(n),n=n.nextSibling;k===NodeFilter.FILTER_ACCEPT&&(q===Node.ELEMENT_NODE&&a.isParagraph(e)?c+="\n":q===Node.TEXT_NODE&&e.textContent&&(c+=e.textContent));return c}var l=this,a=odf.OdfUtils;this.filter=null;this.writeToString=function(a){if(!a)return"";
a=f(a);"\n"===a[a.length-1]&&(a=a.substr(0,a.length-1));return a}};gui.MimeDataExporter=function(){var f;this.exportRangeToDataTransfer=function(l,a){var e;e=a.startContainer.ownerDocument.createElement("span");e.appendChild(a.cloneContents());e=f.writeToString(e);try{l.setData("text/plain",e)}catch(c){l.setData("Text",e)}};f=new odf.TextSerializer;f.filter=new odf.OdfNodeFilter};gui.Clipboard=function(f){this.setDataFromRange=function(l,a){var e,c=l.clipboardData;e=runtime.getWindow();!c&&e&&(c=e.clipboardData);c?(e=!0,f.exportRangeToDataTransfer(c,a),l.preventDefault()):e=!1;return e}};gui.StyleSummary=function(f){function l(a,e){var l=a+"|"+e,p;c.hasOwnProperty(l)||(p=[],f.forEach(function(c){c=(c=c.styleProperties[a])&&c[e];-1===p.indexOf(c)&&p.push(c)}),c[l]=p);return c[l]}function a(a,c,e){return function(){var f=l(a,c);return e.length>=f.length&&f.every(function(a){return-1!==e.indexOf(a)})}}function e(a,c){var e=l(a,c);return 1===e.length?e[0]:void 0}var c={};this.getPropertyValues=l;this.getCommonValue=e;this.isBold=a("style:text-properties","fo:font-weight",["bold"]);this.isItalic=
a("style:text-properties","fo:font-style",["italic"]);this.hasUnderline=a("style:text-properties","style:text-underline-style",["solid"]);this.hasStrikeThrough=a("style:text-properties","style:text-line-through-style",["solid"]);this.fontSize=function(){var a=e("style:text-properties","fo:font-size");return a&&parseFloat(a)};this.fontName=function(){return e("style:text-properties","style:font-name")};this.isAlignedLeft=a("style:paragraph-properties","fo:text-align",["left","start"]);this.isAlignedCenter=
a("style:paragraph-properties","fo:text-align",["center"]);this.isAlignedRight=a("style:paragraph-properties","fo:text-align",["right","end"]);this.isAlignedJustified=a("style:paragraph-properties","fo:text-align",["justify"]);this.text={isBold:this.isBold,isItalic:this.isItalic,hasUnderline:this.hasUnderline,hasStrikeThrough:this.hasStrikeThrough,fontSize:this.fontSize,fontName:this.fontName};this.paragraph={isAlignedLeft:this.isAlignedLeft,isAlignedCenter:this.isAlignedCenter,isAlignedRight:this.isAlignedRight,
isAlignedJustified:this.isAlignedJustified}};gui.DirectFormattingController=function(f,l,a,e,c,k,q){function n(){return V.value().styleSummary}function p(){return V.value().enabledFeatures}function g(b){var a;b.collapsed?(a=b.startContainer,a.hasChildNodes()&&b.startOffset<a.childNodes.length&&(a=a.childNodes.item(b.startOffset)),b=[a]):b=ba.getTextElements(b,!0,!1);return b}function h(){var b=I.getCursor(e),d=b&&b.getSelectedRange(),c=[],c=[],f=!0,h={directTextStyling:!0,directParagraphStyling:!0};d&&(c=g(d),0===c.length&&(c=[d.startContainer,
d.endContainer],f=!1),c=I.getFormatting().getAppliedStyles(c));void 0!==c[0]&&$&&(c[0].styleProperties=G.mergeObjects(c[0].styleProperties,$));!0===l.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)&&(h.directTextStyling=h.directParagraphStyling=a.isLocalCursorWithinOwnAnnotation());h.directTextStyling&&(h.directTextStyling=f&&void 0!==b&&b.getSelectionType()===ops.OdtCursor.RangeSelection);return{enabledFeatures:h,appliedStyles:c,styleSummary:new gui.StyleSummary(c)}}function b(b,a){var d={};Object.keys(b).forEach(function(c){var e=
b[c](),f=a[c]();e!==f&&(d[c]=f)});return d}function d(){var a,d;d=C.styleSummary;var c=V.value(),e=c.styleSummary,f=C.enabledFeatures,h=c.enabledFeatures;a=b(d.text,e.text);d=b(d.paragraph,e.paragraph);f=!(h.directTextStyling===f.directTextStyling&&h.directParagraphStyling===f.directParagraphStyling);C=c;f&&T.emit(gui.DirectFormattingController.enabledChanged,h);0<Object.keys(a).length&&T.emit(gui.DirectFormattingController.textStylingChanged,a);0<Object.keys(d).length&&T.emit(gui.DirectFormattingController.paragraphStylingChanged,
d)}function r(){V.reset();d()}function m(b){("string"===typeof b?b:b.getMemberId())===e&&V.reset()}function x(){V.reset()}function t(b){var a=I.getCursor(e);b=b.paragraphElement;a&&ba.getParagraphElement(a.getNode())===b&&V.reset()}function y(b,a){a(!b());return!0}function v(b){if(p().directTextStyling){var a=I.getCursorSelection(e),d={"style:text-properties":b};0!==a.length?(b=new ops.OpApplyDirectStyling,b.init({memberid:e,position:a.position,length:a.length,setProperties:d}),f.enqueue([b])):($=
G.mergeObjects($||{},d),V.reset())}}function s(b,a){var d={};d[b]=a;v(d)}function w(b){b=b.spec();$&&b.memberid===e&&"SplitParagraph"!==b.optype&&($=null,V.reset())}function u(b){s("fo:font-weight",b?"bold":"normal")}function A(b){s("fo:font-style",b?"italic":"normal")}function F(b){s("style:text-underline-style",b?"solid":"none")}function B(b){s("style:text-line-through-style",b?"solid":"none")}function E(b){if(p().directParagraphStyling){var a=I.getCursor(e).getSelectedRange(),a=ba.getParagraphElements(a),
d=I.getFormatting(),h=[],g={},m;a.forEach(function(a){var f=I.convertDomPointToCursorStep(a,0,O),k=a.getAttributeNS(odf.Namespaces.textns,"style-name"),l;a=k?g.hasOwnProperty(k)?g[k]:void 0:m;a||(a=c.generateStyleName(),k?(g[k]=a,l=d.createDerivedStyleObject(k,"paragraph",{})):(m=a,l={}),l=b(l),k=new ops.OpAddStyle,k.init({memberid:e,styleName:a.toString(),styleFamily:"paragraph",isAutomaticStyle:!0,setProperties:l}),h.push(k));k=new ops.OpSetParagraphStyle;k.init({memberid:e,styleName:a.toString(),
position:f});h.push(k)});f.enqueue(h)}}function J(b){E(function(a){return G.mergeObjects(a,b)})}function H(b){J({"style:paragraph-properties":{"fo:text-align":b}})}function Q(b,a){var d=I.getFormatting().getDefaultTabStopDistance(),c=a["style:paragraph-properties"],e;c&&(c=c["fo:margin-left"],e=ba.parseLength(c));return G.mergeObjects(a,{"style:paragraph-properties":{"fo:margin-left":e&&e.unit===d.unit?e.value+b*d.value+e.unit:b*d.value+d.unit}})}function N(b,a){var d=g(b),d=0===d.length?[b.startContainer]:
d,d=I.getFormatting().getAppliedStyles(d),c=0<d.length?d[0].styleProperties:void 0,e=I.getFormatting().getAppliedStylesForElement(a).styleProperties;if(!c||"text"!==c["style:family"]||!c["style:text-properties"])return!1;if(!e||!e["style:text-properties"])return!0;c=c["style:text-properties"];e=e["style:text-properties"];return!Object.keys(c).every(function(b){return c[b]===e[b]})}function z(){}function Z(){return!1}var R=this,I=f.getOdtDocument(),G=new core.Utils,ba=odf.OdfUtils,T=new core.EventNotifier([gui.DirectFormattingController.enabledChanged,
gui.DirectFormattingController.textStylingChanged,gui.DirectFormattingController.paragraphStylingChanged]),D=odf.Namespaces.textns,O=core.StepDirection.NEXT,$=null,C,V;this.enabledFeatures=p;this.formatTextSelection=v;this.createCursorStyleOp=function(b,a,d){var c=null,f=$;d&&(f=(d=V.value().appliedStyles[0])&&d.styleProperties);f&&f["style:text-properties"]&&(c=new ops.OpApplyDirectStyling,c.init({memberid:e,position:b,length:a,setProperties:{"style:text-properties":f["style:text-properties"]}}),
$=null,V.reset());return c};this.setBold=u;this.setItalic=A;this.setHasUnderline=F;this.setHasStrikethrough=B;this.setFontSize=function(b){s("fo:font-size",b+"pt")};this.setFontName=function(b){s("style:font-name",b)};this.getAppliedStyles=function(){return V.value().appliedStyles};this.toggleBold=y.bind(R,function(){return n().isBold()},u);this.toggleItalic=y.bind(R,function(){return n().isItalic()},A);this.toggleUnderline=y.bind(R,function(){return n().hasUnderline()},F);this.toggleStrikethrough=
y.bind(R,function(){return n().hasStrikeThrough()},B);this.isBold=function(){return n().isBold()};this.isItalic=function(){return n().isItalic()};this.hasUnderline=function(){return n().hasUnderline()};this.hasStrikeThrough=function(){return n().hasStrikeThrough()};this.fontSize=function(){return n().fontSize()};this.fontName=function(){return n().fontName()};this.isAlignedLeft=function(){return n().isAlignedLeft()};this.isAlignedCenter=function(){return n().isAlignedCenter()};this.isAlignedRight=
function(){return n().isAlignedRight()};this.isAlignedJustified=function(){return n().isAlignedJustified()};this.alignParagraphLeft=function(){H("left");return!0};this.alignParagraphCenter=function(){H("center");return!0};this.alignParagraphRight=function(){H("right");return!0};this.alignParagraphJustified=function(){H("justify");return!0};this.indent=function(){E(Q.bind(null,1));return!0};this.outdent=function(){E(Q.bind(null,-1));return!0};this.createParagraphStyleOps=function(b){if(!p().directParagraphStyling)return[];
var a=I.getCursor(e),d=a.getSelectedRange(),f=[],h,g;a.hasForwardSelection()?(h=a.getAnchorNode(),g=a.getNode()):(h=a.getNode(),g=a.getAnchorNode());a=ba.getParagraphElement(g);runtime.assert(Boolean(a),"DirectFormattingController: Cursor outside paragraph");var m=a,k=[I.getPositionFilter(),I.createRootFilter(e)];if(!1!==I.createStepIterator(d.endContainer,d.endOffset,k,m).nextStep())return f;g!==h&&(a=ba.getParagraphElement(h));if(!$&&!N(d,a))return f;d=(d=V.value().appliedStyles[0])&&d.styleProperties;
if(!d)return f;if(a=a.getAttributeNS(D,"style-name"))d={"style:text-properties":d["style:text-properties"]},d=I.getFormatting().createDerivedStyleObject(a,"paragraph",d);h=c.generateStyleName();a=new ops.OpAddStyle;a.init({memberid:e,styleName:h,styleFamily:"paragraph",isAutomaticStyle:!0,setProperties:d});f.push(a);a=new ops.OpSetParagraphStyle;a.init({memberid:e,styleName:h,position:b});f.push(a);return f};this.subscribe=function(b,a){T.subscribe(b,a)};this.unsubscribe=function(b,a){T.unsubscribe(b,
a)};this.destroy=function(b){I.unsubscribe(ops.Document.signalCursorAdded,m);I.unsubscribe(ops.Document.signalCursorRemoved,m);I.unsubscribe(ops.Document.signalCursorMoved,m);I.unsubscribe(ops.OdtDocument.signalParagraphStyleModified,x);I.unsubscribe(ops.OdtDocument.signalParagraphChanged,t);I.unsubscribe(ops.OdtDocument.signalOperationEnd,w);I.unsubscribe(ops.OdtDocument.signalProcessingBatchEnd,d);l.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,r);b()};(function(){I.subscribe(ops.Document.signalCursorAdded,
m);I.subscribe(ops.Document.signalCursorRemoved,m);I.subscribe(ops.Document.signalCursorMoved,m);I.subscribe(ops.OdtDocument.signalParagraphStyleModified,x);I.subscribe(ops.OdtDocument.signalParagraphChanged,t);I.subscribe(ops.OdtDocument.signalOperationEnd,w);I.subscribe(ops.OdtDocument.signalProcessingBatchEnd,d);l.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,r);V=new core.LazyProperty(h);C=V.value();k||(R.formatTextSelection=z,R.setBold=z,R.setItalic=z,R.setHasUnderline=z,R.setHasStrikethrough=
z,R.setFontSize=z,R.setFontName=z,R.toggleBold=Z,R.toggleItalic=Z,R.toggleUnderline=Z,R.toggleStrikethrough=Z);q||(R.alignParagraphCenter=z,R.alignParagraphJustified=z,R.alignParagraphLeft=z,R.alignParagraphRight=z,R.createParagraphStyleOps=function(){return[]},R.indent=z,R.outdent=z)})()};gui.DirectFormattingController.enabledChanged="enabled/changed";gui.DirectFormattingController.textStylingChanged="textStyling/changed";gui.DirectFormattingController.paragraphStylingChanged="paragraphStyling/changed";
gui.DirectFormattingController.SelectionInfo=function(){};gui.KeyboardHandler=function(){function f(a,e){e||(e=l.None);switch(a){case gui.KeyboardHandler.KeyCode.LeftMeta:case gui.KeyboardHandler.KeyCode.RightMeta:case gui.KeyboardHandler.KeyCode.MetaInMozilla:e|=l.Meta;break;case gui.KeyboardHandler.KeyCode.Ctrl:e|=l.Ctrl;break;case gui.KeyboardHandler.KeyCode.Alt:e|=l.Alt;break;case gui.KeyboardHandler.KeyCode.Shift:e|=l.Shift}return a+":"+e}var l=gui.KeyboardHandler.Modifier,a=null,e={};this.setDefault=function(c){a=c};this.bind=function(a,k,l,n){a=f(a,
k);runtime.assert(n||!1===e.hasOwnProperty(a),"tried to overwrite the callback handler of key combo: "+a);e[a]=l};this.unbind=function(a,k){var l=f(a,k);delete e[l]};this.reset=function(){a=null;e={}};this.handleEvent=function(c){var k=c.keyCode,q=l.None;c.metaKey&&(q|=l.Meta);c.ctrlKey&&(q|=l.Ctrl);c.altKey&&(q|=l.Alt);c.shiftKey&&(q|=l.Shift);k=f(k,q);k=e[k];q=!1;k?q=k():null!==a&&(q=a(c));q&&(c.preventDefault?c.preventDefault():c.returnValue=!1)}};
gui.KeyboardHandler.Modifier={None:0,Meta:1,Ctrl:2,Alt:4,CtrlAlt:6,Shift:8,MetaShift:9,CtrlShift:10,AltShift:12};gui.KeyboardHandler.KeyCode={Backspace:8,Tab:9,Clear:12,Enter:13,Shift:16,Ctrl:17,Alt:18,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,Delete:46,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,LeftMeta:91,RightMeta:93,MetaInMozilla:224};gui.HyperlinkClickHandler=function(f,l,a){function e(){var b=f();runtime.assert(Boolean(b.classList),"Document container has no classList element");b.classList.remove("webodf-inactiveLinks")}function c(){var b=f();runtime.assert(Boolean(b.classList),"Document container has no classList element");b.classList.add("webodf-inactiveLinks")}function k(){b.removeEventListener("focus",c,!1);r.forEach(function(b){l.unbind(b.keyCode,b.modifier);a.unbind(b.keyCode,b.modifier)});r.length=0}function q(d){k();
if(d!==n.None){b.addEventListener("focus",c,!1);switch(d){case n.Ctrl:r.push({keyCode:p.Ctrl,modifier:n.None});break;case n.Meta:r.push({keyCode:p.LeftMeta,modifier:n.None}),r.push({keyCode:p.RightMeta,modifier:n.None}),r.push({keyCode:p.MetaInMozilla,modifier:n.None})}r.forEach(function(b){l.bind(b.keyCode,b.modifier,e);a.bind(b.keyCode,b.modifier,c)})}}var n=gui.KeyboardHandler.Modifier,p=gui.KeyboardHandler.KeyCode,g=xmldom.XPath,h=odf.OdfUtils,b=runtime.getWindow(),d=n.None,r=[];runtime.assert(null!==
b,"Expected to be run in an environment which has a global window, like a browser.");this.handleClick=function(a){var c=a.target||a.srcElement,e,k;a.ctrlKey?e=n.Ctrl:a.metaKey&&(e=n.Meta);if(d===n.None||d===e){a:{for(;null!==c;){if(h.isHyperlink(c))break a;if(h.isParagraph(c))break;c=c.parentNode}c=null}c&&(c=h.getHyperlinkTarget(c),""!==c&&("#"===c[0]?(c=c.substring(1),e=f(),k=g.getODFElementsWithXPath(e,"//text:bookmark-start[@text:name='"+c+"']",odf.Namespaces.lookupNamespaceURI),0===k.length&&
(k=g.getODFElementsWithXPath(e,"//text:bookmark[@text:name='"+c+"']",odf.Namespaces.lookupNamespaceURI)),0<k.length&&k[0].scrollIntoView(!0)):/^\s*(javascript|data):/.test(c)?runtime.log("WARN:","potentially malicious URL ignored"):b.open(c),a.preventDefault?a.preventDefault():a.returnValue=!1))}};this.setModifier=function(b){d!==b&&(runtime.assert(b===n.None||b===n.Ctrl||b===n.Meta,"Unsupported KeyboardHandler.Modifier value: "+b),d=b,d!==n.None?c():e(),q(d))};this.getModifier=function(){return d};
this.destroy=function(b){c();k();b()}};gui.EventManager=function(f){function l(b){function a(b,d,c){var e,f=!1;e="on"+d;b.attachEvent&&(b.attachEvent(e,c),f=!0);!f&&b.addEventListener&&(b.addEventListener(d,c,!1),f=!0);f&&!w[d]||!b.hasOwnProperty(e)||(b[e]=c)}function d(b,a,c){var e="on"+a;b.detachEvent&&b.detachEvent(e,c);b.removeEventListener&&b.removeEventListener(a,c,!1);b[e]===c&&(b[e]=null)}function c(a){if(-1===f.indexOf(a)){f.push(a);if(e.filters.every(function(b){return b(a)}))try{h.emit(b,a)}catch(d){runtime.log("Error occurred while processing "+
b+":\n"+d.message+"\n"+d.stack)}runtime.setTimeout(function(){f.splice(f.indexOf(a),1)},0)}}var e=this,f=[],h=new core.EventNotifier([b]);this.filters=[];this.subscribe=function(a){h.subscribe(b,a)};this.unsubscribe=function(a){h.unsubscribe(b,a)};this.destroy=function(){d(s,b,c);d(B,b,c);d(E,b,c)};u[b]&&a(s,b,c);a(B,b,c);a(E,b,c)}function a(b,a,d){function c(a){d(a,e,function(a){a.type=b;f.emit(b,a)})}var e={},f=new core.EventNotifier([b]);this.subscribe=function(a){f.subscribe(b,a)};this.unsubscribe=
function(a){f.unsubscribe(b,a)};this.destroy=function(){a.forEach(function(b){J.unsubscribe(b,c)})};(function(){a.forEach(function(b){J.subscribe(b,c)})})()}function e(b){runtime.clearTimeout(b);delete H[b]}function c(b,a){var d=runtime.setTimeout(function(){b();e(d)},a);H[d]=!0;return d}function k(b,a,d){var f=b.touches.length,h=b.touches[0],g=a.timer;"touchmove"===b.type||"touchend"===b.type?g&&e(g):"touchstart"===b.type&&(1!==f?runtime.clearTimeout(g):g=c(function(){d({clientX:h.clientX,clientY:h.clientY,
pageX:h.pageX,pageY:h.pageY,target:b.target||b.srcElement||null,detail:1})},400));a.timer=g}function q(b,a,d){var c=b.touches[0],e=b.target||b.srcElement||null,f=a.target;1!==b.touches.length||"touchend"===b.type?f=null:"touchstart"===b.type&&"webodf-draggable"===e.getAttribute("class")?f=e:"touchmove"===b.type&&f&&(b.preventDefault(),b.stopPropagation(),d({clientX:c.clientX,clientY:c.clientY,pageX:c.pageX,pageY:c.pageY,target:f,detail:1}));a.target=f}function n(b,a,d){var c=b.target||b.srcElement||
null,e=a.dragging;"drag"===b.type?e=!0:"touchend"===b.type&&e&&(e=!1,b=b.changedTouches[0],d({clientX:b.clientX,clientY:b.clientY,pageX:b.pageX,pageY:b.pageY,target:c,detail:1}));a.dragging=e}function p(){E.classList.add("webodf-touchEnabled");J.unsubscribe("touchstart",p)}function g(b){var a=b.scrollX,d=b.scrollY;this.restore=function(){b.scrollX===a&&b.scrollY===d||b.scrollTo(a,d)}}function h(b){var a=b.scrollTop,d=b.scrollLeft;this.restore=function(){if(b.scrollTop!==a||b.scrollLeft!==d)b.scrollTop=
a,b.scrollLeft=d}}function b(b,a){var d=F[b]||A[b]||null;!d&&a&&(d=F[b]=new l(b));return d}function d(a,d){b(a,!0).subscribe(d)}function r(a,d){var c=b(a,!1);c&&c.unsubscribe(d)}function m(){return f.getDOMDocument().activeElement===B}function x(){m()&&B.blur();B.setAttribute("disabled","true")}function t(){B.removeAttribute("disabled")}function y(b){for(var a=[];b;)(b.scrollWidth>b.clientWidth||b.scrollHeight>b.clientHeight)&&a.push(new h(b)),b=b.parentNode;a.push(new g(s));return a}function v(){var b;
m()||(b=y(B),t(),B.focus(),b.forEach(function(b){b.restore()}))}var s=runtime.getWindow(),w={beforecut:!0,beforepaste:!0,longpress:!0,drag:!0,dragstop:!0},u={mousedown:!0,mouseup:!0,focus:!0},A={},F={},B,E=f.getCanvas().getElement(),J=this,H={};this.addFilter=function(a,d){b(a,!0).filters.push(d)};this.removeFilter=function(a,d){var c=b(a,!0),e=c.filters.indexOf(d);-1!==e&&c.filters.splice(e,1)};this.subscribe=d;this.unsubscribe=r;this.hasFocus=m;this.focus=v;this.getEventTrap=function(){return B};
this.setEditing=function(b){var a=m();a&&B.blur();b?B.removeAttribute("readOnly"):B.setAttribute("readOnly","true");a&&v()};this.destroy=function(b){r("touchstart",p);Object.keys(H).forEach(function(b){e(parseInt(b,10))});H.length=0;Object.keys(A).forEach(function(b){A[b].destroy()});A={};r("mousedown",x);r("mouseup",t);r("contextmenu",t);Object.keys(F).forEach(function(b){F[b].destroy()});F={};B.parentNode.removeChild(B);b()};(function(){var b=f.getOdfCanvas().getSizer(),c=b.ownerDocument;runtime.assert(Boolean(s),
"EventManager requires a window object to operate correctly");B=c.createElement("textarea");B.id="eventTrap";B.setAttribute("tabindex","-1");B.setAttribute("readOnly","true");B.setAttribute("rows","1");b.appendChild(B);d("mousedown",x);d("mouseup",t);d("contextmenu",t);A.longpress=new a("longpress",["touchstart","touchmove","touchend"],k);A.drag=new a("drag",["touchstart","touchmove","touchend"],q);A.dragstop=new a("dragstop",["drag","touchend"],n);d("touchstart",p)})()};gui.IOSSafariSupport=function(f){function l(){a.innerHeight!==a.outerHeight&&(e.style.display="none",runtime.requestAnimationFrame(function(){e.style.display="block"}))}var a=runtime.getWindow(),e=f.getEventTrap();this.destroy=function(a){f.unsubscribe("focus",l);e.removeAttribute("autocapitalize");e.style.WebkitTransform="";a()};f.subscribe("focus",l);e.setAttribute("autocapitalize","off");e.style.WebkitTransform="translateX(-10000px)"};gui.HyperlinkController=function(f,l,a,e){function c(){var c=!0;!0===l.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)&&(c=a.isLocalCursorWithinOwnAnnotation());c!==g&&(g=c,p.emit(gui.HyperlinkController.enabledChanged,g))}function k(a){a.getMemberId()===e&&c()}var q=odf.OdfUtils,n=f.getOdtDocument(),p=new core.EventNotifier([gui.HyperlinkController.enabledChanged]),g=!1;this.isEnabled=function(){return g};this.subscribe=function(a,b){p.subscribe(a,b)};this.unsubscribe=function(a,b){p.unsubscribe(a,
b)};this.addHyperlink=function(a,b){if(g){var d=n.getCursorSelection(e),c=new ops.OpApplyHyperlink,m=[];if(0===d.length||b)b=b||a,c=new ops.OpInsertText,c.init({memberid:e,position:d.position,text:b}),d.length=b.length,m.push(c);c=new ops.OpApplyHyperlink;c.init({memberid:e,position:d.position,length:d.length,hyperlink:a});m.push(c);f.enqueue(m)}};this.removeHyperlinks=function(){if(g){var a=n.createPositionIterator(n.getRootNode()),b=n.getCursor(e).getSelectedRange(),d=q.getHyperlinkElements(b),
c=b.collapsed&&1===d.length,m=n.getDOMDocument().createRange(),k=[],l,p;0!==d.length&&(d.forEach(function(b){m.selectNodeContents(b);l=n.convertDomToCursorRange({anchorNode:m.startContainer,anchorOffset:m.startOffset,focusNode:m.endContainer,focusOffset:m.endOffset});p=new ops.OpRemoveHyperlink;p.init({memberid:e,position:l.position,length:l.length});k.push(p)}),c||(c=d[0],-1===b.comparePoint(c,0)&&(m.setStart(c,0),m.setEnd(b.startContainer,b.startOffset),l=n.convertDomToCursorRange({anchorNode:m.startContainer,
anchorOffset:m.startOffset,focusNode:m.endContainer,focusOffset:m.endOffset}),0<l.length&&(p=new ops.OpApplyHyperlink,p.init({memberid:e,position:l.position,length:l.length,hyperlink:q.getHyperlinkTarget(c)}),k.push(p))),d=d[d.length-1],a.moveToEndOfNode(d),a=a.unfilteredDomOffset(),1===b.comparePoint(d,a)&&(m.setStart(b.endContainer,b.endOffset),m.setEnd(d,a),l=n.convertDomToCursorRange({anchorNode:m.startContainer,anchorOffset:m.startOffset,focusNode:m.endContainer,focusOffset:m.endOffset}),0<l.length&&
(p=new ops.OpApplyHyperlink,p.init({memberid:e,position:l.position,length:l.length,hyperlink:q.getHyperlinkTarget(d)}),k.push(p)))),f.enqueue(k),m.detach())}};this.destroy=function(a){n.unsubscribe(ops.Document.signalCursorMoved,k);l.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,c);a()};n.subscribe(ops.Document.signalCursorMoved,k);l.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,c);c()};gui.HyperlinkController.enabledChanged="enabled/changed";gui.ImageController=function(f,l,a,e,c){function k(){var b=!0;!0===l.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)&&(b=a.isLocalCursorWithinOwnAnnotation());b!==r&&(r=b,d.emit(gui.ImageController.enabledChanged,r))}function q(b){b.getMemberId()===e&&k()}var n={"image/gif":".gif","image/jpeg":".jpg","image/png":".png"},p=odf.Namespaces.textns,g=f.getOdtDocument(),h=odf.OdfUtils,b=g.getFormatting(),d=new core.EventNotifier([gui.HyperlinkController.enabledChanged]),r=!1;this.isEnabled=function(){return r};
this.subscribe=function(b,a){d.subscribe(b,a)};this.unsubscribe=function(b,a){d.unsubscribe(b,a)};this.insertImage=function(a,d,k,l){if(r){runtime.assert(0<k&&0<l,"Both width and height of the image should be greater than 0px.");l={width:k,height:l};if(k=h.getParagraphElement(g.getCursor(e).getNode()).getAttributeNS(p,"style-name")){k=b.getContentSize(k,"paragraph");var q=1,s=1;l.width>k.width&&(q=k.width/l.width);l.height>k.height&&(s=k.height/l.height);k=Math.min(q,s);l={width:l.width*k,height:l.height*
k}}k=l.width/37.8+"cm";l=l.height/37.8+"cm";var w=g.getOdfCanvas().odfContainer().rootElement.styles,q=a.toLowerCase(),s=n.hasOwnProperty(q)?n[q]:null,u,q=[];runtime.assert(null!==s,"Image type is not supported: "+a);s="Pictures/"+c.generateImageName()+s;u=new ops.OpSetBlob;u.init({memberid:e,filename:s,mimetype:a,content:d});q.push(u);b.getStyleElement("Graphics","graphic",[w])||(a=new ops.OpAddStyle,a.init({memberid:e,styleName:"Graphics",styleFamily:"graphic",isAutomaticStyle:!1,setProperties:{"style:graphic-properties":{"text:anchor-type":"paragraph",
"svg:x":"0cm","svg:y":"0cm","style:wrap":"dynamic","style:number-wrapped-paragraphs":"no-limit","style:wrap-contour":"false","style:vertical-pos":"top","style:vertical-rel":"paragraph","style:horizontal-pos":"center","style:horizontal-rel":"paragraph"}}}),q.push(a));a=c.generateStyleName();d=new ops.OpAddStyle;d.init({memberid:e,styleName:a,styleFamily:"graphic",isAutomaticStyle:!0,setProperties:{"style:parent-style-name":"Graphics","style:graphic-properties":{"style:vertical-pos":"top","style:vertical-rel":"baseline",
"style:horizontal-pos":"center","style:horizontal-rel":"paragraph","fo:background-color":"transparent","style:background-transparency":"100%","style:shadow":"none","style:mirror":"none","fo:clip":"rect(0cm, 0cm, 0cm, 0cm)","draw:luminance":"0%","draw:contrast":"0%","draw:red":"0%","draw:green":"0%","draw:blue":"0%","draw:gamma":"100%","draw:color-inversion":"false","draw:image-opacity":"100%","draw:color-mode":"standard"}}});q.push(d);u=new ops.OpInsertImage;u.init({memberid:e,position:g.getCursorPosition(e),
filename:s,frameWidth:k,frameHeight:l,frameStyleName:a,frameName:c.generateFrameName()});q.push(u);f.enqueue(q)}};this.destroy=function(b){g.unsubscribe(ops.Document.signalCursorMoved,q);l.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,k);b()};g.subscribe(ops.Document.signalCursorMoved,q);l.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,k);k()};gui.ImageController.enabledChanged="enabled/changed";gui.ImageSelector=function(f){function l(){var a=f.getSizer(),k=c.createElement("div");k.id="imageSelector";k.style.borderWidth="1px";a.appendChild(k);e.forEach(function(a){var e=c.createElement("div");e.className=a;k.appendChild(e)});return k}var a=odf.Namespaces.svgns,e="topLeft topRight bottomRight bottomLeft topMiddle rightMiddle bottomMiddle leftMiddle".split(" "),c=f.getElement().ownerDocument,k=!1;this.select=function(e){var n,p,g=c.getElementById("imageSelector");g||(g=l());k=!0;n=g.parentNode;
p=e.getBoundingClientRect();var h=n.getBoundingClientRect(),b=f.getZoomLevel();n=(p.left-h.left)/b-1;p=(p.top-h.top)/b-1;g.style.display="block";g.style.left=n+"px";g.style.top=p+"px";g.style.width=e.getAttributeNS(a,"width");g.style.height=e.getAttributeNS(a,"height")};this.clearSelection=function(){var a;k&&(a=c.getElementById("imageSelector"))&&(a.style.display="none");k=!1};this.isSelectorElement=function(a){var e=c.getElementById("imageSelector");return e?a===e||a.parentNode===e:!1}};(function(){function f(f){function a(a){q=a.which&&String.fromCharCode(a.which)===k;k=void 0;return!1===q}function e(){q=!1}function c(a){k=a.data;q=!1}var k,q=!1;this.destroy=function(k){f.unsubscribe("textInput",e);f.unsubscribe("compositionend",c);f.removeFilter("keypress",a);k()};f.subscribe("textInput",e);f.subscribe("compositionend",c);f.addFilter("keypress",a)}gui.InputMethodEditor=function(l,a){function e(a){d&&(a?d.getNode().setAttributeNS(b,"composing","true"):(d.getNode().removeAttributeNS(b,
"composing"),x.textContent=""))}function c(){y&&(y=!1,e(!1),s.emit(gui.InputMethodEditor.signalCompositionEnd,{data:v}),v="")}function k(){B||(B=!0,c(),d&&d.getSelectedRange().collapsed?r.value="":r.value=u.writeToString(d.getSelectedRange().cloneContents()),r.setSelectionRange(0,r.value.length),B=!1)}function q(){a.hasFocus()&&t.trigger()}function n(){w=void 0;t.cancel();e(!0);y||s.emit(gui.InputMethodEditor.signalCompositionStart,{data:""})}function p(b){b=w=b.data;y=!0;v+=b;t.trigger()}function g(b){b.data!==
w&&(b=b.data,y=!0,v+=b,t.trigger());w=void 0}function h(){x.textContent=r.value}var b="urn:webodf:names:cursor",d=null,r=a.getEventTrap(),m=r.ownerDocument,x,t,y=!1,v="",s=new core.EventNotifier([gui.InputMethodEditor.signalCompositionStart,gui.InputMethodEditor.signalCompositionEnd]),w,u,A=[],F,B=!1;this.subscribe=s.subscribe;this.unsubscribe=s.unsubscribe;this.registerCursor=function(b){b.getMemberId()===l&&(d=b,d.getNode().appendChild(x),b.subscribe(ops.OdtCursor.signalCursorUpdated,q),a.subscribe("input",
h),a.subscribe("compositionupdate",h))};this.removeCursor=function(b){d&&b===l&&(d.getNode().removeChild(x),d.unsubscribe(ops.OdtCursor.signalCursorUpdated,q),a.unsubscribe("input",h),a.unsubscribe("compositionupdate",h),d=null)};this.destroy=function(b){a.unsubscribe("compositionstart",n);a.unsubscribe("compositionend",p);a.unsubscribe("textInput",g);a.unsubscribe("keypress",c);a.unsubscribe("focus",k);core.Async.destroyAll(F,b)};(function(){u=new odf.TextSerializer;u.filter=new odf.OdfNodeFilter;
a.subscribe("compositionstart",n);a.subscribe("compositionend",p);a.subscribe("textInput",g);a.subscribe("keypress",c);a.subscribe("focus",k);A.push(new f(a));F=A.map(function(b){return b.destroy});x=m.createElement("span");x.setAttribute("id","composer");t=core.Task.createTimeoutTask(k,1);F.push(t.destroy)})()};gui.InputMethodEditor.signalCompositionStart="input/compositionstart";gui.InputMethodEditor.signalCompositionEnd="input/compositionend"})();gui.MetadataController=function(f,l){function a(a){k.emit(gui.MetadataController.signalMetadataChanged,a)}function e(a){var c=-1===q.indexOf(a);c||runtime.log("Setting "+a+" is restricted.");return c}var c=f.getOdtDocument(),k=new core.EventNotifier([gui.MetadataController.signalMetadataChanged]),q=["dc:creator","dc:date","meta:editing-cycles","meta:editing-duration","meta:document-statistic"];this.setMetadata=function(a,c){var g={},h="",b;a&&Object.keys(a).filter(e).forEach(function(b){g[b]=a[b]});
c&&(h=c.filter(e).join(","));if(0<h.length||0<Object.keys(g).length)b=new ops.OpUpdateMetadata,b.init({memberid:l,setProperties:g,removedProperties:0<h.length?{attributes:h}:null}),f.enqueue([b])};this.getMetadata=function(a){var e;runtime.assert("string"===typeof a,"Property must be a string");e=a.split(":");runtime.assert(2===e.length,"Property must be a namespace-prefixed string");a=odf.Namespaces.lookupNamespaceURI(e[0]);runtime.assert(Boolean(a),"Prefix must be for an ODF namespace.");return c.getOdfCanvas().odfContainer().getMetadata(a,
e[1])};this.subscribe=function(a,c){k.subscribe(a,c)};this.unsubscribe=function(a,c){k.unsubscribe(a,c)};this.destroy=function(e){c.unsubscribe(ops.OdtDocument.signalMetadataUpdated,a);e()};c.subscribe(ops.OdtDocument.signalMetadataUpdated,a)};gui.MetadataController.signalMetadataChanged="metadata/changed";gui.PasteController=function(f,l,a,e){function c(){n=!0===l.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)?a.isLocalCursorWithinOwnAnnotation():!0}function k(b){b.getMemberId()===e&&c()}var q=f.getOdtDocument(),n=!1,p=odf.Namespaces.textns,g=core.StepDirection.NEXT,h=odf.OdfUtils;this.isEnabled=function(){return n};this.paste=function(b){if(n){var a=q.getCursorPosition(e),c=q.getCursor(e).getNode(),c=h.getParagraphElement(c),k=c.getAttributeNS(p,"style-name")||"",l=a,t=[],y=q.convertDomPointToCursorStep(c,
0,g);b.replace(/\r/g,"").split("\n").forEach(function(b){var a=new ops.OpInsertText,d=new ops.OpSplitParagraph;a.init({memberid:e,position:l,text:b,moveCursor:!0});t.push(a);l+=b.length;d.init({memberid:e,position:l,paragraphStyleName:k,sourceParagraphPosition:y,moveCursor:!0});t.push(d);y=l+=1});t.pop();f.enqueue(t)}};this.destroy=function(b){q.unsubscribe(ops.Document.signalCursorMoved,k);l.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,c);b()};q.subscribe(ops.Document.signalCursorMoved,k);
l.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,c);c()};gui.ClosestXOffsetScanner=function(f){function l(a){return null!==a&&void 0!==c?Math.abs(a-f)>c:!1}function a(a){null!==a&&!1===l(a)&&(c=Math.abs(a-f))}var e=this,c,k=gui.StepInfo.VisualDirection.LEFT_TO_RIGHT;this.token=void 0;this.process=function(c,f,p){var g,h;c.visualDirection===k?(g=f&&f.right,h=p&&p.left):(g=f&&f.left,h=p&&p.right);if(l(g)||l(h))return!0;if(f||p)a(g),a(h),e.token=c.token;return!1}};gui.LineBoundaryScanner=function(){var f=this,l=null;this.token=void 0;this.process=function(a,e,c){var k;if(k=c)if(l){var q=l;k=Math.min(q.bottom-q.top,c.bottom-c.top);var n=Math.max(q.top,c.top),q=Math.min(q.bottom,c.bottom)-n;k=0.4>=(0<k?q/k:0)}else k=!1;!e||c&&!k||(f.token=a.token);if(k)return!0;l=(a=l)&&e?{left:Math.min(a.left,e.left),right:Math.max(a.right,e.right),top:Math.min(a.top,e.top),bottom:Math.min(a.bottom,e.bottom)}:a||e;return!1}};gui.ParagraphBoundaryScanner=function(){var f=this,l=!1,a,e=odf.OdfUtils;this.token=void 0;this.process=function(c){var k=e.getParagraphElement(c.container());l||(a=k,l=!0);if(a!==k)return!0;f.token=c.token;return!1}};odf.WordBoundaryFilter=function(f,l){function a(b,a,d){for(var c=null,e=f.getRootNode(),h;b!==e&&null!==b&&null===c;)h=0>a?b.previousSibling:b.nextSibling,d(h)===NodeFilter.FILTER_ACCEPT&&(c=h),b=b.parentNode;return c}function e(b,a){var d;return null===b?r.NO_NEIGHBOUR:q.isCharacterElement(b)?r.SPACE_CHAR:b.nodeType===c||q.isTextSpan(b)||q.isHyperlink(b)?(d=b.textContent.charAt(a()),p.test(d)?r.SPACE_CHAR:n.test(d)?r.PUNCTUATION_CHAR:r.WORD_CHAR):r.OTHER}var c=Node.TEXT_NODE,k=Node.ELEMENT_NODE,
q=odf.OdfUtils,n=/[!-#%-*,-\/:-;?-@\[-\]_{}\u00a1\u00ab\u00b7\u00bb\u00bf;\u00b7\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0700-\u070d\u07f7-\u07f9\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u169b-\u169c\u16eb-\u16ed\u1735-\u1736\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u1944-\u1945\u19de-\u19df\u1a1e-\u1a1f\u1b5a-\u1b60\u1c3b-\u1c3f\u1c7e-\u1c7f\u2000-\u206e\u207d-\u207e\u208d-\u208e\u3008-\u3009\u2768-\u2775\u27c5-\u27c6\u27e6-\u27ef\u2983-\u2998\u29d8-\u29db\u29fc-\u29fd\u2cf9-\u2cfc\u2cfe-\u2cff\u2e00-\u2e7e\u3000-\u303f\u30a0\u30fb\ua60d-\ua60f\ua673\ua67e\ua874-\ua877\ua8ce-\ua8cf\ua92e-\ua92f\ua95f\uaa5c-\uaa5f\ufd3e-\ufd3f\ufe10-\ufe19\ufe30-\ufe52\ufe54-\ufe61\ufe63\ufe68\ufe6a-\ufe6b\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|\ud800[\udd00-\udd01\udf9f\udfd0]|\ud802[\udd1f\udd3f\ude50-\ude58]|\ud809[\udc00-\udc7e]/,
p=/\s/,g=core.PositionFilter.FilterResult.FILTER_ACCEPT,h=core.PositionFilter.FilterResult.FILTER_REJECT,b=odf.WordBoundaryFilter.IncludeWhitespace.TRAILING,d=odf.WordBoundaryFilter.IncludeWhitespace.LEADING,r={NO_NEIGHBOUR:0,SPACE_CHAR:1,PUNCTUATION_CHAR:2,WORD_CHAR:3,OTHER:4};this.acceptPosition=function(c){var f=c.container(),n=c.leftNode(),p=c.rightNode(),q=c.unfilteredDomOffset,s=function(){return c.unfilteredDomOffset()-1};f.nodeType===k&&(null===p&&(p=a(f,1,c.getNodeFilter())),null===n&&(n=
a(f,-1,c.getNodeFilter())));f!==p&&(q=function(){return 0});f!==n&&null!==n&&(s=function(){return n.textContent.length-1});f=e(n,s);p=e(p,q);return f===r.WORD_CHAR&&p===r.WORD_CHAR||f===r.PUNCTUATION_CHAR&&p===r.PUNCTUATION_CHAR||l===b&&f!==r.NO_NEIGHBOUR&&p===r.SPACE_CHAR||l===d&&f===r.SPACE_CHAR&&p!==r.NO_NEIGHBOUR?h:g}};odf.WordBoundaryFilter.IncludeWhitespace={None:0,TRAILING:1,LEADING:2};gui.SelectionController=function(f,l){function a(b){var a=b.spec();if(b.isEdit||a.memberid===l)F=void 0,B.cancel()}function e(){var b=t.getCursor(l).getNode();return t.createStepIterator(b,0,[s,u],t.getRootElement(b))}function c(b,a,d){d=new odf.WordBoundaryFilter(t,d);var c=t.getRootElement(b)||t.getRootNode(),e=t.createRootFilter(c);return t.createStepIterator(b,a,[s,e,d],c)}function k(b,a){return a?{anchorNode:b.startContainer,anchorOffset:b.startOffset,focusNode:b.endContainer,focusOffset:b.endOffset}:
{anchorNode:b.endContainer,anchorOffset:b.endOffset,focusNode:b.startContainer,focusOffset:b.startOffset}}function q(b,a,d){var c=new ops.OpMoveCursor;c.init({memberid:l,position:b,length:a||0,selectionType:d});return c}function n(b,a,d){var c;c=t.getCursor(l);c=k(c.getSelectedRange(),c.hasForwardSelection());c.focusNode=b;c.focusOffset=a;d||(c.anchorNode=c.focusNode,c.anchorOffset=c.focusOffset);b=t.convertDomToCursorRange(c);f.enqueue([q(b.position,b.length)])}function p(b){var a;a=c(b.startContainer,
b.startOffset,E);a.roundToPreviousStep()&&b.setStart(a.container(),a.offset());a=c(b.endContainer,b.endOffset,J);a.roundToNextStep()&&b.setEnd(a.container(),a.offset())}function g(b){var a=v.getParagraphElements(b),d=a[0],a=a[a.length-1];d&&b.setStart(d,0);a&&(v.isParagraph(b.endContainer)&&0===b.endOffset?b.setEndBefore(a):b.setEnd(a,a.childNodes.length))}function h(b,a,d,c){var e,f;c?(e=d.startContainer,f=d.startOffset):(e=d.endContainer,f=d.endOffset);y.containsNode(b,e)||(f=0>y.comparePoints(b,
0,e,f)?0:b.childNodes.length,e=b);b=t.createStepIterator(e,f,a,v.getParagraphElement(e)||b);b.roundToClosestStep()||runtime.assert(!1,"No step found in requested range");c?d.setStart(b.container(),b.offset()):d.setEnd(b.container(),b.offset())}function b(b,a){var d=e();d.advanceStep(b)&&n(d.container(),d.offset(),a)}function d(b,a){var d,c=F,f=[new gui.LineBoundaryScanner,new gui.ParagraphBoundaryScanner];void 0===c&&A&&(c=A());isNaN(c)||(d=e(),w.moveToFilteredStep(d,b,f)&&d.advanceStep(b)&&(f=[new gui.ClosestXOffsetScanner(c),
new gui.LineBoundaryScanner,new gui.ParagraphBoundaryScanner],w.moveToFilteredStep(d,b,f)&&(n(d.container(),d.offset(),a),F=c,B.restart())))}function r(b,a){var d=e(),c=[new gui.LineBoundaryScanner,new gui.ParagraphBoundaryScanner];w.moveToFilteredStep(d,b,c)&&n(d.container(),d.offset(),a)}function m(b,a){var d=t.getCursor(l),d=k(d.getSelectedRange(),d.hasForwardSelection()),d=c(d.focusNode,d.focusOffset,E);d.advanceStep(b)&&n(d.container(),d.offset(),a)}function x(b,a,d){var c=!1,e=t.getCursor(l),
e=k(e.getSelectedRange(),e.hasForwardSelection()),c=t.getRootElement(e.focusNode);runtime.assert(Boolean(c),"SelectionController: Cursor outside root");e=t.createStepIterator(e.focusNode,e.focusOffset,[s,u],c);e.roundToClosestStep();e.advanceStep(b)&&(d=d(e.container()))&&(b===H?(e.setPosition(d,0),c=e.roundToNextStep()):(e.setPosition(d,d.childNodes.length),c=e.roundToPreviousStep()),c&&n(e.container(),e.offset(),a))}var t=f.getOdtDocument(),y=core.DomUtils,v=odf.OdfUtils,s=t.getPositionFilter(),
w=new gui.GuiStepUtils,u=t.createRootFilter(l),A=null,F,B,E=odf.WordBoundaryFilter.IncludeWhitespace.TRAILING,J=odf.WordBoundaryFilter.IncludeWhitespace.LEADING,H=core.StepDirection.PREVIOUS,Q=core.StepDirection.NEXT;this.selectionToRange=function(b){var a=0<=y.comparePoints(b.anchorNode,b.anchorOffset,b.focusNode,b.focusOffset),d=b.focusNode.ownerDocument.createRange();a?(d.setStart(b.anchorNode,b.anchorOffset),d.setEnd(b.focusNode,b.focusOffset)):(d.setStart(b.focusNode,b.focusOffset),d.setEnd(b.anchorNode,
b.anchorOffset));return{range:d,hasForwardSelection:a}};this.rangeToSelection=k;this.selectImage=function(b){var a=t.getRootElement(b),d=t.createRootFilter(a),a=t.createStepIterator(b,0,[d,t.getPositionFilter()],a),c;a.roundToPreviousStep()||runtime.assert(!1,"No walkable position before frame");d=a.container();c=a.offset();a.setPosition(b,b.childNodes.length);a.roundToNextStep()||runtime.assert(!1,"No walkable position after frame");b=t.convertDomToCursorRange({anchorNode:d,anchorOffset:c,focusNode:a.container(),
focusOffset:a.offset()});b=q(b.position,b.length,ops.OdtCursor.RegionSelection);f.enqueue([b])};this.expandToWordBoundaries=p;this.expandToParagraphBoundaries=g;this.selectRange=function(b,a,d){var c=t.getOdfCanvas().getElement(),e,m=[s];e=y.containsNode(c,b.startContainer);c=y.containsNode(c,b.endContainer);if(e||c)if(e&&c&&(2===d?p(b):3<=d&&g(b)),(d=a?t.getRootElement(b.startContainer):t.getRootElement(b.endContainer))||(d=t.getRootNode()),m.push(t.createRootFilter(d)),h(d,m,b,!0),h(d,m,b,!1),b=
k(b,a),a=t.convertDomToCursorRange(b),b=t.getCursorSelection(l),a.position!==b.position||a.length!==b.length)b=q(a.position,a.length,ops.OdtCursor.RangeSelection),f.enqueue([b])};this.moveCursorToLeft=function(){b(H,!1);return!0};this.moveCursorToRight=function(){b(Q,!1);return!0};this.extendSelectionToLeft=function(){b(H,!0);return!0};this.extendSelectionToRight=function(){b(Q,!0);return!0};this.setCaretXPositionLocator=function(b){A=b};this.moveCursorUp=function(){d(H,!1);return!0};this.moveCursorDown=
function(){d(Q,!1);return!0};this.extendSelectionUp=function(){d(H,!0);return!0};this.extendSelectionDown=function(){d(Q,!0);return!0};this.moveCursorBeforeWord=function(){m(H,!1);return!0};this.moveCursorPastWord=function(){m(Q,!1);return!0};this.extendSelectionBeforeWord=function(){m(H,!0);return!0};this.extendSelectionPastWord=function(){m(Q,!0);return!0};this.moveCursorToLineStart=function(){r(H,!1);return!0};this.moveCursorToLineEnd=function(){r(Q,!1);return!0};this.extendSelectionToLineStart=
function(){r(H,!0);return!0};this.extendSelectionToLineEnd=function(){r(Q,!0);return!0};this.extendSelectionToParagraphStart=function(){x(H,!0,v.getParagraphElement);return!0};this.extendSelectionToParagraphEnd=function(){x(Q,!0,v.getParagraphElement);return!0};this.moveCursorToParagraphStart=function(){x(H,!1,v.getParagraphElement);return!0};this.moveCursorToParagraphEnd=function(){x(Q,!1,v.getParagraphElement);return!0};this.moveCursorToDocumentStart=function(){x(H,!1,t.getRootElement);return!0};
this.moveCursorToDocumentEnd=function(){x(Q,!1,t.getRootElement);return!0};this.extendSelectionToDocumentStart=function(){x(H,!0,t.getRootElement);return!0};this.extendSelectionToDocumentEnd=function(){x(Q,!0,t.getRootElement);return!0};this.extendSelectionToEntireDocument=function(){var b=t.getCursor(l),b=t.getRootElement(b.getNode()),a,d,c;runtime.assert(Boolean(b),"SelectionController: Cursor outside root");c=t.createStepIterator(b,0,[s,u],b);c.roundToClosestStep();a=c.container();d=c.offset();
c.setPosition(b,b.childNodes.length);c.roundToClosestStep();b=t.convertDomToCursorRange({anchorNode:a,anchorOffset:d,focusNode:c.container(),focusOffset:c.offset()});f.enqueue([q(b.position,b.length)]);return!0};this.destroy=function(b){t.unsubscribe(ops.OdtDocument.signalOperationStart,a);core.Async.destroyAll([B.destroy],b)};(function(){B=core.Task.createTimeoutTask(function(){F=void 0},2E3);t.subscribe(ops.OdtDocument.signalOperationStart,a)})()};gui.TextController=function(f,l,a,e,c,k){function q(){x=!0===l.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)?a.isLocalCursorWithinOwnAnnotation():!0}function n(b){b.getMemberId()===e&&q()}function p(b,a,c){var e=[d.getPositionFilter()];c&&e.push(d.createRootFilter(b.startContainer));c=d.createStepIterator(b.startContainer,b.startOffset,e,a);c.roundToClosestStep()||runtime.assert(!1,"No walkable step found in paragraph element at range start");a=d.convertDomPointToCursorStep(c.container(),c.offset());
b.collapsed?b=a:(c.setPosition(b.endContainer,b.endOffset),c.roundToClosestStep()||runtime.assert(!1,"No walkable step found in paragraph element at range end"),b=d.convertDomPointToCursorStep(c.container(),c.offset()));return{position:a,length:b-a}}function g(b){var a,d,c,f=r.getParagraphElements(b),h=b.cloneRange(),g=[];a=f[0];1<f.length&&(r.hasNoODFContent(a)&&(a=f[f.length-1]),d=a.getAttributeNS(odf.Namespaces.textns,"style-name")||"");f.forEach(function(a,f){var k,l;h.setStart(a,0);h.collapse(!0);
k=p(h,a,!1).position;0<f&&(l=new ops.OpMergeParagraph,l.init({memberid:e,paragraphStyleName:d,destinationStartPosition:c,sourceStartPosition:k,moveCursor:1===f}),g.unshift(l));c=k;h.selectNodeContents(a);if(k=m.rangeIntersection(h,b))k=p(k,a,!0),0<k.length&&(l=new ops.OpRemoveText,l.init({memberid:e,position:k.position,length:k.length}),g.unshift(l))});return g}function h(b){0>b.length&&(b.position+=b.length,b.length=-b.length);return b}function b(b){if(!x)return!1;var a,c=d.getCursor(e).getSelectedRange().cloneRange(),
k=h(d.getCursorSelection(e)),m;if(0===k.length){k=void 0;a=d.getCursor(e).getNode();m=d.getRootElement(a);var l=[d.getPositionFilter(),d.createRootFilter(m)];m=d.createStepIterator(a,0,l,m);m.roundToClosestStep()&&(b?m.nextStep():m.previousStep())&&(k=h(d.convertDomToCursorRange({anchorNode:a,anchorOffset:0,focusNode:m.container(),focusOffset:m.offset()})),b?(c.setStart(a,0),c.setEnd(m.container(),m.offset())):(c.setStart(m.container(),m.offset()),c.setEnd(a,0)))}k&&f.enqueue(g(c));return void 0!==
k}var d=f.getOdtDocument(),r=odf.OdfUtils,m=core.DomUtils,x=!1,t=odf.Namespaces.textns,y=core.StepDirection.NEXT;this.isEnabled=function(){return x};this.enqueueParagraphSplittingOps=function(){if(!x)return!1;var b=d.getCursor(e),a=b.getSelectedRange(),c=h(d.getCursorSelection(e)),m=[],b=r.getParagraphElement(b.getNode()),l=b.getAttributeNS(t,"style-name")||"";0<c.length&&(m=m.concat(g(a)));a=new ops.OpSplitParagraph;a.init({memberid:e,position:c.position,paragraphStyleName:l,sourceParagraphPosition:d.convertDomPointToCursorStep(b,
0,y),moveCursor:!0});m.push(a);k&&(c=k(c.position+1),m=m.concat(c));f.enqueue(m);return!0};this.removeTextByBackspaceKey=function(){return b(!1)};this.removeTextByDeleteKey=function(){return b(!0)};this.removeCurrentSelection=function(){if(!x)return!1;var b=d.getCursor(e).getSelectedRange();f.enqueue(g(b));return!0};this.insertText=function(b){if(x){var a=d.getCursor(e).getSelectedRange(),k=h(d.getCursorSelection(e)),m=[],l=!1;0<k.length&&(m=m.concat(g(a)),l=!0);a=new ops.OpInsertText;a.init({memberid:e,
position:k.position,text:b,moveCursor:!0});m.push(a);c&&(b=c(k.position,b.length,l))&&m.push(b);f.enqueue(m)}};this.destroy=function(b){d.unsubscribe(ops.Document.signalCursorMoved,n);l.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,q);b()};d.subscribe(ops.Document.signalCursorMoved,n);l.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,q);q()};gui.UndoManager=function(){};gui.UndoManager.prototype.subscribe=function(f,l){};gui.UndoManager.prototype.unsubscribe=function(f,l){};gui.UndoManager.prototype.setDocument=function(f){};gui.UndoManager.prototype.setInitialState=function(){};gui.UndoManager.prototype.initialize=function(){};gui.UndoManager.prototype.purgeInitialState=function(){};gui.UndoManager.prototype.setPlaybackFunction=function(f){};gui.UndoManager.prototype.hasUndoStates=function(){};
gui.UndoManager.prototype.hasRedoStates=function(){};gui.UndoManager.prototype.moveForward=function(f){};gui.UndoManager.prototype.moveBackward=function(f){};gui.UndoManager.prototype.onOperationExecuted=function(f){};gui.UndoManager.prototype.isDocumentModified=function(){};gui.UndoManager.prototype.setDocumentModified=function(f){};gui.UndoManager.signalUndoStackChanged="undoStackChanged";gui.UndoManager.signalUndoStateCreated="undoStateCreated";gui.UndoManager.signalUndoStateModified="undoStateModified";
gui.UndoManager.signalDocumentModifiedChanged="documentModifiedChanged";gui.SessionControllerOptions=function(){this.annotationsEnabled=this.directParagraphStylingEnabled=this.directTextStylingEnabled=!1};
(function(){var f=core.PositionFilter.FilterResult.FILTER_ACCEPT;gui.SessionController=function(l,a,e,c){function k(b){return b.target||b.srcElement||null}function q(b,a){var d=I.getDOMDocument(),c=null;d.caretRangeFromPoint?(d=d.caretRangeFromPoint(b,a),c={container:d.startContainer,offset:d.startOffset}):d.caretPositionFromPoint&&(d=d.caretPositionFromPoint(b,a))&&d.offsetNode&&(c={container:d.offsetNode,offset:d.offset});return c}function n(b){var d=I.getCursor(a).getSelectedRange();d.collapsed?
b.preventDefault():$.setDataFromRange(b,d)?ha.removeCurrentSelection():runtime.log("Cut operation failed")}function p(){return!1!==I.getCursor(a).getSelectedRange().collapsed}function g(b){var d=I.getCursor(a).getSelectedRange();d.collapsed?b.preventDefault():$.setDataFromRange(b,d)||runtime.log("Copy operation failed")}function h(b){var a;R.clipboardData&&R.clipboardData.getData?a=R.clipboardData.getData("Text"):b.clipboardData&&b.clipboardData.getData&&(a=b.clipboardData.getData("text/plain"));
a&&(ha.removeCurrentSelection(),pa.paste(a));b.preventDefault?b.preventDefault():b.returnValue=!1}function b(){return!1}function d(b){if(S)S.onOperationExecuted(b)}function r(b){I.emit(ops.OdtDocument.signalUndoStackChanged,b)}function m(){var b;return S?(b=K.hasFocus(),S.moveBackward(1),b&&K.focus(),!0):!1}function x(){var b;return S?(b=K.hasFocus(),S.moveForward(1),b&&K.focus(),!0):!1}function t(b){var d=I.getCursor(a).getSelectedRange(),c=k(b).getAttribute("end");d&&c&&(b=q(b.clientX,b.clientY))&&
(ia.setUnfilteredPosition(b.container,b.offset),P.acceptPosition(ia)===f&&(d=d.cloneRange(),"left"===c?d.setStart(ia.container(),ia.unfilteredDomOffset()):d.setEnd(ia.container(),ia.unfilteredDomOffset()),e.setSelectedRange(d,"right"===c),I.emit(ops.Document.signalCursorMoved,e)))}function y(){X.selectRange(e.getSelectedRange(),e.hasForwardSelection(),1)}function v(){var b=R.getSelection(),a=0<b.rangeCount&&X.selectionToRange(b);ca&&a&&(W=!0,la.clearSelection(),ia.setUnfilteredPosition(b.focusNode,
b.focusOffset),P.acceptPosition(ia)===f&&(2===na?X.expandToWordBoundaries(a.range):3<=na&&X.expandToParagraphBoundaries(a.range),e.setSelectedRange(a.range,a.hasForwardSelection),I.emit(ops.Document.signalCursorMoved,e)))}function s(b){var d=k(b),c=I.getCursor(a);if(ca=null!==d&&T.containsNode(I.getOdfCanvas().getElement(),d))W=!1,d=I.getRootElement(d)||I.getRootNode(),P=I.createRootFilter(d),na=0===b.button?b.detail:0,c&&b.shiftKey?R.getSelection().collapse(c.getAnchorNode(),0):(b=R.getSelection(),
d=c.getSelectedRange(),b.extend?c.hasForwardSelection()?(b.collapse(d.startContainer,d.startOffset),b.extend(d.endContainer,d.endOffset)):(b.collapse(d.endContainer,d.endOffset),b.extend(d.startContainer,d.startOffset)):(b.removeAllRanges(),b.addRange(d.cloneRange()))),1<na&&v()}function w(b){var a=I.getRootElement(b),d=I.createRootFilter(a),a=I.createStepIterator(b,0,[d,I.getPositionFilter()],a);a.setPosition(b,b.childNodes.length);return a.roundToNextStep()?{container:a.container(),offset:a.offset()}:
null}function u(b){var a;a=(a=R.getSelection())?{anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}:null;var d=R.getSelection().isCollapsed,c,e;a.anchorNode||a.focusNode||!(c=q(b.clientX,b.clientY))||(a.anchorNode=c.container,a.anchorOffset=c.offset,a.focusNode=a.anchorNode,a.focusOffset=a.anchorOffset);if(D.isImage(a.focusNode)&&0===a.focusOffset&&D.isCharacterFrame(a.focusNode.parentNode)){if(e=a.focusNode.parentNode,c=e.getBoundingClientRect(),
b.clientX>c.left&&(c=w(e)))a.focusNode=c.container,a.focusOffset=c.offset,d&&(a.anchorNode=a.focusNode,a.anchorOffset=a.focusOffset)}else D.isImage(a.focusNode.firstChild)&&1===a.focusOffset&&D.isCharacterFrame(a.focusNode)&&(c=w(a.focusNode))&&(a.anchorNode=a.focusNode=c.container,a.anchorOffset=a.focusOffset=c.offset);a.anchorNode&&a.focusNode&&(a=X.selectionToRange(a),X.selectRange(a.range,a.hasForwardSelection,0===b.button?b.detail:0));K.focus()}function A(b){var a;if(a=q(b.clientX,b.clientY))b=
a.container,a=a.offset,b={anchorNode:b,anchorOffset:a,focusNode:b,focusOffset:a},b=X.selectionToRange(b),X.selectRange(b.range,b.hasForwardSelection,2),K.focus()}function F(b){var a=k(b),d,c,f;ja.processRequests();ca&&(D.isImage(a)&&D.isCharacterFrame(a.parentNode)&&R.getSelection().isCollapsed?(X.selectImage(a.parentNode),K.focus()):la.isSelectorElement(a)?K.focus():W?(a=e.getSelectedRange(),c=a.collapsed,D.isImage(a.endContainer)&&0===a.endOffset&&D.isCharacterFrame(a.endContainer.parentNode)&&
(f=a.endContainer.parentNode,f=w(f))&&(a.setEnd(f.container,f.offset),c&&a.collapse(!1)),X.selectRange(a,e.hasForwardSelection(),0===b.button?b.detail:0),K.focus()):ua?u(b):(d=T.cloneEvent(b),Y=runtime.setTimeout(function(){u(d)},0)),na=0,W=ca=!1)}function B(b){var d=I.getCursor(a).getSelectedRange();d.collapsed||O.exportRangeToDataTransfer(b.dataTransfer,d)}function E(){ca&&K.focus();na=0;W=ca=!1}function J(b){F(b)}function H(b){var a=k(b),d=null;"annotationRemoveButton"===a.className?(runtime.assert(ea,
"Remove buttons are displayed on annotations while annotation editing is disabled in the controller."),d=a.parentNode.getElementsByTagNameNS(odf.Namespaces.officens,"annotation").item(0),ga.removeAnnotation(d),K.focus()):"webodf-draggable"!==a.getAttribute("class")&&F(b)}function Q(b){(b=b.data)&&(-1===b.indexOf("\n")?ha.insertText(b):pa.paste(b))}function N(b){return function(){b();return!0}}function z(b){return function(d){return I.getCursor(a).getSelectionType()===ops.OdtCursor.RangeSelection?
b(d):!0}}function Z(b){K.unsubscribe("keydown",C.handleEvent);K.unsubscribe("keypress",V.handleEvent);K.unsubscribe("keyup",aa.handleEvent);K.unsubscribe("copy",g);K.unsubscribe("mousedown",s);K.unsubscribe("mousemove",ja.trigger);K.unsubscribe("mouseup",H);K.unsubscribe("contextmenu",J);K.unsubscribe("dragstart",B);K.unsubscribe("dragend",E);K.unsubscribe("click",oa.handleClick);K.unsubscribe("longpress",A);K.unsubscribe("drag",t);K.unsubscribe("dragstop",y);I.unsubscribe(ops.OdtDocument.signalOperationEnd,
fa.trigger);I.unsubscribe(ops.Document.signalCursorAdded,ka.registerCursor);I.unsubscribe(ops.Document.signalCursorRemoved,ka.removeCursor);I.unsubscribe(ops.OdtDocument.signalOperationEnd,d);b()}var R=runtime.getWindow(),I=l.getOdtDocument(),G=new gui.SessionConstraints,ba=new gui.SessionContext(l,a),T=core.DomUtils,D=odf.OdfUtils,O=new gui.MimeDataExporter,$=new gui.Clipboard(O),C=new gui.KeyboardHandler,V=new gui.KeyboardHandler,aa=new gui.KeyboardHandler,ca=!1,U=new odf.ObjectNameGenerator(I.getOdfCanvas().odfContainer(),
a),W=!1,P=null,Y,S=null,K=new gui.EventManager(I),ea=c.annotationsEnabled,ga=new gui.AnnotationController(l,G,a),da=new gui.DirectFormattingController(l,G,ba,a,U,c.directTextStylingEnabled,c.directParagraphStylingEnabled),ha=new gui.TextController(l,G,ba,a,da.createCursorStyleOp,da.createParagraphStyleOps),ma=new gui.ImageController(l,G,ba,a,U),la=new gui.ImageSelector(I.getOdfCanvas()),ia=I.createPositionIterator(I.getRootNode()),ja,fa,pa=new gui.PasteController(l,G,ba,a),ka=new gui.InputMethodEditor(a,
K),na=0,oa=new gui.HyperlinkClickHandler(I.getOdfCanvas().getElement,C,aa),qa=new gui.HyperlinkController(l,G,ba,a),va=new gui.BulletlistController(l,K,G,ba,a),X=new gui.SelectionController(l,a),ta=new gui.MetadataController(l,a),L=gui.KeyboardHandler.Modifier,M=gui.KeyboardHandler.KeyCode,ra=-1!==R.navigator.appVersion.toLowerCase().indexOf("mac"),ua=-1!==["iPad","iPod","iPhone"].indexOf(R.navigator.platform),sa;runtime.assert(null!==R,"Expected to be run in an environment which has a global window, like a browser.");
this.undo=m;this.redo=x;this.insertLocalCursor=function(){runtime.assert(void 0===l.getOdtDocument().getCursor(a),"Inserting local cursor a second time.");var b=new ops.OpAddCursor;b.init({memberid:a});l.enqueue([b]);K.focus()};this.removeLocalCursor=function(){runtime.assert(void 0!==l.getOdtDocument().getCursor(a),"Removing local cursor without inserting before.");var b=new ops.OpRemoveCursor;b.init({memberid:a});l.enqueue([b])};this.startEditing=function(){ka.subscribe(gui.InputMethodEditor.signalCompositionStart,
ha.removeCurrentSelection);ka.subscribe(gui.InputMethodEditor.signalCompositionEnd,Q);K.subscribe("beforecut",p);K.subscribe("cut",n);K.subscribe("beforepaste",b);K.subscribe("paste",h);S&&S.initialize();K.setEditing(!0);oa.setModifier(ra?L.Meta:L.Ctrl);C.bind(M.Backspace,L.None,N(ha.removeTextByBackspaceKey),!0);C.bind(M.Delete,L.None,ha.removeTextByDeleteKey);C.bind(M.Tab,L.None,z(function(){ha.insertText("\t");return!0}));ra?(C.bind(M.Clear,L.None,ha.removeCurrentSelection),C.bind(M.B,L.Meta,z(da.toggleBold)),
C.bind(M.I,L.Meta,z(da.toggleItalic)),C.bind(M.U,L.Meta,z(da.toggleUnderline)),C.bind(M.L,L.MetaShift,z(da.alignParagraphLeft)),C.bind(M.E,L.MetaShift,z(da.alignParagraphCenter)),C.bind(M.R,L.MetaShift,z(da.alignParagraphRight)),C.bind(M.J,L.MetaShift,z(da.alignParagraphJustified)),ea&&C.bind(M.C,L.MetaShift,ga.addAnnotation),C.bind(M.Z,L.Meta,m),C.bind(M.Z,L.MetaShift,x)):(C.bind(M.B,L.Ctrl,z(da.toggleBold)),C.bind(M.I,L.Ctrl,z(da.toggleItalic)),C.bind(M.U,L.Ctrl,z(da.toggleUnderline)),C.bind(M.L,
L.CtrlShift,z(da.alignParagraphLeft)),C.bind(M.E,L.CtrlShift,z(da.alignParagraphCenter)),C.bind(M.R,L.CtrlShift,z(da.alignParagraphRight)),C.bind(M.J,L.CtrlShift,z(da.alignParagraphJustified)),ea&&C.bind(M.C,L.CtrlAlt,ga.addAnnotation),C.bind(M.Z,L.Ctrl,m),C.bind(M.Z,L.CtrlShift,x));V.setDefault(z(function(b){var a;a=null===b.which||void 0===b.which?String.fromCharCode(b.keyCode):0!==b.which&&0!==b.charCode?String.fromCharCode(b.which):null;return!a||b.altKey||b.ctrlKey||b.metaKey?!1:(ha.insertText(a),
!0)}));V.bind(M.Enter,L.None,z(ha.enqueueParagraphSplittingOps))};this.endEditing=function(){ka.unsubscribe(gui.InputMethodEditor.signalCompositionStart,ha.removeCurrentSelection);ka.unsubscribe(gui.InputMethodEditor.signalCompositionEnd,Q);K.unsubscribe("cut",n);K.unsubscribe("beforecut",p);K.unsubscribe("paste",h);K.unsubscribe("beforepaste",b);K.setEditing(!1);oa.setModifier(L.None);C.bind(M.Backspace,L.None,function(){return!0},!0);C.unbind(M.Delete,L.None);C.unbind(M.Tab,L.None);ra?(C.unbind(M.Clear,
L.None),C.unbind(M.B,L.Meta),C.unbind(M.I,L.Meta),C.unbind(M.U,L.Meta),C.unbind(M.L,L.MetaShift),C.unbind(M.E,L.MetaShift),C.unbind(M.R,L.MetaShift),C.unbind(M.J,L.MetaShift),ea&&C.unbind(M.C,L.MetaShift),C.unbind(M.Z,L.Meta),C.unbind(M.Z,L.MetaShift)):(C.unbind(M.B,L.Ctrl),C.unbind(M.I,L.Ctrl),C.unbind(M.U,L.Ctrl),C.unbind(M.L,L.CtrlShift),C.unbind(M.E,L.CtrlShift),C.unbind(M.R,L.CtrlShift),C.unbind(M.J,L.CtrlShift),ea&&C.unbind(M.C,L.CtrlAlt),C.unbind(M.Z,L.Ctrl),C.unbind(M.Z,L.CtrlShift));V.setDefault(null);
V.unbind(M.Enter,L.None)};this.getInputMemberId=function(){return a};this.getSession=function(){return l};this.getSessionConstraints=function(){return G};this.setUndoManager=function(b){S&&S.unsubscribe(gui.UndoManager.signalUndoStackChanged,r);if(S=b)S.setDocument(I),S.setPlaybackFunction(l.enqueue),S.subscribe(gui.UndoManager.signalUndoStackChanged,r)};this.getUndoManager=function(){return S};this.getMetadataController=function(){return ta};this.getAnnotationController=function(){return ga};this.getDirectFormattingController=
function(){return da};this.getHyperlinkClickHandler=function(){return oa};this.getHyperlinkController=function(){return qa};this.getBulletlistController=function(){return va};this.getImageController=function(){return ma};this.getSelectionController=function(){return X};this.getTextController=function(){return ha};this.getEventManager=function(){return K};this.getKeyboardHandlers=function(){return{keydown:C,keypress:V}};this.destroy=function(b){var a=[ja.destroy,fa.destroy,da.destroy,ka.destroy,K.destroy,
oa.destroy,qa.destroy,ta.destroy,X.destroy,ha.destroy,Z];sa&&a.unshift(sa.destroy);runtime.clearTimeout(Y);core.Async.destroyAll(a,b)};ja=core.Task.createRedrawTask(v);fa=core.Task.createRedrawTask(function(){var b=I.getCursor(a);if(b&&b.getSelectionType()===ops.OdtCursor.RegionSelection&&(b=D.getImageElements(b.getSelectedRange())[0])){la.select(b.parentNode);return}la.clearSelection()});C.bind(M.Left,L.None,z(X.moveCursorToLeft));C.bind(M.Right,L.None,z(X.moveCursorToRight));C.bind(M.Up,L.None,
z(X.moveCursorUp));C.bind(M.Down,L.None,z(X.moveCursorDown));C.bind(M.Left,L.Shift,z(X.extendSelectionToLeft));C.bind(M.Right,L.Shift,z(X.extendSelectionToRight));C.bind(M.Up,L.Shift,z(X.extendSelectionUp));C.bind(M.Down,L.Shift,z(X.extendSelectionDown));C.bind(M.Home,L.None,z(X.moveCursorToLineStart));C.bind(M.End,L.None,z(X.moveCursorToLineEnd));C.bind(M.Home,L.Ctrl,z(X.moveCursorToDocumentStart));C.bind(M.End,L.Ctrl,z(X.moveCursorToDocumentEnd));C.bind(M.Home,L.Shift,z(X.extendSelectionToLineStart));
C.bind(M.End,L.Shift,z(X.extendSelectionToLineEnd));C.bind(M.Up,L.CtrlShift,z(X.extendSelectionToParagraphStart));C.bind(M.Down,L.CtrlShift,z(X.extendSelectionToParagraphEnd));C.bind(M.Home,L.CtrlShift,z(X.extendSelectionToDocumentStart));C.bind(M.End,L.CtrlShift,z(X.extendSelectionToDocumentEnd));ra?(C.bind(M.Left,L.Alt,z(X.moveCursorBeforeWord)),C.bind(M.Right,L.Alt,z(X.moveCursorPastWord)),C.bind(M.Left,L.Meta,z(X.moveCursorToLineStart)),C.bind(M.Right,L.Meta,z(X.moveCursorToLineEnd)),C.bind(M.Home,
L.Meta,z(X.moveCursorToDocumentStart)),C.bind(M.End,L.Meta,z(X.moveCursorToDocumentEnd)),C.bind(M.Left,L.AltShift,z(X.extendSelectionBeforeWord)),C.bind(M.Right,L.AltShift,z(X.extendSelectionPastWord)),C.bind(M.Left,L.MetaShift,z(X.extendSelectionToLineStart)),C.bind(M.Right,L.MetaShift,z(X.extendSelectionToLineEnd)),C.bind(M.Up,L.AltShift,z(X.extendSelectionToParagraphStart)),C.bind(M.Down,L.AltShift,z(X.extendSelectionToParagraphEnd)),C.bind(M.Up,L.MetaShift,z(X.extendSelectionToDocumentStart)),
C.bind(M.Down,L.MetaShift,z(X.extendSelectionToDocumentEnd)),C.bind(M.A,L.Meta,z(X.extendSelectionToEntireDocument))):(C.bind(M.Left,L.Ctrl,z(X.moveCursorBeforeWord)),C.bind(M.Right,L.Ctrl,z(X.moveCursorPastWord)),C.bind(M.Left,L.CtrlShift,z(X.extendSelectionBeforeWord)),C.bind(M.Right,L.CtrlShift,z(X.extendSelectionPastWord)),C.bind(M.A,L.Ctrl,z(X.extendSelectionToEntireDocument)));ua&&(sa=new gui.IOSSafariSupport(K));K.subscribe("keydown",C.handleEvent);K.subscribe("keypress",V.handleEvent);K.subscribe("keyup",
aa.handleEvent);K.subscribe("copy",g);K.subscribe("mousedown",s);K.subscribe("mousemove",ja.trigger);K.subscribe("mouseup",H);K.subscribe("contextmenu",J);K.subscribe("dragstart",B);K.subscribe("dragend",E);K.subscribe("click",oa.handleClick);K.subscribe("longpress",A);K.subscribe("drag",t);K.subscribe("dragstop",y);I.subscribe(ops.OdtDocument.signalOperationEnd,fa.trigger);I.subscribe(ops.Document.signalCursorAdded,ka.registerCursor);I.subscribe(ops.Document.signalCursorRemoved,ka.removeCursor);
I.subscribe(ops.OdtDocument.signalOperationEnd,d)}})();gui.CaretManager=function(f,l){function a(a){return k.hasOwnProperty(a)?k[a]:null}function e(){return Object.keys(k).map(function(a){return k[a]})}function c(a){var c=k[a];c&&(delete k[a],a===f.getInputMemberId()?(n.unsubscribe(ops.OdtDocument.signalProcessingBatchEnd,c.ensureVisible),n.unsubscribe(ops.Document.signalCursorMoved,c.refreshCursorBlinking),p.unsubscribe("compositionupdate",c.handleUpdate),p.unsubscribe("compositionend",c.handleUpdate),p.unsubscribe("focus",c.setFocus),p.unsubscribe("blur",
c.removeFocus),q.removeEventListener("focus",c.show,!1),q.removeEventListener("blur",c.hide,!1)):n.unsubscribe(ops.OdtDocument.signalProcessingBatchEnd,c.handleUpdate),c.destroy(function(){}))}var k={},q=runtime.getWindow(),n=f.getSession().getOdtDocument(),p=f.getEventManager();this.registerCursor=function(a,c,b){var d=a.getMemberId();a=new gui.Caret(a,l,c,b);k[d]=a;d===f.getInputMemberId()?(runtime.log("Starting to track input on new cursor of "+d),n.subscribe(ops.OdtDocument.signalProcessingBatchEnd,
a.ensureVisible),n.subscribe(ops.Document.signalCursorMoved,a.refreshCursorBlinking),p.subscribe("compositionupdate",a.handleUpdate),p.subscribe("compositionend",a.handleUpdate),p.subscribe("focus",a.setFocus),p.subscribe("blur",a.removeFocus),q.addEventListener("focus",a.show,!1),q.addEventListener("blur",a.hide,!1),a.setOverlayElement(p.getEventTrap())):n.subscribe(ops.OdtDocument.signalProcessingBatchEnd,a.handleUpdate);return a};this.getCaret=a;this.getCarets=e;this.destroy=function(a){var h=
e().map(function(b){return b.destroy});f.getSelectionController().setCaretXPositionLocator(null);n.unsubscribe(ops.Document.signalCursorRemoved,c);k={};core.Async.destroyAll(h,a)};f.getSelectionController().setCaretXPositionLocator(function(){var c=a(f.getInputMemberId()),e;c&&(e=c.getBoundingClientRect());return e?e.right:void 0});n.subscribe(ops.Document.signalCursorRemoved,c)};gui.EditInfoHandle=function(f){var l=[],a,e=f.ownerDocument,c=e.documentElement.namespaceURI;this.setEdits=function(f){l=f;var q,n,p,g;core.DomUtils.removeAllChildNodes(a);for(f=0;f<l.length;f+=1)q=e.createElementNS(c,"div"),q.className="editInfo",n=e.createElementNS(c,"span"),n.className="editInfoColor",n.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",l[f].memberid),p=e.createElementNS(c,"span"),p.className="editInfoAuthor",p.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",
l[f].memberid),g=e.createElementNS(c,"span"),g.className="editInfoTime",g.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",l[f].memberid),g.appendChild(e.createTextNode(l[f].time.toString())),q.appendChild(n),q.appendChild(p),q.appendChild(g),a.appendChild(q)};this.show=function(){a.style.display="block"};this.hide=function(){a.style.display="none"};this.destroy=function(c){f.removeChild(a);c()};a=e.createElementNS(c,"div");a.setAttribute("class","editInfoHandle");a.style.display="none";
f.appendChild(a)};ops.EditInfo=function(f,l){function a(){var a=[],e;for(e in c)c.hasOwnProperty(e)&&a.push({memberid:e,time:c[e].time});a.sort(function(a,c){return a.time-c.time});return a}var e,c={};this.getNode=function(){return e};this.getOdtDocument=function(){return l};this.getEdits=function(){return c};this.getSortedEdits=function(){return a()};this.addEdit=function(a,e){c[a]={time:e}};this.clearEdits=function(){c={}};this.destroy=function(a){f.parentNode&&f.removeChild(e);a()};e=l.getDOMDocument().createElementNS("urn:webodf:names:editinfo",
"editinfo");f.insertBefore(e,f.firstChild)};gui.EditInfoMarker=function(f,l){function a(a,b){return runtime.setTimeout(function(){q.style.opacity=a},b)}var e=this,c,k,q,n,p,g;this.addEdit=function(c,b){var d=Date.now()-b;f.addEdit(c,b);k.setEdits(f.getSortedEdits());q.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",c);runtime.clearTimeout(p);runtime.clearTimeout(g);1E4>d?(n=a(1,0),p=a(0.5,1E4-d),g=a(0.2,2E4-d)):1E4<=d&&2E4>d?(n=a(0.5,0),g=a(0.2,2E4-d)):n=a(0.2,0)};this.getEdits=function(){return f.getEdits()};this.clearEdits=
function(){f.clearEdits();k.setEdits([]);q.hasAttributeNS("urn:webodf:names:editinfo","editinfo:memberid")&&q.removeAttributeNS("urn:webodf:names:editinfo","editinfo:memberid")};this.getEditInfo=function(){return f};this.show=function(){q.style.display="block"};this.hide=function(){e.hideHandle();q.style.display="none"};this.showHandle=function(){k.show()};this.hideHandle=function(){k.hide()};this.destroy=function(a){runtime.clearTimeout(n);runtime.clearTimeout(p);runtime.clearTimeout(g);c.removeChild(q);
k.destroy(function(b){b?a(b):f.destroy(a)})};(function(){var a=f.getOdtDocument().getDOMDocument();q=a.createElementNS(a.documentElement.namespaceURI,"div");q.setAttribute("class","editInfoMarker");q.onmouseover=function(){e.showHandle()};q.onmouseout=function(){e.hideHandle()};c=f.getNode();c.appendChild(q);k=new gui.EditInfoHandle(c);l||e.hide()})()};gui.HyperlinkTooltipView=function(f,l){var a=core.DomUtils,e=odf.OdfUtils,c=runtime.getWindow(),k,q,n;runtime.assert(null!==c,"Expected to be run in an environment which has a global window, like a browser.");this.showTooltip=function(p){var g=p.target||p.srcElement,h=f.getSizer(),b=f.getZoomLevel(),d;a:{for(;g;){if(e.isHyperlink(g))break a;if(e.isParagraph(g)||e.isInlineRoot(g))break;g=g.parentNode}g=null}if(g){a.containsNode(h,n)||h.appendChild(n);d=q;var r;switch(l()){case gui.KeyboardHandler.Modifier.Ctrl:r=
runtime.tr("Ctrl-click to follow link");break;case gui.KeyboardHandler.Modifier.Meta:r=runtime.tr("\u2318-click to follow link");break;default:r=""}d.textContent=r;k.textContent=e.getHyperlinkTarget(g);n.style.display="block";d=c.innerWidth-n.offsetWidth-15;g=p.clientX>d?d:p.clientX+15;d=c.innerHeight-n.offsetHeight-10;p=p.clientY>d?d:p.clientY+10;h=h.getBoundingClientRect();g=(g-h.left)/b;p=(p-h.top)/b;n.style.left=g+"px";n.style.top=p+"px"}};this.hideTooltip=function(){n.style.display="none"};this.destroy=
function(a){n.parentNode&&n.parentNode.removeChild(n);a()};(function(){var a=f.getElement().ownerDocument;k=a.createElement("span");q=a.createElement("span");k.className="webodf-hyperlinkTooltipLink";q.className="webodf-hyperlinkTooltipText";n=a.createElement("div");n.className="webodf-hyperlinkTooltip";n.appendChild(k);n.appendChild(q);f.getElement().appendChild(n)})()};gui.OdfFieldView=function(f){function l(){var a=odf.OdfSchema.getFields().map(function(a){return a.replace(":","|")}),e=a.join(",\n")+"\n{ background-color: #D0D0D0; }\n",a=a.map(function(a){return a+":empty::after"}).join(",\n")+"\n{ content:' '; white-space: pre; }\n";return e+"\n"+a}var a,e=f.getElement().ownerDocument;this.showFieldHighlight=function(){a.appendChild(e.createTextNode(l()))};this.hideFieldHighlight=function(){for(var c=a.sheet,e=c.cssRules;e.length;)c.deleteRule(e.length-1)};this.destroy=
function(c){a.parentNode&&a.parentNode.removeChild(a);c()};a=function(){var a=e.getElementsByTagName("head").item(0),f=e.createElement("style"),l="";f.type="text/css";f.media="screen, print, handheld, projection";odf.Namespaces.forEachPrefix(function(a,c){l+="@namespace "+a+" url("+c+");\n"});f.appendChild(e.createTextNode(l));a.appendChild(f);return f}()};gui.ShadowCursor=function(f){var l=f.getDOMDocument().createRange(),a=!0;this.removeFromDocument=function(){};this.getMemberId=function(){return gui.ShadowCursor.ShadowCursorMemberId};this.getSelectedRange=function(){return l};this.setSelectedRange=function(e,c){l=e;a=!1!==c};this.hasForwardSelection=function(){return a};this.getDocument=function(){return f};this.getSelectionType=function(){return ops.OdtCursor.RangeSelection};l.setStart(f.getRootNode(),0)};gui.ShadowCursor.ShadowCursorMemberId="";gui.SelectionView=function(f){};gui.SelectionView.prototype.rerender=function(){};gui.SelectionView.prototype.show=function(){};gui.SelectionView.prototype.hide=function(){};gui.SelectionView.prototype.destroy=function(f){};gui.SelectionViewManager=function(f){function l(){return Object.keys(a).map(function(e){return a[e]})}var a={};this.getSelectionView=function(e){return a.hasOwnProperty(e)?a[e]:null};this.getSelectionViews=l;this.removeSelectionView=function(e){a.hasOwnProperty(e)&&(a[e].destroy(function(){}),delete a[e])};this.hideSelectionView=function(e){a.hasOwnProperty(e)&&a[e].hide()};this.showSelectionView=function(e){a.hasOwnProperty(e)&&a[e].show()};this.rerenderSelectionViews=function(){Object.keys(a).forEach(function(e){a[e].rerender()})};
this.registerCursor=function(e,c){var k=e.getMemberId(),l=new f(e);c?l.show():l.hide();return a[k]=l};this.destroy=function(a){function c(l,n){n?a(n):l<f.length?f[l].destroy(function(a){c(l+1,a)}):a()}var f=l();c(0,void 0)}};gui.SessionViewOptions=function(){this.caretBlinksOnRangeSelect=this.caretAvatarsInitiallyVisible=this.editInfoMarkersInitiallyVisible=!0};
(function(){gui.SessionView=function(f,l,a,e,c,k){function q(b){b.memberId===l&&F.getViewport().scrollIntoView(b.annotation.getBoundingClientRect())}function n(){var b=document.getElementsByTagName("head").item(0),a=document.createElement("style");a.type="text/css";a.media="screen, print, handheld, projection";b.appendChild(a);return a}function p(b,a,d){function c(a,d,e){d=a+'[editinfo|memberid="'+b+'"]'+e+d;a:{var f=v.firstChild;for(a=a+'[editinfo|memberid="'+b+'"]'+e+"{";f;){if(f.nodeType===Node.TEXT_NODE&&
0===f.data.indexOf(a)){a=f;break a}f=f.nextSibling}a=null}a?a.data=d:v.appendChild(document.createTextNode(d))}c("div.editInfoMarker","{ background-color: "+d+"; }","");c("span.editInfoColor","{ background-color: "+d+"; }","");c("span.editInfoAuthor",'{ content: "'+a+'"; }',":before");c("dc|creator","{ background-color: "+d+"; }","");c(".webodf-selectionOverlay","{ fill: "+d+"; stroke: "+d+";}","");b===l&&(c(".webodf-touchEnabled .webodf-selectionOverlay","{ display: block; }"," > .webodf-draggable"),
b=gui.ShadowCursor.ShadowCursorMemberId,c(".webodf-selectionOverlay","{ fill: "+d+"; stroke: "+d+";}",""),c(".webodf-touchEnabled .webodf-selectionOverlay","{ display: block; }"," > .webodf-draggable"))}function g(b){var a,d;for(d in u)u.hasOwnProperty(d)&&(a=u[d],b?a.show():a.hide())}function h(b){c.getCarets().forEach(function(a){b?a.showHandle():a.hideHandle()})}function b(b){var a=b.getMemberId();b=b.getProperties();p(a,b.fullName,b.color)}function d(b){var d=b.getMemberId(),e=a.getOdtDocument().getMember(d).getProperties();
c.registerCursor(b,J,H);k.registerCursor(b,!0);if(b=c.getCaret(d))b.setAvatarImageUrl(e.imageUrl),b.setColor(e.color);runtime.log("+++ View here +++ eagerly created an Caret for '"+d+"'! +++")}function r(b){b=b.getMemberId();var a=k.getSelectionView(l),d=k.getSelectionView(gui.ShadowCursor.ShadowCursorMemberId),e=c.getCaret(l);b===l?(d.hide(),a&&a.show(),e&&e.show()):b===gui.ShadowCursor.ShadowCursorMemberId&&(d.show(),a&&a.hide(),e&&e.hide())}function m(b){k.removeSelectionView(b)}function x(b){var d=
b.paragraphElement,c=b.memberId;b=b.timeStamp;var e,f="",h=d.getElementsByTagNameNS(w,"editinfo").item(0);h?(f=h.getAttributeNS(w,"id"),e=u[f]):(f=Math.random().toString(),e=new ops.EditInfo(d,a.getOdtDocument()),e=new gui.EditInfoMarker(e,E),h=d.getElementsByTagNameNS(w,"editinfo").item(0),h.setAttributeNS(w,"id",f),u[f]=e);e.addEdit(c,new Date(b));B.trigger()}function t(){var b;s.hasChildNodes()&&core.DomUtils.removeAllChildNodes(s);!0===e.getState(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN)&&
(b=a.getOdtDocument().getMember(l))&&(b=b.getProperties().fullName,s.appendChild(document.createTextNode(".annotationWrapper:not([creator = '"+b+"']) .annotationRemoveButton { display: none; }")))}function y(a){var c=Object.keys(u).map(function(b){return u[b]});A.unsubscribe(ops.Document.signalMemberAdded,b);A.unsubscribe(ops.Document.signalMemberUpdated,b);A.unsubscribe(ops.Document.signalCursorAdded,d);A.unsubscribe(ops.Document.signalCursorRemoved,m);A.unsubscribe(ops.OdtDocument.signalParagraphChanged,
x);A.unsubscribe(ops.Document.signalCursorMoved,r);A.unsubscribe(ops.OdtDocument.signalParagraphChanged,k.rerenderSelectionViews);A.unsubscribe(ops.OdtDocument.signalTableAdded,k.rerenderSelectionViews);A.unsubscribe(ops.OdtDocument.signalParagraphStyleModified,k.rerenderSelectionViews);e.unsubscribe(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN,t);A.unsubscribe(ops.Document.signalMemberAdded,t);A.unsubscribe(ops.Document.signalMemberUpdated,t);v.parentNode.removeChild(v);s.parentNode.removeChild(s);
(function Z(b,d){d?a(d):b<c.length?c[b].destroy(function(a){Z(b+1,a)}):a()})(0,void 0)}var v,s,w="urn:webodf:names:editinfo",u={},A,F,B,E=void 0!==f.editInfoMarkersInitiallyVisible?Boolean(f.editInfoMarkersInitiallyVisible):!0,J=void 0!==f.caretAvatarsInitiallyVisible?Boolean(f.caretAvatarsInitiallyVisible):!0,H=void 0!==f.caretBlinksOnRangeSelect?Boolean(f.caretBlinksOnRangeSelect):!0;this.showEditInfoMarkers=function(){E||(E=!0,g(E))};this.hideEditInfoMarkers=function(){E&&(E=!1,g(E))};this.showCaretAvatars=
function(){J||(J=!0,h(J))};this.hideCaretAvatars=function(){J&&(J=!1,h(J))};this.getSession=function(){return a};this.getCaret=function(b){return c.getCaret(b)};this.destroy=function(b){var a=[B.destroy,y];A.unsubscribe(ops.OdtDocument.signalAnnotationAdded,q);core.Async.destroyAll(a,b)};A=a.getOdtDocument();F=A.getOdfCanvas();A.subscribe(ops.OdtDocument.signalAnnotationAdded,q);A.subscribe(ops.Document.signalMemberAdded,b);A.subscribe(ops.Document.signalMemberUpdated,b);A.subscribe(ops.Document.signalCursorAdded,
d);A.subscribe(ops.Document.signalCursorRemoved,m);A.subscribe(ops.OdtDocument.signalParagraphChanged,x);A.subscribe(ops.Document.signalCursorMoved,r);A.subscribe(ops.OdtDocument.signalParagraphChanged,k.rerenderSelectionViews);A.subscribe(ops.OdtDocument.signalTableAdded,k.rerenderSelectionViews);A.subscribe(ops.OdtDocument.signalParagraphStyleModified,k.rerenderSelectionViews);e.subscribe(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN,t);A.subscribe(ops.Document.signalMemberAdded,t);A.subscribe(ops.Document.signalMemberUpdated,
t);v=n();v.appendChild(document.createTextNode("@namespace editinfo url(urn:webodf:names:editinfo);"));v.appendChild(document.createTextNode("@namespace dc url(http://purl.org/dc/elements/1.1/);"));s=n();t();B=core.Task.createRedrawTask(function(){var b=F.getAnnotationViewManager();b&&(b.rehighlightAnnotations(),A.fixCursorPositions())})}})();gui.SvgSelectionView=function(f){function l(){var b=d.getRootNode();r!==b&&(r=b,m=d.getCanvas().getSizer(),m.appendChild(t),t.setAttribute("class","webodf-selectionOverlay"),v.setAttribute("class","webodf-draggable"),s.setAttribute("class","webodf-draggable"),v.setAttribute("end","left"),s.setAttribute("end","right"),v.setAttribute("r",8),s.setAttribute("r",8),t.appendChild(y),t.appendChild(v),t.appendChild(s))}function a(b){b=b.getBoundingClientRect();return Boolean(b&&0!==b.height)}function e(b){var d=
w.getTextElements(b,!0,!1),c=b.cloneRange(),e=b.cloneRange();b=b.cloneRange();if(!d.length)return null;var f;a:{f=0;var h=d[f],g=c.startContainer===h?c.startOffset:0,m=g;c.setStart(h,g);for(c.setEnd(h,m);!a(c);){if(h.nodeType===Node.ELEMENT_NODE&&m<h.childNodes.length)m=h.childNodes.length;else if(h.nodeType===Node.TEXT_NODE&&m<h.length)m+=1;else if(d[f])h=d[f],f+=1,g=m=0;else{f=!1;break a}c.setStart(h,g);c.setEnd(h,m)}f=!0}if(!f)return null;a:{f=d.length-1;h=d[f];m=g=e.endContainer===h?e.endOffset:
h.nodeType===Node.TEXT_NODE?h.length:h.childNodes.length;e.setStart(h,g);for(e.setEnd(h,m);!a(e);){if(h.nodeType===Node.ELEMENT_NODE&&0<g)g=0;else if(h.nodeType===Node.TEXT_NODE&&0<g)g-=1;else if(d[f])h=d[f],f-=1,g=m=h.length||h.childNodes.length;else{d=!1;break a}e.setStart(h,g);e.setEnd(h,m)}d=!0}if(!d)return null;b.setStart(c.startContainer,c.startOffset);b.setEnd(e.endContainer,e.endOffset);return{firstRange:c,lastRange:e,fillerRange:b}}function c(b,a){var d={};d.top=Math.min(b.top,a.top);d.left=
Math.min(b.left,a.left);d.right=Math.max(b.right,a.right);d.bottom=Math.max(b.bottom,a.bottom);d.width=d.right-d.left;d.height=d.bottom-d.top;return d}function k(b,a){a&&0<a.width&&0<a.height&&(b=b?c(b,a):a);return b}function q(b){function a(b){B.setUnfilteredPosition(b,0);return t.acceptNode(b)===E&&s.acceptPosition(B)===E?E:J}function c(b){var d=null;a(b)===E&&(d=u.getBoundingClientRect(b));return d}var e=b.commonAncestorContainer,f=b.startContainer,h=b.endContainer,g=b.startOffset,m=b.endOffset,
l,n,p=null,r,q=x.createRange(),s,t=new odf.OdfNodeFilter,v;if(f===e||h===e)return q=b.cloneRange(),p=q.getBoundingClientRect(),q.detach(),p;for(b=f;b.parentNode!==e;)b=b.parentNode;for(n=h;n.parentNode!==e;)n=n.parentNode;s=d.createRootFilter(f);for(e=b.nextSibling;e&&e!==n;)r=c(e),p=k(p,r),e=e.nextSibling;if(w.isParagraph(b))p=k(p,u.getBoundingClientRect(b));else if(b.nodeType===Node.TEXT_NODE)e=b,q.setStart(e,g),q.setEnd(e,e===n?m:e.length),r=q.getBoundingClientRect(),p=k(p,r);else for(v=x.createTreeWalker(b,
NodeFilter.SHOW_TEXT,a,!1),e=v.currentNode=f;e&&e!==h;)q.setStart(e,g),q.setEnd(e,e.length),r=q.getBoundingClientRect(),p=k(p,r),l=e,g=0,e=v.nextNode();l||(l=f);if(w.isParagraph(n))p=k(p,u.getBoundingClientRect(n));else if(n.nodeType===Node.TEXT_NODE)e=n,q.setStart(e,e===b?g:0),q.setEnd(e,m),r=q.getBoundingClientRect(),p=k(p,r);else for(v=x.createTreeWalker(n,NodeFilter.SHOW_TEXT,a,!1),e=v.currentNode=h;e&&e!==l;)if(q.setStart(e,0),q.setEnd(e,m),r=q.getBoundingClientRect(),p=k(p,r),e=v.previousNode())m=
e.length;return p}function n(b,a){var d=b.getBoundingClientRect(),c={width:0};c.top=d.top;c.bottom=d.bottom;c.height=d.height;c.left=c.right=a?d.right:d.left;return c}function p(){var b=f.getSelectedRange(),a;if(a=F&&f.getSelectionType()===ops.OdtCursor.RangeSelection&&!b.collapsed){l();var d=u.getBoundingClientRect(m),h=A.getZoomLevel(),b=e(b),g,k,p,r,x,w;if(b){a=b.firstRange;g=b.lastRange;k=b.fillerRange;p=u.translateRect(n(a,!1),d,h);x=u.translateRect(n(g,!0),d,h);r=(r=q(k))?u.translateRect(r,
d,h):c(p,x);w=r.left;r=p.left+Math.max(0,r.width-(p.left-r.left));d=Math.min(p.top,x.top);h=x.top+x.height;w=[{x:p.left,y:d+p.height},{x:p.left,y:d},{x:r,y:d},{x:r,y:h-x.height},{x:x.right,y:h-x.height},{x:x.right,y:h},{x:w,y:h},{x:w,y:d+p.height},{x:p.left,y:d+p.height}];r="";var B;for(B=0;B<w.length;B+=1)r+=w[B].x+","+w[B].y+" ";y.setAttribute("points",r);v.setAttribute("cx",p.left);v.setAttribute("cy",d+p.height/2);s.setAttribute("cx",x.right);s.setAttribute("cy",h-x.height/2);a.detach();g.detach();
k.detach()}a=Boolean(b)}t.style.display=a?"block":"none"}function g(b){F&&b===f&&H.trigger()}function h(b){b=8/b;v.setAttribute("r",b);s.setAttribute("r",b)}function b(b){m.removeChild(t);m.classList.remove("webodf-virtualSelections");f.getDocument().unsubscribe(ops.Document.signalCursorMoved,g);A.unsubscribe(gui.ZoomHelper.signalZoomChanged,h);b()}var d=f.getDocument(),r,m,x=d.getDOMDocument(),t=x.createElementNS("http://www.w3.org/2000/svg","svg"),y=x.createElementNS("http://www.w3.org/2000/svg",
"polygon"),v=x.createElementNS("http://www.w3.org/2000/svg","circle"),s=x.createElementNS("http://www.w3.org/2000/svg","circle"),w=odf.OdfUtils,u=core.DomUtils,A=d.getCanvas().getZoomHelper(),F=!0,B=f.getDocument().createPositionIterator(d.getRootNode()),E=NodeFilter.FILTER_ACCEPT,J=NodeFilter.FILTER_REJECT,H;this.rerender=function(){F&&H.trigger()};this.show=function(){F=!0;H.trigger()};this.hide=function(){F=!1;H.trigger()};this.destroy=function(a){core.Async.destroyAll([H.destroy,b],a)};(function(){var b=
f.getMemberId();H=core.Task.createRedrawTask(p);l();t.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",b);m.classList.add("webodf-virtualSelections");f.getDocument().subscribe(ops.Document.signalCursorMoved,g);A.subscribe(gui.ZoomHelper.signalZoomChanged,h);h(A.getZoomLevel())})()};gui.UndoStateRules=function(){function f(a,e){var f=a.length;this.previous=function(){for(f-=1;0<=f;f-=1)if(e(a[f]))return a[f];return null}}function l(a){a=a.spec();var e;a.hasOwnProperty("position")&&(e=a.position);return e}function a(a){return a.isEdit}function e(a,e,f){if(!f)return f=l(a)-l(e),0===f||1===Math.abs(f);a=l(a);e=l(e);f=l(f);return a-e===e-f}this.isEditOperation=a;this.isPartOfOperationSet=function(c,k){var l=void 0!==c.group,n;if(!c.isEdit||0===k.length)return!0;n=k[k.length-1];if(l&&
c.group===n.group)return!0;a:switch(c.spec().optype){case "RemoveText":case "InsertText":n=!0;break a;default:n=!1}if(n&&k.some(a)){if(l){var p;l=c.spec().optype;n=new f(k,a);var g=n.previous(),h=null,b,d;runtime.assert(Boolean(g),"No edit operations found in state");d=g.group;runtime.assert(void 0!==d,"Operation has no group");for(b=1;g&&g.group===d;){if(l===g.spec().optype){p=g;break}g=n.previous()}if(p){for(g=n.previous();g;){if(g.group!==d){if(2===b)break;d=g.group;b+=1}if(l===g.spec().optype){h=
g;break}g=n.previous()}p=e(c,p,h)}else p=!1;return p}p=c.spec().optype;l=new f(k,a);n=l.previous();runtime.assert(Boolean(n),"No edit operations found in state");p=p===n.spec().optype?e(c,n,l.previous()):!1;return p}return!1}};(function(){function f(a,c){this.mainId=void 0!==a?a:-1;this.subId=void 0!==c?c:-1}function l(e,c,k){function l(a,b){return a+(e.isEditOperation(b)?1:0)}var n,p,g;this.addOperation=function(a){e.isEditOperation(a)&&(g+=1);p.push(a)};this.isNextStateId=function(a){return a.mainId===n&&a.subId===g};this.getNextStateId=function(){return new f(n,g)};this.getOperations=function(){return p};n=a+=1;p=c||[];g=c&&k?c.reduce(l,0):0}var a=0;gui.TrivialUndoManager=function(a){function c(){return!0!==u.isNextStateId(w)}
function k(b){b=b.getOperations();0<b.length&&(J=!0,v(b),J=!1)}function q(){B.emit(gui.UndoManager.signalUndoStackChanged,{undoAvailable:r.hasUndoStates(),redoAvailable:r.hasRedoStates()})}function n(b){var a=c();b!==a&&B.emit(gui.UndoManager.signalDocumentModifiedChanged,a)}function p(){u!==y&&u!==A[A.length-1]&&A.push(u)}function g(b){var a=b.previousSibling||b.nextSibling;b.parentNode.removeChild(b);x.normalizeTextNodes(a)}function h(b){return Object.keys(b).map(function(a){return b[a]})}function b(b){function a(b){var h=
b.spec();if(e[h.memberid])switch(h.optype){case "AddCursor":d[h.memberid]||(d[h.memberid]=b,delete e[h.memberid],f-=1);break;case "MoveCursor":c[h.memberid]||(c[h.memberid]=b)}}var d={},c={},e={},f,g;g=b.pop();s.getMemberIds().forEach(function(b){e[b]=!0});for(f=Object.keys(e).length;g&&0<f;)g=g.getOperations(),g.reverse(),g.forEach(a),g=b.pop();return new l(E,h(d).concat(h(c)))}function d(){var a=c(),d=t=s.cloneDocumentElement();x.getElementsByTagNameNS(d,m,"cursor").forEach(g);x.getElementsByTagNameNS(d,
m,"anchor").forEach(g);p();u=y=b([y].concat(A));A.length=0;F.length=0;a||(w=u.getNextStateId());q();n(a)}var r=this,m="urn:webodf:names:cursor",x=core.DomUtils,t,y,v,s,w,u,A=[],F=[],B=new core.EventNotifier([gui.UndoManager.signalUndoStackChanged,gui.UndoManager.signalUndoStateCreated,gui.UndoManager.signalUndoStateModified,gui.UndoManager.signalDocumentModifiedChanged,gui.TrivialUndoManager.signalDocumentRootReplaced]),E=a||new gui.UndoStateRules,J=!1;this.subscribe=function(b,a){B.subscribe(b,a)};
this.unsubscribe=function(b,a){B.unsubscribe(b,a)};this.isDocumentModified=c;this.setDocumentModified=function(b){c()!==b&&(w=b?new f:u.getNextStateId(),B.emit(gui.UndoManager.signalDocumentModifiedChanged,b))};this.hasUndoStates=function(){return 0<A.length};this.hasRedoStates=function(){return 0<F.length};this.setDocument=function(b){s=b};this.purgeInitialState=function(){var b=c();A.length=0;F.length=0;u=y=new l(E);w=u.getNextStateId();t=null;q();n(b)};this.setInitialState=d;this.initialize=function(){t||
d()};this.setPlaybackFunction=function(b){v=b};this.onOperationExecuted=function(b){if(!J){var a=c();E.isEditOperation(b)&&(u===y||0<F.length)||!E.isPartOfOperationSet(b,u.getOperations())?(F.length=0,p(),u=new l(E,[b],!0),A.push(u),B.emit(gui.UndoManager.signalUndoStateCreated,{operations:u.getOperations()}),q()):(u.addOperation(b),B.emit(gui.UndoManager.signalUndoStateModified,{operations:u.getOperations()}));n(a)}};this.moveForward=function(b){for(var a=0,d=c(),e;b&&F.length;)e=F.pop(),A.push(e),
k(e),b-=1,a+=1;a&&(u=A[A.length-1],q(),n(d));return a};this.moveBackward=function(b){for(var a=0,d=c();b&&A.length;)F.push(A.pop()),b-=1,a+=1;a&&(s.getMemberIds().forEach(function(b){s.removeCursor(b)}),s.setDocumentElement(t.cloneNode(!0)),B.emit(gui.TrivialUndoManager.signalDocumentRootReplaced,{}),k(y),A.forEach(k),u=A[A.length-1]||y,q(),n(d));return a};u=y=new l(E);w=u.getNextStateId()};gui.TrivialUndoManager.signalDocumentRootReplaced="documentRootReplaced"})();odf.GraphicProperties=function(f,l,a){var e=this,c=odf.Namespaces.stylens,k=odf.Namespaces.svgns;this.verticalPos=function(){return e.data.value("verticalPos")};this.verticalRel=function(){return e.data.value("verticalRel")};this.horizontalPos=function(){return e.data.value("horizontalPos")};this.horizontalRel=function(){return e.data.value("horizontalRel")};this.strokeWidth=function(){return e.data.value("strokeWidth")};e.data=new odf.LazyStyleProperties(void 0===a?void 0:a.data,{verticalPos:function(){var a=
f.getAttributeNS(c,"vertical-pos");return""===a?void 0:a},verticalRel:function(){var a=f.getAttributeNS(c,"vertical-rel");return""===a?void 0:a},horizontalPos:function(){var a=f.getAttributeNS(c,"horizontal-pos");return""===a?void 0:a},horizontalRel:function(){var a=f.getAttributeNS(c,"horizontal-rel");return""===a?void 0:a},strokeWidth:function(){var a=f.getAttributeNS(k,"stroke-width");return l.parseLength(a)}})};
odf.ComputedGraphicProperties=function(){var f;this.setGraphicProperties=function(l){f=l};this.verticalPos=function(){return f&&f.verticalPos()||"from-top"};this.verticalRel=function(){return f&&f.verticalRel()||"page"};this.horizontalPos=function(){return f&&f.horizontalPos()||"from-left"};this.horizontalRel=function(){return f&&f.horizontalRel()||"page"}};odf.PageLayoutProperties=function(f,l,a){var e=this,c=odf.Namespaces.fons;this.pageHeight=function(){return e.data.value("pageHeight")||1123};this.pageWidth=function(){return e.data.value("pageWidth")||794};e.data=new odf.LazyStyleProperties(void 0===a?void 0:a.data,{pageHeight:function(){var a;f&&(a=f.getAttributeNS(c,"page-height"),a=l.parseLength(a));return a},pageWidth:function(){var a;f&&(a=f.getAttributeNS(c,"page-width"),a=l.parseLength(a));return a}})};
odf.PageLayout=function(f,l,a){var e=null;f&&(e=l.getPropertiesElement("page-layout-properties",f));this.pageLayout=new odf.PageLayoutProperties(e,l,a&&a.pageLayout)};odf.PageLayoutCache=function(){};odf.PageLayoutCache.prototype.getPageLayout=function(f){};odf.PageLayoutCache.prototype.getDefaultPageLayout=function(){};odf.ParagraphProperties=function(f,l,a){var e=this,c=odf.Namespaces.fons;this.marginTop=function(){return e.data.value("marginTop")};e.data=new odf.LazyStyleProperties(void 0===a?void 0:a.data,{marginTop:function(){var e=f.getAttributeNS(c,"margin-top");return l.parsePositiveLengthOrPercent(e,"marginTop",a&&a.data)}})};
odf.ComputedParagraphProperties=function(){var f={},l=[];this.setStyleChain=function(a){l=a;f={}};this.marginTop=function(){var a,e;if(f.hasOwnProperty("marginTop"))a=f.marginTop;else{for(e=0;void 0===a&&e<l.length;e+=1)a=l[e].marginTop();f.marginTop=a}return a||0}};odf.TextProperties=function(f,l,a){var e=this,c=odf.Namespaces.fons;this.fontSize=function(){return e.data.value("fontSize")};e.data=new odf.LazyStyleProperties(void 0===a?void 0:a.data,{fontSize:function(){var e=f.getAttributeNS(c,"font-size");return l.parsePositiveLengthOrPercent(e,"fontSize",a&&a.data)}})};
odf.ComputedTextProperties=function(){var f={},l=[];this.setStyleChain=function(a){l=a;f={}};this.fontSize=function(){var a,e;if(f.hasOwnProperty("fontSize"))a=f.fontSize;else{for(e=0;void 0===a&&e<l.length;e+=1)a=l[e].fontSize();f.fontSize=a}return a||12}};odf.MasterPage=function(f,l){var a;f?(a=f.getAttributeNS(odf.Namespaces.stylens,"page-layout-name"),this.pageLayout=l.getPageLayout(a)):this.pageLayout=l.getDefaultPageLayout()};odf.MasterPageCache=function(){};odf.MasterPageCache.prototype.getMasterPage=function(f){};
odf.StylePileEntry=function(f,l,a,e){this.masterPage=function(){var c=f.getAttributeNS(odf.Namespaces.stylens,"master-page-name"),e=null;c&&(e=a.getMasterPage(c));return e};(function(a){var k=f.getAttributeNS(odf.Namespaces.stylens,"family"),q=null;if("graphic"===k||"chart"===k)a.graphic=void 0===e?void 0:e.graphic,q=l.getPropertiesElement("graphic-properties",f,q),null!==q&&(a.graphic=new odf.GraphicProperties(q,l,a.graphic));if("paragraph"===k||"table-cell"===k||"graphic"===k||"presentation"===
k||"chart"===k)a.paragraph=void 0===e?void 0:e.paragraph,q=l.getPropertiesElement("paragraph-properties",f,q),null!==q&&(a.paragraph=new odf.ParagraphProperties(q,l,a.paragraph));if("text"===k||"paragraph"===k||"table-cell"===k||"graphic"===k||"presentation"===k||"chart"===k)a.text=void 0===e?void 0:e.text,q=l.getPropertiesElement("text-properties",f,q),null!==q&&(a.text=new odf.TextProperties(q,l,a.text))})(this)};
odf.StylePile=function(f,l){function a(a,b){var d,c;a.hasAttributeNS(e,"parent-style-name")&&(c=a.getAttributeNS(e,"parent-style-name"),-1===b.indexOf(c)&&(d=g(c,b)));return new odf.StylePileEntry(a,f,l,d)}var e=odf.Namespaces.stylens,c={},k={},q,n={},p={},g;g=function(e,b){var d=n[e],f;!d&&(f=c[e])&&(b.push(e),d=a(f,b),n[e]=d);return d};this.getStyle=function(e){var b=p[e]||n[e],d,f=[];b||(d=k[e],d||(d=c[e])&&f.push(e),d&&(b=a(d,f)));return b};this.addCommonStyle=function(a){var b;a.hasAttributeNS(e,
"name")&&(b=a.getAttributeNS(e,"name"),c.hasOwnProperty(b)||(c[b]=a))};this.addAutomaticStyle=function(a){var b;a.hasAttributeNS(e,"name")&&(b=a.getAttributeNS(e,"name"),k.hasOwnProperty(b)||(k[b]=a))};this.setDefaultStyle=function(c){void 0===q&&(q=a(c,[]))};this.getDefaultStyle=function(){return q}};odf.ComputedGraphicStyle=function(){this.text=new odf.ComputedTextProperties;this.paragraph=new odf.ComputedParagraphProperties;this.graphic=new odf.ComputedGraphicProperties};
odf.ComputedParagraphStyle=function(){this.text=new odf.ComputedTextProperties;this.paragraph=new odf.ComputedParagraphProperties};odf.ComputedTextStyle=function(){this.text=new odf.ComputedTextProperties};
odf.StyleCache=function(f){function l(b,a,d,c){a=d.getAttributeNS(a,"class-names");var e;if(a)for(a=a.split(" "),e=0;e<a.length;e+=1)if(d=a[e])c.push(b),c.push(d)}function a(b,a){var d=t.getStyleName("paragraph",b);void 0!==d&&(a.push("paragraph"),a.push(d));b.namespaceURI!==m||"h"!==b.localName&&"p"!==b.localName||l("paragraph",m,b,a);return a}function e(b,a,d){var c=[],e,f,h,g;for(e=0;e<b.length;e+=2)h=b[e],g=b[e+1],h=n[h],g=h.getStyle(g),void 0!==g&&(g=g[a],void 0!==g&&g!==f&&(c.push(g),f=g));
h=n[d];if(g=h.getDefaultStyle())g=g[a],void 0!==g&&g!==f&&c.push(g);return c}function c(b,d){var e=t.getStyleName("text",b),g=b.parentNode;void 0!==e&&(d.push("text"),d.push(e));"span"===b.localName&&b.namespaceURI===m&&l("text",m,b,d);if(!g||g===f)return d;g.namespaceURI!==m||"p"!==g.localName&&"h"!==g.localName?c(g,d):a(g,d);return d}function k(b){b=b.getAttributeNS(x,"family");return n[b]}var q=this,n,p,g,h,b,d,r,m=odf.Namespaces.textns,x=odf.Namespaces.stylens,t=new odf.StyleInfo,y=new odf.StyleParseUtils,
v,s,w,u,A,F;this.getComputedGraphicStyle=function(b){var a=[];b=t.getStyleName("graphic",b);void 0!==b&&(a.push("graphic"),a.push(b));b=a.join("/");var d=h[b];runtime.assert(0===a.length%2,"Invalid style chain.");void 0===d&&(d=new odf.ComputedGraphicStyle,d.graphic.setGraphicProperties(e(a,"graphic","graphic")[0]),d.text.setStyleChain(e(a,"text","graphic")),d.paragraph.setStyleChain(e(a,"paragraph","graphic")),h[b]=d);return d};this.getComputedParagraphStyle=function(b){b=a(b,[]);var d=b.join("/"),
c=g[d];runtime.assert(0===b.length%2,"Invalid style chain.");void 0===c&&(c=new odf.ComputedParagraphStyle,c.text.setStyleChain(e(b,"text","paragraph")),c.paragraph.setStyleChain(e(b,"paragraph","paragraph")),g[d]=c);return c};this.getComputedTextStyle=function(b){b=c(b,[]);var a=b.join("/"),d=p[a];runtime.assert(0===b.length%2,"Invalid style chain.");void 0===d&&(d=new odf.ComputedTextStyle,d.text.setStyleChain(e(b,"text","text")),p[a]=d);return d};this.getPageLayout=function(b){var a=F[b];a||((a=
A[b])?(a=new odf.PageLayout(a,y,u),F[b]=a):a=u);return a};this.getDefaultPageLayout=function(){return u};this.getMasterPage=function(b){var a=s[b];void 0===a&&((a=v[b])?(a=new odf.MasterPage(a,q),s[b]=a):a=null);return a};this.getDefaultMasterPage=function(){return w};this.update=function(){var a,c,e=null,m=null;p={};g={};h={};v={};s={};F={};A={};b=new odf.StylePile(y,q);d=new odf.StylePile(y,q);r=new odf.StylePile(y,q);n={text:b,paragraph:d,graphic:r};for(a=f.styles.firstElementChild;a;)a.namespaceURI===
x&&((c=k(a))?"style"===a.localName?c.addCommonStyle(a):"default-style"===a.localName&&c.setDefaultStyle(a):"default-page-layout"===a.localName&&(e=a)),a=a.nextElementSibling;u=new odf.PageLayout(e,y);for(a=f.automaticStyles.firstElementChild;a;)a.namespaceURI===x&&((c=k(a))&&"style"===a.localName?c.addAutomaticStyle(a):"page-layout"===a.localName&&(A[a.getAttributeNS(x,"name")]=a)),a=a.nextElementSibling;for(a=f.masterStyles.firstElementChild;a;)a.namespaceURI===x&&"master-page"===a.localName&&(m=
m||a,c=a,e=c.getAttributeNS(x,"name"),0<e.length&&!v.hasOwnProperty(e)&&(v[e]=c)),a=a.nextElementSibling;w=new odf.MasterPage(m,q)}};ops.OperationTransformMatrix=function(){function f(b){b.position+=b.length;b.length*=-1}function l(b){var a=0>b.length;a&&f(b);return a}function a(b,a){function c(f){b[f]===a&&e.push(f)}var e=[];b&&["style:parent-style-name","style:next-style-name"].forEach(c);return e}function e(b,a){function c(e){b[e]===a&&delete b[e]}b&&["style:parent-style-name","style:next-style-name"].forEach(c)}function c(b){var a={};Object.keys(b).forEach(function(e){a[e]="object"===typeof b[e]?c(b[e]):b[e]});return a}function k(b,
a,c,e){var f,g=!1,h=!1,k,l=[];e&&e.attributes&&(l=e.attributes.split(","));b&&(c||0<l.length)&&Object.keys(b).forEach(function(a){var d=b[a],e;"object"!==typeof d&&(c&&(e=c[a]),void 0!==e?(delete b[a],h=!0,e===d&&(delete c[a],g=!0)):-1!==l.indexOf(a)&&(delete b[a],h=!0))});if(a&&a.attributes&&(c||0<l.length)){k=a.attributes.split(",");for(e=0;e<k.length;e+=1)if(f=k[e],c&&void 0!==c[f]||l&&-1!==l.indexOf(f))k.splice(e,1),e-=1,h=!0;0<k.length?a.attributes=k.join(","):delete a.attributes}return{majorChanged:g,
minorChanged:h}}function q(b){for(var a in b)if(b.hasOwnProperty(a))return!0;return!1}function n(b){for(var a in b)if(b.hasOwnProperty(a)&&("attributes"!==a||0<b.attributes.length))return!0;return!1}function p(b,a,c,e,f){var g=b?b[f]:null,h=a?a[f]:null,l=c?c[f]:null,p=e?e[f]:null,w;w=k(g,h,l,p);g&&!q(g)&&delete b[f];h&&!n(h)&&delete a[f];l&&!q(l)&&delete c[f];p&&!n(p)&&delete e[f];return w}function g(b,a){return{opSpecsA:[b],opSpecsB:[a]}}var h;h={AddAnnotation:{AddAnnotation:function(b,a,c){var e;
b.position<a.position?(e=b,c=a):a.position<b.position?(e=a,c=b):(e=c?b:a,c=c?a:b);c.position<e.position+e.length&&(e.length+=2);c.position+=2;return{opSpecsA:[b],opSpecsB:[a]}},AddCursor:g,AddMember:g,AddStyle:g,ApplyDirectStyling:function(b,a){b.position<=a.position?a.position+=2:b.position<=a.position+a.length&&(a.length+=2);return{opSpecsA:[b],opSpecsB:[a]}},InsertText:function(b,a){a.position<=b.position?b.position+=a.text.length:(void 0!==b.length&&a.position<=b.position+b.length&&(b.length+=
a.text.length),a.position+=2);return{opSpecsA:[b],opSpecsB:[a]}},MergeParagraph:function(b,a){a.sourceStartPosition<=b.position?b.position-=1:(void 0!==b.length&&a.sourceStartPosition<=b.position+b.length&&(b.length-=1),a.sourceStartPosition+=2,b.position<a.destinationStartPosition&&(a.destinationStartPosition+=2));return{opSpecsA:[b],opSpecsB:[a]}},MoveCursor:function(b,a){var c=l(a);b.position<a.position?a.position+=2:b.position<a.position+a.length&&(a.length+=2);c&&f(a);return{opSpecsA:[b],opSpecsB:[a]}},
RemoveAnnotation:function(b,a){b.position<a.position?(a.position<b.position+b.length&&(b.length-=a.length+2),a.position+=2):b.position-=a.length+2;return{opSpecsA:[b],opSpecsB:[a]}},RemoveCursor:g,RemoveMember:g,RemoveStyle:g,RemoveText:function(b,a){var c=a.position,e=a.position+a.length,f,g=[b],h=[a];b.position<=a.position?a.position+=2:b.position<e&&(a.length=b.position-a.position,f={optype:"RemoveText",memberid:a.memberid,timestamp:a.timestamp,position:b.position+2,length:e-b.position},h.unshift(f));
a.position+a.length<=b.position?(b.position-=a.length,void 0!==b.length&&f&&(b.length=f.length>=b.length?0:b.length-f.length)):void 0!==b.length&&(f=b.position+b.length,e<=f?b.length-=a.length:c<f&&(b.length=c-b.position));return{opSpecsA:g,opSpecsB:h}},SetParagraphStyle:function(b,a){b.position<a.position&&(a.position+=2);return{opSpecsA:[b],opSpecsB:[a]}},SplitParagraph:function(b,a){b.position<a.sourceParagraphPosition&&(a.sourceParagraphPosition+=2);a.position<=b.position?b.position+=1:(void 0!==
b.length&&a.position<=b.position+b.length&&(b.length+=1),a.position+=2);return{opSpecsA:[b],opSpecsB:[a]}},UpdateMember:g,UpdateMetadata:g,UpdateParagraphStyle:g},AddCursor:{AddCursor:g,AddMember:g,AddStyle:g,ApplyDirectStyling:g,InsertText:g,MergeParagraph:g,MoveCursor:g,RemoveAnnotation:g,RemoveCursor:g,RemoveMember:g,RemoveStyle:g,RemoveText:g,SetParagraphStyle:g,SplitParagraph:g,UpdateMember:g,UpdateMetadata:g,UpdateParagraphStyle:g},AddMember:{AddStyle:g,ApplyDirectStyling:g,InsertText:g,MergeParagraph:g,
MoveCursor:g,RemoveAnnotation:g,RemoveCursor:g,RemoveStyle:g,RemoveText:g,SetParagraphStyle:g,SplitParagraph:g,UpdateMetadata:g,UpdateParagraphStyle:g},AddStyle:{AddStyle:g,ApplyDirectStyling:g,InsertText:g,MergeParagraph:g,MoveCursor:g,RemoveAnnotation:g,RemoveCursor:g,RemoveMember:g,RemoveStyle:function(b,d){var c,f=[b],g=[d];b.styleFamily===d.styleFamily&&(c=a(b.setProperties,d.styleName),0<c.length&&(c={optype:"UpdateParagraphStyle",memberid:d.memberid,timestamp:d.timestamp,styleName:b.styleName,
removedProperties:{attributes:c.join(",")}},g.unshift(c)),e(b.setProperties,d.styleName));return{opSpecsA:f,opSpecsB:g}},RemoveText:g,SetParagraphStyle:g,SplitParagraph:g,UpdateMember:g,UpdateMetadata:g,UpdateParagraphStyle:g},ApplyDirectStyling:{ApplyDirectStyling:function(b,a,e){var f,g,h,k,l,n,w,u;k=[b];h=[a];if(!(b.position+b.length<=a.position||b.position>=a.position+a.length)){f=e?b:a;g=e?a:b;if(b.position!==a.position||b.length!==a.length)n=c(f),w=c(g);a=p(g.setProperties,null,f.setProperties,
null,"style:text-properties");if(a.majorChanged||a.minorChanged)h=[],b=[],k=f.position+f.length,l=g.position+g.length,g.position<f.position?a.minorChanged&&(u=c(w),u.length=f.position-g.position,b.push(u),g.position=f.position,g.length=l-g.position):f.position<g.position&&a.majorChanged&&(u=c(n),u.length=g.position-f.position,h.push(u),f.position=g.position,f.length=k-f.position),l>k?a.minorChanged&&(n=w,n.position=k,n.length=l-k,b.push(n),g.length=k-g.position):k>l&&a.majorChanged&&(n.position=l,
n.length=k-l,h.push(n),f.length=l-f.position),f.setProperties&&q(f.setProperties)&&h.push(f),g.setProperties&&q(g.setProperties)&&b.push(g),e?(k=h,h=b):k=b}return{opSpecsA:k,opSpecsB:h}},InsertText:function(b,a){a.position<=b.position?b.position+=a.text.length:a.position<=b.position+b.length&&(b.length+=a.text.length);return{opSpecsA:[b],opSpecsB:[a]}},MergeParagraph:function(b,a){var c=b.position,e=b.position+b.length;c>=a.sourceStartPosition&&(c-=1);e>=a.sourceStartPosition&&(e-=1);b.position=c;
b.length=e-c;return{opSpecsA:[b],opSpecsB:[a]}},MoveCursor:g,RemoveAnnotation:function(b,a){var c=b.position,e=b.position+b.length,f=a.position+a.length,g=[b],h=[a];a.position<=c&&e<=f?g=[]:(f<c&&(c-=a.length+2),f<e&&(e-=a.length+2),b.position=c,b.length=e-c);return{opSpecsA:g,opSpecsB:h}},RemoveCursor:g,RemoveMember:g,RemoveStyle:g,RemoveText:function(b,a){var c=b.position+b.length,e=a.position+a.length,f=[b],g=[a];e<=b.position?b.position-=a.length:a.position<c&&(b.position<a.position?b.length=
e<c?b.length-a.length:a.position-b.position:(b.position=a.position,e<c?b.length=c-e:f=[]));return{opSpecsA:f,opSpecsB:g}},SetParagraphStyle:g,SplitParagraph:function(b,a){a.position<b.position?b.position+=1:a.position<b.position+b.length&&(b.length+=1);return{opSpecsA:[b],opSpecsB:[a]}},UpdateMember:g,UpdateMetadata:g,UpdateParagraphStyle:g},InsertText:{InsertText:function(b,a,c){b.position<a.position?a.position+=b.text.length:b.position>a.position?b.position+=a.text.length:c?a.position+=b.text.length:
b.position+=a.text.length;return{opSpecsA:[b],opSpecsB:[a]}},MergeParagraph:function(b,a){b.position>=a.sourceStartPosition?b.position-=1:(b.position<a.sourceStartPosition&&(a.sourceStartPosition+=b.text.length),b.position<a.destinationStartPosition&&(a.destinationStartPosition+=b.text.length));return{opSpecsA:[b],opSpecsB:[a]}},MoveCursor:function(b,a){var c=l(a);b.position<a.position?a.position+=b.text.length:b.position<a.position+a.length&&(a.length+=b.text.length);c&&f(a);return{opSpecsA:[b],
opSpecsB:[a]}},RemoveAnnotation:function(b,a){var c=b.position,e=a.position+a.length,f=[b],g=[a];a.position<=c&&c<=e?(f=[],a.length+=b.text.length):e<b.position?b.position-=a.length+2:a.position+=b.text.length;return{opSpecsA:f,opSpecsB:g}},RemoveCursor:g,RemoveMember:g,RemoveStyle:g,RemoveText:function(b,a){var c;c=a.position+a.length;var e=[b],f=[a];c<=b.position?b.position-=a.length:b.position<=a.position?a.position+=b.text.length:(a.length=b.position-a.position,c={optype:"RemoveText",memberid:a.memberid,
timestamp:a.timestamp,position:b.position+b.text.length,length:c-b.position},f.unshift(c),b.position=a.position);return{opSpecsA:e,opSpecsB:f}},SetParagraphStyle:function(b,a){a.position>b.position&&(a.position+=b.text.length);return{opSpecsA:[b],opSpecsB:[a]}},SplitParagraph:function(b,a){b.position<a.sourceParagraphPosition&&(a.sourceParagraphPosition+=b.text.length);b.position<=a.position?a.position+=b.text.length:b.position+=1;return{opSpecsA:[b],opSpecsB:[a]}},UpdateMember:g,UpdateMetadata:g,
UpdateParagraphStyle:g},MergeParagraph:{MergeParagraph:function(b,a,c){var e=[b],f=[a],g;b.destinationStartPosition===a.destinationStartPosition?(e=[],f=[],b.moveCursor&&(g={optype:"MoveCursor",memberid:b.memberid,timestamp:b.timestamp,position:b.sourceStartPosition-1},e.push(g)),a.moveCursor&&(g={optype:"MoveCursor",memberid:a.memberid,timestamp:a.timestamp,position:a.sourceStartPosition-1},f.push(g)),b=c?b:a,b={optype:"SetParagraphStyle",memberid:b.memberid,timestamp:b.timestamp,position:b.destinationStartPosition,
styleName:b.paragraphStyleName},c?e.push(b):f.push(b)):a.sourceStartPosition===b.destinationStartPosition?(b.destinationStartPosition=a.destinationStartPosition,b.sourceStartPosition-=1,b.paragraphStyleName=a.paragraphStyleName):b.sourceStartPosition===a.destinationStartPosition?(a.destinationStartPosition=b.destinationStartPosition,a.sourceStartPosition-=1,a.paragraphStyleName=b.paragraphStyleName):b.destinationStartPosition<a.destinationStartPosition?(a.destinationStartPosition-=1,a.sourceStartPosition-=
1):(b.destinationStartPosition-=1,b.sourceStartPosition-=1);return{opSpecsA:e,opSpecsB:f}},MoveCursor:function(b,a){var c=a.position,e=a.position+a.length,f=Math.min(c,e),c=Math.max(c,e);f>=b.sourceStartPosition&&(f-=1);c>=b.sourceStartPosition&&(c-=1);0<=a.length?(a.position=f,a.length=c-f):(a.position=c,a.length=f-c);return{opSpecsA:[b],opSpecsB:[a]}},RemoveAnnotation:function(b,a){var c=a.position+a.length,e=[b],f=[a];a.position<=b.destinationStartPosition&&b.sourceStartPosition<=c?(e=[],a.length-=
1):b.sourceStartPosition<a.position?a.position-=1:(c<b.destinationStartPosition&&(b.destinationStartPosition-=a.length+2),c<b.sourceStartPosition&&(b.sourceStartPosition-=a.length+2));return{opSpecsA:e,opSpecsB:f}},RemoveCursor:g,RemoveMember:g,RemoveStyle:g,RemoveText:function(b,a){a.position>=b.sourceStartPosition?a.position-=1:(a.position<b.destinationStartPosition&&(b.destinationStartPosition-=a.length),a.position<b.sourceStartPosition&&(b.sourceStartPosition-=a.length));return{opSpecsA:[b],opSpecsB:[a]}},
SetParagraphStyle:function(b,a){var c=[b],e=[a];if(a.position>b.sourceStartPosition)a.position-=1;else if(a.position===b.destinationStartPosition||a.position===b.sourceStartPosition)a.position=b.destinationStartPosition,b.paragraphStyleName=a.styleName;return{opSpecsA:c,opSpecsB:e}},SplitParagraph:function(b,a){var c,e=[b],f=[a];a.position<b.destinationStartPosition?(b.destinationStartPosition+=1,b.sourceStartPosition+=1):a.position>=b.destinationStartPosition&&a.position<b.sourceStartPosition?(a.paragraphStyleName=
b.paragraphStyleName,c={optype:"SetParagraphStyle",memberid:b.memberid,timestamp:b.timestamp,position:b.destinationStartPosition,styleName:b.paragraphStyleName},e.push(c),a.position===b.sourceStartPosition-1&&b.moveCursor&&(c={optype:"MoveCursor",memberid:b.memberid,timestamp:b.timestamp,position:a.position,length:0},e.push(c)),b.destinationStartPosition=a.position+1,b.sourceStartPosition+=1):a.position>=b.sourceStartPosition&&(a.position-=1,a.sourceParagraphPosition-=1);return{opSpecsA:e,opSpecsB:f}},
UpdateMember:g,UpdateMetadata:g,UpdateParagraphStyle:g},MoveCursor:{MoveCursor:g,RemoveAnnotation:function(b,a){var c=l(b),e=b.position+b.length,g=a.position+a.length;a.position<=b.position&&e<=g?(b.position=a.position-1,b.length=0):(g<b.position?b.position-=a.length+2:g<e&&(b.length-=a.length+2),c&&f(b));return{opSpecsA:[b],opSpecsB:[a]}},RemoveCursor:function(b,a){return{opSpecsA:b.memberid===a.memberid?[]:[b],opSpecsB:[a]}},RemoveMember:g,RemoveStyle:g,RemoveText:function(b,a){var c=l(b),e=b.position+
b.length,g=a.position+a.length;g<=b.position?b.position-=a.length:a.position<e&&(b.position<a.position?b.length=g<e?b.length-a.length:a.position-b.position:(b.position=a.position,b.length=g<e?e-g:0));c&&f(b);return{opSpecsA:[b],opSpecsB:[a]}},SetParagraphStyle:g,SplitParagraph:function(b,a){var c=l(b);a.position<b.position?b.position+=1:a.position<b.position+b.length&&(b.length+=1);c&&f(b);return{opSpecsA:[b],opSpecsB:[a]}},UpdateMember:g,UpdateMetadata:g,UpdateParagraphStyle:g},RemoveAnnotation:{RemoveAnnotation:function(b,
a){var c=[b],e=[a];b.position===a.position&&b.length===a.length?(c=[],e=[]):b.position<a.position?a.position-=b.length+2:b.position-=a.length+2;return{opSpecsA:c,opSpecsB:e}},RemoveCursor:g,RemoveMember:g,RemoveStyle:g,RemoveText:function(b,a){var c=b.position+b.length,e=a.position+a.length,f=[b],g=[a];b.position<=a.position&&e<=c?(g=[],b.length-=a.length):e<b.position?b.position-=a.length:a.position<b.position?(b.position=a.position+1,a.length-=b.length+2):a.position-=b.length+2;return{opSpecsA:f,
opSpecsB:g}},SetParagraphStyle:function(b,a){var c=a.position,e=b.position+b.length,f=[b],g=[a];b.position<=c&&c<=e?g=[]:e<c&&(a.position-=b.length+2);return{opSpecsA:f,opSpecsB:g}},SplitParagraph:function(b,a){var c=a.position,e=b.position+b.length,f=[b],g=[a];b.position<=c&&c<=e?(g=[],b.length+=1):(e<a.sourceParagraphPosition&&(a.sourceParagraphPosition-=b.length+2),e<c?a.position-=b.length+2:b.position+=1);return{opSpecsA:f,opSpecsB:g}},UpdateMember:g,UpdateMetadata:g,UpdateParagraphStyle:g},RemoveCursor:{RemoveCursor:function(b,
a){var c=b.memberid===a.memberid;return{opSpecsA:c?[]:[b],opSpecsB:c?[]:[a]}},RemoveMember:g,RemoveStyle:g,RemoveText:g,SetParagraphStyle:g,SplitParagraph:g,UpdateMember:g,UpdateMetadata:g,UpdateParagraphStyle:g},RemoveMember:{RemoveStyle:g,RemoveText:g,SetParagraphStyle:g,SplitParagraph:g,UpdateMetadata:g,UpdateParagraphStyle:g},RemoveStyle:{RemoveStyle:function(b,a){var c=b.styleName===a.styleName&&b.styleFamily===a.styleFamily;return{opSpecsA:c?[]:[b],opSpecsB:c?[]:[a]}},RemoveText:g,SetParagraphStyle:function(b,
a){var c,e=[b],f=[a];"paragraph"===b.styleFamily&&b.styleName===a.styleName&&(c={optype:"SetParagraphStyle",memberid:b.memberid,timestamp:b.timestamp,position:a.position,styleName:""},e.unshift(c),a.styleName="");return{opSpecsA:e,opSpecsB:f}},SplitParagraph:g,UpdateMember:g,UpdateMetadata:g,UpdateParagraphStyle:function(b,c){var f,g=[b],h=[c];"paragraph"===b.styleFamily&&(f=a(c.setProperties,b.styleName),0<f.length&&(f={optype:"UpdateParagraphStyle",memberid:b.memberid,timestamp:b.timestamp,styleName:c.styleName,
removedProperties:{attributes:f.join(",")}},g.unshift(f)),b.styleName===c.styleName?h=[]:e(c.setProperties,b.styleName));return{opSpecsA:g,opSpecsB:h}}},RemoveText:{RemoveText:function(b,a){var c=b.position+b.length,e=a.position+a.length,f=[b],g=[a];e<=b.position?b.position-=a.length:c<=a.position?a.position-=b.length:a.position<c&&(b.position<a.position?(b.length=e<c?b.length-a.length:a.position-b.position,c<e?(a.position=b.position,a.length=e-c):g=[]):(c<e?a.length-=b.length:a.position<b.position?
a.length=b.position-a.position:g=[],e<c?(b.position=a.position,b.length=c-e):f=[]));return{opSpecsA:f,opSpecsB:g}},SetParagraphStyle:function(b,a){b.position<a.position&&(a.position-=b.length);return{opSpecsA:[b],opSpecsB:[a]}},SplitParagraph:function(b,a){var c=b.position+b.length,e=[b],f=[a];a.position<=b.position?b.position+=1:a.position<c&&(b.length=a.position-b.position,c={optype:"RemoveText",memberid:b.memberid,timestamp:b.timestamp,position:a.position+1,length:c-a.position},e.unshift(c));b.position+
b.length<=a.position?a.position-=b.length:b.position<a.position&&(a.position=b.position);b.position+b.length<a.sourceParagraphPosition&&(a.sourceParagraphPosition-=b.length);return{opSpecsA:e,opSpecsB:f}},UpdateMember:g,UpdateMetadata:g,UpdateParagraphStyle:g},SetParagraphStyle:{SetParagraphStyle:function(a,c,e){a.position===c.position&&(e?c.styleName=a.styleName:a.styleName=c.styleName);return{opSpecsA:[a],opSpecsB:[c]}},SplitParagraph:function(a,d){var e=[a],f=[d],g;a.position>d.position?a.position+=
1:a.position===d.sourceParagraphPosition&&(d.paragraphStyleName=a.styleName,g=c(a),g.position=d.position+1,e.push(g));return{opSpecsA:e,opSpecsB:f}},UpdateMember:g,UpdateMetadata:g,UpdateParagraphStyle:g},SplitParagraph:{SplitParagraph:function(a,c,e){var f,g;a.position<c.position?f=!0:c.position<a.position?g=!0:a.position===c.position&&(e?f=!0:g=!0);f?(c.position+=1,c.sourceParagraphPosition=a.position<c.sourceParagraphPosition?c.sourceParagraphPosition+1:a.position+1):g&&(a.position+=1,a.sourceParagraphPosition=
c.position<c.sourceParagraphPosition?a.sourceParagraphPosition+1:c.position+1);return{opSpecsA:[a],opSpecsB:[c]}},UpdateMember:g,UpdateMetadata:g,UpdateParagraphStyle:g},UpdateMember:{UpdateMetadata:g,UpdateParagraphStyle:g},UpdateMetadata:{UpdateMetadata:function(a,c,e){var f,g=[a],h=[c];f=e?a:c;a=e?c:a;k(a.setProperties||null,a.removedProperties||null,f.setProperties||null,f.removedProperties||null);f.setProperties&&q(f.setProperties)||f.removedProperties&&n(f.removedProperties)||(e?g=[]:h=[]);
a.setProperties&&q(a.setProperties)||a.removedProperties&&n(a.removedProperties)||(e?h=[]:g=[]);return{opSpecsA:g,opSpecsB:h}},UpdateParagraphStyle:g},UpdateParagraphStyle:{UpdateParagraphStyle:function(a,c,e){var f,g=[a],h=[c];a.styleName===c.styleName&&(f=e?a:c,a=e?c:a,p(a.setProperties,a.removedProperties,f.setProperties,f.removedProperties,"style:paragraph-properties"),p(a.setProperties,a.removedProperties,f.setProperties,f.removedProperties,"style:text-properties"),k(a.setProperties||null,a.removedProperties||
null,f.setProperties||null,f.removedProperties||null),f.setProperties&&q(f.setProperties)||f.removedProperties&&n(f.removedProperties)||(e?g=[]:h=[]),a.setProperties&&q(a.setProperties)||a.removedProperties&&n(a.removedProperties)||(e?h=[]:g=[]));return{opSpecsA:g,opSpecsB:h}}}};this.passUnchanged=g;this.extendTransformations=function(a){Object.keys(a).forEach(function(c){var e=a[c],f,g=h.hasOwnProperty(c);runtime.log((g?"Extending":"Adding")+" map for optypeA: "+c);g||(h[c]={});f=h[c];Object.keys(e).forEach(function(a){var b=
f.hasOwnProperty(a);runtime.assert(c<=a,"Wrong order:"+c+", "+a);runtime.log("  "+(b?"Overwriting":"Adding")+" entry for optypeB: "+a);f[a]=e[a]})})};this.transformOpspecVsOpspec=function(a,c){var e=a.optype<=c.optype,f;runtime.log("Crosstransforming:");runtime.log(runtime.toJson(a));runtime.log(runtime.toJson(c));e||(f=a,a=c,c=f);(f=(f=h[a.optype])&&f[c.optype])?(f=f(a,c,!e),e||null===f||(f={opSpecsA:f.opSpecsB,opSpecsB:f.opSpecsA})):f=null;runtime.log("result:");f?(runtime.log(runtime.toJson(f.opSpecsA)),
runtime.log(runtime.toJson(f.opSpecsB))):runtime.log("null");return f}};ops.OperationTransformer=function(){function f(a,e){for(var c,k,q=[],n=[];0<a.length&&e;){c=a.shift();c=l.transformOpspecVsOpspec(c,e);if(!c)return null;q=q.concat(c.opSpecsA);if(0===c.opSpecsB.length){q=q.concat(a);e=null;break}for(;1<c.opSpecsB.length;){k=f(a,c.opSpecsB.shift());if(!k)return null;n=n.concat(k.opSpecsB);a=k.opSpecsA}e=c.opSpecsB.pop()}e&&n.push(e);return{opSpecsA:q,opSpecsB:n}}var l=new ops.OperationTransformMatrix;this.getOperationTransformMatrix=function(){return l};this.transform=
function(a,e){for(var c,k=[];0<e.length;){c=f(a,e.shift());if(!c)return null;a=c.opSpecsA;k=k.concat(c.opSpecsB)}return{opSpecsA:a,opSpecsB:k}}};var webodf_css='@namespace draw url(urn:oasis:names:tc:opendocument:xmlns:drawing:1.0);@namespace fo url(urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0);@namespace office url(urn:oasis:names:tc:opendocument:xmlns:office:1.0);@namespace presentation url(urn:oasis:names:tc:opendocument:xmlns:presentation:1.0);@namespace style url(urn:oasis:names:tc:opendocument:xmlns:style:1.0);@namespace svg url(urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0);@namespace table url(urn:oasis:names:tc:opendocument:xmlns:table:1.0);@namespace text url(urn:oasis:names:tc:opendocument:xmlns:text:1.0);@namespace webodfhelper url(urn:webodf:names:helper);@namespace cursor url(urn:webodf:names:cursor);@namespace editinfo url(urn:webodf:names:editinfo);@namespace annotation url(urn:webodf:names:annotation);@namespace dc url(http://purl.org/dc/elements/1.1/);@namespace svgns url(http://www.w3.org/2000/svg);office|document > *, office|document-content > * {display: none;}office|body, office|document {display: inline-block;position: relative;}text|p, text|h {display: block;padding: 0;margin: 0;line-height: normal;position: relative;}text|p::after, text|h::after {content: "\\200B";white-space: pre;}*[webodfhelper|containsparagraphanchor] {position: relative;}text|s {white-space: pre;}text|tab {display: inline;white-space: pre;}text|tracked-changes {display: none;}office|binary-data {display: none;}office|text {display: block;text-align: left;overflow: visible;word-wrap: break-word;}office|text::selection {background: transparent;}.webodf-virtualSelections *::selection {background: transparent;}.webodf-virtualSelections *::-moz-selection {background: transparent;}office|text * draw|text-box {display: block;border: 1px solid #d3d3d3;}office|text draw|frame {z-index: 1;}office|spreadsheet {display: block;border-collapse: collapse;empty-cells: show;font-family: sans-serif;font-size: 10pt;text-align: left;page-break-inside: avoid;overflow: hidden;}office|presentation {display: inline-block;text-align: left;}#shadowContent {display: inline-block;text-align: left;}draw|page {display: block;position: relative;overflow: hidden;}presentation|notes, presentation|footer-decl, presentation|date-time-decl {display: none;}@media print {draw|page {border: 1pt solid black;page-break-inside: avoid;}presentation|notes {}}office|spreadsheet text|p {border: 0px;padding: 1px;margin: 0px;}office|spreadsheet table|table {margin: 3px;}office|spreadsheet table|table:after {}office|spreadsheet table|table-row {counter-increment: row;}office|spreadsheet table|table-row:before {width: 3em;background: #cccccc;border: 1px solid black;text-align: center;content: counter(row);display: table-cell;}office|spreadsheet table|table-cell {border: 1px solid #cccccc;}table|table {display: table;}draw|frame table|table {width: 100%;height: 100%;background: white;}table|table-header-rows {display: table-header-group;}table|table-row {display: table-row;}table|table-column {display: table-column;}table|table-cell {width: 0.889in;display: table-cell;word-break: break-all;}draw|frame {display: block;}draw|image {display: block;width: 100%;height: 100%;top: 0px;left: 0px;background-repeat: no-repeat;background-size: 100% 100%;-moz-background-size: 100% 100%;}draw|frame > draw|image:nth-of-type(n+2) {display: none;}text|list:before {display: none;content:"";}text|list {display: block;}text|list-item {display: block;}text|number {display:none;}text|a {color: blue;text-decoration: underline;cursor: pointer;}.webodf-inactiveLinks text|a {cursor: text;}text|note-citation {vertical-align: super;font-size: smaller;}text|note-body {display: none;}text|note:hover text|note-citation {background: #dddddd;}text|note:hover text|note-body {display: block;left:1em;max-width: 80%;position: absolute;background: #ffffaa;}text|bibliography-source {display: none;}svg|title, svg|desc {display: none;}video {width: 100%;height: 100%}cursor|anchor {display: none;}cursor|cursor {display: none;}.webodf-caretOverlay {position: absolute;top: 5%;height: 1em;z-index: 10;padding-left: 1px;pointer-events: none;}.webodf-caretOverlay .caret {position: absolute;border-left: 2px solid black;top: 0;bottom: 0;right: 0;}.webodf-caretOverlay .handle {position: absolute;margin-top: 5px;padding-top: 3px;margin-left: auto;margin-right: auto;width: 64px;height: 68px;border-radius: 5px;opacity: 0.3;text-align: center;background-color: black;box-shadow: 0px 0px 5px rgb(90, 90, 90);border: 1px solid black;top: -85px;right: -32px;}.webodf-caretOverlay .handle > img {box-shadow: 0px 0px 5px rgb(90, 90, 90) inset;background-color: rgb(200, 200, 200);border-radius: 5px;border: 2px solid;height: 60px;width: 60px;display: block;margin: auto;}.webodf-caretOverlay .handle.active {opacity: 0.8;}.webodf-caretOverlay .handle:after {content: " ";position: absolute;width: 0px;height: 0px;border-style: solid;border-width: 8.7px 5px 0 5px;border-color: black transparent transparent transparent;top: 100%;left: 43%;}.webodf-caretSizer {display: inline-block;width: 0;visibility: hidden;}#eventTrap {display: block;position: absolute;bottom: 0;left: 0;outline: none;opacity: 0;color: rgba(255, 255, 255, 0);pointer-events: none;white-space: pre;overflow: hidden;}cursor|cursor > #composer {text-decoration: underline;}cursor|cursor[cursor|caret-sizer-active="true"],cursor|cursor[cursor|composing="true"] {display: inline;}editinfo|editinfo {display: inline-block;}.editInfoMarker {position: absolute;width: 10px;height: 100%;left: -20px;opacity: 0.8;top: 0;border-radius: 5px;background-color: transparent;box-shadow: 0px 0px 5px rgba(50, 50, 50, 0.75);}.editInfoMarker:hover {box-shadow: 0px 0px 8px rgba(0, 0, 0, 1);}.editInfoHandle {position: absolute;background-color: black;padding: 5px;border-radius: 5px;opacity: 0.8;box-shadow: 0px 0px 5px rgba(50, 50, 50, 0.75);bottom: 100%;margin-bottom: 10px;z-index: 3;left: -25px;}.editInfoHandle:after {content: " ";position: absolute;width: 0px;height: 0px;border-style: solid;border-width: 8.7px 5px 0 5px;border-color: black transparent transparent transparent;top: 100%;left: 5px;}.editInfo {font-family: sans-serif;font-weight: normal;font-style: normal;text-decoration: none;color: white;width: 100%;height: 12pt;}.editInfoColor {float: left;width: 10pt;height: 10pt;border: 1px solid white;}.editInfoAuthor {float: left;margin-left: 5pt;font-size: 10pt;text-align: left;height: 12pt;line-height: 12pt;}.editInfoTime {float: right;margin-left: 30pt;font-size: 8pt;font-style: italic;color: yellow;height: 12pt;line-height: 12pt;}.annotationWrapper {display: inline;position: relative;}.annotationRemoveButton:before {content: "\u00d7";color: white;padding: 5px;line-height: 1em;}.annotationRemoveButton {width: 20px;height: 20px;border-radius: 10px;background-color: black;box-shadow: 0px 0px 5px rgba(50, 50, 50, 0.75);position: absolute;top: -10px;left: -10px;z-index: 3;text-align: center;font-family: sans-serif;font-style: normal;font-weight: normal;text-decoration: none;font-size: 15px;}.annotationRemoveButton:hover {cursor: pointer;box-shadow: 0px 0px 5px rgba(0, 0, 0, 1);}.annotationNote {width: 4cm;position: absolute;display: inline;z-index: 10;top: 0;}.annotationNote > office|annotation {display: block;text-align: left;}.annotationConnector {position: absolute;display: inline;top: 0;z-index: 2;border-top: 1px dashed brown;}.annotationConnector.angular {-moz-transform-origin: left top;-webkit-transform-origin: left top;-ms-transform-origin: left top;transform-origin: left top;}.annotationConnector.horizontal {left: 0;}.annotationConnector.horizontal:before {content: "";display: inline;position: absolute;width: 0px;height: 0px;border-style: solid;border-width: 8.7px 5px 0 5px;border-color: brown transparent transparent transparent;top: -1px;left: -5px;}office|annotation {width: 100%;height: 100%;display: none;background: rgb(198, 238, 184);background: -moz-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: -webkit-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: -o-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: -ms-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: linear-gradient(180deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);box-shadow: 0 3px 4px -3px #ccc;}office|annotation > dc|creator {display: block;font-size: 10pt;font-weight: normal;font-style: normal;font-family: sans-serif;color: white;background-color: brown;padding: 4px;}office|annotation > dc|date {display: block;font-size: 10pt;font-weight: normal;font-style: normal;font-family: sans-serif;border: 4px solid transparent;color: black;}office|annotation > text|list {display: block;padding: 5px;}office|annotation text|p {font-size: 10pt;color: black;font-weight: normal;font-style: normal;text-decoration: none;font-family: sans-serif;}#annotationsPane {background-color: #EAEAEA;width: 4cm;height: 100%;display: none;position: absolute;outline: 1px solid #ccc;}.webodf-annotationHighlight {background-color: yellow;position: relative;}.webodf-selectionOverlay {position: absolute;pointer-events: none;top: 0;left: 0;top: 0;left: 0;width: 100%;height: 100%;z-index: 15;}.webodf-selectionOverlay > polygon {fill-opacity: 0.3;stroke-opacity: 0.8;stroke-width: 1;fill-rule: evenodd;}.webodf-selectionOverlay > .webodf-draggable {fill-opacity: 0.8;stroke-opacity: 0;stroke-width: 8;pointer-events: all;display: none;-moz-transform-origin: center center;-webkit-transform-origin: center center;-ms-transform-origin: center center;transform-origin: center center;}#imageSelector {display: none;position: absolute;border-style: solid;border-color: black;}#imageSelector > div {width: 5px;height: 5px;display: block;position: absolute;border: 1px solid black;background-color: #ffffff;}#imageSelector > .topLeft {top: -4px;left: -4px;}#imageSelector > .topRight {top: -4px;right: -4px;}#imageSelector > .bottomRight {right: -4px;bottom: -4px;}#imageSelector > .bottomLeft {bottom: -4px;left: -4px;}#imageSelector > .topMiddle {top: -4px;left: 50%;margin-left: -2.5px;}#imageSelector > .rightMiddle {top: 50%;right: -4px;margin-top: -2.5px;}#imageSelector > .bottomMiddle {bottom: -4px;left: 50%;margin-left: -2.5px;}#imageSelector > .leftMiddle {top: 50%;left: -4px;margin-top: -2.5px;}div.webodf-customScrollbars::-webkit-scrollbar{width: 8px;height: 8px;background-color: transparent;}div.webodf-customScrollbars::-webkit-scrollbar-track{background-color: transparent;}div.webodf-customScrollbars::-webkit-scrollbar-thumb{background-color: #444;border-radius: 4px;}.webodf-hyperlinkTooltip {display: none;color: white;background-color: black;border-radius: 5px;box-shadow: 2px 2px 5px gray;padding: 3px;position: absolute;max-width: 210px;text-align: left;word-break: break-all;z-index: 16;}.webodf-hyperlinkTooltipText {display: block;font-weight: bold;}';
