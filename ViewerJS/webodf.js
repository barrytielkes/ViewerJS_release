/*

 This is a generated file. DO NOT EDIT.

 Copyright (C) 2010-2015 KO GmbH <copyright@kogmbh.com>

 @licstart
 This file is the compiled version of the WebODF library.

 WebODF is free software: you can redistribute it and/or modify it
 under the terms of the GNU Affero General Public License (GNU AGPL)
 as published by the Free Software Foundation, either version 3 of
 the License, or (at your option) any later version.

 WebODF is distributed in the hope that it will be useful, but
 WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU Affero General Public License for more details.

 You should have received a copy of the GNU Affero General Public License
 along with WebODF.  If not, see <http://www.gnu.org/licenses/>.
 @licend

 @source: http://www.webodf.org/
 @source: https://github.com/kogmbh/WebODF/
*/
var webodf_version="0.5.7-47-g7aa5eb1-dirty";function Runtime(){}Runtime.prototype.getVariable=function(f){};Runtime.prototype.toJson=function(f){};Runtime.prototype.fromJson=function(f){};Runtime.prototype.byteArrayFromString=function(f,k){};Runtime.prototype.byteArrayToString=function(f,k){};Runtime.prototype.read=function(f,k,a,d){};Runtime.prototype.readFile=function(f,k,a){};Runtime.prototype.readFileSync=function(f,k){};Runtime.prototype.loadXML=function(f,k){};Runtime.prototype.writeFile=function(f,k,a){};
Runtime.prototype.deleteFile=function(f,k){};Runtime.prototype.log=function(f,k){};Runtime.prototype.setTimeout=function(f,k){};Runtime.prototype.clearTimeout=function(f){};Runtime.prototype.libraryPaths=function(){};Runtime.prototype.currentDirectory=function(){};Runtime.prototype.setCurrentDirectory=function(f){};Runtime.prototype.type=function(){};Runtime.prototype.getDOMImplementation=function(){};Runtime.prototype.parseXML=function(f){};Runtime.prototype.exit=function(f){};
Runtime.prototype.getWindow=function(){};Runtime.prototype.requestAnimationFrame=function(f){};Runtime.prototype.cancelAnimationFrame=function(f){};Runtime.prototype.assert=function(f,k){};var IS_COMPILED_CODE=!0;
Runtime.byteArrayToString=function(f,k){function a(a){var h="",d,p=a.length;for(d=0;d<p;d+=1)h+=String.fromCharCode(a[d]&255);return h}function d(d){var h="",a,p=d.length,n=[],g,e,b,r;for(a=3<=p&&239===d[0]&&187===d[1]&&191===d[2]?3:0;a<p;a+=1)g=d[a],128>g?n.push(g):(a+=1,e=d[a],194<=g&&224>g?n.push((g&31)<<6|e&63):(a+=1,b=d[a],224<=g&&240>g?n.push((g&15)<<12|(e&63)<<6|b&63):(a+=1,r=d[a],240<=g&&245>g&&(g=(g&7)<<18|(e&63)<<12|(b&63)<<6|r&63,g-=65536,n.push((g>>10)+55296,(g&1023)+56320))))),1E3<=n.length&&
(h+=String.fromCharCode.apply(null,n),n.length=0);return h+String.fromCharCode.apply(null,n)}var c;"utf8"===k?c=d(f):("binary"!==k&&this.log("Unsupported encoding: "+k),c=a(f));return c};Runtime.getVariable=function(f){try{return eval(f)}catch(k){}};Runtime.toJson=function(f){return JSON.stringify(f)};Runtime.fromJson=function(f){return JSON.parse(f)};Runtime.getFunctionName=function(f){return void 0===f.name?(f=/function\s+(\w+)/.exec(f))&&f[1]:f.name};
Runtime.assert=function(f,k){if(!f)throw this.log("alert","ASSERTION FAILED:\n"+k),Error(k);};
function BrowserRuntime(){function f(a){var n=a.length,g,e,b=0;for(g=0;g<n;g+=1)e=a.charCodeAt(g),b+=1+(128<e)+(2048<e),55040<e&&57344>e&&(b+=1,g+=1);return b}function k(a,n,g){var e=a.length,b,r;n=new Uint8Array(new ArrayBuffer(n));g?(n[0]=239,n[1]=187,n[2]=191,r=3):r=0;for(g=0;g<e;g+=1)b=a.charCodeAt(g),128>b?(n[r]=b,r+=1):2048>b?(n[r]=192|b>>>6,n[r+1]=128|b&63,r+=2):55040>=b||57344<=b?(n[r]=224|b>>>12&15,n[r+1]=128|b>>>6&63,n[r+2]=128|b&63,r+=3):(g+=1,b=(b-55296<<10|a.charCodeAt(g)-56320)+65536,
n[r]=240|b>>>18&7,n[r+1]=128|b>>>12&63,n[r+2]=128|b>>>6&63,n[r+3]=128|b&63,r+=4);return n}function a(a){var n=a.length,g=new Uint8Array(new ArrayBuffer(n)),e;for(e=0;e<n;e+=1)g[e]=a.charCodeAt(e)&255;return g}function d(a,n){var g;void 0!==n?g=a:n=a;console.log(n);q.enableAlerts&&"alert"===g&&alert(n)}function c(d,n,g){if(0!==g.status||g.responseText)if(200===g.status||0===g.status){if(g.response&&"string"!==typeof g.response)"binary"===n?(g=g.response,g=new Uint8Array(g)):g=String(g.response);else if("binary"===
n)if(null!==g.responseBody&&"undefined"!==String(typeof VBArray)){g=(new VBArray(g.responseBody)).toArray();var e=g.length;n=new Uint8Array(new ArrayBuffer(e));for(d=0;d<e;d+=1)n[d]=g[d];g=n}else{(d=g.getResponseHeader("Content-Length"))&&(d=parseInt(d,10));if(d&&d!==g.responseText.length)a:{e=g.responseText;n=!1;var b=f(e);if("number"===typeof d){if(d!==b&&d!==b+3){e=void 0;break a}n=b+3===d;b=d}e=k(e,b,n)}void 0===e&&(e=a(g.responseText));g=e}else g=g.responseText;g={err:null,data:g}}else g={err:g.responseText||
g.statusText,data:null};else g={err:"File "+d+" is empty.",data:null};return g}function m(a,d,g){var e=new XMLHttpRequest;e.open("GET",a,g);e.overrideMimeType&&("binary"!==d?e.overrideMimeType("text/plain; charset="+d):e.overrideMimeType("text/plain; charset=x-user-defined"));return e}function h(d,a,g){var e=m(d,a,!0);e.onreadystatechange=function(){var b;4===e.readyState&&(b=c(d,a,e),g(b.err,b.data))};try{e.send(null)}catch(b){g(b.message,null)}}var q=this;this.byteArrayFromString=function(d,h){var g;
"utf8"===h?g=k(d,f(d),!1):("binary"!==h&&q.log("unknown encoding: "+h),g=a(d));return g};this.byteArrayToString=Runtime.byteArrayToString;this.getVariable=Runtime.getVariable;this.fromJson=Runtime.fromJson;this.toJson=Runtime.toJson;this.readFile=h;this.read=function(d,a,g,e){h(d,"binary",function(b,r){var l=null;if(r){if("string"===typeof r)throw"This should not happen.";l=r.subarray(a,a+g)}e(b,l)})};this.readFileSync=function(d,a){var g=m(d,a,!1),e;try{g.send(null);e=c(d,a,g);if(e.err)throw e.err;
if(null===e.data)throw"No data read from "+d+".";}catch(b){throw b;}return e.data};this.writeFile=function(d,a,g){var e=new XMLHttpRequest,b;e.open("PUT",d,!0);e.onreadystatechange=function(){4===e.readyState&&(0!==e.status||e.responseText?200<=e.status&&300>e.status||0===e.status?g(null):g("Status "+String(e.status)+": "+e.responseText||e.statusText):g("File "+d+" is empty."))};b=a.buffer&&!e.sendAsBinary?a.buffer:q.byteArrayToString(a,"binary");try{e.sendAsBinary?e.sendAsBinary(b):e.send(b)}catch(r){q.log("HUH? "+
r+" "+a),g(r.message)}};this.deleteFile=function(d,a){var g=new XMLHttpRequest;g.open("DELETE",d,!0);g.onreadystatechange=function(){4===g.readyState&&(200>g.status&&300<=g.status?a(g.responseText):a(null))};g.send(null)};this.loadXML=function(d,a){var g=new XMLHttpRequest;g.open("GET",d,!0);g.overrideMimeType&&g.overrideMimeType("text/xml");g.onreadystatechange=function(){4===g.readyState&&(0!==g.status||g.responseText?200===g.status||0===g.status?a(null,g.responseXML):a(g.responseText,null):a("File "+
d+" is empty.",null))};try{g.send(null)}catch(e){a(e.message,null)}};this.log=d;this.enableAlerts=!0;this.assert=Runtime.assert;this.setTimeout=function(a,d){return setTimeout(function(){a()},d)};this.clearTimeout=function(a){clearTimeout(a)};this.libraryPaths=function(){return["lib"]};this.setCurrentDirectory=function(){};this.currentDirectory=function(){return""};this.type=function(){return"BrowserRuntime"};this.getDOMImplementation=function(){return window.document.implementation};this.parseXML=
function(a){return(new DOMParser).parseFromString(a,"text/xml")};this.exit=function(a){d("Calling exit with code "+String(a)+", but exit() is not implemented.")};this.getWindow=function(){return window};this.requestAnimationFrame=function(a){var d=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,g=0;if(d)d.bind(window),g=d(a);else return setTimeout(a,15);return g};this.cancelAnimationFrame=function(a){var d=window.cancelAnimationFrame||
window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame;d?(d.bind(window),d(a)):clearTimeout(a)}}
function NodeJSRuntime(){function f(a){var d=a.length,g,e=new Uint8Array(new ArrayBuffer(d));for(g=0;g<d;g+=1)e[g]=a[g];return e}function k(a,h,g){function e(b,e){if(b)return g(b,null);if(!e)return g("No data for "+a+".",null);if("string"===typeof e)return g(b,e);g(b,f(e))}a=c.resolve(m,a);"binary"!==h?d.readFile(a,h,e):d.readFile(a,null,e)}var a=this,d=require("fs"),c=require("path"),m="",h,q;this.byteArrayFromString=function(a,d){var h=new Buffer(a,d),e,b=h.length,r=new Uint8Array(new ArrayBuffer(b));
for(e=0;e<b;e+=1)r[e]=h[e];return r};this.byteArrayToString=Runtime.byteArrayToString;this.getVariable=Runtime.getVariable;this.fromJson=Runtime.fromJson;this.toJson=Runtime.toJson;this.readFile=k;this.loadXML=function(d,h){k(d,"utf-8",function(g,e){if(g)return h(g,null);if(!e)return h("No data for "+d+".",null);h(null,a.parseXML(e))})};this.writeFile=function(a,h,g){h=new Buffer(h);a=c.resolve(m,a);d.writeFile(a,h,"binary",function(e){g(e||null)})};this.deleteFile=function(a,h){a=c.resolve(m,a);
d.unlink(a,h)};this.read=function(a,h,g,e){a=c.resolve(m,a);d.open(a,"r+",666,function(b,r){if(b)e(b,null);else{var l=new Buffer(g);d.read(r,l,0,g,h,function(b){d.close(r);e(b,f(l))})}})};this.readFileSync=function(a,h){var g;g=d.readFileSync(a,"binary"===h?null:h);if(null===g)throw"File "+a+" could not be read.";"binary"===h&&(g=f(g));return g};this.log=function(a,d){var h;void 0!==d?h=a:d=a;"alert"===h&&process.stderr.write("\n!!!!! ALERT !!!!!\n");process.stderr.write(d+"\n");"alert"===h&&process.stderr.write("!!!!! ALERT !!!!!\n")};
this.assert=Runtime.assert;this.setTimeout=function(a,d){return setTimeout(function(){a()},d)};this.clearTimeout=function(a){clearTimeout(a)};this.libraryPaths=function(){return[__dirname]};this.setCurrentDirectory=function(a){m=a};this.currentDirectory=function(){return m};this.type=function(){return"NodeJSRuntime"};this.getDOMImplementation=function(){return q};this.parseXML=function(a){return h.parseFromString(a,"text/xml")};this.exit=process.exit;this.getWindow=function(){return null};this.requestAnimationFrame=
function(a){return setTimeout(a,15)};this.cancelAnimationFrame=function(a){clearTimeout(a)};h=new (require("xmldom").DOMParser);q=a.parseXML("<a/>").implementation}
function RhinoRuntime(){var f=this,k={},a=k.javax.xml.parsers.DocumentBuilderFactory.newInstance(),d,c,m="";a.setValidating(!1);a.setNamespaceAware(!0);a.setExpandEntityReferences(!1);a.setSchema(null);c=k.org.xml.sax.EntityResolver({resolveEntity:function(a,d){var c=new k.java.io.FileReader(d);return new k.org.xml.sax.InputSource(c)}});d=a.newDocumentBuilder();d.setEntityResolver(c);this.byteArrayFromString=function(a,d){var c,m=a.length,g=new Uint8Array(new ArrayBuffer(m));for(c=0;c<m;c+=1)g[c]=
a.charCodeAt(c)&255;return g};this.byteArrayToString=Runtime.byteArrayToString;this.getVariable=Runtime.getVariable;this.fromJson=Runtime.fromJson;this.toJson=Runtime.toJson;this.loadXML=function(a,c){var m=new k.java.io.File(a),n=null;try{n=d.parse(m)}catch(g){return print(g),c(g,null)}c(null,n)};this.readFile=function(a,d,c){m&&(a=m+"/"+a);var n=new k.java.io.File(a),g="binary"===d?"latin1":d;n.isFile()?((a=readFile(a,g))&&"binary"===d&&(a=f.byteArrayFromString(a,"binary")),c(null,a)):c(a+" is not a file.",
null)};this.writeFile=function(a,d,c){m&&(a=m+"/"+a);a=new k.java.io.FileOutputStream(a);var n,g=d.length;for(n=0;n<g;n+=1)a.write(d[n]);a.close();c(null)};this.deleteFile=function(a,d){m&&(a=m+"/"+a);var c=new k.java.io.File(a),n=a+Math.random(),n=new k.java.io.File(n);c.rename(n)?(n.deleteOnExit(),d(null)):d("Could not delete "+a)};this.read=function(a,d,c,n){m&&(a=m+"/"+a);var g;g=a;var e="binary";(new k.java.io.File(g)).isFile()?("binary"===e&&(e="latin1"),g=readFile(g,e)):g=null;g?n(null,this.byteArrayFromString(g.substring(d,
d+c),"binary")):n("Cannot read "+a,null)};this.readFileSync=function(a,d){if(!d)return"";var c=readFile(a,d);if(null===c)throw"File could not be read.";return c};this.log=function(a,d){var c;void 0!==d?c=a:d=a;"alert"===c&&print("\n!!!!! ALERT !!!!!");print(d);"alert"===c&&print("!!!!! ALERT !!!!!")};this.assert=Runtime.assert;this.setTimeout=function(a){a();return 0};this.clearTimeout=function(){};this.libraryPaths=function(){return["lib"]};this.setCurrentDirectory=function(a){m=a};this.currentDirectory=
function(){return m};this.type=function(){return"RhinoRuntime"};this.getDOMImplementation=function(){return d.getDOMImplementation()};this.parseXML=function(a){a=new k.java.io.StringReader(a);a=new k.org.xml.sax.InputSource(a);return d.parse(a)};this.exit=quit;this.getWindow=function(){return null};this.requestAnimationFrame=function(a){a();return 0};this.cancelAnimationFrame=function(){}}
Runtime.create=function(){return"undefined"!==String(typeof window)?new BrowserRuntime:"undefined"!==String(typeof require)?new NodeJSRuntime:new RhinoRuntime};var runtime=Runtime.create(),core={},gui={},xmldom={},odf={},ops={},webodf={};(function(){webodf.Version="undefined"!==String(typeof webodf_version)?webodf_version:"From Source"})();
(function(){function f(a,d,c){var g=a+"/manifest.json",e,b;runtime.log("Loading manifest: "+g);try{e=runtime.readFileSync(g,"utf-8")}catch(r){if(c)runtime.log("No loadable manifest found.");else throw console.log(String(r)),r;return}c=JSON.parse(e);for(b in c)c.hasOwnProperty(b)&&(d[b]={dir:a,deps:c[b]})}function k(a,d,c){function g(l){if(!r[l]&&!c(l)){if(b[l])throw"Circular dependency detected for "+l+".";b[l]=!0;if(!d[l])throw"Missing dependency information for class "+l+".";var a=d[l],h=a.deps,
m,q=h.length;for(m=0;m<q;m+=1)g(h[m]);b[l]=!1;r[l]=!0;e.push(a.dir+"/"+l.replace(".","/")+".js")}}var e=[],b={},r={};a.forEach(g);return e}function a(a,d){return d+("\n//# sourceURL="+a)}function d(d){var c,h;for(c=0;c<d.length;c+=1)h=runtime.readFileSync(d[c],"utf-8"),h=a(d[c],h),eval(h)}function c(a){a=a.split(".");var d,c=h,g=a.length;for(d=0;d<g;d+=1){if(!c.hasOwnProperty(a[d]))return!1;c=c[a[d]]}return!0}var m,h={core:core,gui:gui,xmldom:xmldom,odf:odf,ops:ops};runtime.loadClasses=function(a,
h){if(IS_COMPILED_CODE||0===a.length)return h&&h();var n;if(!(n=m)){n=[];var g=runtime.libraryPaths(),e;runtime.currentDirectory()&&-1===g.indexOf(runtime.currentDirectory())&&f(runtime.currentDirectory(),n,!0);for(e=0;e<g.length;e+=1)f(g[e],n)}m=n;a=k(a,m,c);if(0===a.length)return h&&h();if("BrowserRuntime"===runtime.type()&&h){n=a;g=document.currentScript||document.documentElement.lastChild;e=document.createDocumentFragment();var b,r;for(r=0;r<n.length;r+=1)b=document.createElement("script"),b.type=
"text/javascript",b.charset="utf-8",b.async=!1,b.setAttribute("src",n[r]),e.appendChild(b);h&&(b.onload=h);g.parentNode.insertBefore(e,g)}else d(a),h&&h()};runtime.loadClass=function(a,d){runtime.loadClasses([a],d)}})();(function(){var f=function(f){return f};runtime.getTranslator=function(){return f};runtime.setTranslator=function(k){f=k};runtime.tr=function(k){var a=f(k);return a&&"string"===String(typeof a)?a:k}})();
(function(f){function k(a){if(a.length){var d=a[0];runtime.readFile(d,"utf8",function(c,m){function h(){var a;(a=eval(f))&&runtime.exit(a)}var q="",q=d.lastIndexOf("/"),f=m,q=-1!==q?d.substring(0,q):".";runtime.setCurrentDirectory(q);c?(runtime.log(c),runtime.exit(1)):null===f?(runtime.log("No code found for "+d),runtime.exit(1)):h.apply(null,a)})}}f=f?Array.prototype.slice.call(f):[];"NodeJSRuntime"===runtime.type()?k(process.argv.slice(2)):"RhinoRuntime"===runtime.type()?k(f):k(f.slice(1))})("undefined"!==
String(typeof arguments)&&arguments);(function(){core.Async=function(){return{forEach:function(f,k,a){function d(d){h!==m&&(d?(h=m,a(d)):(h+=1,h===m&&a(null)))}var c,m=f.length,h=0;for(c=0;c<m;c+=1)k(f[c],d)},destroyAll:function(f,k){function a(d,c){if(c)k(c);else if(d<f.length)f[d](function(c){a(d+1,c)});else k()}a(0,void 0)}}}()})();function makeBase64(){function f(e){var b,l=e.length,r=new Uint8Array(new ArrayBuffer(l));for(b=0;b<l;b+=1)r[b]=e.charCodeAt(b)&255;return r}function k(b){var e,l="",r,a=b.length-2;for(r=0;r<a;r+=3)e=b[r]<<16|b[r+1]<<8|b[r+2],l+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e>>>18],l+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e>>>12&63],l+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e>>>6&63],l+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e&
63];r===a+1?(e=b[r]<<4,l+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e>>>6],l+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e&63],l+="=="):r===a&&(e=b[r]<<10|b[r+1]<<2,l+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e>>>12],l+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e>>>6&63],l+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e&63],l+="=");return l}function a(e){e=e.replace(/[^A-Za-z0-9+\/]+/g,
"");var b=e.length,r=new Uint8Array(new ArrayBuffer(3*b)),a=e.length%4,d=0,c,B;for(c=0;c<b;c+=4)B=(l[e.charAt(c)]||0)<<18|(l[e.charAt(c+1)]||0)<<12|(l[e.charAt(c+2)]||0)<<6|(l[e.charAt(c+3)]||0),r[d]=B>>16,r[d+1]=B>>8&255,r[d+2]=B&255,d+=3;b=3*b-[0,0,2,1][a];return r.subarray(0,b)}function d(e){var b,l,r=e.length,a=0,d=new Uint8Array(new ArrayBuffer(3*r));for(b=0;b<r;b+=1)l=e[b],128>l?d[a++]=l:(2048>l?d[a++]=192|l>>>6:(d[a++]=224|l>>>12&15,d[a++]=128|l>>>6&63),d[a++]=128|l&63);return d.subarray(0,
a)}function c(e){var b,l,r,a,d=e.length,B=new Uint8Array(new ArrayBuffer(d)),c=0;for(b=0;b<d;b+=1)l=e[b],128>l?B[c++]=l:(b+=1,r=e[b],224>l?B[c++]=(l&31)<<6|r&63:(b+=1,a=e[b],B[c++]=(l&15)<<12|(r&63)<<6|a&63));return B.subarray(0,c)}function m(b){return k(f(b))}function h(b){return String.fromCharCode.apply(String,a(b))}function q(b){return c(f(b))}function p(b){b=c(b);for(var e="",l=0;l<b.length;)e+=String.fromCharCode.apply(String,b.subarray(l,l+45E3)),l+=45E3;return e}function n(b,e,l){var r,a,
d,B="";for(d=e;d<l;d+=1)e=b.charCodeAt(d)&255,128>e?B+=String.fromCharCode(e):(d+=1,r=b.charCodeAt(d)&255,224>e?B+=String.fromCharCode((e&31)<<6|r&63):(d+=1,a=b.charCodeAt(d)&255,B+=String.fromCharCode((e&15)<<12|(r&63)<<6|a&63)));return B}function g(b,e){function l(){var d=a+1E5;d>b.length&&(d=b.length);r+=n(b,a,d);a=d;d=a===b.length;e(r,d)&&!d&&runtime.setTimeout(l,0)}var r="",a=0;1E5>b.length?e(n(b,0,b.length),!0):("string"!==typeof b&&(b=b.slice()),l())}function e(b){return d(f(b))}function b(b){return String.fromCharCode.apply(String,
d(b))}function r(b){return String.fromCharCode.apply(String,d(f(b)))}var l=function(b){var e={},l,r;l=0;for(r=b.length;l<r;l+=1)e[b.charAt(l)]=l;return e}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),y,t,z=runtime.getWindow(),w,s;z&&z.btoa?(w=z.btoa,y=function(b){return w(r(b))}):(w=m,y=function(b){return k(e(b))});z&&z.atob?(s=z.atob,t=function(b){b=s(b);return n(b,0,b.length)}):(s=h,t=function(b){return p(a(b))});core.Base64=function(){this.convertByteArrayToBase64=this.convertUTF8ArrayToBase64=
k;this.convertBase64ToByteArray=this.convertBase64ToUTF8Array=a;this.convertUTF16ArrayToByteArray=this.convertUTF16ArrayToUTF8Array=d;this.convertByteArrayToUTF16Array=this.convertUTF8ArrayToUTF16Array=c;this.convertUTF8StringToBase64=m;this.convertBase64ToUTF8String=h;this.convertUTF8StringToUTF16Array=q;this.convertByteArrayToUTF16String=this.convertUTF8ArrayToUTF16String=p;this.convertUTF8StringToUTF16String=g;this.convertUTF16StringToByteArray=this.convertUTF16StringToUTF8Array=e;this.convertUTF16ArrayToUTF8String=
b;this.convertUTF16StringToUTF8String=r;this.convertUTF16StringToBase64=y;this.convertBase64ToUTF16String=t;this.fromBase64=h;this.toBase64=m;this.atob=s;this.btoa=w;this.utob=r;this.btou=g;this.encode=y;this.encodeURI=function(b){return y(b).replace(/[+\/]/g,function(b){return"+"===b?"-":"_"}).replace(/\\=+$/,"")};this.decode=function(b){return t(b.replace(/[\-_]/g,function(b){return"-"===b?"+":"/"}))};return this};return core.Base64}core.Base64=makeBase64();core.ByteArray=function(f){this.pos=0;this.data=f;this.readUInt32LE=function(){this.pos+=4;var f=this.data,a=this.pos;return f[--a]<<24|f[--a]<<16|f[--a]<<8|f[--a]};this.readUInt16LE=function(){this.pos+=2;var f=this.data,a=this.pos;return f[--a]<<8|f[--a]}};core.ByteArrayWriter=function(f){function k(a){a>c-d&&(c=Math.max(2*c,d+a),a=new Uint8Array(new ArrayBuffer(c)),a.set(m),m=a)}var a=this,d=0,c=1024,m=new Uint8Array(new ArrayBuffer(c));this.appendByteArrayWriter=function(d){a.appendByteArray(d.getByteArray())};this.appendByteArray=function(a){var c=a.length;k(c);m.set(a,d);d+=c};this.appendArray=function(a){var c=a.length;k(c);m.set(a,d);d+=c};this.appendUInt16LE=function(d){a.appendArray([d&255,d>>8&255])};this.appendUInt32LE=function(d){a.appendArray([d&
255,d>>8&255,d>>16&255,d>>24&255])};this.appendString=function(d){a.appendByteArray(runtime.byteArrayFromString(d,f))};this.getLength=function(){return d};this.getByteArray=function(){var a=new Uint8Array(new ArrayBuffer(d));a.set(m.subarray(0,d));return a}};core.CSSUnits=function(){var f=this,k={"in":1,cm:2.54,mm:25.4,pt:72,pc:12,px:96};this.convert=function(a,d,c){return a*k[c]/k[d]};this.convertMeasure=function(a,d){var c,m;a&&d&&(c=parseFloat(a),m=a.replace(c.toString(),""),c=f.convert(c,m,d));return c};this.getUnits=function(a){return a.substr(a.length-2,a.length)}};(function(){function f(){var d,c,m,h,f,k,n,g,e;void 0===a&&(c=(d=runtime.getWindow())&&d.document,k=c.documentElement,n=c.body,a={rangeBCRIgnoresElementBCR:!1,unscaledRangeClientRects:!1,elementBCRIgnoresBodyScroll:!1},c&&(h=c.createElement("div"),h.style.position="absolute",h.style.left="-99999px",h.style.transform="scale(2)",h.style["-webkit-transform"]="scale(2)",f=c.createElement("div"),h.appendChild(f),n.appendChild(h),d=c.createRange(),d.selectNode(f),a.rangeBCRIgnoresElementBCR=0===d.getClientRects().length,
f.appendChild(c.createTextNode("Rect transform test")),c=f.getBoundingClientRect(),m=d.getBoundingClientRect(),a.unscaledRangeClientRects=2<Math.abs(c.height-m.height),h.style.transform="",h.style["-webkit-transform"]="",c=k.style.overflow,m=n.style.overflow,g=n.style.height,e=n.scrollTop,k.style.overflow="visible",n.style.overflow="visible",n.style.height="200%",n.scrollTop=n.scrollHeight,a.elementBCRIgnoresBodyScroll=d.getBoundingClientRect().top!==f.getBoundingClientRect().top,n.scrollTop=e,n.style.height=
g,n.style.overflow=m,k.style.overflow=c,d.detach(),n.removeChild(h),d=Object.keys(a).map(function(b){return b+":"+String(a[b])}).join(", "),runtime.log("Detected browser quirks - "+d)));return a}function k(a,c,m){for(a=a?a.firstElementChild:null;a;){if(a.localName===m&&a.namespaceURI===c)return a;a=a.nextElementSibling}return null}var a;core.DomUtilsImpl=function(){function a(b,e){for(var d=0,c;b.parentNode!==e;)runtime.assert(null!==b.parentNode,"parent is null"),b=b.parentNode;for(c=e.firstChild;c!==
b;)d+=1,c=c.nextSibling;return d}function c(b,e){return 0>=b.compareBoundaryPoints(Range.START_TO_START,e)&&0<=b.compareBoundaryPoints(Range.END_TO_END,e)}function m(b,e){return 0>=b.compareBoundaryPoints(Range.END_TO_START,e)&&0<=b.compareBoundaryPoints(Range.START_TO_END,e)}function h(b,e){var a=null;b.nodeType===Node.TEXT_NODE&&(0===b.length?(b.parentNode.removeChild(b),e.nodeType===Node.TEXT_NODE&&(a=e)):(e.nodeType===Node.TEXT_NODE&&(b.appendData(e.data),e.parentNode.removeChild(e)),a=b));return a}
function q(b){for(var e=b.parentNode;b.firstChild;)e.insertBefore(b.firstChild,b);e.removeChild(b);return e}function p(b,e){var a=b.parentNode,d=b.firstChild,c=e(b),g;if(c===NodeFilter.FILTER_SKIP)return a;for(;d;)g=d.nextSibling,p(d,e),d=g;a&&c===NodeFilter.FILTER_REJECT&&q(b);return a}function n(b,e){return b===e||Boolean(b.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)}function g(b,e){return f().unscaledRangeClientRects?b:b/e}function e(b,l,a){Object.keys(l).forEach(function(d){var c=
d.split(":"),g=c[1],h=a(c[0]),c=l[d],m=typeof c;"object"===m?Object.keys(c).length&&(d=h?b.getElementsByTagNameNS(h,g)[0]||b.ownerDocument.createElementNS(h,d):b.getElementsByTagName(g)[0]||b.ownerDocument.createElement(d),b.appendChild(d),e(d,c,a)):h&&(runtime.assert("number"===m||"string"===m,"attempting to map unsupported type '"+m+"' (key: "+d+")"),b.setAttributeNS(h,d,String(c)))})}var b=null;this.splitBoundaries=function(b){var e,c=[],g,h,m;if(b.startContainer.nodeType===Node.TEXT_NODE||b.endContainer.nodeType===
Node.TEXT_NODE){g=b.endContainer;h=b.endContainer.nodeType!==Node.TEXT_NODE?b.endOffset===b.endContainer.childNodes.length:!1;m=b.endOffset;e=b.endContainer;if(m<e.childNodes.length)for(e=e.childNodes.item(m),m=0;e.firstChild;)e=e.firstChild;else for(;e.lastChild;)e=e.lastChild,m=e.nodeType===Node.TEXT_NODE?e.textContent.length:e.childNodes.length;e===g&&(g=null);b.setEnd(e,m);m=b.endContainer;0!==b.endOffset&&m.nodeType===Node.TEXT_NODE&&(e=m,b.endOffset!==e.length&&(c.push(e.splitText(b.endOffset)),
c.push(e)));m=b.startContainer;0!==b.startOffset&&m.nodeType===Node.TEXT_NODE&&(e=m,b.startOffset!==e.length&&(m=e.splitText(b.startOffset),c.push(e),c.push(m),b.setStart(m,0)));if(null!==g){for(m=b.endContainer;m.parentNode&&m.parentNode!==g;)m=m.parentNode;h=h?g.childNodes.length:a(m,g);b.setEnd(g,h)}}return c};this.containsRange=c;this.rangesIntersect=m;this.rangeIntersection=function(b,e){var a;m(b,e)&&(a=b.cloneRange(),-1===b.compareBoundaryPoints(Range.START_TO_START,e)&&a.setStart(e.startContainer,
e.startOffset),1===b.compareBoundaryPoints(Range.END_TO_END,e)&&a.setEnd(e.endContainer,e.endOffset));return a};this.getNodesInRange=function(b,e,a){var d=[],c=b.commonAncestorContainer,c=c.nodeType===Node.TEXT_NODE?c.parentNode:c;a=b.startContainer.ownerDocument.createTreeWalker(c,a,e,!1);var g,h;b.endContainer.childNodes[b.endOffset-1]?(g=b.endContainer.childNodes[b.endOffset-1],h=Node.DOCUMENT_POSITION_PRECEDING|Node.DOCUMENT_POSITION_CONTAINED_BY):(g=b.endContainer,h=Node.DOCUMENT_POSITION_PRECEDING);
b.startContainer.childNodes[b.startOffset]?(b=b.startContainer.childNodes[b.startOffset],a.currentNode=b):b.startOffset===(b.startContainer.nodeType===Node.TEXT_NODE?b.startContainer.length:b.startContainer.childNodes.length)?(b=b.startContainer,a.currentNode=b,a.lastChild(),b=a.nextNode()):(b=b.startContainer,a.currentNode=b);if(b){b=a.currentNode;if(b!==c)for(b=b.parentNode;b&&b!==c;)e(b)===NodeFilter.FILTER_REJECT&&(a.currentNode=b),b=b.parentNode;b=a.currentNode;switch(e(b)){case NodeFilter.FILTER_REJECT:for(b=
a.nextSibling();!b&&a.parentNode();)b=a.nextSibling();break;case NodeFilter.FILTER_SKIP:b=a.nextNode()}for(;b;){e=g.compareDocumentPosition(b);if(0!==e&&0===(e&h))break;d.push(b);b=a.nextNode()}}return d};this.normalizeTextNodes=function(b){b&&b.nextSibling&&(b=h(b,b.nextSibling));b&&b.previousSibling&&h(b.previousSibling,b)};this.rangeContainsNode=function(b,e){var a=e.ownerDocument.createRange(),d=e.ownerDocument.createRange(),g;a.setStart(b.startContainer,b.startOffset);a.setEnd(b.endContainer,
b.endOffset);d.selectNodeContents(e);g=c(a,d);a.detach();d.detach();return g};this.mergeIntoParent=q;this.removeUnwantedNodes=p;this.removeAllChildNodes=function(b){for(;b.firstChild;)b.removeChild(b.firstChild)};this.getElementsByTagNameNS=function(b,e,a){var d=[];b=b.getElementsByTagNameNS(e,a);d.length=a=b.length;for(e=0;e<a;e+=1)d[e]=b.item(e);return d};this.getElementsByTagName=function(b,e){var a=[],d,c,g;d=b.getElementsByTagName(e);a.length=g=d.length;for(c=0;c<g;c+=1)a[c]=d.item(c);return a};
this.containsNode=function(b,e){return b===e||b.contains(e)};this.comparePoints=function(b,e,c,g){if(b===c)return g-e;var h=b.compareDocumentPosition(c);2===h?h=-1:4===h?h=1:10===h?(e=a(b,c),h=e<g?1:-1):(g=a(c,b),h=g<e?-1:1);return h};this.adaptRangeDifferenceToZoomLevel=g;this.translateRect=function(b,e,a){return{top:g(b.top-e.top,a),left:g(b.left-e.left,a),bottom:g(b.bottom-e.top,a),right:g(b.right-e.left,a),width:g(b.width,a),height:g(b.height,a)}};this.getBoundingClientRect=function(e){var a=
e.ownerDocument,d=f(),c=a.body;if((!1===d.unscaledRangeClientRects||d.rangeBCRIgnoresElementBCR)&&e.nodeType===Node.ELEMENT_NODE)return e=e.getBoundingClientRect(),d.elementBCRIgnoresBodyScroll?{left:e.left+c.scrollLeft,right:e.right+c.scrollLeft,top:e.top+c.scrollTop,bottom:e.bottom+c.scrollTop,width:e.width,height:e.height}:e;var g;b?g=b:b=g=a.createRange();d=g;d.selectNode(e);return d.getBoundingClientRect()};this.mapKeyValObjOntoNode=function(b,e,a){Object.keys(e).forEach(function(d){var c=d.split(":"),
g=c[1],c=a(c[0]),h=e[d];c?(g=b.getElementsByTagNameNS(c,g)[0],g||(g=b.ownerDocument.createElementNS(c,d),b.appendChild(g)),g.textContent=h):runtime.log("Key ignored: "+d)})};this.removeKeyElementsFromNode=function(b,e,a){e.forEach(function(e){var l=e.split(":"),d=l[1];(l=a(l[0]))?(d=b.getElementsByTagNameNS(l,d)[0])?d.parentNode.removeChild(d):runtime.log("Element for "+e+" not found."):runtime.log("Property Name ignored: "+e)})};this.getKeyValRepresentationOfNode=function(b,e){for(var a={},d=b.firstElementChild,
c;d;){if(c=e(d.namespaceURI))a[c+":"+d.localName]=d.textContent;d=d.nextElementSibling}return a};this.mapObjOntoNode=e;this.cloneEvent=function(b){var e=Object.create(null);Object.keys(b).forEach(function(a){e[a]=b[a]});e.prototype=b.constructor.prototype;return e};this.getDirectChild=k;(function(b){var e,a;a=runtime.getWindow();null!==a&&(e=a.navigator.appVersion.toLowerCase(),a=-1===e.indexOf("chrome")&&(-1!==e.indexOf("applewebkit")||-1!==e.indexOf("safari")),e=-1!==e.indexOf("msie")||-1!==e.indexOf("trident"),
a||e)&&(b.containsNode=n)})(this)};core.DomUtils=new core.DomUtilsImpl})();core.Cursor=function(f,k){function a(e){e.parentNode&&(q.push(e.previousSibling),q.push(e.nextSibling),e.parentNode.removeChild(e))}function d(e,b,a){if(b.nodeType===Node.TEXT_NODE){runtime.assert(Boolean(b),"putCursorIntoTextNode: invalid container");var d=b.parentNode;runtime.assert(Boolean(d),"putCursorIntoTextNode: container without parent");runtime.assert(0<=a&&a<=b.length,"putCursorIntoTextNode: offset is out of bounds");0===a?d.insertBefore(e,b):(a!==b.length&&b.splitText(a),d.insertBefore(e,
b.nextSibling))}else b.nodeType===Node.ELEMENT_NODE&&b.insertBefore(e,b.childNodes.item(a));q.push(e.previousSibling);q.push(e.nextSibling)}var c=f.createElementNS("urn:webodf:names:cursor","cursor"),m=f.createElementNS("urn:webodf:names:cursor","anchor"),h,q=[],p=f.createRange(),n,g=core.DomUtils;this.getNode=function(){return c};this.getAnchorNode=function(){return m.parentNode?m:c};this.getSelectedRange=function(){n?(p.setStartBefore(c),p.collapse(!0)):(p.setStartAfter(h?m:c),p.setEndBefore(h?
c:m));return p};this.setSelectedRange=function(e,b){p&&p!==e&&p.detach();p=e;h=!1!==b;(n=e.collapsed)?(a(m),a(c),d(c,e.startContainer,e.startOffset)):(a(m),a(c),d(h?c:m,e.endContainer,e.endOffset),d(h?m:c,e.startContainer,e.startOffset));q.forEach(g.normalizeTextNodes);q.length=0};this.hasForwardSelection=function(){return h};this.remove=function(){a(c);q.forEach(g.normalizeTextNodes);q.length=0};c.setAttributeNS("urn:webodf:names:cursor","memberId",k);m.setAttributeNS("urn:webodf:names:cursor","memberId",
k)};core.Destroyable=function(){};core.Destroyable.prototype.destroy=function(f){};core.EventSource=function(){};core.EventSource.prototype.subscribe=function(f,k){};core.EventSource.prototype.unsubscribe=function(f,k){};core.EventNotifier=function(f){function k(d){runtime.assert(!a.hasOwnProperty(d),'Duplicated event ids: "'+d+'" registered more than once.');a[d]=[]}var a={};this.emit=function(d,c){var m,h;runtime.assert(a.hasOwnProperty(d),'unknown event fired "'+d+'"');h=a[d];for(m=0;m<h.length;m+=1)h[m](c)};this.subscribe=function(d,c){runtime.assert(a.hasOwnProperty(d),'tried to subscribe to unknown event "'+d+'"');a[d].push(c)};this.unsubscribe=function(d,c){var m;runtime.assert(a.hasOwnProperty(d),'tried to unsubscribe from unknown event "'+
d+'"');m=a[d].indexOf(c);runtime.assert(-1!==m,'tried to unsubscribe unknown callback from event "'+d+'"');-1!==m&&a[d].splice(m,1)};this.register=k;f&&f.forEach(k)};core.ScheduledTask=function(f,k,a){function d(){h&&(a(m),h=!1)}function c(){d();f.apply(void 0,q);q=null}var m,h=!1,q=[],p=!1;this.trigger=function(){runtime.assert(!1===p,"Can't trigger destroyed ScheduledTask instance");q=Array.prototype.slice.call(arguments);h||(h=!0,m=k(c))};this.triggerImmediate=function(){runtime.assert(!1===p,"Can't trigger destroyed ScheduledTask instance");q=Array.prototype.slice.call(arguments);c()};this.processRequests=function(){h&&c()};this.cancel=d;this.restart=function(){runtime.assert(!1===
p,"Can't trigger destroyed ScheduledTask instance");d();h=!0;m=k(c)};this.destroy=function(a){d();p=!0;a()}};(function(){var f;core.Task={};core.Task.SUPPRESS_MANUAL_PROCESSING=!1;core.Task.processTasks=function(){core.Task.SUPPRESS_MANUAL_PROCESSING||f.performRedraw()};core.Task.createRedrawTask=function(k){return new core.ScheduledTask(k,f.requestRedrawTask,f.cancelRedrawTask)};core.Task.createTimeoutTask=function(f,a){return new core.ScheduledTask(f,function(d){return runtime.setTimeout(d,a)},runtime.clearTimeout)};f=new function(){var f={};this.requestRedrawTask=function(a){var d=runtime.requestAnimationFrame(function(){a();
delete f[d]});f[d]=a;return d};this.performRedraw=function(){Object.keys(f).forEach(function(a){f[a]();runtime.cancelAnimationFrame(parseInt(a,10))});f={}};this.cancelRedrawTask=function(a){runtime.cancelAnimationFrame(a);delete f[a]}}})();core.EventSubscriptions=function(){function f(d,c,m){d.subscribe(c,m);a.push({eventSource:d,eventid:c,callback:m})}function k(){var h=[];a.forEach(function(a){a.eventSource.unsubscribe(a.eventid,a.callback)});a.length=0;Object.keys(c).forEach(function(a){c[a].forEach(function(a){h.push(a.task.destroy)});delete c[a]});core.Async.destroyAll(h,function(){});d=new core.EventNotifier}var a=[],d=new core.EventNotifier,c={},m=0;this.addSubscription=f;this.addFrameSubscription=function(a,q,k){var n,g,e,b;
c.hasOwnProperty(q)||(c[q]=[]);e=c[q];for(b=0;b<e.length;b+=1)if(e[b].eventSource===a){n=e[b];break}n||(g="s"+m,m+=1,d.register(g),n={frameEventId:g,eventSource:a,task:core.Task.createRedrawTask(function(){d.emit(g,void 0)})},e.push(n),f(a,q,n.task.trigger));d.subscribe(n.frameEventId,k)};this.unsubscribeAll=k;this.destroy=function(a){k();a()}};core.LazyProperty=function(f){var k,a=!1;this.value=function(){a||(k=f(),a=!0);return k};this.reset=function(){a=!1}};core.LoopWatchDog=function(f,k){var a=Date.now(),d=0;this.check=function(){var c;if(f&&(c=Date.now(),c-a>f))throw runtime.log("alert","watchdog timeout"),"timeout!";if(0<k&&(d+=1,d>k))throw runtime.log("alert","watchdog loop overflow"),"loop overflow";}};core.NodeFilterChain=function(f){var k=NodeFilter.FILTER_REJECT,a=NodeFilter.FILTER_ACCEPT;this.acceptNode=function(d){var c;for(c=0;c<f.length;c+=1)if(f[c].acceptNode(d)===k)return k;return a}};core.PositionIterator=function(f,k,a,d){function c(){this.acceptNode=function(b){return!b||b.nodeType===r&&0===b.length?t:y}}function m(b){this.acceptNode=function(e){return!e||e.nodeType===r&&0===e.length?t:b.acceptNode(e)}}function h(){var b=g.currentNode,a=b.nodeType;e=a===r?b.length-1:a===l?1:0}function q(){if(null===g.previousSibling()){if(!g.parentNode()||g.currentNode===f)return g.firstChild(),!1;e=0}else h();return!0}function p(){var a=g.currentNode,d;d=b(a);if(a!==f)for(a=a.parentNode;a&&
a!==f;)b(a)===t&&(g.currentNode=a,d=t),a=a.parentNode;d===t?(e=g.currentNode.nodeType===r?a.length:1,a=n.nextPosition()):a=d===y?!0:n.nextPosition();a&&runtime.assert(b(g.currentNode)===y,"moveToAcceptedNode did not result in walker being on an accepted node");return a}var n=this,g,e,b,r=Node.TEXT_NODE,l=Node.ELEMENT_NODE,y=NodeFilter.FILTER_ACCEPT,t=NodeFilter.FILTER_REJECT;this.nextPosition=function(){var b=g.currentNode,a=b.nodeType;if(b===f)return!1;if(0===e&&a===l)null===g.firstChild()&&(e=1);
else if(a===r&&e+1<b.length)e+=1;else if(null!==g.nextSibling())e=0;else if(g.parentNode())e=1;else return!1;return!0};this.previousPosition=function(){var b=!0,a=g.currentNode;0===e?b=q():a.nodeType===r?e-=1:null!==g.lastChild()?h():a===f?b=!1:e=0;return b};this.previousNode=q;this.container=function(){var b=g.currentNode,a=b.nodeType;0===e&&a!==r&&(b=b.parentNode);return b};this.rightNode=function(){var a=g.currentNode,d=a.nodeType;if(d===r&&e===a.length)for(a=a.nextSibling;a&&b(a)!==y;)a=a.nextSibling;
else d===l&&1===e&&(a=null);return a};this.leftNode=function(){var a=g.currentNode;if(0===e)for(a=a.previousSibling;a&&b(a)!==y;)a=a.previousSibling;else if(a.nodeType===l)for(a=a.lastChild;a&&b(a)!==y;)a=a.previousSibling;return a};this.getCurrentNode=function(){return g.currentNode};this.unfilteredDomOffset=function(){if(g.currentNode.nodeType===r)return e;for(var b=0,a=g.currentNode,a=1===e?a.lastChild:a.previousSibling;a;)b+=1,a=a.previousSibling;return b};this.getPreviousSibling=function(){var b=
g.currentNode,e=g.previousSibling();g.currentNode=b;return e};this.getNextSibling=function(){var b=g.currentNode,e=g.nextSibling();g.currentNode=b;return e};this.setPositionBeforeElement=function(b){runtime.assert(Boolean(b),"setPositionBeforeElement called without element");g.currentNode=b;e=0;return p()};this.setUnfilteredPosition=function(b,a){runtime.assert(Boolean(b),"PositionIterator.setUnfilteredPosition called without container");g.currentNode=b;b.nodeType===r?(e=a,runtime.assert(a<=b.length,
"Error in setPosition: "+a+" > "+b.length),runtime.assert(0<=a,"Error in setPosition: "+a+" < 0"),a===b.length&&(g.nextSibling()?e=0:g.parentNode()?e=1:runtime.assert(!1,"Error in setUnfilteredPosition: position not valid."))):a<b.childNodes.length?(g.currentNode=b.childNodes.item(a),e=0):e=1;return p()};this.moveToEnd=function(){g.currentNode=f;e=1};this.moveToEndOfNode=function(b){b.nodeType===r?n.setUnfilteredPosition(b,b.length):(g.currentNode=b,e=1)};this.isBeforeNode=function(){return 0===e};
this.getNodeFilter=function(){return b};b=(a?new m(a):new c).acceptNode;b.acceptNode=b;k=k||NodeFilter.SHOW_ALL;runtime.assert(f.nodeType!==Node.TEXT_NODE,"Internet Explorer doesn't allow tree walker roots to be text nodes");g=f.ownerDocument.createTreeWalker(f,k,b,d);e=0;null===g.firstChild()&&(e=1)};core.PositionFilter=function(){};core.PositionFilter.FilterResult={FILTER_ACCEPT:1,FILTER_REJECT:2,FILTER_SKIP:3};core.PositionFilter.prototype.acceptPosition=function(f){};core.PositionFilterChain=function(){var f=[],k=core.PositionFilter.FilterResult.FILTER_ACCEPT,a=core.PositionFilter.FilterResult.FILTER_REJECT;this.acceptPosition=function(d){var c;for(c=0;c<f.length;c+=1)if(f[c].acceptPosition(d)===a)return a;return k};this.addFilter=function(a){f.push(a)}};(function(){core.RawInflate=function(){var f;(function(k){f=k()})(function(){return function a(d,c,m){function h(f,n){if(!c[f]){if(!d[f])throw Error("Cannot find module '"+f+"'");var g=c[f]={exports:{}};d[f][0].call(g.exports,function(e){var b=d[f][1][e];return h(b?b:e)},g,g.exports,a,d,c,m)}return c[f].exports}for(var f=0;f<m.length;f++)h(m[f]);return h}({1:[function(a,d,c){function m(b,e){var a=new r(e);a.push(b,!0);if(a.err)throw a.msg;return a.result}var h=a("./zlib/inflate.js"),f=a("./utils/common"),
p=a("./utils/strings"),n=a("./zlib/constants"),g=a("./zlib/messages"),e=a("./zlib/zstream"),b=a("./zlib/gzheader"),r=function(a){var d=this.options=f.assign({chunkSize:16384,windowBits:0,to:""},a||{});d.raw&&0<=d.windowBits&&16>d.windowBits&&(d.windowBits=-d.windowBits,0===d.windowBits&&(d.windowBits=-15));!(0<=d.windowBits&&16>d.windowBits)||a&&a.windowBits||(d.windowBits+=32);15<d.windowBits&&48>d.windowBits&&0===(d.windowBits&15)&&(d.windowBits|=15);this.err=0;this.msg="";this.ended=!1;this.chunks=
[];this.strm=new e;this.strm.avail_out=0;a=h.inflateInit2(this.strm,d.windowBits);if(a!==n.Z_OK)throw Error(g[a]);this.header=new b;h.inflateGetHeader(this.strm,this.header)};r.prototype.push=function(b,e){var a=this.strm,d=this.options.chunkSize,c,r,g,m,A;if(this.ended)return!1;r=e===~~e?e:!0===e?n.Z_FINISH:n.Z_NO_FLUSH;a.input="string"===typeof b?p.binstring2buf(b):b;a.next_in=0;a.avail_in=a.input.length;do{0===a.avail_out&&(a.output=new f.Buf8(d),a.next_out=0,a.avail_out=d);c=h.inflate(a,n.Z_NO_FLUSH);
if(c!==n.Z_STREAM_END&&c!==n.Z_OK)return this.onEnd(c),this.ended=!0,!1;if(a.next_out&&(0===a.avail_out||c===n.Z_STREAM_END||0===a.avail_in&&r===n.Z_FINISH))if("string"===this.options.to)g=p.utf8border(a.output,a.next_out),m=a.next_out-g,A=p.buf2string(a.output,g),a.next_out=m,a.avail_out=d-m,m&&f.arraySet(a.output,a.output,g,m,0),this.onData(A);else this.onData(f.shrinkBuf(a.output,a.next_out))}while((0<a.avail_in||0===a.avail_out)&&c!==n.Z_STREAM_END);c===n.Z_STREAM_END&&(r=n.Z_FINISH);return r===
n.Z_FINISH?(c=h.inflateEnd(this.strm),this.onEnd(c),this.ended=!0,c===n.Z_OK):!0};r.prototype.onData=function(b){this.chunks.push(b)};r.prototype.onEnd=function(b){b===n.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):f.flattenChunks(this.chunks));this.chunks=[];this.err=b;this.msg=this.strm.msg};c.Inflate=r;c.inflate=m;c.inflateRaw=function(b,e){e=e||{};e.raw=!0;return m(b,e)};c.ungzip=m},{"./utils/common":2,"./utils/strings":3,"./zlib/constants":5,"./zlib/gzheader":7,"./zlib/inflate.js":9,
"./zlib/messages":11,"./zlib/zstream":12}],2:[function(a,d,c){a="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Int32Array;c.assign=function(a){for(var d=Array.prototype.slice.call(arguments,1);d.length;){var c=d.shift();if(c){if("object"!==typeof c)throw new TypeError(c+"must be non-object");for(var g in c)c.hasOwnProperty(g)&&(a[g]=c[g])}}return a};c.shrinkBuf=function(a,d){if(a.length===d)return a;if(a.subarray)return a.subarray(0,d);a.length=d;return a};
var m={arraySet:function(a,d,c,g,e){if(d.subarray&&a.subarray)a.set(d.subarray(c,c+g),e);else for(var b=0;b<g;b++)a[e+b]=d[c+b]},flattenChunks:function(a){var d,c,g,e,b;d=g=0;for(c=a.length;d<c;d++)g+=a[d].length;b=new Uint8Array(g);d=g=0;for(c=a.length;d<c;d++)e=a[d],b.set(e,g),g+=e.length;return b}},h={arraySet:function(a,d,c,g,e){for(var b=0;b<g;b++)a[e+b]=d[c+b]},flattenChunks:function(a){return[].concat.apply([],a)}};c.setTyped=function(a){a?(c.Buf8=Uint8Array,c.Buf16=Uint16Array,c.Buf32=Int32Array,
c.assign(c,m)):(c.Buf8=Array,c.Buf16=Array,c.Buf32=Array,c.assign(c,h))};c.setTyped(a)},{}],3:[function(a,d,c){function m(b,e){if(65537>e&&(b.subarray&&p||!b.subarray&&f))return String.fromCharCode.apply(null,h.shrinkBuf(b,e));for(var a="",d=0;d<e;d++)a+=String.fromCharCode(b[d]);return a}var h=a("./common"),f=!0,p=!0;try{String.fromCharCode.apply(null,[0])}catch(n){f=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(g){p=!1}var e=new h.Buf8(256);for(a=0;256>a;a++)e[a]=252<=a?6:248<=
a?5:240<=a?4:224<=a?3:192<=a?2:1;e[254]=e[254]=1;c.string2buf=function(b){var e,a,d,c,g,m=b.length,f=0;for(c=0;c<m;c++)a=b.charCodeAt(c),55296===(a&64512)&&c+1<m&&(d=b.charCodeAt(c+1),56320===(d&64512)&&(a=65536+(a-55296<<10)+(d-56320),c++)),f+=128>a?1:2048>a?2:65536>a?3:4;e=new h.Buf8(f);for(c=g=0;g<f;c++)a=b.charCodeAt(c),55296===(a&64512)&&c+1<m&&(d=b.charCodeAt(c+1),56320===(d&64512)&&(a=65536+(a-55296<<10)+(d-56320),c++)),128>a?e[g++]=a:(2048>a?e[g++]=192|a>>>6:(65536>a?e[g++]=224|a>>>12:(e[g++]=
240|a>>>18,e[g++]=128|a>>>12&63),e[g++]=128|a>>>6&63),e[g++]=128|a&63);return e};c.buf2binstring=function(b){return m(b,b.length)};c.binstring2buf=function(b){for(var e=new h.Buf8(b.length),a=0,d=e.length;a<d;a++)e[a]=b.charCodeAt(a);return e};c.buf2string=function(b,a){var d,c,g,h,f=a||b.length,n=Array(2*f);for(d=c=0;d<f;)if(g=b[d++],128>g)n[c++]=g;else if(h=e[g],4<h)n[c++]=65533,d+=h-1;else{for(g&=2===h?31:3===h?15:7;1<h&&d<f;)g=g<<6|b[d++]&63,h--;1<h?n[c++]=65533:65536>g?n[c++]=g:(g-=65536,n[c++]=
55296|g>>10&1023,n[c++]=56320|g&1023)}return m(n,c)};c.utf8border=function(b,a){var d;a=a||b.length;a>b.length&&(a=b.length);for(d=a-1;0<=d&&128===(b[d]&192);)d--;return 0>d||0===d?a:d+e[b[d]]>a?d:a}},{"./common":2}],4:[function(a,d,c){d.exports=function(a,d,c,f){var n=a&65535|0;a=a>>>16&65535|0;for(var g=0;0!==c;){g=2E3<c?2E3:c;c-=g;do n=n+d[f++]|0,a=a+n|0;while(--g);n%=65521;a%=65521}return n|a<<16|0}},{}],5:[function(a,d,c){d.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,
Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],6:[function(a,d,c){var m=function(){for(var a,d=[],c=0;256>c;c++){a=c;for(var m=0;8>m;m++)a=a&1?3988292384^a>>>1:a>>>1;d[c]=a}return d}();d.exports=function(a,d,c,f){c=f+c;for(a^=
-1;f<c;f++)a=a>>>8^m[(a^d[f])&255];return a^-1}},{}],7:[function(a,d,c){d.exports=function(){this.os=this.xflags=this.time=this.text=0;this.extra=null;this.extra_len=0;this.comment=this.name="";this.hcrc=0;this.done=!1}},{}],8:[function(a,d,c){d.exports=function(a,d){var c,f,n,g,e,b,r,l,y,t,z,w,s,x,u,A,H,C,G,B,J,P,Q,D;c=a.state;f=a.next_in;Q=a.input;n=f+(a.avail_in-5);g=a.next_out;D=a.output;e=g-(d-a.avail_out);b=g+(a.avail_out-257);r=c.dmax;l=c.wsize;y=c.whave;t=c.wnext;z=c.window;w=c.hold;s=c.bits;
x=c.lencode;u=c.distcode;A=(1<<c.lenbits)-1;H=(1<<c.distbits)-1;a:do b:for(15>s&&(w+=Q[f++]<<s,s+=8,w+=Q[f++]<<s,s+=8),C=x[w&A];;){G=C>>>24;w>>>=G;s-=G;G=C>>>16&255;if(0===G)D[g++]=C&65535;else if(G&16){B=C&65535;if(G&=15)s<G&&(w+=Q[f++]<<s,s+=8),B+=w&(1<<G)-1,w>>>=G,s-=G;15>s&&(w+=Q[f++]<<s,s+=8,w+=Q[f++]<<s,s+=8);C=u[w&H];c:for(;;){G=C>>>24;w>>>=G;s-=G;G=C>>>16&255;if(G&16){C&=65535;G&=15;s<G&&(w+=Q[f++]<<s,s+=8,s<G&&(w+=Q[f++]<<s,s+=8));C+=w&(1<<G)-1;if(C>r){a.msg="invalid distance too far back";
c.mode=30;break a}w>>>=G;s-=G;G=g-e;if(C>G){G=C-G;if(G>y&&c.sane){a.msg="invalid distance too far back";c.mode=30;break a}J=0;P=z;if(0===t){if(J+=l-G,G<B){B-=G;do D[g++]=z[J++];while(--G);J=g-C;P=D}}else if(t<G){if(J+=l+t-G,G-=t,G<B){B-=G;do D[g++]=z[J++];while(--G);J=0;if(t<B){G=t;B-=G;do D[g++]=z[J++];while(--G);J=g-C;P=D}}}else if(J+=t-G,G<B){B-=G;do D[g++]=z[J++];while(--G);J=g-C;P=D}for(;2<B;)D[g++]=P[J++],D[g++]=P[J++],D[g++]=P[J++],B-=3;B&&(D[g++]=P[J++],1<B&&(D[g++]=P[J++]))}else{J=g-C;do D[g++]=
D[J++],D[g++]=D[J++],D[g++]=D[J++],B-=3;while(2<B);B&&(D[g++]=D[J++],1<B&&(D[g++]=D[J++]))}}else if(0===(G&64)){C=u[(C&65535)+(w&(1<<G)-1)];continue c}else{a.msg="invalid distance code";c.mode=30;break a}break}}else if(0===(G&64)){C=x[(C&65535)+(w&(1<<G)-1)];continue b}else{G&32?c.mode=12:(a.msg="invalid literal/length code",c.mode=30);break a}break}while(f<n&&g<b);B=s>>3;f-=B;s-=B<<3;a.next_in=f;a.next_out=g;a.avail_in=f<n?5+(n-f):5-(f-n);a.avail_out=g<b?257+(b-g):257-(g-b);c.hold=w&(1<<s)-1;c.bits=
s}},{}],9:[function(a,d,c){function m(b){return(b>>>24&255)+(b>>>8&65280)+((b&65280)<<8)+((b&255)<<24)}function h(){this.mode=0;this.last=!1;this.wrap=0;this.havedict=!1;this.total=this.check=this.dmax=this.flags=0;this.head=null;this.wnext=this.whave=this.wsize=this.wbits=0;this.window=null;this.extra=this.offset=this.length=this.bits=this.hold=0;this.distcode=this.lencode=null;this.have=this.ndist=this.nlen=this.ncode=this.distbits=this.lenbits=0;this.next=null;this.lens=new e.Buf16(320);this.work=
new e.Buf16(288);this.distdyn=this.lendyn=null;this.was=this.back=this.sane=0}function f(b){var a;if(!b||!b.state)return z;a=b.state;b.total_in=b.total_out=a.total=0;b.msg="";a.wrap&&(b.adler=a.wrap&1);a.mode=w;a.last=0;a.havedict=0;a.dmax=32768;a.head=null;a.hold=0;a.bits=0;a.lencode=a.lendyn=new e.Buf32(s);a.distcode=a.distdyn=new e.Buf32(x);a.sane=1;a.back=-1;return t}function p(b){var e;if(!b||!b.state)return z;e=b.state;e.wsize=0;e.whave=0;e.wnext=0;return f(b)}function n(b,e){var a,d;if(!b||
!b.state)return z;d=b.state;0>e?(a=0,e=-e):(a=(e>>4)+1,48>e&&(e&=15));if(e&&(8>e||15<e))return z;null!==d.window&&d.wbits!==e&&(d.window=null);d.wrap=a;d.wbits=e;return p(b)}function g(b,e){var a;if(!b)return z;a=new h;b.state=a;a.window=null;a=n(b,e);a!==t&&(b.state=null);return a}var e=a("../utils/common"),b=a("./adler32"),r=a("./crc32"),l=a("./inffast"),y=a("./inftrees"),t=0,z=-2,w=1,s=852,x=592,u=!0,A,H;c.inflateReset=p;c.inflateReset2=n;c.inflateResetKeep=f;c.inflateInit=function(b){return g(b,
15)};c.inflateInit2=g;c.inflate=function(a,d){var c,g,h,f,n,q,p,v,s,x,T,F,N,$;F=0;var E,V,aa,ca,U,W=new e.Buf8(4),O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!a||!a.state||!a.output||!a.input&&0!==a.avail_in)return z;c=a.state;12===c.mode&&(c.mode=13);n=a.next_out;h=a.output;p=a.avail_out;f=a.next_in;g=a.input;q=a.avail_in;v=c.hold;s=c.bits;x=q;T=p;U=t;a:for(;;)switch(c.mode){case w:if(0===c.wrap){c.mode=13;break}for(;16>s;){if(0===q)break a;q--;v+=g[f++]<<s;s+=8}if(c.wrap&2&&35615===v){c.check=
0;W[0]=v&255;W[1]=v>>>8&255;c.check=r(c.check,W,2,0);s=v=0;c.mode=2;break}c.flags=0;c.head&&(c.head.done=!1);if(!(c.wrap&1)||(((v&255)<<8)+(v>>8))%31){a.msg="incorrect header check";c.mode=30;break}if(8!==(v&15)){a.msg="unknown compression method";c.mode=30;break}v>>>=4;s-=4;N=(v&15)+8;if(0===c.wbits)c.wbits=N;else if(N>c.wbits){a.msg="invalid window size";c.mode=30;break}c.dmax=1<<N;a.adler=c.check=1;c.mode=v&512?10:12;s=v=0;break;case 2:for(;16>s;){if(0===q)break a;q--;v+=g[f++]<<s;s+=8}c.flags=
v;if(8!==(c.flags&255)){a.msg="unknown compression method";c.mode=30;break}if(c.flags&57344){a.msg="unknown header flags set";c.mode=30;break}c.head&&(c.head.text=v>>8&1);c.flags&512&&(W[0]=v&255,W[1]=v>>>8&255,c.check=r(c.check,W,2,0));s=v=0;c.mode=3;case 3:for(;32>s;){if(0===q)break a;q--;v+=g[f++]<<s;s+=8}c.head&&(c.head.time=v);c.flags&512&&(W[0]=v&255,W[1]=v>>>8&255,W[2]=v>>>16&255,W[3]=v>>>24&255,c.check=r(c.check,W,4,0));s=v=0;c.mode=4;case 4:for(;16>s;){if(0===q)break a;q--;v+=g[f++]<<s;s+=
8}c.head&&(c.head.xflags=v&255,c.head.os=v>>8);c.flags&512&&(W[0]=v&255,W[1]=v>>>8&255,c.check=r(c.check,W,2,0));s=v=0;c.mode=5;case 5:if(c.flags&1024){for(;16>s;){if(0===q)break a;q--;v+=g[f++]<<s;s+=8}c.length=v;c.head&&(c.head.extra_len=v);c.flags&512&&(W[0]=v&255,W[1]=v>>>8&255,c.check=r(c.check,W,2,0));s=v=0}else c.head&&(c.head.extra=null);c.mode=6;case 6:if(c.flags&1024&&(F=c.length,F>q&&(F=q),F&&(c.head&&(N=c.head.extra_len-c.length,c.head.extra||(c.head.extra=Array(c.head.extra_len)),e.arraySet(c.head.extra,
g,f,F,N)),c.flags&512&&(c.check=r(c.check,g,F,f)),q-=F,f+=F,c.length-=F),c.length))break a;c.length=0;c.mode=7;case 7:if(c.flags&2048){if(0===q)break a;F=0;do N=g[f+F++],c.head&&N&&65536>c.length&&(c.head.name+=String.fromCharCode(N));while(N&&F<q);c.flags&512&&(c.check=r(c.check,g,F,f));q-=F;f+=F;if(N)break a}else c.head&&(c.head.name=null);c.length=0;c.mode=8;case 8:if(c.flags&4096){if(0===q)break a;F=0;do N=g[f+F++],c.head&&N&&65536>c.length&&(c.head.comment+=String.fromCharCode(N));while(N&&F<
q);c.flags&512&&(c.check=r(c.check,g,F,f));q-=F;f+=F;if(N)break a}else c.head&&(c.head.comment=null);c.mode=9;case 9:if(c.flags&512){for(;16>s;){if(0===q)break a;q--;v+=g[f++]<<s;s+=8}if(v!==(c.check&65535)){a.msg="header crc mismatch";c.mode=30;break}s=v=0}c.head&&(c.head.hcrc=c.flags>>9&1,c.head.done=!0);a.adler=c.check=0;c.mode=12;break;case 10:for(;32>s;){if(0===q)break a;q--;v+=g[f++]<<s;s+=8}a.adler=c.check=m(v);s=v=0;c.mode=11;case 11:if(0===c.havedict)return a.next_out=n,a.avail_out=p,a.next_in=
f,a.avail_in=q,c.hold=v,c.bits=s,2;a.adler=c.check=1;c.mode=12;case 12:if(5===d||6===d)break a;case 13:if(c.last){v>>>=s&7;s-=s&7;c.mode=27;break}for(;3>s;){if(0===q)break a;q--;v+=g[f++]<<s;s+=8}c.last=v&1;v>>>=1;s-=1;switch(v&3){case 0:c.mode=14;break;case 1:F=c;if(u){N=void 0;A=new e.Buf32(512);H=new e.Buf32(32);for(N=0;144>N;)F.lens[N++]=8;for(;256>N;)F.lens[N++]=9;for(;280>N;)F.lens[N++]=7;for(;288>N;)F.lens[N++]=8;y(1,F.lens,0,288,A,0,F.work,{bits:9});for(N=0;32>N;)F.lens[N++]=5;y(2,F.lens,
0,32,H,0,F.work,{bits:5});u=!1}F.lencode=A;F.lenbits=9;F.distcode=H;F.distbits=5;c.mode=20;if(6===d){v>>>=2;s-=2;break a}break;case 2:c.mode=17;break;case 3:a.msg="invalid block type",c.mode=30}v>>>=2;s-=2;break;case 14:v>>>=s&7;for(s-=s&7;32>s;){if(0===q)break a;q--;v+=g[f++]<<s;s+=8}if((v&65535)!==(v>>>16^65535)){a.msg="invalid stored block lengths";c.mode=30;break}c.length=v&65535;s=v=0;c.mode=15;if(6===d)break a;case 15:c.mode=16;case 16:if(F=c.length){F>q&&(F=q);F>p&&(F=p);if(0===F)break a;e.arraySet(h,
g,f,F,n);q-=F;f+=F;p-=F;n+=F;c.length-=F;break}c.mode=12;break;case 17:for(;14>s;){if(0===q)break a;q--;v+=g[f++]<<s;s+=8}c.nlen=(v&31)+257;v>>>=5;s-=5;c.ndist=(v&31)+1;v>>>=5;s-=5;c.ncode=(v&15)+4;v>>>=4;s-=4;if(286<c.nlen||30<c.ndist){a.msg="too many length or distance symbols";c.mode=30;break}c.have=0;c.mode=18;case 18:for(;c.have<c.ncode;){for(;3>s;){if(0===q)break a;q--;v+=g[f++]<<s;s+=8}c.lens[O[c.have++]]=v&7;v>>>=3;s-=3}for(;19>c.have;)c.lens[O[c.have++]]=0;c.lencode=c.lendyn;c.lenbits=7;
F={bits:c.lenbits};U=y(0,c.lens,0,19,c.lencode,0,c.work,F);c.lenbits=F.bits;if(U){a.msg="invalid code lengths set";c.mode=30;break}c.have=0;c.mode=19;case 19:for(;c.have<c.nlen+c.ndist;){for(;;){F=c.lencode[v&(1<<c.lenbits)-1];E=F>>>24;V=F>>>16&255;aa=F&65535;if(E<=s)break;if(0===q)break a;q--;v+=g[f++]<<s;s+=8}if(16>aa)v>>>=E,s-=E,c.lens[c.have++]=aa;else{if(16===aa){for(F=E+2;s<F;){if(0===q)break a;q--;v+=g[f++]<<s;s+=8}v>>>=E;s-=E;if(0===c.have){a.msg="invalid bit length repeat";c.mode=30;break}N=
c.lens[c.have-1];F=3+(v&3);v>>>=2;s-=2}else if(17===aa){for(F=E+3;s<F;){if(0===q)break a;q--;v+=g[f++]<<s;s+=8}v>>>=E;s-=E;N=0;F=3+(v&7);v>>>=3;s-=3}else{for(F=E+7;s<F;){if(0===q)break a;q--;v+=g[f++]<<s;s+=8}v>>>=E;s-=E;N=0;F=11+(v&127);v>>>=7;s-=7}if(c.have+F>c.nlen+c.ndist){a.msg="invalid bit length repeat";c.mode=30;break}for(;F--;)c.lens[c.have++]=N}}if(30===c.mode)break;if(0===c.lens[256]){a.msg="invalid code -- missing end-of-block";c.mode=30;break}c.lenbits=9;F={bits:c.lenbits};U=y(1,c.lens,
0,c.nlen,c.lencode,0,c.work,F);c.lenbits=F.bits;if(U){a.msg="invalid literal/lengths set";c.mode=30;break}c.distbits=6;c.distcode=c.distdyn;F={bits:c.distbits};U=y(2,c.lens,c.nlen,c.ndist,c.distcode,0,c.work,F);c.distbits=F.bits;if(U){a.msg="invalid distances set";c.mode=30;break}c.mode=20;if(6===d)break a;case 20:c.mode=21;case 21:if(6<=q&&258<=p){a.next_out=n;a.avail_out=p;a.next_in=f;a.avail_in=q;c.hold=v;c.bits=s;l(a,T);n=a.next_out;h=a.output;p=a.avail_out;f=a.next_in;g=a.input;q=a.avail_in;
v=c.hold;s=c.bits;12===c.mode&&(c.back=-1);break}for(c.back=0;;){F=c.lencode[v&(1<<c.lenbits)-1];E=F>>>24;V=F>>>16&255;aa=F&65535;if(E<=s)break;if(0===q)break a;q--;v+=g[f++]<<s;s+=8}if(V&&0===(V&240)){N=E;$=V;for(ca=aa;;){F=c.lencode[ca+((v&(1<<N+$)-1)>>N)];E=F>>>24;V=F>>>16&255;aa=F&65535;if(N+E<=s)break;if(0===q)break a;q--;v+=g[f++]<<s;s+=8}v>>>=N;s-=N;c.back+=N}v>>>=E;s-=E;c.back+=E;c.length=aa;if(0===V){c.mode=26;break}if(V&32){c.back=-1;c.mode=12;break}if(V&64){a.msg="invalid literal/length code";
c.mode=30;break}c.extra=V&15;c.mode=22;case 22:if(c.extra){for(F=c.extra;s<F;){if(0===q)break a;q--;v+=g[f++]<<s;s+=8}c.length+=v&(1<<c.extra)-1;v>>>=c.extra;s-=c.extra;c.back+=c.extra}c.was=c.length;c.mode=23;case 23:for(;;){F=c.distcode[v&(1<<c.distbits)-1];E=F>>>24;V=F>>>16&255;aa=F&65535;if(E<=s)break;if(0===q)break a;q--;v+=g[f++]<<s;s+=8}if(0===(V&240)){N=E;$=V;for(ca=aa;;){F=c.distcode[ca+((v&(1<<N+$)-1)>>N)];E=F>>>24;V=F>>>16&255;aa=F&65535;if(N+E<=s)break;if(0===q)break a;q--;v+=g[f++]<<
s;s+=8}v>>>=N;s-=N;c.back+=N}v>>>=E;s-=E;c.back+=E;if(V&64){a.msg="invalid distance code";c.mode=30;break}c.offset=aa;c.extra=V&15;c.mode=24;case 24:if(c.extra){for(F=c.extra;s<F;){if(0===q)break a;q--;v+=g[f++]<<s;s+=8}c.offset+=v&(1<<c.extra)-1;v>>>=c.extra;s-=c.extra;c.back+=c.extra}if(c.offset>c.dmax){a.msg="invalid distance too far back";c.mode=30;break}c.mode=25;case 25:if(0===p)break a;F=T-p;if(c.offset>F){F=c.offset-F;if(F>c.whave&&c.sane){a.msg="invalid distance too far back";c.mode=30;break}F>
c.wnext?(F-=c.wnext,N=c.wsize-F):N=c.wnext-F;F>c.length&&(F=c.length);$=c.window}else $=h,N=n-c.offset,F=c.length;F>p&&(F=p);p-=F;c.length-=F;do h[n++]=$[N++];while(--F);0===c.length&&(c.mode=21);break;case 26:if(0===p)break a;h[n++]=c.length;p--;c.mode=21;break;case 27:if(c.wrap){for(;32>s;){if(0===q)break a;q--;v|=g[f++]<<s;s+=8}T-=p;a.total_out+=T;c.total+=T;T&&(a.adler=c.check=c.flags?r(c.check,h,T,n-T):b(c.check,h,T,n-T));T=p;if((c.flags?v:m(v))!==c.check){a.msg="incorrect data check";c.mode=
30;break}s=v=0}c.mode=28;case 28:if(c.wrap&&c.flags){for(;32>s;){if(0===q)break a;q--;v+=g[f++]<<s;s+=8}if(v!==(c.total&4294967295)){a.msg="incorrect length check";c.mode=30;break}s=v=0}c.mode=29;case 29:U=1;break a;case 30:U=-3;break a;case 31:return-4;default:return z}a.next_out=n;a.avail_out=p;a.next_in=f;a.avail_in=q;c.hold=v;c.bits=s;if(c.wsize||T!==a.avail_out&&30>c.mode&&(27>c.mode||4!==d))g=a.output,f=a.next_out,n=T-a.avail_out,p=a.state,null===p.window&&(p.wsize=1<<p.wbits,p.wnext=0,p.whave=
0,p.window=new e.Buf8(p.wsize)),n>=p.wsize?(e.arraySet(p.window,g,f-p.wsize,p.wsize,0),p.wnext=0,p.whave=p.wsize):(q=p.wsize-p.wnext,q>n&&(q=n),e.arraySet(p.window,g,f-n,q,p.wnext),(n-=q)?(e.arraySet(p.window,g,f-n,n,0),p.wnext=n,p.whave=p.wsize):(p.wnext+=q,p.wnext===p.wsize&&(p.wnext=0),p.whave<p.wsize&&(p.whave+=q)));x-=a.avail_in;T-=a.avail_out;a.total_in+=x;a.total_out+=T;c.total+=T;c.wrap&&T&&(a.adler=c.check=c.flags?r(c.check,h,T,a.next_out-T):b(c.check,h,T,a.next_out-T));a.data_type=c.bits+
(c.last?64:0)+(12===c.mode?128:0)+(20===c.mode||15===c.mode?256:0);(0===x&&0===T||4===d)&&U===t&&(U=-5);return U};c.inflateEnd=function(b){if(!b||!b.state)return z;var a=b.state;a.window&&(a.window=null);b.state=null;return t};c.inflateGetHeader=function(b,a){var e;if(!b||!b.state)return z;e=b.state;if(0===(e.wrap&2))return z;e.head=a;a.done=!1;return t};c.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":2,"./adler32":4,"./crc32":6,"./inffast":8,"./inftrees":10}],10:[function(a,
d,c){var f=a("../utils/common"),h=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],q=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],p=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],n=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];d.exports=function(a,e,b,c,d,y,t,z){for(var w=z.bits,s=0,x=
0,u=0,A=0,H=0,C=0,G=0,B=0,J=0,P=0,Q,D,Z=null,S=0,v,I=new f.Buf16(16),C=new f.Buf16(16),ba=null,T=0,F,N,$,s=0;15>=s;s++)I[s]=0;for(x=0;x<c;x++)I[e[b+x]]++;H=w;for(A=15;1<=A&&0===I[A];A--);H>A&&(H=A);if(0===A)return d[y++]=20971520,d[y++]=20971520,z.bits=1,0;for(u=1;u<A&&0===I[u];u++);H<u&&(H=u);for(s=B=1;15>=s;s++)if(B<<=1,B-=I[s],0>B)return-1;if(0<B&&(0===a||1!==A))return-1;C[1]=0;for(s=1;15>s;s++)C[s+1]=C[s]+I[s];for(x=0;x<c;x++)0!==e[b+x]&&(t[C[e[b+x]]++]=x);switch(a){case 0:Z=ba=t;v=19;break;case 1:Z=
h;S-=257;ba=q;T-=257;v=256;break;default:Z=p,ba=n,v=-1}x=P=0;s=u;w=y;C=H;G=0;D=-1;J=1<<H;c=J-1;if(1===a&&852<J||2===a&&592<J)return 1;for(var E=0;;){E++;F=s-G;t[x]<v?(N=0,$=t[x]):t[x]>v?(N=ba[T+t[x]],$=Z[S+t[x]]):(N=96,$=0);B=1<<s-G;u=Q=1<<C;do Q-=B,d[w+(P>>G)+Q]=F<<24|N<<16|$|0;while(0!==Q);for(B=1<<s-1;P&B;)B>>=1;0!==B?(P&=B-1,P+=B):P=0;x++;if(0===--I[s]){if(s===A)break;s=e[b+t[x]]}if(s>H&&(P&c)!==D){0===G&&(G=H);w+=u;C=s-G;for(B=1<<C;C+G<A;){B-=I[C+G];if(0>=B)break;C++;B<<=1}J+=1<<C;if(1===a&&
852<J||2===a&&592<J)return 1;D=P&c;d[D]=H<<24|C<<16|w-y|0}}0!==P&&(d[w+P]=s-G<<24|4194304);z.bits=H;return 0}},{"../utils/common":2}],11:[function(a,d,c){d.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],12:[function(a,d,c){d.exports=function(){this.input=null;this.total_in=this.avail_in=this.next_in=0;this.output=null;this.total_out=this.avail_out=this.next_out=
0;this.msg="";this.state=null;this.data_type=2;this.adler=0}},{}]},{},[1])(1)});return{inflate:function(k,a){return f.inflateRaw(k)}}}()})();core.StepDirection={PREVIOUS:1,NEXT:2};core.StepIterator=function(f,k){function a(){e=null;r=b=void 0}function d(){void 0===r&&(r=f.acceptPosition(k)===n);return r}function c(b,e){a();return k.setUnfilteredPosition(b,e)}function m(){e||(e=k.container());return e}function h(){void 0===b&&(b=k.unfilteredDomOffset());return b}function q(){for(a();k.nextPosition();)if(a(),d())return!0;return!1}function p(){for(a();k.previousPosition();)if(a(),d())return!0;return!1}var n=core.PositionFilter.FilterResult.FILTER_ACCEPT,g=core.StepDirection.NEXT,
e,b,r;this.isStep=d;this.setPosition=c;this.container=m;this.offset=h;this.nextStep=q;this.previousStep=p;this.advanceStep=function(b){return b===g?q():p()};this.roundToClosestStep=function(){var b,a,e=d();e||(b=m(),a=h(),e=p(),e||(c(b,a),e=q()));return e};this.roundToPreviousStep=function(){var b=d();b||(b=p());return b};this.roundToNextStep=function(){var b=d();b||(b=q());return b};this.leftNode=function(){return k.leftNode()};this.snapshot=function(){return new core.StepIterator.StepSnapshot(m(),
h())};this.restore=function(b){c(b.container,b.offset)}};core.StepIterator.StepSnapshot=function(f,k){this.container=f;this.offset=k};core.Utils=function(){function f(k,a){if(a&&Array.isArray(a)){k=k||[];if(!Array.isArray(k))throw"Destination is not an array.";k=k.concat(a.map(function(a){return f(null,a)}))}else if(a&&"object"===typeof a){k=k||{};if("object"!==typeof k)throw"Destination is not an object.";Object.keys(a).forEach(function(d){k[d]=f(k[d],a[d])})}else k=a;return k}this.hashString=function(f){var a=0,d,c;d=0;for(c=f.length;d<c;d+=1)a=(a<<5)-a+f.charCodeAt(d),a|=0;return a};this.mergeObjects=function(k,a){Object.keys(a).forEach(function(d){k[d]=
f(k[d],a[d])});return k}};core.Zip=function(f,k){function a(b,a,e){y?e(null,y.subarray(b,b+a)):e("File data not loaded",null)}function d(b){var a=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,
1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,
1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,
1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,
628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,
3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918E3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],e,c,d=b.length,g=0,g=0;e=-1;for(c=0;c<d;c+=1)g=(e^b[c])&255,g=a[g],e=e>>>8^g;return e^-1}function c(b){return new Date((b>>25&127)+1980,(b>>21&15)-1,b>>16&31,b>>11&15,
b>>5&63,(b&31)<<1)}function m(b){var a=b.getFullYear();return 1980>a?0:a-1980<<25|b.getMonth()+1<<21|b.getDate()<<16|b.getHours()<<11|b.getMinutes()<<5|b.getSeconds()>>1}function h(b,e){var d,g,l,r,f,h,m,n=this;this.load=function(e){if(null!==n.data)e(null,n.data);else{var c=f+34+g+l+256;c+m>t&&(c=t-m);a(m,c,function(a,c){if(a||null===c)e(a,c);else a:{var d=c,g=new core.ByteArray(d),l=g.readUInt32LE(),m;if(67324752!==l)e("File entry signature is wrong."+l.toString()+" "+d.length.toString(),null);
else{g.pos+=22;l=g.readUInt16LE();m=g.readUInt16LE();g.pos+=l+m;if(r){d=d.subarray(g.pos,g.pos+f);if(f!==d.length){e("The amount of compressed bytes read was "+d.length.toString()+" instead of "+f.toString()+" for "+n.filename+" in "+b+".",null);break a}d=w(d,h)}else d=d.subarray(g.pos,g.pos+h);h!==d.length?e("The amount of bytes read was "+d.length.toString()+" instead of "+h.toString()+" for "+n.filename+" in "+b+".",null):(n.data=d,e(null,d))}}})}};this.set=function(b,e,a,c){n.filename=b;n.data=
e;n.compressed=a;n.date=c};this.error=null;e&&(d=e.readUInt32LE(),33639248!==d?this.error="Central directory entry has wrong signature at position "+(e.pos-4).toString()+' for file "'+b+'": '+e.data.length.toString():(e.pos+=6,r=e.readUInt16LE(),this.date=c(e.readUInt32LE()),e.readUInt32LE(),f=e.readUInt32LE(),h=e.readUInt32LE(),g=e.readUInt16LE(),l=e.readUInt16LE(),d=e.readUInt16LE(),e.pos+=8,m=e.readUInt32LE(),this.filename=runtime.byteArrayToString(e.data.subarray(e.pos,e.pos+g),"utf8"),this.data=
null,e.pos+=g+l+d))}function q(b,e){if(22!==b.length)e("Central directory length should be 22.",s);else{var c=new core.ByteArray(b),d;d=c.readUInt32LE();101010256!==d?e("Central directory signature is wrong: "+d.toString(),s):(d=c.readUInt16LE(),0!==d?e("Zip files with non-zero disk numbers are not supported.",s):(d=c.readUInt16LE(),0!==d?e("Zip files with non-zero disk numbers are not supported.",s):(d=c.readUInt16LE(),z=c.readUInt16LE(),d!==z?e("Number of entries is inconsistent.",s):(d=c.readUInt32LE(),
c=c.readUInt16LE(),c=t-22-d,a(c,t-c,function(b,a){if(b||null===a)e(b,s);else a:{var c=new core.ByteArray(a),d,g;l=[];for(d=0;d<z;d+=1){g=new h(f,c);if(g.error){e(g.error,s);break a}l[l.length]=g}e(null,s)}})))))}}function p(b,e){var a=null,c,d;for(d=0;d<l.length;d+=1)if(c=l[d],c.filename===b){a=c;break}a?a.data?e(null,a.data):a.load(e):e(b+" not found.",null)}function n(b){var e=new core.ByteArrayWriter("utf8"),a=0;e.appendArray([80,75,3,4,20,0,0,0,0,0]);b.data&&(a=b.data.length);e.appendUInt32LE(m(b.date));
e.appendUInt32LE(b.data?d(b.data):0);e.appendUInt32LE(a);e.appendUInt32LE(a);e.appendUInt16LE(b.filename.length);e.appendUInt16LE(0);e.appendString(b.filename);b.data&&e.appendByteArray(b.data);return e}function g(b,e){var a=new core.ByteArrayWriter("utf8"),c=0;a.appendArray([80,75,1,2,20,0,20,0,0,0,0,0]);b.data&&(c=b.data.length);a.appendUInt32LE(m(b.date));a.appendUInt32LE(b.data?d(b.data):0);a.appendUInt32LE(c);a.appendUInt32LE(c);a.appendUInt16LE(b.filename.length);a.appendArray([0,0,0,0,0,0,
0,0,0,0,0,0]);a.appendUInt32LE(e);a.appendString(b.filename);return a}function e(b,a){if(b===l.length)a(null);else{var c=l[b];null!==c.data?e(b+1,a):c.load(function(c){c?a(c):e(b+1,a)})}}function b(b,a){e(0,function(e){if(e)a(e);else{var c,d,r=new core.ByteArrayWriter("utf8"),f=[0];for(c=0;c<l.length;c+=1)r.appendByteArrayWriter(n(l[c])),f.push(r.getLength());e=r.getLength();for(c=0;c<l.length;c+=1)d=l[c],r.appendByteArrayWriter(g(d,f[c]));c=r.getLength()-e;r.appendArray([80,75,5,6,0,0,0,0]);r.appendUInt16LE(l.length);
r.appendUInt16LE(l.length);r.appendUInt32LE(c);r.appendUInt32LE(e);r.appendArray([0,0]);b(r.getByteArray())}})}function r(e,a){b(function(b){runtime.writeFile(e,b,function(e){e||(y=b,t=y.length);a(e)})},a)}var l,y,t,z,w=core.RawInflate.inflate,s=this,x=new core.Base64;this.load=p;this.save=function(b,e,a,c){var d,g;for(d=0;d<l.length;d+=1)if(g=l[d],g.filename===b){g.set(b,e,a,c);return}g=new h(f);g.set(b,e,a,c);l.push(g)};this.remove=function(b){var e,a;for(e=0;e<l.length;e+=1)if(a=l[e],a.filename===
b)return l.splice(e,1),!0;return!1};this.write=function(b){r(f,b)};this.writeAs=r;this.createByteArray=b;this.loadContentXmlAsFragments=function(b,e){s.loadAsString(b,function(b,a){if(b)return e.rootElementReady(b);e.rootElementReady(null,a,!0)})};this.loadAsString=function(b,e){p(b,function(b,a){if(b||null===a)return e(b,null);var c=runtime.byteArrayToString(a,"utf8");e(null,c)})};this.loadAsDOM=function(b,e){s.loadAsString(b,function(b,a){if(b||null===a)e(b,null);else{var c=(new DOMParser).parseFromString(a,
"text/xml");e(null,c)}})};this.loadAsDataURL=function(b,e,a){p(b,function(b,c){if(b||!c)return a(b,null);var d=0,g;e||(e=80===c[1]&&78===c[2]&&71===c[3]?"image/png":255===c[0]&&216===c[1]&&255===c[2]?"image/jpeg":71===c[0]&&73===c[1]&&70===c[2]?"image/gif":"");for(g="data:"+e+";base64,";d<c.length;)g+=x.convertUTF8ArrayToBase64(c.subarray(d,Math.min(d+45E3,c.length))),d+=45E3;a(null,g)})};this.getEntries=function(){return l.slice()};t=-1;null===k?l=[]:runtime.readFile(f,"binary",function(b,e){"string"===
typeof e&&(b="file was read as a string. Should be Uint8Array.");b||!e||0===e.length?k("File '"+f+"' cannot be read. Err: "+(b||"[none]"),s):(y=e,t=y.length,a(t-22,22,function(b,e){b||null===e?k(b,s):q(e,k)}))})};core.SimpleClientRect=null;gui.CommonConstraints={EDIT:{ANNOTATIONS:{ONLY_DELETE_OWN:"onlyDeleteOwn"},REVIEW_MODE:"reviewMode"}};gui.SessionConstraints=function(){function f(d){k.hasOwnProperty(d)||(k[d]=!1,a.register(d))}var k={},a=new core.EventNotifier;this.registerConstraint=f;this.subscribe=function(d,c){f(d);a.subscribe(d,c)};this.unsubscribe=function(d,c){a.unsubscribe(d,c)};this.setState=function(d,c){runtime.assert(!0===k.hasOwnProperty(d),"No such constraint");k[d]!==c&&(k[d]=c,a.emit(d,c))};this.getState=function(a){runtime.assert(!0===k.hasOwnProperty(a),"No such constraint");return k[a]}};gui.BlacklistNamespaceNodeFilter=function(f){var k={},a=NodeFilter.FILTER_REJECT,d=NodeFilter.FILTER_ACCEPT;this.acceptNode=function(c){return!c||k.hasOwnProperty(c.namespaceURI)?a:d};(function(){f.forEach(function(a){k[a]=!0})})()};odf.Namespaces={namespaceMap:{config:"urn:oasis:names:tc:opendocument:xmlns:config:1.0",db:"urn:oasis:names:tc:opendocument:xmlns:database:1.0",dc:"http://purl.org/dc/elements/1.1/",dr3d:"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0",draw:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",chart:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",fo:"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0",form:"urn:oasis:names:tc:opendocument:xmlns:form:1.0",math:"http://www.w3.org/1998/Math/MathML",
meta:"urn:oasis:names:tc:opendocument:xmlns:meta:1.0",number:"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0",office:"urn:oasis:names:tc:opendocument:xmlns:office:1.0",presentation:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",style:"urn:oasis:names:tc:opendocument:xmlns:style:1.0",svg:"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0",table:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",text:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",xforms:"http://www.w3.org/2002/xforms",
xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"},prefixMap:{},configns:"urn:oasis:names:tc:opendocument:xmlns:config:1.0",dbns:"urn:oasis:names:tc:opendocument:xmlns:database:1.0",dcns:"http://purl.org/dc/elements/1.1/",dr3dns:"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0",drawns:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",chartns:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",fons:"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0",formns:"urn:oasis:names:tc:opendocument:xmlns:form:1.0",
mathns:"http://www.w3.org/1998/Math/MathML",metans:"urn:oasis:names:tc:opendocument:xmlns:meta:1.0",numberns:"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0",officens:"urn:oasis:names:tc:opendocument:xmlns:office:1.0",presentationns:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",stylens:"urn:oasis:names:tc:opendocument:xmlns:style:1.0",svgns:"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0",tablens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",textns:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",
xformsns:"http://www.w3.org/2002/xforms",xlinkns:"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/XML/1998/namespace"};(function(){var f=odf.Namespaces.namespaceMap,k=odf.Namespaces.prefixMap,a;for(a in f)f.hasOwnProperty(a)&&(k[f[a]]=a)})();odf.Namespaces.forEachPrefix=function(f){var k=odf.Namespaces.namespaceMap,a;for(a in k)k.hasOwnProperty(a)&&f(a,k[a])};
odf.Namespaces.lookupNamespaceURI=function(f){var k=null;odf.Namespaces.namespaceMap.hasOwnProperty(f)&&(k=odf.Namespaces.namespaceMap[f]);return k};odf.Namespaces.lookupPrefix=function(f){var k=odf.Namespaces.prefixMap;return k.hasOwnProperty(f)?k[f]:null};odf.Namespaces.lookupNamespaceURI.lookupNamespaceURI=odf.Namespaces.lookupNamespaceURI;(function(){odf.OdfSchemaImpl=function(){var f=[["config:config-item","uncategorized"],["form:item","object"],["form:option","uncategorized"],["math:math","field"],["meta:user-defined","uncategorized"],["number:currency-symbol","uncategorized"],["number:embedded-text","uncategorized"],["number:text","uncategorized"],["presentation:date-time-decl","uncategorized"],["presentation:footer-decl","uncategorized"],["presentation:header-decl","uncategorized"],["svg:desc","text"],["svg:title","text"],["table:desc",
"uncategorized"],["table:title","uncategorized"],["text:a","text"],["text:author-initials","field"],["text:author-name","field"],["text:bibliography-mark","field"],["text:bookmark-ref","field"],["text:chapter","field"],["text:character-count","field"],["text:conditional-text","field"],["text:creation-date","field"],["text:creation-time","field"],["text:creator","field"],["text:database-display","field"],["text:database-name","field"],["text:database-row-number","field"],["text:date","field"],["text:dde-connection",
"field"],["text:description","field"],["text:editing-cycles","field"],["text:editing-duration","field"],["text:execute-macro","uncategorized"],["text:expression","uncategorized"],["text:file-name","field"],["text:h","text"],["text:hidden-paragraph","text"],["text:hidden-text","text"],["text:image-count","field"],["text:index-entry-span","uncategorized"],["text:index-title-template","uncategorized"],["text:initial-creator","field"],["text:keywords","field"],["text:linenumbering-separator","style"],
["text:measure","uncategorized"],["text:meta","uncategorized"],["text:meta-field","uncategorized"],["text:modification-date","field"],["text:modification-time","field"],["text:note-citation","field"],["text:note-continuation-notice-backward","style"],["text:note-continuation-notice-forward","style"],["text:note-ref","field"],["text:object-count","field"],["text:p","text"],["text:page-continuation","uncategorized"],["text:page-count","field"],["text:page-number","field"],["text:page-variable-get",
"field"],["text:page-variable-set","field"],["text:paragraph-count","field"],["text:placeholder","field"],["text:print-date","field"],["text:print-time","field"],["text:printed-by","field"],["text:reference-ref","field"],["text:ruby-base","text"],["text:ruby-text","text"],["text:script","text"],["text:sender-city","field"],["text:sender-company","field"],["text:sender-country","field"],["text:sender-email","field"],["text:sender-fax","field"],["text:sender-firstname","field"],["text:sender-initials",
"field"],["text:sender-lastname","field"],["text:sender-phone-private","field"],["text:sender-phone-work","field"],["text:sender-position","field"],["text:sender-postal-code","field"],["text:sender-state-or-province","field"],["text:sender-street","field"],["text:sender-title","field"],["text:sequence","uncategorized"],["text:sequence-ref","uncategorized"],["text:sheet-name","uncategorized"],["text:span","text"],["text:subject","field"],["text:table-count","field"],["text:table-formula","deprecated"],
["text:template-name","uncategorized"],["text:text-input","field"],["text:time","field"],["text:title","field"],["text:user-defined","field"],["text:user-field-get","field"],["text:user-field-input","field"],["text:variable-get","field"],["text:variable-input","field"],["text:variable-set","field"],["text:word-count","field"],["xforms:model","uncategorized"]],k={};this.isTextContainer=function(a,d){return"text"===k[a+":"+d]};this.isField=function(a,d){return"field"===k[a+":"+d]};this.getFields=function(){return f.filter(function(a){return"field"===
a[1]}).map(function(a){return a[0]})};(function(){f.forEach(function(a){var d=a[1],c=a[0].split(":");a=c[0];var c=c[1],f=odf.Namespaces.lookupNamespaceURI(a);f?k[f+":"+c]=d:runtime.log("DEBUG: OdfSchema - unknown prefix '"+a+"'")})})()};odf.OdfSchema=new odf.OdfSchemaImpl})();odf.OdfUtilsImpl=function(){function f(b){return"image"===(b&&b.localName)&&b.namespaceURI===S}function k(b){return null!==b&&b.nodeType===Node.ELEMENT_NODE&&"frame"===b.localName&&b.namespaceURI===S&&"as-char"===b.getAttributeNS(Z,"anchor-type")}function a(b){var e;(e="annotation"===(b&&b.localName)&&b.namespaceURI===odf.Namespaces.officens)||(e="div"===(b&&b.localName)&&"annotationWrapper"===b.className);return e}function d(b){return"a"===(b&&b.localName)&&b.namespaceURI===Z}function c(b){var e=
b&&b.localName;return("p"===e||"h"===e)&&b.namespaceURI===Z}function m(b,e){for(b&&void 0!==e&&!c(b)&&b.childNodes.item(e)&&(b=b.childNodes.item(e));b&&!c(b);)b=b.parentNode;return b}function h(b,e){for(;b&&b!==e;){if(b.namespaceURI===odf.Namespaces.officens&&"annotation"===b.localName)return b;b=b.parentNode}return null}function q(b){return/^[ \t\r\n]+$/.test(b)}function p(b){if(null===b||b.nodeType!==Node.ELEMENT_NODE)return!1;var e=b.localName;return T.isTextContainer(b.namespaceURI,e)||"span"===
e&&"webodf-annotationHighlight"===b.className}function n(b){return null===b||b.nodeType!==Node.ELEMENT_NODE?!1:T.isField(b.namespaceURI,b.localName)}function g(b){var e=b&&b.localName,a=!1;e&&(b=b.namespaceURI,b===Z&&(a="s"===e||"tab"===e||"line-break"===e));return a}function e(b){return g(b)||n(b)||k(b)||a(b)}function b(b){var e=b&&b.localName,a=!1;e&&(b=b.namespaceURI,b===Z&&(a="s"===e));return a}function r(b){return-1!==ba.indexOf(b.namespaceURI)}function l(b){if(g(b)||n(b))return!1;if(p(b.parentNode)&&
b.nodeType===Node.TEXT_NODE)return 0===b.textContent.length;for(b=b.firstChild;b;){if(r(b)||!l(b))return!1;b=b.nextSibling}return!0}function y(b){for(;null!==b.firstChild&&p(b);)b=b.firstChild;return b}function t(b){for(;null!==b.lastChild&&p(b);)b=b.lastChild;return b}function z(b){for(;!c(b)&&null===b.previousSibling;)b=b.parentNode;return c(b)?null:t(b.previousSibling)}function w(b){for(;!c(b)&&null===b.nextSibling;)b=b.parentNode;return c(b)?null:y(b.nextSibling)}function s(a){for(var c=!1;a;)if(a.nodeType===
Node.TEXT_NODE)if(0===a.length)a=z(a);else return!q(a.data.substr(a.length-1,1));else e(a)?(c=!1===b(a),a=null):a=z(a);return c}function x(b){var a=!1,c;for(b=b&&y(b);b;){c=b.nodeType===Node.TEXT_NODE?b.length:0;if(0<c&&!q(b.data)){a=!0;break}if(e(b)){a=!0;break}b=w(b)}return a}function u(b,e){return q(b.data.substr(e))?!x(w(b)):!1}function A(b,a){var c=b.data,d;if(!q(c[a])||e(b.parentNode))return!1;0<a?q(c[a-1])||(d=!0):s(z(b))&&(d=!0);return!0===d?u(b,a)?!1:!0:!1}function H(b){return(b=/(-?[0-9]*[0-9][0-9]*(\.[0-9]*)?|0+\.[0-9]*[1-9][0-9]*|\.[0-9]*[1-9][0-9]*)((cm)|(mm)|(in)|(pt)|(pc)|(px)|(%))/.exec(b))?
{value:parseFloat(b[1]),unit:b[3]}:null}function C(b){return(b=H(b))&&(0>b.value||"%"===b.unit)?null:b}function G(b){return(b=H(b))&&"%"!==b.unit?null:b}function B(b){switch(b.namespaceURI){case odf.Namespaces.drawns:case odf.Namespaces.svgns:case odf.Namespaces.dr3dns:return!1;case odf.Namespaces.textns:switch(b.localName){case "note-body":case "ruby-text":return!1}break;case odf.Namespaces.officens:switch(b.localName){case "annotation":case "binary-data":case "event-listeners":return!1}break;default:switch(b.localName){case "cursor":case "editinfo":return!1}}return!0}
function J(b,e){for(;0<e.length&&!I.rangeContainsNode(b,e[0]);)e.shift();for(;0<e.length&&!I.rangeContainsNode(b,e[e.length-1]);)e.pop()}function P(b,c,d){var l;l=I.getNodesInRange(b,function(b){var c=NodeFilter.FILTER_REJECT;if(g(b.parentNode)||n(b.parentNode)||a(b))c=NodeFilter.FILTER_REJECT;else if(b.nodeType===Node.TEXT_NODE){if(d||Boolean(m(b)&&(!q(b.textContent)||A(b,0))))c=NodeFilter.FILTER_ACCEPT}else if(e(b))c=NodeFilter.FILTER_ACCEPT;else if(B(b)||p(b))c=NodeFilter.FILTER_SKIP;return c},
NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT);c||J(b,l);return l}function Q(b,e,c){for(;b;){if(c(b)){e[0]!==b&&e.unshift(b);break}if(a(b))break;b=b.parentNode}}function D(b,e){var a=b;if(e<a.childNodes.length-1)a=a.childNodes[e+1];else{for(;!a.nextSibling;)a=a.parentNode;a=a.nextSibling}for(;a.firstChild;)a=a.firstChild;return a}var Z=odf.Namespaces.textns,S=odf.Namespaces.drawns,v=odf.Namespaces.xlinkns,I=core.DomUtils,ba=[odf.Namespaces.dbns,odf.Namespaces.dcns,odf.Namespaces.dr3dns,odf.Namespaces.drawns,
odf.Namespaces.chartns,odf.Namespaces.formns,odf.Namespaces.numberns,odf.Namespaces.officens,odf.Namespaces.presentationns,odf.Namespaces.stylens,odf.Namespaces.svgns,odf.Namespaces.tablens,odf.Namespaces.textns],T=odf.OdfSchema;this.isImage=f;this.isCharacterFrame=k;this.isInlineRoot=a;this.isTextSpan=function(b){return"span"===(b&&b.localName)&&b.namespaceURI===Z};this.isHyperlink=d;this.getHyperlinkTarget=function(b){return b.getAttributeNS(v,"href")||""};this.isParagraph=c;this.getParagraphElement=
m;this.getParentAnnotation=h;this.isWithinAnnotation=function(b,e){return Boolean(h(b,e))};this.getAnnotationCreator=function(b){return b.getElementsByTagNameNS(odf.Namespaces.dcns,"creator")[0].textContent};this.isListItem=function(b){return"list-item"===(b&&b.localName)&&b.namespaceURI===Z};this.isLineBreak=function(b){return"line-break"===(b&&b.localName)&&b.namespaceURI===Z};this.isODFWhitespace=q;this.isGroupingElement=p;this.isFieldElement=n;this.isCharacterElement=g;this.isAnchoredAsCharacterElement=
e;this.isSpaceElement=b;this.isODFNode=r;this.hasNoODFContent=l;this.firstChild=y;this.lastChild=t;this.previousNode=z;this.nextNode=w;this.scanLeftForNonSpace=s;this.lookLeftForCharacter=function(b){var a,c=a=0;b.nodeType===Node.TEXT_NODE&&(c=b.length);0<c?(a=b.data,a=q(a.substr(c-1,1))?1===c?s(z(b))?2:0:q(a.substr(c-2,1))?0:2:1):e(b)&&(a=1);return a};this.lookRightForCharacter=function(b){var a=!1,c=0;b&&b.nodeType===Node.TEXT_NODE&&(c=b.length);0<c?a=!q(b.data.substr(0,1)):e(b)&&(a=!0);return a};
this.scanLeftForAnyCharacter=function(b){var a=!1,c;for(b=b&&t(b);b;){c=b.nodeType===Node.TEXT_NODE?b.length:0;if(0<c&&!q(b.data)){a=!0;break}if(e(b)){a=!0;break}b=z(b)}return a};this.scanRightForAnyCharacter=x;this.isTrailingWhitespace=u;this.isSignificantWhitespace=A;this.isDowngradableSpaceElement=function(e){return b(e)?s(z(e))&&x(w(e)):!1};this.parseLength=H;this.parseNonNegativeLength=C;this.parseFoFontSize=function(b){var e;e=(e=H(b))&&(0>=e.value||"%"===e.unit)?null:e;return e||G(b)};this.parseFoLineHeight=
function(b){return C(b)||G(b)};this.isTextContentContainingNode=B;this.getTextNodes=function(b,e){var a;a=I.getNodesInRange(b,function(b){var e=NodeFilter.FILTER_REJECT;b.nodeType===Node.TEXT_NODE?Boolean(m(b)&&(!q(b.textContent)||A(b,0)))&&(e=NodeFilter.FILTER_ACCEPT):B(b)&&(e=NodeFilter.FILTER_SKIP);return e},NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT);e||J(b,a);return a};this.getTextElements=P;this.getParagraphElements=function(b){var e;e=I.getNodesInRange(b,function(b){var e=NodeFilter.FILTER_REJECT;
if(c(b))e=NodeFilter.FILTER_ACCEPT;else if(B(b)||p(b))e=NodeFilter.FILTER_SKIP;return e},NodeFilter.SHOW_ELEMENT);Q(b.startContainer,e,c);return e};this.getImageElements=function(b){var e;e=I.getNodesInRange(b,function(b){var e=NodeFilter.FILTER_SKIP;f(b)&&(e=NodeFilter.FILTER_ACCEPT);return e},NodeFilter.SHOW_ELEMENT);Q(b.startContainer,e,f);return e};this.getHyperlinkElements=function(b){var e=[],a=b.cloneRange();b.collapsed&&b.endContainer.nodeType===Node.ELEMENT_NODE&&(b=D(b.endContainer,b.endOffset),
b.nodeType===Node.TEXT_NODE&&a.setEnd(b,1));P(a,!0,!1).forEach(function(b){for(b=b.parentNode;!c(b);){if(d(b)&&-1===e.indexOf(b)){e.push(b);break}b=b.parentNode}});a.detach();return e};this.getNormalizedFontFamilyName=function(b){/^(["'])(?:.|[\n\r])*?\1$/.test(b)||(b=b.replace(/^[ \t\r\n\f]*((?:.|[\n\r])*?)[ \t\r\n\f]*$/,"$1"),/[ \t\r\n\f]/.test(b)&&(b="'"+b.replace(/[ \t\r\n\f]+/g," ")+"'"));return b}};odf.OdfUtils=new odf.OdfUtilsImpl;gui.OdfTextBodyNodeFilter=function(){var f=odf.OdfUtils,k=Node.TEXT_NODE,a=NodeFilter.FILTER_REJECT,d=NodeFilter.FILTER_ACCEPT,c=odf.Namespaces.textns;this.acceptNode=function(m){if(m.nodeType===k){if(!f.isGroupingElement(m.parentNode))return a}else if(m.namespaceURI===c&&"tracked-changes"===m.localName)return a;return d}};xmldom.LSSerializerFilter=function(){};xmldom.LSSerializerFilter.prototype.acceptNode=function(f){};odf.OdfNodeFilter=function(){this.acceptNode=function(f){return"http://www.w3.org/1999/xhtml"===f.namespaceURI?NodeFilter.FILTER_SKIP:f.namespaceURI&&f.namespaceURI.match(/^urn:webodf:/)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}};xmldom.XPathIterator=function(){};xmldom.XPathIterator.prototype.next=function(){};xmldom.XPathIterator.prototype.reset=function(){};
function createXPathSingleton(){function f(a,e,b){return-1!==a&&(a<e||-1===e)&&(a<b||-1===b)}function k(a){for(var e=[],b=0,c=a.length,d;b<c;){var h=a,m=c,q=e,k="",p=[],x=h.indexOf("[",b),u=h.indexOf("/",b),A=h.indexOf("=",b);f(u,x,A)?(k=h.substring(b,u),b=u+1):f(x,u,A)?(k=h.substring(b,x),b=n(h,x,p)):f(A,u,x)?(k=h.substring(b,A),b=A):(k=h.substring(b,m),b=m);q.push({location:k,predicates:p});if(b<c&&"="===a[b]){d=a.substring(b+1,c);if(2<d.length&&("'"===d[0]||'"'===d[0]))d=d.slice(1,d.length-1);
else try{d=parseInt(d,10)}catch(H){}b=c}}return{steps:e,value:d}}function a(){var a=null,e=!1;this.setNode=function(b){a=b};this.reset=function(){e=!1};this.next=function(){var b=e?null:a;e=!0;return b}}function d(a,e,b){this.reset=function(){a.reset()};this.next=function(){for(var c=a.next();c;){c.nodeType===Node.ELEMENT_NODE&&(c=c.getAttributeNodeNS(e,b));if(c)break;c=a.next()}return c}}function c(a,e){var b=a.next(),c=null;this.reset=function(){a.reset();b=a.next();c=null};this.next=function(){for(;b;){if(c)if(e&&
c.firstChild)c=c.firstChild;else{for(;!c.nextSibling&&c!==b;)c=c.parentNode;c===b?b=a.next():c=c.nextSibling}else{do(c=b.firstChild)||(b=a.next());while(b&&!c)}if(c&&c.nodeType===Node.ELEMENT_NODE)return c}return null}}function m(a,e){this.reset=function(){a.reset()};this.next=function(){for(var b=a.next();b&&!e(b);)b=a.next();return b}}function h(a,e,b){e=e.split(":",2);var c=b(e[0]),d=e[1];return new m(a,function(b){return b.localName===d&&b.namespaceURI===c})}function q(c,e,b){var d=new a,l=p(d,
e,b),f=e.value;return void 0===f?new m(c,function(b){d.setNode(b);l.reset();return null!==l.next()}):new m(c,function(b){d.setNode(b);l.reset();return(b=l.next())?b.nodeValue===f:!1})}var p,n;n=function(a,e,b){for(var c=e,d=a.length,f=0;c<d;)"]"===a[c]?(f-=1,0>=f&&b.push(k(a.substring(e,c)))):"["===a[c]&&(0>=f&&(e=c+1),f+=1),c+=1;return c};p=function(a,e,b){var f,l,m,n;for(f=0;f<e.steps.length;f+=1){m=e.steps[f];l=m.location;if(""===l)a=new c(a,!1);else if("@"===l[0]){l=l.substr(1).split(":",2);n=
b(l[0]);if(!n)throw"No namespace associated with the prefix "+l[0];a=new d(a,n,l[1])}else"."!==l&&(a=new c(a,!1),-1!==l.indexOf(":")&&(a=h(a,l,b)));for(l=0;l<m.predicates.length;l+=1)n=m.predicates[l],a=q(a,n,b)}return a};return{getODFElementsWithXPath:function(c,e,b){var d=c.ownerDocument,l=[],f=null;if(d&&"function"===typeof d.evaluate)for(b=d.evaluate(e,c,b,XPathResult.UNORDERED_NODE_ITERATOR_TYPE,null),f=b.iterateNext();null!==f;)f.nodeType===Node.ELEMENT_NODE&&l.push(f),f=b.iterateNext();else{l=
new a;l.setNode(c);c=k(e);l=p(l,c,b);c=[];for(b=l.next();b;)c.push(b),b=l.next();l=c}return l}}}xmldom.XPath=createXPathSingleton();odf.StyleInfo=function(){function f(b,a){var e,c,d,l,g,h=0;if(e=C[b.localName])if(d=e[b.namespaceURI])h=d.length;for(e=0;e<h;e+=1)c=d[e],l=c.ns,g=c.localname,(c=b.getAttributeNS(l,g))&&b.setAttributeNS(l,A[l]+g,a+c);for(d=b.firstElementChild;d;)f(d,a),d=d.nextElementSibling}function k(b,a){var e,c,d,l,g,f=0;if(e=C[b.localName])if(d=e[b.namespaceURI])f=d.length;for(e=0;e<f;e+=1)if(c=d[e],l=c.ns,g=c.localname,c=b.getAttributeNS(l,g))c=c.replace(a,""),b.setAttributeNS(l,A[l]+g,c);for(d=b.firstElementChild;d;)k(d,
a),d=d.nextElementSibling}function a(b,e){var a,c,d,l,g,f=0;if(a=C[b.localName])if(d=a[b.namespaceURI])f=d.length;for(a=0;a<f;a+=1)if(l=d[a],c=l.ns,g=l.localname,c=b.getAttributeNS(c,g))e=e||{},l=l.keyname,e.hasOwnProperty(l)?e[l][c]=1:(g={},g[c]=1,e[l]=g);return e}function d(b,e){var c,l;a(b,e);for(c=b.firstChild;c;)c.nodeType===Node.ELEMENT_NODE&&(l=c,d(l,e)),c=c.nextSibling}function c(b,e,a){this.key=b;this.name=e;this.family=a;this.requires={}}function m(b,e,a){var d=b+'"'+e,l=a[d];l||(l=a[d]=
new c(d,b,e));return l}function h(b,e,a){var c,d,l,g,f,r=0;c=b.getAttributeNS(s,"name");g=b.getAttributeNS(s,"family");c&&g&&(e=m(c,g,a));if(e){if(c=C[b.localName])if(l=c[b.namespaceURI])r=l.length;for(c=0;c<r;c+=1)if(g=l[c],d=g.ns,f=g.localname,d=b.getAttributeNS(d,f))g=g.keyname,g=m(d,g,a),e.requires[g.key]=g}for(b=b.firstElementChild;b;)h(b,e,a),b=b.nextElementSibling;return a}function q(b,e){var a=e[b.family];a||(a=e[b.family]={});a[b.name]=1;Object.keys(b.requires).forEach(function(a){q(b.requires[a],
e)})}function p(b,e){var a=h(b,null,{});Object.keys(a).forEach(function(b){b=a[b];var c=e[b.family];c&&c.hasOwnProperty(b.name)&&q(b,e)})}function n(b,e){function a(e){(e=l.getAttributeNS(s,e))&&(b[e]=!0)}var c=["font-name","font-name-asian","font-name-complex"],d,l;for(d=e&&e.firstElementChild;d;)l=d,c.forEach(a),n(b,l),d=d.nextElementSibling}function g(b,e){function a(b){var c=l.getAttributeNS(s,b);c&&e.hasOwnProperty(c)&&l.setAttributeNS(s,"style:"+b,e[c])}var c=["font-name","font-name-asian",
"font-name-complex"],d,l;for(d=b&&b.firstElementChild;d;)l=d,c.forEach(a),g(l,e),d=d.nextElementSibling}var e=odf.Namespaces.chartns,b=odf.Namespaces.dbns,r=odf.Namespaces.dr3dns,l=odf.Namespaces.drawns,y=odf.Namespaces.formns,t=odf.Namespaces.numberns,z=odf.Namespaces.officens,w=odf.Namespaces.presentationns,s=odf.Namespaces.stylens,x=odf.Namespaces.tablens,u=odf.Namespaces.textns,A={"urn:oasis:names:tc:opendocument:xmlns:chart:1.0":"chart:","urn:oasis:names:tc:opendocument:xmlns:database:1.0":"db:",
"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0":"dr3d:","urn:oasis:names:tc:opendocument:xmlns:drawing:1.0":"draw:","urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0":"fo:","urn:oasis:names:tc:opendocument:xmlns:form:1.0":"form:","urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0":"number:","urn:oasis:names:tc:opendocument:xmlns:office:1.0":"office:","urn:oasis:names:tc:opendocument:xmlns:presentation:1.0":"presentation:","urn:oasis:names:tc:opendocument:xmlns:style:1.0":"style:","urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0":"svg:",
"urn:oasis:names:tc:opendocument:xmlns:table:1.0":"table:","urn:oasis:names:tc:opendocument:xmlns:text:1.0":"chart:","http://www.w3.org/XML/1998/namespace":"xml:"},H={text:[{ens:s,en:"tab-stop",ans:s,a:"leader-text-style"},{ens:s,en:"drop-cap",ans:s,a:"style-name"},{ens:u,en:"notes-configuration",ans:u,a:"citation-body-style-name"},{ens:u,en:"notes-configuration",ans:u,a:"citation-style-name"},{ens:u,en:"a",ans:u,a:"style-name"},{ens:u,en:"alphabetical-index",ans:u,a:"style-name"},{ens:u,en:"linenumbering-configuration",
ans:u,a:"style-name"},{ens:u,en:"list-level-style-number",ans:u,a:"style-name"},{ens:u,en:"ruby-text",ans:u,a:"style-name"},{ens:u,en:"span",ans:u,a:"style-name"},{ens:u,en:"a",ans:u,a:"visited-style-name"},{ens:s,en:"text-properties",ans:s,a:"text-line-through-text-style"},{ens:u,en:"alphabetical-index-source",ans:u,a:"main-entry-style-name"},{ens:u,en:"index-entry-bibliography",ans:u,a:"style-name"},{ens:u,en:"index-entry-chapter",ans:u,a:"style-name"},{ens:u,en:"index-entry-link-end",ans:u,a:"style-name"},
{ens:u,en:"index-entry-link-start",ans:u,a:"style-name"},{ens:u,en:"index-entry-page-number",ans:u,a:"style-name"},{ens:u,en:"index-entry-span",ans:u,a:"style-name"},{ens:u,en:"index-entry-tab-stop",ans:u,a:"style-name"},{ens:u,en:"index-entry-text",ans:u,a:"style-name"},{ens:u,en:"index-title-template",ans:u,a:"style-name"},{ens:u,en:"list-level-style-bullet",ans:u,a:"style-name"},{ens:u,en:"outline-level-style",ans:u,a:"style-name"}],paragraph:[{ens:l,en:"caption",ans:l,a:"text-style-name"},{ens:l,
en:"circle",ans:l,a:"text-style-name"},{ens:l,en:"connector",ans:l,a:"text-style-name"},{ens:l,en:"control",ans:l,a:"text-style-name"},{ens:l,en:"custom-shape",ans:l,a:"text-style-name"},{ens:l,en:"ellipse",ans:l,a:"text-style-name"},{ens:l,en:"frame",ans:l,a:"text-style-name"},{ens:l,en:"line",ans:l,a:"text-style-name"},{ens:l,en:"measure",ans:l,a:"text-style-name"},{ens:l,en:"path",ans:l,a:"text-style-name"},{ens:l,en:"polygon",ans:l,a:"text-style-name"},{ens:l,en:"polyline",ans:l,a:"text-style-name"},
{ens:l,en:"rect",ans:l,a:"text-style-name"},{ens:l,en:"regular-polygon",ans:l,a:"text-style-name"},{ens:z,en:"annotation",ans:l,a:"text-style-name"},{ens:y,en:"column",ans:y,a:"text-style-name"},{ens:s,en:"style",ans:s,a:"next-style-name"},{ens:x,en:"body",ans:x,a:"paragraph-style-name"},{ens:x,en:"even-columns",ans:x,a:"paragraph-style-name"},{ens:x,en:"even-rows",ans:x,a:"paragraph-style-name"},{ens:x,en:"first-column",ans:x,a:"paragraph-style-name"},{ens:x,en:"first-row",ans:x,a:"paragraph-style-name"},
{ens:x,en:"last-column",ans:x,a:"paragraph-style-name"},{ens:x,en:"last-row",ans:x,a:"paragraph-style-name"},{ens:x,en:"odd-columns",ans:x,a:"paragraph-style-name"},{ens:x,en:"odd-rows",ans:x,a:"paragraph-style-name"},{ens:u,en:"notes-configuration",ans:u,a:"default-style-name"},{ens:u,en:"alphabetical-index-entry-template",ans:u,a:"style-name"},{ens:u,en:"bibliography-entry-template",ans:u,a:"style-name"},{ens:u,en:"h",ans:u,a:"style-name"},{ens:u,en:"illustration-index-entry-template",ans:u,a:"style-name"},
{ens:u,en:"index-source-style",ans:u,a:"style-name"},{ens:u,en:"object-index-entry-template",ans:u,a:"style-name"},{ens:u,en:"p",ans:u,a:"style-name"},{ens:u,en:"table-index-entry-template",ans:u,a:"style-name"},{ens:u,en:"table-of-content-entry-template",ans:u,a:"style-name"},{ens:u,en:"table-index-entry-template",ans:u,a:"style-name"},{ens:u,en:"user-index-entry-template",ans:u,a:"style-name"},{ens:s,en:"page-layout-properties",ans:s,a:"register-truth-ref-style-name"}],chart:[{ens:e,en:"axis",ans:e,
a:"style-name"},{ens:e,en:"chart",ans:e,a:"style-name"},{ens:e,en:"data-label",ans:e,a:"style-name"},{ens:e,en:"data-point",ans:e,a:"style-name"},{ens:e,en:"equation",ans:e,a:"style-name"},{ens:e,en:"error-indicator",ans:e,a:"style-name"},{ens:e,en:"floor",ans:e,a:"style-name"},{ens:e,en:"footer",ans:e,a:"style-name"},{ens:e,en:"grid",ans:e,a:"style-name"},{ens:e,en:"legend",ans:e,a:"style-name"},{ens:e,en:"mean-value",ans:e,a:"style-name"},{ens:e,en:"plot-area",ans:e,a:"style-name"},{ens:e,en:"regression-curve",
ans:e,a:"style-name"},{ens:e,en:"series",ans:e,a:"style-name"},{ens:e,en:"stock-gain-marker",ans:e,a:"style-name"},{ens:e,en:"stock-loss-marker",ans:e,a:"style-name"},{ens:e,en:"stock-range-line",ans:e,a:"style-name"},{ens:e,en:"subtitle",ans:e,a:"style-name"},{ens:e,en:"title",ans:e,a:"style-name"},{ens:e,en:"wall",ans:e,a:"style-name"}],section:[{ens:u,en:"alphabetical-index",ans:u,a:"style-name"},{ens:u,en:"bibliography",ans:u,a:"style-name"},{ens:u,en:"illustration-index",ans:u,a:"style-name"},
{ens:u,en:"index-title",ans:u,a:"style-name"},{ens:u,en:"object-index",ans:u,a:"style-name"},{ens:u,en:"section",ans:u,a:"style-name"},{ens:u,en:"table-of-content",ans:u,a:"style-name"},{ens:u,en:"table-index",ans:u,a:"style-name"},{ens:u,en:"user-index",ans:u,a:"style-name"}],ruby:[{ens:u,en:"ruby",ans:u,a:"style-name"}],table:[{ens:b,en:"query",ans:b,a:"style-name"},{ens:b,en:"table-representation",ans:b,a:"style-name"},{ens:x,en:"background",ans:x,a:"style-name"},{ens:x,en:"table",ans:x,a:"style-name"}],
"table-column":[{ens:b,en:"column",ans:b,a:"style-name"},{ens:x,en:"table-column",ans:x,a:"style-name"}],"table-row":[{ens:b,en:"query",ans:b,a:"default-row-style-name"},{ens:b,en:"table-representation",ans:b,a:"default-row-style-name"},{ens:x,en:"table-row",ans:x,a:"style-name"}],"table-cell":[{ens:b,en:"column",ans:b,a:"default-cell-style-name"},{ens:x,en:"table-column",ans:x,a:"default-cell-style-name"},{ens:x,en:"table-row",ans:x,a:"default-cell-style-name"},{ens:x,en:"body",ans:x,a:"style-name"},
{ens:x,en:"covered-table-cell",ans:x,a:"style-name"},{ens:x,en:"even-columns",ans:x,a:"style-name"},{ens:x,en:"covered-table-cell",ans:x,a:"style-name"},{ens:x,en:"even-columns",ans:x,a:"style-name"},{ens:x,en:"even-rows",ans:x,a:"style-name"},{ens:x,en:"first-column",ans:x,a:"style-name"},{ens:x,en:"first-row",ans:x,a:"style-name"},{ens:x,en:"last-column",ans:x,a:"style-name"},{ens:x,en:"last-row",ans:x,a:"style-name"},{ens:x,en:"odd-columns",ans:x,a:"style-name"},{ens:x,en:"odd-rows",ans:x,a:"style-name"},
{ens:x,en:"table-cell",ans:x,a:"style-name"}],graphic:[{ens:r,en:"cube",ans:l,a:"style-name"},{ens:r,en:"extrude",ans:l,a:"style-name"},{ens:r,en:"rotate",ans:l,a:"style-name"},{ens:r,en:"scene",ans:l,a:"style-name"},{ens:r,en:"sphere",ans:l,a:"style-name"},{ens:l,en:"caption",ans:l,a:"style-name"},{ens:l,en:"circle",ans:l,a:"style-name"},{ens:l,en:"connector",ans:l,a:"style-name"},{ens:l,en:"control",ans:l,a:"style-name"},{ens:l,en:"custom-shape",ans:l,a:"style-name"},{ens:l,en:"ellipse",ans:l,a:"style-name"},
{ens:l,en:"frame",ans:l,a:"style-name"},{ens:l,en:"g",ans:l,a:"style-name"},{ens:l,en:"line",ans:l,a:"style-name"},{ens:l,en:"measure",ans:l,a:"style-name"},{ens:l,en:"page-thumbnail",ans:l,a:"style-name"},{ens:l,en:"path",ans:l,a:"style-name"},{ens:l,en:"polygon",ans:l,a:"style-name"},{ens:l,en:"polyline",ans:l,a:"style-name"},{ens:l,en:"rect",ans:l,a:"style-name"},{ens:l,en:"regular-polygon",ans:l,a:"style-name"},{ens:z,en:"annotation",ans:l,a:"style-name"}],presentation:[{ens:r,en:"cube",ans:w,
a:"style-name"},{ens:r,en:"extrude",ans:w,a:"style-name"},{ens:r,en:"rotate",ans:w,a:"style-name"},{ens:r,en:"scene",ans:w,a:"style-name"},{ens:r,en:"sphere",ans:w,a:"style-name"},{ens:l,en:"caption",ans:w,a:"style-name"},{ens:l,en:"circle",ans:w,a:"style-name"},{ens:l,en:"connector",ans:w,a:"style-name"},{ens:l,en:"control",ans:w,a:"style-name"},{ens:l,en:"custom-shape",ans:w,a:"style-name"},{ens:l,en:"ellipse",ans:w,a:"style-name"},{ens:l,en:"frame",ans:w,a:"style-name"},{ens:l,en:"g",ans:w,a:"style-name"},
{ens:l,en:"line",ans:w,a:"style-name"},{ens:l,en:"measure",ans:w,a:"style-name"},{ens:l,en:"page-thumbnail",ans:w,a:"style-name"},{ens:l,en:"path",ans:w,a:"style-name"},{ens:l,en:"polygon",ans:w,a:"style-name"},{ens:l,en:"polyline",ans:w,a:"style-name"},{ens:l,en:"rect",ans:w,a:"style-name"},{ens:l,en:"regular-polygon",ans:w,a:"style-name"},{ens:z,en:"annotation",ans:w,a:"style-name"}],"drawing-page":[{ens:l,en:"page",ans:l,a:"style-name"},{ens:w,en:"notes",ans:l,a:"style-name"},{ens:s,en:"handout-master",
ans:l,a:"style-name"},{ens:s,en:"master-page",ans:l,a:"style-name"}],"list-style":[{ens:u,en:"list",ans:u,a:"style-name"},{ens:u,en:"numbered-paragraph",ans:u,a:"style-name"},{ens:u,en:"list-item",ans:u,a:"style-override"},{ens:s,en:"style",ans:s,a:"list-style-name"}],data:[{ens:s,en:"style",ans:s,a:"data-style-name"},{ens:s,en:"style",ans:s,a:"percentage-data-style-name"},{ens:w,en:"date-time-decl",ans:s,a:"data-style-name"},{ens:u,en:"creation-date",ans:s,a:"data-style-name"},{ens:u,en:"creation-time",
ans:s,a:"data-style-name"},{ens:u,en:"database-display",ans:s,a:"data-style-name"},{ens:u,en:"date",ans:s,a:"data-style-name"},{ens:u,en:"editing-duration",ans:s,a:"data-style-name"},{ens:u,en:"expression",ans:s,a:"data-style-name"},{ens:u,en:"meta-field",ans:s,a:"data-style-name"},{ens:u,en:"modification-date",ans:s,a:"data-style-name"},{ens:u,en:"modification-time",ans:s,a:"data-style-name"},{ens:u,en:"print-date",ans:s,a:"data-style-name"},{ens:u,en:"print-time",ans:s,a:"data-style-name"},{ens:u,
en:"table-formula",ans:s,a:"data-style-name"},{ens:u,en:"time",ans:s,a:"data-style-name"},{ens:u,en:"user-defined",ans:s,a:"data-style-name"},{ens:u,en:"user-field-get",ans:s,a:"data-style-name"},{ens:u,en:"user-field-input",ans:s,a:"data-style-name"},{ens:u,en:"variable-get",ans:s,a:"data-style-name"},{ens:u,en:"variable-input",ans:s,a:"data-style-name"},{ens:u,en:"variable-set",ans:s,a:"data-style-name"}],"page-layout":[{ens:w,en:"notes",ans:s,a:"page-layout-name"},{ens:s,en:"handout-master",ans:s,
a:"page-layout-name"},{ens:s,en:"master-page",ans:s,a:"page-layout-name"}]},C,G=xmldom.XPath;this.collectUsedFontFaces=n;this.changeFontFaceNames=g;this.UsedStyleList=function(b,e){var a={};this.uses=function(b){var e=b.localName,c=b.getAttributeNS(l,"name")||b.getAttributeNS(s,"name");b="style"===e?b.getAttributeNS(s,"family"):b.namespaceURI===t?"data":e;return(b=a[b])?0<b[c]:!1};d(b,a);e&&p(e,a)};this.getStyleName=function(b,e){var a,c,d=C[e.localName];if(d&&(d=d[e.namespaceURI]))for(c=0;c<d.length;c+=
1)if(d[c].keyname===b&&(d=d[c],e.hasAttributeNS(d.ns,d.localname))){a=e.getAttributeNS(d.ns,d.localname);break}return a};this.hasDerivedStyles=function(b,e,a){var c=a.getAttributeNS(s,"name");a=a.getAttributeNS(s,"family");return G.getODFElementsWithXPath(b,'//style:*[@style:parent-style-name="'+c+'"][@style:family="'+a+'"]',e).length?!0:!1};this.prefixStyleNames=function(b,e,a){var c;if(b){for(c=b.firstChild;c;){if(c.nodeType===Node.ELEMENT_NODE){var d=c,g=e,h=d.getAttributeNS(l,"name"),r=void 0;
h?r=l:(h=d.getAttributeNS(s,"name"))&&(r=s);r&&d.setAttributeNS(r,A[r]+"name",g+h)}c=c.nextSibling}f(b,e);a&&f(a,e)}};this.removePrefixFromStyleNames=function(b,e,a){var c=RegExp("^"+e);if(b){for(e=b.firstChild;e;){if(e.nodeType===Node.ELEMENT_NODE){var d=e,g=c,f=d.getAttributeNS(l,"name"),h=void 0;f?h=l:(f=d.getAttributeNS(s,"name"))&&(h=s);h&&(f=f.replace(g,""),d.setAttributeNS(h,A[h]+"name",f))}e=e.nextSibling}k(b,c);a&&k(a,c)}};this.determineStylesForNode=a;C=function(){var b,e,a,c,d,l={},g,f,
h,r;for(a in H)if(H.hasOwnProperty(a))for(c=H[a],e=c.length,b=0;b<e;b+=1)d=c[b],h=d.en,r=d.ens,l.hasOwnProperty(h)?g=l[h]:l[h]=g={},g.hasOwnProperty(r)?f=g[r]:g[r]=f=[],f.push({ns:d.ans,localname:d.a,keyname:a});return l}()};"function"!==typeof Object.create&&(Object.create=function(f){var k=function(){};k.prototype=f;return new k});
xmldom.LSSerializer=function(){function f(a){var d=a||{},f=function(a){var e={},b;for(b in a)a.hasOwnProperty(b)&&(e[a[b]]=b);return e}(a),q=[d],k=[f],n=0;this.push=function(){n+=1;d=q[n]=Object.create(d);f=k[n]=Object.create(f)};this.pop=function(){q.pop();k.pop();n-=1;d=q[n];f=k[n]};this.getLocalNamespaceDefinitions=function(){return f};this.getQName=function(a){var e=a.namespaceURI,b=0,c;if(!e)return a.localName;if(c=f[e])return c+":"+a.localName;do{c||!a.prefix?(c="ns"+b,b+=1):c=a.prefix;if(d[c]===
e)break;if(!d[c]){d[c]=e;f[e]=c;break}c=null}while(null===c);return c+":"+a.localName}}function k(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;")}function a(c,f){var h="",q=d.filter?d.filter.acceptNode(f):NodeFilter.FILTER_ACCEPT,p;if(q===NodeFilter.FILTER_ACCEPT&&f.nodeType===Node.ELEMENT_NODE){c.push();p=c.getQName(f);var n,g=f.attributes,e,b,r,l="",y;n="<"+p;e=g.length;for(b=0;b<e;b+=1)r=g.item(b),"http://www.w3.org/2000/xmlns/"!==
r.namespaceURI&&(y=d.filter?d.filter.acceptNode(r):NodeFilter.FILTER_ACCEPT,y===NodeFilter.FILTER_ACCEPT&&(y=c.getQName(r),r="string"===typeof r.value?k(r.value):r.value,l+=" "+(y+'="'+r+'"')));e=c.getLocalNamespaceDefinitions();for(b in e)e.hasOwnProperty(b)&&((g=e[b])?"xmlns"!==g&&(n+=" xmlns:"+e[b]+'="'+b+'"'):n+=' xmlns="'+b+'"');h+=n+(l+">")}if(q===NodeFilter.FILTER_ACCEPT||q===NodeFilter.FILTER_SKIP){for(q=f.firstChild;q;)h+=a(c,q),q=q.nextSibling;f.nodeValue&&(h+=k(f.nodeValue))}p&&(h+="</"+
p+">",c.pop());return h}var d=this;this.filter=null;this.writeToString=function(c,d){if(!c)return"";var h=new f(d);return a(h,c)}};(function(){function f(a){var e,b=q.length;for(e=0;e<b;e+=1)if("urn:oasis:names:tc:opendocument:xmlns:office:1.0"===a.namespaceURI&&a.localName===q[e])return e;return-1}function k(a,e){var b=new c.UsedStyleList(a,e),d=new odf.OdfNodeFilter;this.acceptNode=function(a){var c=d.acceptNode(a);c===NodeFilter.FILTER_ACCEPT&&a.parentNode===e&&a.nodeType===Node.ELEMENT_NODE&&(c=b.uses(a)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT);return c}}function a(a,e){var b=new k(a,e);this.acceptNode=function(a){var e=
b.acceptNode(a);e!==NodeFilter.FILTER_ACCEPT||!a.parentNode||a.parentNode.namespaceURI!==odf.Namespaces.textns||"s"!==a.parentNode.localName&&"tab"!==a.parentNode.localName||(e=NodeFilter.FILTER_REJECT);return e}}function d(a,e){if(e){var b=f(e),c,d=a.firstChild;if(-1!==b){for(;d;){c=f(d);if(-1!==c&&c>b)break;d=d.nextSibling}a.insertBefore(e,d)}}}var c=new odf.StyleInfo,m=core.DomUtils,h=odf.Namespaces.stylens,q="meta settings scripts font-face-decls styles automatic-styles master-styles body".split(" "),
p=Date.now()+"_webodf_",n=new core.Base64;odf.ODFElement=function(){};odf.ODFDocumentElement=function(){};odf.ODFDocumentElement.prototype=new odf.ODFElement;odf.ODFDocumentElement.prototype.constructor=odf.ODFDocumentElement;odf.ODFDocumentElement.prototype.fontFaceDecls=null;odf.ODFDocumentElement.prototype.manifest=null;odf.ODFDocumentElement.prototype.settings=null;odf.ODFDocumentElement.namespaceURI="urn:oasis:names:tc:opendocument:xmlns:office:1.0";odf.ODFDocumentElement.localName="document";
odf.AnnotationElement=function(){};odf.OdfPart=function(a,e,b,c){var d=this;this.size=0;this.type=null;this.name=a;this.container=b;this.url=null;this.mimetype=e;this.onstatereadychange=this.document=null;this.EMPTY=0;this.LOADING=1;this.DONE=2;this.state=this.EMPTY;this.data="";this.load=function(){null!==c&&(this.mimetype=e,c.loadAsDataURL(a,e,function(b,a){b&&runtime.log(b);d.url=a;if(d.onchange)d.onchange(d);if(d.onstatereadychange)d.onstatereadychange(d)}))}};odf.OdfPart.prototype.load=function(){};
odf.OdfPart.prototype.getUrl=function(){return this.data?"data:;base64,"+n.toBase64(this.data):null};odf.OdfContainer=function e(b,f){function l(b){for(var a=b.firstChild,e;a;)e=a.nextSibling,a.nodeType===Node.ELEMENT_NODE?l(a):a.nodeType===Node.PROCESSING_INSTRUCTION_NODE&&b.removeChild(a),a=e}function q(b){var a={},e,c,d=b.ownerDocument.createNodeIterator(b,NodeFilter.SHOW_ELEMENT,null,!1);for(b=d.nextNode();b;)"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===b.namespaceURI&&("annotation"===
b.localName?(e=b.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","name"))&&(a.hasOwnProperty(e)?runtime.log("Warning: annotation name used more than once with <office:annotation/>: '"+e+"'"):a[e]=b):"annotation-end"===b.localName&&((e=b.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","name"))?a.hasOwnProperty(e)?(c=a[e],c.annotationEndElement?runtime.log("Warning: annotation name used more than once with <office:annotation-end/>: '"+e+"'"):c.annotationEndElement=
b):runtime.log("Warning: annotation end without an annotation start, name: '"+e+"'"):runtime.log("Warning: annotation end without a name found"))),b=d.nextNode()}function t(b,a){for(var e=b&&b.firstChild;e;)e.nodeType===Node.ELEMENT_NODE&&e.setAttributeNS("urn:webodf:names:scope","scope",a),e=e.nextSibling}function z(b,a){for(var e=U.rootElement.meta,e=e&&e.firstChild;e&&(e.namespaceURI!==b||e.localName!==a);)e=e.nextSibling;for(e=e&&e.firstChild;e&&e.nodeType!==Node.TEXT_NODE;)e=e.nextSibling;return e?
e.data:null}function w(b){var a={},e;for(b=b.firstChild;b;)b.nodeType===Node.ELEMENT_NODE&&b.namespaceURI===h&&"font-face"===b.localName&&(e=b.getAttributeNS(h,"name"),a[e]=b),b=b.nextSibling;return a}function s(b,a){var e=null,c,d,l;if(b)for(e=b.cloneNode(!0),c=e.firstElementChild;c;)d=c.nextElementSibling,(l=c.getAttributeNS("urn:webodf:names:scope","scope"))&&l!==a&&e.removeChild(c),c=d;return e}function x(b,e){var a,d,l,f=null,r={};if(b)for(e.forEach(function(b){c.collectUsedFontFaces(r,b)}),
f=b.cloneNode(!0),a=f.firstElementChild;a;)d=a.nextElementSibling,l=a.getAttributeNS(h,"name"),r[l]||f.removeChild(a),a=d;return f}function u(b){var a=U.rootElement.ownerDocument,e;if(b){l(b.documentElement);try{e=a.importNode(b.documentElement,!0)}catch(c){}}return e}function A(b){U.state=b;if(U.onchange)U.onchange(U);if(U.onstatereadychange)U.onstatereadychange(U)}function H(b){Y=null;U.rootElement=b;b.fontFaceDecls=m.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","font-face-decls");
b.styles=m.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","styles");b.automaticStyles=m.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles");b.masterStyles=m.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","master-styles");b.body=m.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","body");b.meta=m.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","meta");b.settings=m.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0",
"settings");b.scripts=m.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","scripts");q(b)}function C(b){var a=u(b),l=U.rootElement,f;a&&"document-styles"===a.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===a.namespaceURI?(l.fontFaceDecls=m.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","font-face-decls"),d(l,l.fontFaceDecls),f=m.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","styles"),l.styles=f||b.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0",
"styles"),d(l,l.styles),f=m.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles"),l.automaticStyles=f||b.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles"),t(l.automaticStyles,"document-styles"),d(l,l.automaticStyles),a=m.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","master-styles"),l.masterStyles=a||b.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","master-styles"),d(l,l.masterStyles),
c.prefixStyleNames(l.automaticStyles,p,l.masterStyles)):A(e.INVALID)}function G(b){b=u(b);var a,l,f,r,n;if(b&&"document-content"===b.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===b.namespaceURI){a=U.rootElement;r=m.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","font-face-decls");if(a.fontFaceDecls&&r){n=a.fontFaceDecls;var q,k,p,s={};f=w(n);l=w(r);for(r=r.firstElementChild;r;){q=r.nextElementSibling;if(r.namespaceURI===h&&"font-face"===r.localName)if(k=r.getAttributeNS(h,
"name"),f.hasOwnProperty(k)){if(!r.isEqualNode(f[k])){p=k;for(var P=f,D=l,y=0,Z=void 0,Z=p=p.replace(/\d+$/,"");P.hasOwnProperty(Z)||D.hasOwnProperty(Z);)y+=1,Z=p+y;p=Z;r.setAttributeNS(h,"style:name",p);n.appendChild(r);f[p]=r;delete l[k];s[k]=p}}else n.appendChild(r),f[k]=r,delete l[k];r=q}n=s}else r&&(a.fontFaceDecls=r,d(a,r));f=m.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles");t(f,"document-content");for(l=0;l<f.childNodes.length;l+=1)"text:list-style"===
f.childNodes[l].nodeName&&f.childNodes[l].firstChild.setAttributeNS(odf.Namespaces.textns,"text:bullet-char","\u2022");n&&c.changeFontFaceNames(f,n);if(a.automaticStyles&&f)for(n=f.firstChild;n;)a.automaticStyles.appendChild(n),n=f.firstChild;else f&&(a.automaticStyles=f,d(a,f));b=m.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","body");if(null===b)throw"<office:body/> tag is mising.";a.body=b;d(a,a.body)}else A(e.INVALID)}function B(b){b=u(b);var a;b&&"document-meta"===b.localName&&
"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===b.namespaceURI&&(a=U.rootElement,a.meta=m.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","meta"),d(a,a.meta))}function J(b){b=u(b);var a;b&&"document-settings"===b.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===b.namespaceURI&&(a=U.rootElement,a.settings=m.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","settings"),d(a,a.settings))}function P(b){b=u(b);var a;if(b&&"manifest"===b.localName&&
"urn:oasis:names:tc:opendocument:xmlns:manifest:1.0"===b.namespaceURI)for(a=U.rootElement,a.manifest=b,b=a.manifest.firstElementChild;b;)"file-entry"===b.localName&&"urn:oasis:names:tc:opendocument:xmlns:manifest:1.0"===b.namespaceURI&&(O[b.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","full-path")]=b.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","media-type")),b=b.nextElementSibling}function Q(b,a,e){b=m.getElementsByTagName(b,a);var c;for(c=0;c<b.length;c+=
1)a=b[c],e.hasOwnProperty(a.namespaceURI)||a.parentNode.removeChild(a)}function D(b){Q(b,"script",{"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:office:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:table:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:text:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0":!0});Q(b,"style",{"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0":!0,
"urn:oasis:names:tc:opendocument:xmlns:style:1.0":!0})}function Z(b){var a=b.firstElementChild,e=[],c,d,l,f=b.attributes,h=f.length;for(c=0;c<h;c+=1)l=f.item(c),d=l.localName.substr(0,2).toLowerCase(),null===l.namespaceURI&&"on"===d&&e.push(l);h=e.length;for(c=0;c<h;c+=1)b.removeAttributeNode(e[c]);for(;a;)Z(a),a=a.nextElementSibling}function S(b){var a=b.shift();a?W.loadAsDOM(a.path,function(c,d){d&&(D(d),Z(d.documentElement));a.handler(d);U.state===e.INVALID?c?runtime.log("ERROR: Unable to load "+
a.path+" - "+c):runtime.log("ERROR: Unable to load "+a.path):(c&&runtime.log("DEBUG: Unable to load "+a.path+" - "+c),S(b))}):(q(U.rootElement),A(e.DONE))}function v(b){var a="";odf.Namespaces.forEachPrefix(function(b,e){a+=" xmlns:"+b+'="'+e+'"'});return'<?xml version="1.0" encoding="UTF-8"?><office:'+b+" "+a+' office:version="1.2">'}function I(){var b=new xmldom.LSSerializer,a=v("document-meta");b.filter=new odf.OdfNodeFilter;a+=b.writeToString(U.rootElement.meta,odf.Namespaces.namespaceMap);return a+
"</office:document-meta>"}function ba(b,a){var e=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","manifest:file-entry");e.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","manifest:full-path",b);e.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","manifest:media-type",a);return e}function T(){var b=runtime.parseXML('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2"></manifest:manifest>'),
a=b.documentElement,e=new xmldom.LSSerializer,c;for(c in O)O.hasOwnProperty(c)&&a.appendChild(ba(c,O[c]));e.filter=new odf.OdfNodeFilter;return'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n'+e.writeToString(b,odf.Namespaces.namespaceMap)}function F(){var b,a,e,d=odf.Namespaces.namespaceMap,l=new xmldom.LSSerializer,f=v("document-styles");a=s(U.rootElement.automaticStyles,"document-styles");e=U.rootElement.masterStyles.cloneNode(!0);b=x(U.rootElement.fontFaceDecls,[e,U.rootElement.styles,
a]);c.removePrefixFromStyleNames(a,p,e);l.filter=new k(e,a);f+=l.writeToString(b,d);f+=l.writeToString(U.rootElement.styles,d);f+=l.writeToString(a,d);f+=l.writeToString(e,d);return f+"</office:document-styles>"}function N(){var b,e,c=odf.Namespaces.namespaceMap,d=new xmldom.LSSerializer,l=v("document-content");e=s(U.rootElement.automaticStyles,"document-content");b=x(U.rootElement.fontFaceDecls,[e]);d.filter=new a(U.rootElement.body,e);l+=d.writeToString(b,c);l+=d.writeToString(e,c);l+=d.writeToString(U.rootElement.body,
c);return l+"</office:document-content>"}function $(b,a){runtime.loadXML(b,function(b,c){if(b)a(b);else if(c){D(c);Z(c.documentElement);var d=u(c);d&&"document"===d.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===d.namespaceURI?(H(d),A(e.DONE)):A(e.INVALID)}else a("No DOM was loaded.")})}function E(b,a){var e;e=U.rootElement;var c=e.meta;c||(e.meta=c=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","meta"),d(e,c));e=c;b&&m.mapKeyValObjOntoNode(e,b,odf.Namespaces.lookupNamespaceURI);
a&&m.removeKeyElementsFromNode(e,a,odf.Namespaces.lookupNamespaceURI)}function V(b,a){function c(b,a){var e;a||(a=b);e=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0",a);h[b]=e;h.appendChild(e)}var d=new core.Zip("",null),l="application/vnd.oasis.opendocument."+b+(!0===a?"-template":""),f=runtime.byteArrayFromString(l,"utf8"),h=U.rootElement,r=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0",b);d.save("mimetype",f,!1,new Date);c("meta");c("settings");
c("scripts");c("fontFaceDecls","font-face-decls");c("styles");c("automaticStyles","automatic-styles");c("masterStyles","master-styles");c("body");h.body.appendChild(r);O["/"]=l;O["settings.xml"]="text/xml";O["meta.xml"]="text/xml";O["styles.xml"]="text/xml";O["content.xml"]="text/xml";A(e.DONE);return d}function aa(){var b,a=new Date,e="";U.rootElement.settings&&U.rootElement.settings.firstElementChild&&(b=new xmldom.LSSerializer,e=v("document-settings"),b.filter=new odf.OdfNodeFilter,e+=b.writeToString(U.rootElement.settings,
odf.Namespaces.namespaceMap),e+="</office:document-settings>");(b=e)?(b=runtime.byteArrayFromString(b,"utf8"),W.save("settings.xml",b,!0,a)):W.remove("settings.xml");e=runtime.getWindow();b="WebODF/"+webodf.Version;e&&(b=b+" "+e.navigator.userAgent);E({"meta:generator":b},null);b=runtime.byteArrayFromString(I(),"utf8");W.save("meta.xml",b,!0,a);b=runtime.byteArrayFromString(F(),"utf8");W.save("styles.xml",b,!0,a);b=runtime.byteArrayFromString(N(),"utf8");W.save("content.xml",b,!0,a);b=runtime.byteArrayFromString(T(),
"utf8");W.save("META-INF/manifest.xml",b,!0,a)}function ca(b,a){aa();W.writeAs(b,function(b){a(b)})}var U=this,W,O={},Y,R="";this.onstatereadychange=f;this.state=this.onchange=null;this.getMetadata=z;this.setRootElement=H;this.getContentElement=function(){var b;Y||(b=U.rootElement.body,Y=m.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","text")||m.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","presentation")||m.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0",
"spreadsheet"));if(!Y)throw"Could not find content element in <office:body/>.";return Y};this.getDocumentType=function(){var b=U.getContentElement();return b&&b.localName};this.isTemplate=function(){return"-template"===O["/"].substr(-9)};this.setIsTemplate=function(b){var a=O["/"],e="-template"===a.substr(-9);b!==e&&(a=b?a+"-template":a.substr(0,a.length-9),O["/"]=a,b=runtime.byteArrayFromString(a,"utf8"),W.save("mimetype",b,!1,new Date))};this.getPart=function(b){return new odf.OdfPart(b,O[b],U,
W)};this.getPartData=function(b,a){W.load(b,a)};this.setMetadata=E;this.incrementEditingCycles=function(){var b=z(odf.Namespaces.metans,"editing-cycles"),b=b?parseInt(b,10):0;isNaN(b)&&(b=0);E({"meta:editing-cycles":b+1},null);return b+1};this.createByteArray=function(b,a){aa();W.createByteArray(b,a)};this.saveAs=ca;this.save=function(b){ca(R,b)};this.getUrl=function(){return R};this.setBlob=function(b,a,e){e=n.convertBase64ToByteArray(e);W.save(b,e,!1,new Date);O.hasOwnProperty(b)&&runtime.log(b+
" has been overwritten.");O[b]=a};this.removeBlob=function(b){var a=W.remove(b);runtime.assert(a,"file is not found: "+b);delete O[b]};this.state=e.LOADING;this.rootElement=function(b){var a=document.createElementNS(b.namespaceURI,b.localName),e;b=new b.Type;for(e in b)b.hasOwnProperty(e)&&(a[e]=b[e]);return a}({Type:odf.ODFDocumentElement,namespaceURI:odf.ODFDocumentElement.namespaceURI,localName:odf.ODFDocumentElement.localName});b===odf.OdfContainer.DocumentType.TEXT?W=V("text"):b===odf.OdfContainer.DocumentType.TEXT_TEMPLATE?
W=V("text",!0):b===odf.OdfContainer.DocumentType.PRESENTATION?W=V("presentation"):b===odf.OdfContainer.DocumentType.PRESENTATION_TEMPLATE?W=V("presentation",!0):b===odf.OdfContainer.DocumentType.SPREADSHEET?W=V("spreadsheet"):b===odf.OdfContainer.DocumentType.SPREADSHEET_TEMPLATE?W=V("spreadsheet",!0):(R=b,W=new core.Zip(R,function(b,a){W=a;b?$(R,function(a){b&&(W.error=b+"\n"+a,A(e.INVALID))}):S([{path:"styles.xml",handler:C},{path:"content.xml",handler:G},{path:"meta.xml",handler:B},{path:"settings.xml",
handler:J},{path:"META-INF/manifest.xml",handler:P}])}))};odf.OdfContainer.EMPTY=0;odf.OdfContainer.LOADING=1;odf.OdfContainer.DONE=2;odf.OdfContainer.INVALID=3;odf.OdfContainer.SAVING=4;odf.OdfContainer.MODIFIED=5;odf.OdfContainer.getContainer=function(a){return new odf.OdfContainer(a,null)}})();odf.OdfContainer.DocumentType={TEXT:1,TEXT_TEMPLATE:2,PRESENTATION:3,PRESENTATION_TEMPLATE:4,SPREADSHEET:5,SPREADSHEET_TEMPLATE:6};gui.AnnotatableCanvas=function(){};gui.AnnotatableCanvas.prototype.refreshSize=function(){};gui.AnnotatableCanvas.prototype.getZoomLevel=function(){};gui.AnnotatableCanvas.prototype.getSizer=function(){};
gui.AnnotationViewManager=function(f,k,a,d){function c(b){var a=b.annotationEndElement,c=g.createRange(),d=b.getAttributeNS(odf.Namespaces.officens,"name");a&&(c.setStart(b,b.childNodes.length),c.setEnd(a,0),b=e.getTextNodes(c,!1),b.forEach(function(b){var a;a:{for(a=b.parentNode;a.namespaceURI!==odf.Namespaces.officens||"body"!==a.localName;){if(a.namespaceURI===r&&"webodf-annotationHighlight"===a.className&&a.getAttribute("annotation")===d){a=!0;break a}a=a.parentNode}a=!1}a||(a=g.createElement("span"),
a.className="webodf-annotationHighlight",a.setAttribute("annotation",d),b.parentNode.replaceChild(a,b),a.appendChild(b))}));c.detach()}function m(e){var c=f.getSizer();e?(a.style.display="inline-block",c.style.paddingRight=b.getComputedStyle(a).width):(a.style.display="none",c.style.paddingRight=0);f.refreshSize()}function h(){n.sort(function(b,a){return 0!==(b.compareDocumentPosition(a)&Node.DOCUMENT_POSITION_FOLLOWING)?-1:1})}function q(){var b;for(b=0;b<n.length;b+=1){var e=n[b],c=e.parentNode,
d=c.nextElementSibling,g=d.nextElementSibling,h=c.parentNode,r=0,r=n[n.indexOf(e)-1],m=void 0,e=f.getZoomLevel();c.style.left=(a.getBoundingClientRect().left-h.getBoundingClientRect().left)/e+"px";c.style.width=a.getBoundingClientRect().width/e+"px";d.style.width=parseFloat(c.style.left)-30+"px";r?(m=r.parentNode.getBoundingClientRect(),20>=(h.getBoundingClientRect().top-m.bottom)/e?c.style.top=Math.abs(h.getBoundingClientRect().top-m.bottom)/e+20+"px":c.style.top="0px"):c.style.top="0px";g.style.left=
d.getBoundingClientRect().width/e+"px";var d=g.style,h=g.getBoundingClientRect().left/e,r=g.getBoundingClientRect().top/e,m=c.getBoundingClientRect().left/e,q=c.getBoundingClientRect().top/e,k=0,p=0,k=m-h,k=k*k,p=q-r,p=p*p,h=Math.sqrt(k+p);d.width=h+"px";r=Math.asin((c.getBoundingClientRect().top-g.getBoundingClientRect().top)/(e*parseFloat(g.style.width)));g.style.transform="rotate("+r+"rad)";g.style.MozTransform="rotate("+r+"rad)";g.style.WebkitTransform="rotate("+r+"rad)";g.style.msTransform="rotate("+
r+"rad)"}}function p(b){var a=n.indexOf(b),e=b.parentNode.parentNode;"div"===e.localName&&(e.parentNode.insertBefore(b,e),e.parentNode.removeChild(e));b=b.getAttributeNS(odf.Namespaces.officens,"name");b=g.querySelectorAll('span.webodf-annotationHighlight[annotation="'+b+'"]');for(var c,e=0;e<b.length;e+=1){for(c=b.item(e);c.firstChild;)c.parentNode.insertBefore(c.firstChild,c);c.parentNode.removeChild(c)}-1!==a&&n.splice(a,1);0===n.length&&m(!1)}var n=[],g=k.ownerDocument,e=odf.OdfUtils,b=runtime.getWindow(),
r="http://www.w3.org/1999/xhtml";runtime.assert(Boolean(b),"Expected to be run in an environment which has a global window, like a browser.");this.rerenderAnnotations=q;this.rehighlightAnnotations=function(){n.forEach(function(b){c(b)})};this.getMinimumHeightForAnnotationPane=function(){return"none"!==a.style.display&&0<n.length?(n[n.length-1].parentNode.getBoundingClientRect().bottom-a.getBoundingClientRect().top)/f.getZoomLevel()+"px":null};this.addAnnotations=function(b){0!==b.length&&(m(!0),b.forEach(function(b){n.push(b);
var a=g.createElement("div"),l=g.createElement("div"),f=g.createElement("div"),h=g.createElement("div"),r;a.className="annotationWrapper";a.setAttribute("creator",e.getAnnotationCreator(b));b.parentNode.insertBefore(a,b);l.className="annotationNote";l.appendChild(b);d&&(r=g.createElement("div"),r.className="annotationRemoveButton",l.appendChild(r));f.className="annotationConnector horizontal";h.className="annotationConnector angular";a.appendChild(l);a.appendChild(f);a.appendChild(h);b.annotationEndElement&&
c(b)}),h(),q())};this.forgetAnnotation=p;this.forgetAnnotations=function(){for(;n.length;)p(n[0])}};gui.Viewport=function(){};gui.Viewport.prototype.scrollIntoView=function(f,k){};gui.SingleScrollViewport=function(f){this.scrollIntoView=function(k,a){var d,c,m,h;h=f.offsetHeight-f.clientHeight;m=f.offsetWidth-f.clientWidth;var q=f.getBoundingClientRect();if(k&&q){d=q.left+5;c=q.top+5;m=q.right-(m+5);h=q.bottom-(h+5);if(a||k.top<c)f.scrollTop-=c-k.top;else if(k.top>h||k.bottom>h)f.scrollTop=k.bottom-k.top<=h-c?f.scrollTop+(k.bottom-h):f.scrollTop+(k.top-c);k.left<d?f.scrollLeft-=d-k.left:k.right>m&&(f.scrollLeft=k.right-k.left<=m-d?f.scrollLeft+(k.right-m):f.scrollLeft-(d-k.left))}}};(function(){function f(a,m,h,q,k){var n,g=0,e;for(e in a)if(a.hasOwnProperty(e)){if(g===h){n=e;break}g+=1}n?m.getPartData(a[n].href,function(b,e){if(b)runtime.log(b);else if(e){var l="@font-face { font-family: "+(a[n].family||n)+"; src: url(data:application/x-font-ttf;charset=binary;base64,"+d.convertUTF8ArrayToBase64(e)+') format("truetype"); }';try{q.insertRule(l,q.cssRules.length)}catch(g){runtime.log("Problem inserting rule in CSS: "+runtime.toJson(g)+"\nRule: "+l)}}else runtime.log("missing font data for "+
a[n].href);f(a,m,h+1,q,k)}):k&&k()}var k=xmldom.XPath,a=odf.OdfUtils,d=new core.Base64;odf.FontLoader=function(){this.loadFonts=function(c,d){for(var h=c.rootElement.fontFaceDecls;d.cssRules.length;)d.deleteRule(d.cssRules.length-1);if(h){var q={},p,n,g,e;if(h)for(h=k.getODFElementsWithXPath(h,"style:font-face[svg:font-face-src]",odf.Namespaces.lookupNamespaceURI),p=0;p<h.length;p+=1)n=h[p],g=n.getAttributeNS(odf.Namespaces.stylens,"name"),e=a.getNormalizedFontFamilyName(n.getAttributeNS(odf.Namespaces.svgns,
"font-family")),n=k.getODFElementsWithXPath(n,"svg:font-face-src/svg:font-face-uri",odf.Namespaces.lookupNamespaceURI),0<n.length&&(n=n[0].getAttributeNS(odf.Namespaces.xlinkns,"href"),q[g]={href:n,family:e});f(q,c,0,d)}}}})();odf.Formatting=function(){function f(b){return(b=A[b])?x.mergeObjects({},b):{}}function k(){for(var b=e.rootElement.fontFaceDecls,a={},c,d,b=b&&b.firstElementChild;b;){if(c=b.getAttributeNS(l,"name"))if((d=b.getAttributeNS(r,"font-family"))||0<b.getElementsByTagNameNS(r,"font-face-uri").length)a[c]=d;b=b.nextElementSibling}return a}function a(b){for(var a=e.rootElement.styles.firstElementChild;a;){if(a.namespaceURI===l&&"default-style"===a.localName&&a.getAttributeNS(l,"family")===b)return a;a=a.nextElementSibling}return null}
function d(b,a,c){var d,f,g;c=c||[e.rootElement.automaticStyles,e.rootElement.styles];for(g=0;g<c.length;g+=1)for(d=c[g],d=d.firstElementChild;d;){f=d.getAttributeNS(l,"name");if(d.namespaceURI===l&&"style"===d.localName&&d.getAttributeNS(l,"family")===a&&f===b||"list-style"===a&&d.namespaceURI===y&&"list-style"===d.localName&&f===b||"data"===a&&d.namespaceURI===t&&f===b)return d;d=d.nextElementSibling}return null}function c(b){for(var a,e,c,d,f={},g=b.firstElementChild;g;){if(g.namespaceURI===l)for(c=
f[g.nodeName]={},e=g.attributes,a=0;a<e.length;a+=1)d=e.item(a),c[d.name]=d.value;g=g.nextElementSibling}e=b.attributes;for(a=0;a<e.length;a+=1)d=e.item(a),f[d.name]=d.value;return f}function m(b,g){for(var h=e.rootElement.styles,r,m={},n=b.getAttributeNS(l,"family"),q=b;q;)r=c(q),m=x.mergeObjects(r,m),q=(r=q.getAttributeNS(l,"parent-style-name"))?d(r,n,[h]):null;if(q=a(n))r=c(q),m=x.mergeObjects(r,m);!1!==g&&(r=f(n),m=x.mergeObjects(r,m));return m}function h(a,c){function d(b){Object.keys(b).forEach(function(a){Object.keys(b[a]).forEach(function(b){h+=
"|"+a+":"+b+"|"})})}for(var f=a.nodeType===Node.TEXT_NODE?a.parentNode:a,l,g=[],h="",r=!1;f&&!w.isInlineRoot(f)&&f.parentNode!==e.rootElement;)!r&&w.isGroupingElement(f)&&(r=!0),(l=b.determineStylesForNode(f))&&g.push(l),f=f.parentNode;r&&(g.forEach(d),c&&(c[h]=g));return r?g:void 0}function q(b){var a={orderedStyles:[],styleProperties:{}};b.forEach(function(b){Object.keys(b).forEach(function(c){var f=Object.keys(b[c])[0],g={name:f,family:c,displayName:void 0,isCommonStyle:!1},h;(h=d(f,c))?(c=m(h),
a.styleProperties=x.mergeObjects(c,a.styleProperties),g.displayName=h.getAttributeNS(l,"display-name")||void 0,g.isCommonStyle=h.parentNode===e.rootElement.styles):runtime.log("No style element found for '"+f+"' of family '"+c+"'");a.orderedStyles.push(g)})});return a}function p(b,a){var e={},c=[];a||(a={});b.forEach(function(b){h(b,e)});Object.keys(e).forEach(function(b){a[b]||(a[b]=q(e[b]));c.push(a[b])});return c}function n(b){for(var a=e.rootElement.masterStyles.firstElementChild;a&&(a.namespaceURI!==
l||"master-page"!==a.localName||a.getAttributeNS(l,"name")!==b);)a=a.nextElementSibling;return a}function g(b,a){var e;b&&(e=u.convertMeasure(b,"px"));void 0===e&&a&&(e=u.convertMeasure(a,"px"));return e}var e,b=new odf.StyleInfo,r=odf.Namespaces.svgns,l=odf.Namespaces.stylens,y=odf.Namespaces.textns,t=odf.Namespaces.numberns,z=odf.Namespaces.fons,w=odf.OdfUtils,s=core.DomUtils,x=new core.Utils,u=new core.CSSUnits,A={paragraph:{"style:paragraph-properties":{"fo:text-align":"left"}}};this.getSystemDefaultStyleAttributes=
f;this.setOdfContainer=function(b){e=b};this.getFontMap=k;this.getAvailableParagraphStyles=function(){for(var b=e.rootElement.styles,a,c,d=[],b=b&&b.firstElementChild;b;)"style"===b.localName&&b.namespaceURI===l&&(a=b.getAttributeNS(l,"family"),"paragraph"===a&&(a=b.getAttributeNS(l,"name"),c=b.getAttributeNS(l,"display-name")||a,a&&c&&d.push({name:a,displayName:c}))),b=b.nextElementSibling;return d};this.isStyleUsed=function(a){var c,d=e.rootElement;c=b.hasDerivedStyles(d,odf.Namespaces.lookupNamespaceURI,
a);a=(new b.UsedStyleList(d.styles)).uses(a)||(new b.UsedStyleList(d.automaticStyles)).uses(a)||(new b.UsedStyleList(d.body)).uses(a);return c||a};this.getDefaultStyleElement=a;this.getStyleElement=d;this.getStyleAttributes=c;this.getInheritedStyleAttributes=m;this.getFirstCommonParentStyleNameOrSelf=function(b){var a=e.rootElement.styles,c;if(c=d(b,"paragraph",[e.rootElement.automaticStyles]))if(b=c.getAttributeNS(l,"parent-style-name"),!b)return null;return(c=d(b,"paragraph",[a]))?b:null};this.hasParagraphStyle=
function(b){return Boolean(d(b,"paragraph"))};this.getAppliedStyles=p;this.getAppliedStylesForElement=function(b,a){return p([b],a)[0]};this.updateStyle=function(b,a){var c,d;s.mapObjOntoNode(b,a,odf.Namespaces.lookupNamespaceURI);(c=(c=a["style:text-properties"])&&c["style:font-name"])&&!k().hasOwnProperty(c)&&(d=b.ownerDocument.createElementNS(l,"style:font-face"),d.setAttributeNS(l,"style:name",c),d.setAttributeNS(r,"svg:font-family",c),e.rootElement.fontFaceDecls.appendChild(d))};this.createDerivedStyleObject=
function(b,a,f){var l=d(b,a);runtime.assert(Boolean(l),"No style element found for '"+b+"' of family '"+a+"'");b=l.parentNode===e.rootElement.styles?{"style:parent-style-name":b}:c(l);b["style:family"]=a;x.mergeObjects(b,f);return b};this.getDefaultTabStopDistance=function(){for(var b=a("paragraph"),b=b&&b.firstElementChild,e;b;)b.namespaceURI===l&&"paragraph-properties"===b.localName&&(e=b.getAttributeNS(l,"tab-stop-distance")),b=b.nextElementSibling;e||(e="1.25cm");return w.parseNonNegativeLength(e)};
this.getMasterPageElement=n;this.getContentSize=function(b,a){var c,f,h,r,m,q,k,p,y,t;a:{f=d(b,a);runtime.assert("paragraph"===a||"table"===a,"styleFamily must be either paragraph or table");if(f){if(f=f.getAttributeNS(l,"master-page-name"))(c=n(f))||runtime.log("WARN: No master page definition found for "+f);c||(c=n("Standard"));c||(c=e.rootElement.masterStyles.getElementsByTagNameNS(l,"master-page")[0])||runtime.log("WARN: Document has no master pages defined");if(c)for(f=c.getAttributeNS(l,"page-layout-name"),
h=e.rootElement.automaticStyles.getElementsByTagNameNS(l,"page-layout"),r=0;r<h.length;r+=1)if(c=h.item(r),c.getAttributeNS(l,"name")===f)break a}c=null}c||(c=s.getDirectChild(e.rootElement.styles,l,"default-page-layout"));(c=s.getDirectChild(c,l,"page-layout-properties"))?("landscape"===c.getAttributeNS(l,"print-orientation")?(f="29.7cm",h="21.001cm"):(f="21.001cm",h="29.7cm"),f=g(c.getAttributeNS(z,"page-width"),f),h=g(c.getAttributeNS(z,"page-height"),h),r=g(c.getAttributeNS(z,"margin")),void 0===
r?(r=g(c.getAttributeNS(z,"margin-left"),"2cm"),m=g(c.getAttributeNS(z,"margin-right"),"2cm"),q=g(c.getAttributeNS(z,"margin-top"),"2cm"),k=g(c.getAttributeNS(z,"margin-bottom"),"2cm")):r=m=q=k=r,p=g(c.getAttributeNS(z,"padding")),void 0===p?(p=g(c.getAttributeNS(z,"padding-left"),"0cm"),y=g(c.getAttributeNS(z,"padding-right"),"0cm"),t=g(c.getAttributeNS(z,"padding-top"),"0cm"),c=g(c.getAttributeNS(z,"padding-bottom"),"0cm")):p=y=t=c=p):(f=g("21.001cm"),h=g("29.7cm"),r=m=q=k=r=g("2cm"),p=y=t=c=p=
g("0cm"));return{width:f-r-m-p-y,height:h-q-k-t-c}}};(function(){var f=odf.Namespaces.stylens,k=odf.Namespaces.textns,a={graphic:"draw","drawing-page":"draw",paragraph:"text",presentation:"presentation",ruby:"text",section:"text",table:"table","table-cell":"table","table-column":"table","table-row":"table",text:"text",list:"text",page:"office"};odf.StyleTreeNode=function(a){this.derivedStyles={};this.element=a};odf.StyleTree=function(d,c){function m(a){var e,b,c,d={};if(!a)return d;for(a=a.firstElementChild;a;){if(b=a.namespaceURI!==f||"style"!==a.localName&&
"default-style"!==a.localName?a.namespaceURI===k&&"list-style"===a.localName?"list":a.namespaceURI!==f||"page-layout"!==a.localName&&"default-page-layout"!==a.localName?void 0:"page":a.getAttributeNS(f,"family"))(e=a.getAttributeNS(f,"name"))||(e=""),d.hasOwnProperty(b)?c=d[b]:d[b]=c={},c[e]=a;a=a.nextElementSibling}return d}function h(a,e){if(a.hasOwnProperty(e))return a[e];var b=null,c=Object.keys(a),d;for(d=0;d<c.length&&!(b=h(a[c[d]].derivedStyles,e));d+=1);return b}function q(a,e,b){var c,d,
m;if(!e.hasOwnProperty(a))return null;c=new odf.StyleTreeNode(e[a]);d=c.element.getAttributeNS(f,"parent-style-name");m=null;d&&(m=h(b,d)||q(d,e,b));m?m.derivedStyles[a]=c:b[a]=c;delete e[a];return c}function p(a,e){a&&Object.keys(a).forEach(function(b){q(b,a,e)})}var n={};this.getStyleTree=function(){return n};(function(){var f,e,b;e=m(d);b=m(c);Object.keys(a).forEach(function(a){f=n[a]={};p(e[a],f);p(b[a],f)})})()}})();(function(){function f(a,c){try{a.insertRule(c,a.cssRules.length)}catch(d){runtime.log("cannot load rule: "+c+" - "+d)}}function k(a,c){this.listCounterCount=0;this.contentRules=a;this.counterIdStack=[];this.continuedCounterIdStack=c}function a(a){function c(b,d,g,h){var q=d.namespaceURI===m&&"list"===d.localName,k=d.namespaceURI===m&&"list-item"===d.localName;if(q||k){if(q){var q=g+=1,s,x,u;h.listCounterCount+=1;k=b+"-level"+q+"-"+h.listCounterCount;d.setAttributeNS("urn:webodf:names:helper","counter-id",
k);s=h.continuedCounterIdStack.shift();s||(s=k,e+=k+" 1 ",x='text|list[webodfhelper|counter-id="'+k+'"] > text|list-item:first-child > :not(text|list):first-child:before',x+="{",x+="counter-increment: "+s+" 0;",x+="}",f(a,x));for(;h.counterIdStack.length>=q;)h.counterIdStack.pop();h.counterIdStack.push(s);u=h.contentRules[q.toString()]||"";for(x=1;x<=q;x+=1)u=u.replace(x+"webodf-listLevel",h.counterIdStack[x-1]);x='text|list[webodfhelper|counter-id="'+k+'"] > text|list-item > :not(text|list):first-child:before';
x+="{";x+=u;x+="counter-increment: "+s+";";x+="}";f(a,x)}for(d=d.firstElementChild;d;)c(b,d,g,h),d=d.nextElementSibling}else h.continuedCounterIdStack=[]}var d=0,e="",b={};this.createCounterRules=function(a,e,f){var m=e.getAttributeNS(h,"id"),q=[];f&&(f=f.getAttributeNS("urn:webodf:names:helper","counter-id"),q=b[f].slice(0));a=new k(a,q);m?m="Y"+m:(d+=1,m="X"+d);c(m,e,0,a);b[m+"-level1-1"]=a.counterIdStack};this.initialiseCreatedCounters=function(){var b;b="office|document{"+("counter-reset: "+e+
";");b+="}";f(a,b)}}var d=odf.Namespaces.fons,c=odf.Namespaces.stylens,m=odf.Namespaces.textns,h=odf.Namespaces.xmlns,q={1:"decimal",a:"lower-latin",A:"upper-latin",i:"lower-roman",I:"upper-roman"};odf.ListStyleToCss=function(){function k(a){var e=r.parseLength(a);return e?b.convert(e.value,e.unit,"px"):(runtime.log("Could not parse value '"+a+"'."),0)}function n(b){return b.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function g(b,a){var e;b&&(e=b.getAttributeNS(m,"style-name"));return e===a}function e(b,
e,d){e=e.getElementsByTagNameNS(m,"list");b=new a(b);var f,r,k,p,u,A,H={},C;for(C=0;C<e.length;C+=1)if(f=e.item(C),A=f.getAttributeNS(m,"style-name")){k=f.getAttributeNS(m,"continue-numbering");p=f.getAttributeNS(m,"continue-list");(u=f.getAttributeNS(h,"id"))&&(H[u]=f);if(void 0===d[A])u={};else{u=d[A].element.firstElementChild;for(var G=void 0,B={};u;){var G=(G=u.getAttributeNS(m,"level"))&&parseInt(G,10),J=B,P=u,Q="",D=void 0,Z=void 0,S=D=void 0;if("list-level-style-number"===P.localName){var v=
P,Q=v.getAttributeNS(c,"num-format"),D=v.getAttributeNS(c,"num-suffix")||"",Z=v.getAttributeNS(c,"num-prefix")||"",I="",ba=v.getAttributeNS(m,"level"),v=v.getAttributeNS(m,"display-levels");Z&&(I+='"'+n(Z)+'"\n');if(q.hasOwnProperty(Q))for(ba=ba?parseInt(ba,10):1,v=v?parseInt(v,10):1;0<v;)I+=" counter("+(ba-v+1)+"webodf-listLevel,"+q[Q]+")",1<v&&(I+='"."'),v-=1;else I=Q?I+(' "'+Q+'"'):I+' ""';Q="content:"+I+' "'+n(D)+'"'}else"list-level-style-image"===P.localName?Q="content: none":"list-level-style-bullet"===
P.localName&&(Q=P.getAttributeNS(m,"bullet-char"),Q='content: "'+n(Q)+'"');if(D=P.getElementsByTagNameNS(c,"list-level-properties")[0])Z=D.getAttributeNS(m,"list-level-position-and-space-mode"),"label-alignment"===Z&&((D=D.getElementsByTagNameNS(c,"list-level-label-alignment")[0])&&(S=D.getAttributeNS(m,"label-followed-by")),"space"===S&&(Q+=' "\\a0"'));J[G]="\n"+Q+";\n";u=u.nextElementSibling}u=B}k&&!p&&g(r,A)?b.createCounterRules(u,f,r):p&&g(H[p],A)?b.createCounterRules(u,f,H[p]):b.createCounterRules(u,
f);r=f}b.initialiseCreatedCounters()}var b=new core.CSSUnits,r=odf.OdfUtils;this.applyListStyles=function(b,a,g){var h,r;(h=a.list)&&Object.keys(h).forEach(function(a){r=h[a];for(var e=r.element.firstElementChild;e;){if(e.namespaceURI===m){for(var g=b,n=e,q='text|list[text|style-name="'+a+'"]',y=n.getAttributeNS(m,"level"),t=void 0,B=void 0,J=B=void 0,P=void 0,Q=void 0,D=t=void 0,Z=void 0,S=void 0,v=void 0,P=void 0,J=(B=n.getElementsByTagNameNS(c,"list-level-properties")[0])&&B.getAttributeNS(m,"list-level-position-and-space-mode"),
P=B&&B.getElementsByTagNameNS(c,"list-level-label-alignment")[0],t=y=y&&parseInt(y,10);1<t;)q+=" > text|list-item > text|list",t-=1;t=B&&B.getAttributeNS(d,"text-align")||"left";switch(t){case "end":t="right";break;case "start":t="left"}"label-alignment"===J?(Q=P&&P.getAttributeNS(d,"margin-left")||"0px",S=P&&P.getAttributeNS(d,"text-indent")||"0px",v=P&&P.getAttributeNS(m,"label-followed-by"),P=k(Q)):(Q=B&&B.getAttributeNS(m,"space-before")||"0px",D=B&&B.getAttributeNS(m,"min-label-width")||"0px",
Z=B&&B.getAttributeNS(m,"min-label-distance")||"0px",P=k(Q)+k(D));B=q+" > text|list-item";B+="{";B+="margin-left: "+P+"px;";B+="}";f(g,B);B=q+" > text|list-item > text|list";B+="{";B+="margin-left: "+-P+"px;";B+="}";f(g,B);B=q+" > text|list-item > :not(text|list):first-child:before";B+="{";B+="text-align: "+t+";";B+="display: inline-block;";"label-alignment"===J?(B+="margin-left: "+S+";","listtab"===v&&(B+="padding-right: 0.2cm;")):(B+="min-width: "+D+";",B+="margin-left: "+(0===parseFloat(D)?"":
"-")+D+";",B+="padding-right: "+Z+";");B+="}";f(g,B)}e=e.nextElementSibling}});e(b,g,h)}}})();odf.LazyStyleProperties=function(f,k){var a={};this.value=function(d){var c;a.hasOwnProperty(d)?c=a[d]:(c=k[d](),void 0===c&&f&&(c=f.value(d)),a[d]=c);return c};this.reset=function(d){f=d;a={}}};
odf.StyleParseUtils=function(){function f(a){var d,c;a=(a=/(-?[0-9]*[0-9][0-9]*(\.[0-9]*)?|0+\.[0-9]*[1-9][0-9]*|\.[0-9]*[1-9][0-9]*)((cm)|(mm)|(in)|(pt)|(pc)|(px))/.exec(a))?{value:parseFloat(a[1]),unit:a[3]}:null;c=a&&a.unit;"px"===c?d=a.value:"cm"===c?d=96*(a.value/2.54):"mm"===c?d=96*(a.value/25.4):"in"===c?d=96*a.value:"pt"===c?d=a.value/0.75:"pc"===c&&(d=16*a.value);return d}var k=odf.Namespaces.stylens;this.parseLength=f;this.parsePositiveLengthOrPercent=function(a,d,c){var m;a&&(m=parseFloat(a.substr(0,
a.indexOf("%"))),isNaN(m)&&(m=void 0));var h;void 0!==m?(c&&(h=c.value(d)),m=void 0===h?void 0:m*(h/100)):m=f(a);return m};this.getPropertiesElement=function(a,d,c){for(d=c?c.nextElementSibling:d.firstElementChild;null!==d&&(d.localName!==a||d.namespaceURI!==k);)d=d.nextElementSibling;return d};this.parseAttributeList=function(a){a&&(a=a.replace(/^\s*(.*?)\s*$/g,"$1"));return a&&0<a.length?a.split(/\s+/):[]}};odf.Style2CSS=function(){function f(b,a,e){var c=[];e=e.derivedStyles;var d;var g=z[b],l;void 0===g?a=null:(l=a?"["+g+'|style-name="'+a+'"]':"","presentation"===g&&(g="draw",l=a?'[presentation|style-name="'+a+'"]':""),a=g+"|"+w[b].join(l+","+g+"|")+l);null!==a&&c.push(a);for(d in e)e.hasOwnProperty(d)&&(a=f(b,d,e[d]),c=c.concat(a));return c}function k(b){var a="",e="",a=null;if("default-style"===b.localName)return null;a=b.getAttributeNS(g,"parent-style-name");e=b.getAttributeNS(g,"family");return a=
T.getODFElementsWithXPath(I,a?"//style:*[@style:name='"+a+"'][@style:family='"+e+"']":"//style:default-style[@style:family='"+e+"']",odf.Namespaces.lookupNamespaceURI)[0]}function a(b,a){var e="",c,d,f;for(c=0;c<a.length;c+=1)if(d=a[c],f=b.getAttributeNS(d[0],d[1])){f=f.trim();if(Q.hasOwnProperty(d[1])){var l=f,h=l.indexOf(" "),r=void 0;f=void 0;-1!==h?(r=l.substring(0,h),f=l.substring(h)):(r=l,f="");(r=S.parseLength(r))&&"pt"===r.unit&&0.75>r.value&&(l="0.75pt"+f);f=l}else if(D.hasOwnProperty(d[1])){var l=
b,h=d[0],r=d[1],m=S.parseLength(f),n=void 0,q=void 0,p=void 0,s=void 0,p=void 0;if(m&&"%"===m.unit){n=m.value/100;q=k(l.parentNode);for(s="0";q;){if(p=y.getDirectChild(q,g,"paragraph-properties"))if(p=S.parseLength(p.getAttributeNS(h,r))){if("%"!==p.unit){s=p.value*n+p.unit;break}n*=p.value/100}q=k(q)}f=s}}d[2]&&(e+=d[2]+":"+f+";")}return e}function d(b,a,e,c){return a+a+e+e+c+c}function c(b,a){var e=[b],d=a.derivedStyles;Object.keys(d).forEach(function(b){b=c(b,d[b]);e=e.concat(b)});return e}function m(b,
a,e,d){function f(a,e){var c=[],d;a.forEach(function(b){g.forEach(function(a){c.push('draw|page[webodfhelper|page-style-name="'+a+'"] draw|frame[presentation|class="'+b+'"]')})});0<c.length&&(d=c.join(",")+"{visibility:"+e+";}",b.insertRule(d,b.cssRules.length))}var g=c(a,d),h=[],r=[];["page-number","date-time","header","footer"].forEach(function(b){var a;a=e.getAttributeNS(l,"display-"+b);"true"===a?h.push(b):"false"===a&&r.push(b)});f(h,"visible");f(r,"hidden")}function h(e,c,D,Q){var w,z;if("page"===
c){var I=Q.element,T="",O,Y;Y=O="";D=y.getDirectChild(I,g,"page-layout-properties");var R;if(D)if(R=I.getAttributeNS(g,"name"),T+=a(D,J),(O=y.getDirectChild(D,g,"background-image"))&&(Y=O.getAttributeNS(r,"href"))&&(T=T+("background-image: url('odfkit:"+Y+"');")+a(O,x)),"presentation"===v)for(I=(I=y.getDirectChild(I.parentNode.parentNode,n,"master-styles"))&&I.firstElementChild;I;)I.namespaceURI===g&&"master-page"===I.localName&&I.getAttributeNS(g,"page-layout-name")===R&&(Y=I.getAttributeNS(g,"name"),
O='draw|page[draw|master-page-name="'+Y+'"] {'+T+"}",Y='office|body, draw|page[draw|master-page-name="'+Y+'"] {'+a(D,P)+" }",e.insertRule(O,e.cssRules.length),e.insertRule(Y,e.cssRules.length)),I=I.nextElementSibling;else"text"===v&&(O="office|text {"+T+"}",Y="office|body {width: "+D.getAttributeNS(p,"page-width")+";}",e.insertRule(O,e.cssRules.length),e.insertRule(Y,e.cssRules.length))}else{T=f(c,D,Q).join(",");R="";if(I=y.getDirectChild(Q.element,g,"text-properties")){var K=I,ea=z="";O="";Y=1;I=
""+a(K,s);w=K.getAttributeNS(g,"text-underline-style");"solid"===w&&(z+=" underline");w=K.getAttributeNS(g,"text-line-through-style");"solid"===w&&(z+=" line-through");z.length&&(I=I+("text-decoration:"+z+";\n")+("text-decoration-line:"+z+";\n"),I+="-moz-text-decoration-line:"+z+";\n");w=K.getAttributeNS(g,"text-line-through-type");switch(w){case "double":ea+=" double";break;case "single":ea+=" single"}ea&&(I+="text-decoration-style:"+ea+";\n",I+="-moz-text-decoration-style:"+ea+";\n");if(z=K.getAttributeNS(g,
"font-name")||K.getAttributeNS(p,"font-family"))w=Z[z],I+="font-family: "+(w||z)+";";if(w=K.getAttributeNS(g,"text-position"))z=t.parseAttributeList(w),w=z[0],z=z[1],I+="vertical-align: "+w+"\n; ",z&&(Y=parseFloat(z)/100);if(K.hasAttributeNS(p,"font-size")||1!==Y){for(K=K.parentNode;K;){if(w=(w=y.getDirectChild(K,g,"text-properties"))?S.parseFoFontSize(w.getAttributeNS(p,"font-size")):null){if("%"!==w.unit){O="font-size: "+w.value*Y+w.unit+";";break}Y*=w.value/100}K=k(K)}O||(O="font-size: "+parseFloat(ba)*
Y+F.getUnits(ba)+";")}I+=O;R+=I}if(I=y.getDirectChild(Q.element,g,"paragraph-properties"))O=I,I=""+a(O,u),(Y=y.getDirectChild(O,g,"background-image"))&&(K=Y.getAttributeNS(r,"href"))&&(I=I+("background-image: url('odfkit:"+K+"');")+a(Y,x)),(O=O.getAttributeNS(p,"line-height"))&&"normal"!==O&&(O=S.parseFoLineHeight(O),I="%"!==O.unit?I+("line-height: "+O.value+O.unit+";"):I+("line-height: "+O.value/100+";")),R+=I;if(I=y.getDirectChild(Q.element,g,"graphic-properties"))K=I,I=""+a(K,A),O=K.getAttributeNS(q,
"opacity"),Y=K.getAttributeNS(q,"fill"),K=K.getAttributeNS(q,"fill-color"),"solid"===Y||"hatch"===Y?K&&"none"!==K?(O=isNaN(parseFloat(O))?1:parseFloat(O)/100,Y=K.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,d),(K=(Y=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(Y))?{r:parseInt(Y[1],16),g:parseInt(Y[2],16),b:parseInt(Y[3],16)}:null)&&(I+="background-color: rgba("+K.r+","+K.g+","+K.b+","+O+");")):I+="background: none;":"none"===Y&&(I+="background: none;"),R+=I;if(I=y.getDirectChild(Q.element,g,"drawing-page-properties"))O=
I,Y=""+a(O,A),"true"===O.getAttributeNS(l,"background-visible")&&(Y+="background: none;"),R+=Y,m(e,D,I,Q);if(I=y.getDirectChild(Q.element,g,"table-cell-properties"))D=R,R=""+a(I,H),R=D+R;if(I=y.getDirectChild(Q.element,g,"table-row-properties"))D=R,R=""+a(I,G),R=D+R;if(I=y.getDirectChild(Q.element,g,"table-column-properties"))D=R,R=""+a(I,C),R=D+R;if(I=y.getDirectChild(Q.element,g,"table-properties"))D=R,R=""+a(I,B),I=I.getAttributeNS(b,"border-model"),"collapsing"===I?R+="border-collapse:collapse;":
"separating"===I&&(R+="border-collapse:separate;"),R=D+R;0!==R.length&&e.insertRule(T+"{"+R+"}",e.cssRules.length)}for(var ga in Q.derivedStyles)Q.derivedStyles.hasOwnProperty(ga)&&h(e,c,ga,Q.derivedStyles[ga])}var q=odf.Namespaces.drawns,p=odf.Namespaces.fons,n=odf.Namespaces.officens,g=odf.Namespaces.stylens,e=odf.Namespaces.svgns,b=odf.Namespaces.tablens,r=odf.Namespaces.xlinkns,l=odf.Namespaces.presentationns,y=core.DomUtils,t=new odf.StyleParseUtils,z={graphic:"draw","drawing-page":"draw",paragraph:"text",
presentation:"presentation",ruby:"text",section:"text",table:"table","table-cell":"table","table-column":"table","table-row":"table",text:"text",list:"text",page:"office"},w={graphic:"circle connected control custom-shape ellipse frame g line measure page page-thumbnail path polygon polyline rect regular-polygon".split(" "),paragraph:"alphabetical-index-entry-template h illustration-index-entry-template index-source-style object-index-entry-template p table-index-entry-template table-of-content-entry-template user-index-entry-template".split(" "),
presentation:"caption circle connector control custom-shape ellipse frame g line measure page-thumbnail path polygon polyline rect regular-polygon".split(" "),"drawing-page":"caption circle connector control page custom-shape ellipse frame g line measure page-thumbnail path polygon polyline rect regular-polygon".split(" "),ruby:["ruby","ruby-text"],section:"alphabetical-index bibliography illustration-index index-title object-index section table-of-content table-index user-index".split(" "),table:["background",
"table"],"table-cell":"body covered-table-cell even-columns even-rows first-column first-row last-column last-row odd-columns odd-rows table-cell".split(" "),"table-column":["table-column"],"table-row":["table-row"],text:"a index-entry-chapter index-entry-link-end index-entry-link-start index-entry-page-number index-entry-span index-entry-tab-stop index-entry-text index-title-template linenumbering-configuration list-level-style-number list-level-style-bullet outline-level-style span".split(" "),
list:["list-item"]},s=[[p,"color","color"],[p,"background-color","background-color"],[p,"font-weight","font-weight"],[p,"font-style","font-style"]],x=[[g,"repeat","background-repeat"]],u=[[p,"background-color","background-color"],[p,"text-align","text-align"],[p,"text-indent","text-indent"],[p,"padding","padding"],[p,"padding-left","padding-left"],[p,"padding-right","padding-right"],[p,"padding-top","padding-top"],[p,"padding-bottom","padding-bottom"],[p,"border-left","border-left"],[p,"border-right",
"border-right"],[p,"border-top","border-top"],[p,"border-bottom","border-bottom"],[p,"margin","margin"],[p,"margin-left","margin-left"],[p,"margin-right","margin-right"],[p,"margin-top","margin-top"],[p,"margin-bottom","margin-bottom"],[p,"border","border"]],A=[[p,"background-color","background-color"],[p,"min-height","min-height"],[q,"stroke","border"],[e,"stroke-color","border-color"],[e,"stroke-width","border-width"],[p,"border","border"],[p,"border-left","border-left"],[p,"border-right","border-right"],
[p,"border-top","border-top"],[p,"border-bottom","border-bottom"]],H=[[p,"background-color","background-color"],[p,"border-left","border-left"],[p,"border-right","border-right"],[p,"border-top","border-top"],[p,"border-bottom","border-bottom"],[p,"border","border"]],C=[[g,"column-width","width"]],G=[[g,"row-height","height"],[p,"keep-together",null]],B=[[g,"width","width"],[p,"margin-left","margin-left"],[p,"margin-right","margin-right"],[p,"margin-top","margin-top"],[p,"margin-bottom","margin-bottom"]],
J=[[p,"background-color","background-color"],[p,"padding","padding"],[p,"padding-left","padding-left"],[p,"padding-right","padding-right"],[p,"padding-top","padding-top"],[p,"padding-bottom","padding-bottom"],[p,"border","border"],[p,"border-left","border-left"],[p,"border-right","border-right"],[p,"border-top","border-top"],[p,"border-bottom","border-bottom"],[p,"margin","margin"],[p,"margin-left","margin-left"],[p,"margin-right","margin-right"],[p,"margin-top","margin-top"],[p,"margin-bottom","margin-bottom"]],
P=[[p,"page-width","width"],[p,"page-height","height"]],Q={border:!0,"border-left":!0,"border-right":!0,"border-top":!0,"border-bottom":!0,"stroke-width":!0},D={margin:!0,"margin-left":!0,"margin-right":!0,"margin-top":!0,"margin-bottom":!0},Z={},S=odf.OdfUtils,v,I,ba,T=xmldom.XPath,F=new core.CSSUnits;this.style2css=function(b,a,e,c,d){function f(b,a){g="@namespace "+b+" url("+a+");";try{e.insertRule(g,e.cssRules.length)}catch(c){}}var g,l,r;for(I=a;e.cssRules.length;)e.deleteRule(e.cssRules.length-
1);odf.Namespaces.forEachPrefix(f);f("webodfhelper","urn:webodf:names:helper");Z=c;v=b;ba=runtime.getWindow().getComputedStyle(document.body,null).getPropertyValue("font-size")||"12pt";for(r in z)if(z.hasOwnProperty(r))for(l in b=d[r],b)b.hasOwnProperty(l)&&h(e,r,l,b[l])}};(function(){function f(k,a){var d=this;this.getDistance=function(a){var f=d.x-a.x;a=d.y-a.y;return Math.sqrt(f*f+a*a)};this.getCenter=function(a){return new f((d.x+a.x)/2,(d.y+a.y)/2)};d.x=k;d.y=a}gui.ZoomHelper=function(){function k(a,e,c,d){a=d?"translate3d("+a+"px, "+e+"px, 0) scale3d("+c+", "+c+", 1)":"translate("+a+"px, "+e+"px) scale("+c+")";b.style.WebkitTransform=a;b.style.MozTransform=a;b.style.msTransform=a;b.style.OTransform=a;b.style.transform=a}function a(b){b?k(-r.x,-r.y,t,!0):(k(0,
0,t,!0),k(0,0,t,!1))}function d(b){if(s&&C){var a=s.style.overflow,e=s.classList.contains("webodf-customScrollbars");b&&e||!b&&!e||(b?(s.classList.add("webodf-customScrollbars"),s.style.overflow="hidden",runtime.requestAnimationFrame(function(){s.style.overflow=a})):s.classList.remove("webodf-customScrollbars"))}}function c(){k(-r.x,-r.y,t,!0);s.scrollLeft=0;s.scrollTop=0;G=x.style.overflow;x.style.overflow="visible";d(!1)}function m(){k(0,0,t,!0);s.scrollLeft=r.x;s.scrollTop=r.y;x.style.overflow=
G||"";d(!0)}function h(a){return new f(a.pageX-b.offsetLeft,a.pageY-b.offsetTop)}function q(a){l&&(r.x-=a.x-l.x,r.y-=a.y-l.y,r=new f(Math.min(Math.max(r.x,b.offsetLeft),(b.offsetLeft+b.offsetWidth)*t-s.clientWidth),Math.min(Math.max(r.y,b.offsetTop),(b.offsetTop+b.offsetHeight)*t-s.clientHeight)));l=a}function p(b){var a=b.touches.length,e=0<a?h(b.touches[0]):null;b=1<a?h(b.touches[1]):null;e&&b?(y=e.getDistance(b),z=t,l=e.getCenter(b),c(),H=A.PINCH):e&&(l=e,H=A.SCROLL)}function n(e){var d=e.touches.length,
f=0<d?h(e.touches[0]):null,d=1<d?h(e.touches[1]):null;if(f&&d)if(e.preventDefault(),H===A.SCROLL)H=A.PINCH,c(),y=f.getDistance(d);else{e=f.getCenter(d);f=f.getDistance(d)/y;q(e);var d=t,l=Math.min(w,b.offsetParent.clientWidth/b.offsetWidth);t=z*f;t=Math.min(Math.max(t,l),w);f=t/d;r.x+=(f-1)*(e.x+r.x);r.y+=(f-1)*(e.y+r.y);a(!0)}else f&&(H===A.PINCH?(H=A.SCROLL,m()):q(f))}function g(){H===A.PINCH&&(u.emit(gui.ZoomHelper.signalZoomChanged,t),m(),a(!1));H=A.NONE}function e(){s&&(s.removeEventListener("touchstart",
p,!1),s.removeEventListener("touchmove",n,!1),s.removeEventListener("touchend",g,!1))}var b,r,l,y,t,z,w=4,s,x,u=new core.EventNotifier([gui.ZoomHelper.signalZoomChanged]),A={NONE:0,SCROLL:1,PINCH:2},H=A.NONE,C=runtime.getWindow().hasOwnProperty("ontouchstart"),G="";this.subscribe=function(b,a){u.subscribe(b,a)};this.unsubscribe=function(b,a){u.unsubscribe(b,a)};this.getZoomLevel=function(){return t};this.setZoomLevel=function(e){b&&(t=e,a(!1),u.emit(gui.ZoomHelper.signalZoomChanged,t))};this.destroy=
function(b){e();d(!1);b()};this.setZoomableElement=function(c){e();b=c;s=b.offsetParent;x=b.parentNode;a(!1);s&&(s.addEventListener("touchstart",p,!1),s.addEventListener("touchmove",n,!1),s.addEventListener("touchend",g,!1));d(!0)};z=t=1;r=new f(0,0)};gui.ZoomHelper.signalZoomChanged="zoomChanged"})();ops.Canvas=function(){};ops.Canvas.prototype.getZoomLevel=function(){};ops.Canvas.prototype.getElement=function(){};ops.Canvas.prototype.getSizer=function(){};ops.Canvas.prototype.getZoomHelper=function(){};(function(){function f(){function b(c){e=!0;runtime.setTimeout(function(){try{c()}catch(d){runtime.log(String(d)+"\n"+d.stack)}e=!1;0<a.length&&b(a.pop())},10)}var a=[],e=!1;this.clearQueue=function(){a.length=0};this.addToQueue=function(c){if(0===a.length&&!e)return b(c);a.push(c)}}function k(b){function a(){for(;0<e.cssRules.length;)e.deleteRule(0);e.insertRule("#shadowContent draw|page {display:none;}",0);e.insertRule("office|presentation draw|page {display:none;}",1);e.insertRule("#shadowContent draw|page:nth-of-type("+
c+") {display:block;}",2);e.insertRule("office|presentation draw|page:nth-of-type("+c+") {display:block;}",3)}var e=b.sheet,c=1;this.showFirstPage=function(){c=1;a()};this.showNextPage=function(){c+=1;a()};this.showPreviousPage=function(){1<c&&(c-=1,a())};this.showPage=function(b){0<b&&(c=b,a())};this.css=b;this.destroy=function(a){b.parentNode.removeChild(b);a()}}function a(b){b=b.sheet;for(var a=b.cssRules;a.length;)b.deleteRule(a.length-1)}function d(b,a,e){var c=new odf.Style2CSS,d=new odf.ListStyleToCss;
e=e.sheet;var f=(new odf.StyleTree(b.rootElement.styles,b.rootElement.automaticStyles)).getStyleTree();c.style2css(b.getDocumentType(),b.rootElement,e,a.getFontMap(),f);d.applyListStyles(e,f,b.rootElement.body)}function c(b,a){(new odf.FontLoader).loadFonts(b,a.sheet)}function m(b,a,e){var c=null;b=b.rootElement.body.getElementsByTagNameNS(G,e+"-decl");e=a.getAttributeNS(G,"use-"+e+"-name");var d;if(e&&0<b.length)for(a=0;a<b.length;a+=1)if(d=b[a],d.getAttributeNS(G,"name")===e){c=d.textContent;break}return c}
function h(b,a,e,c){var d=b.ownerDocument;a=J.getElementsByTagNameNS(b,a,e);for(b=0;b<a.length;b+=1)J.removeAllChildNodes(a[b]),c&&(e=a[b],e.appendChild(d.createTextNode(c)))}function q(b,a,e){a.setAttributeNS("urn:webodf:names:helper","styleid",b);var c,d=a.getAttributeNS(H,"anchor-type"),f=a.getAttributeNS(u,"x"),l=a.getAttributeNS(u,"y"),g=a.getAttributeNS(u,"width"),h=a.getAttributeNS(u,"height"),r=a.getAttributeNS(w,"min-height"),m=a.getAttributeNS(w,"min-width");if("as-char"===d)c="display: inline-block;";
else if(d||f||l)c="position: absolute;";else if(g||h||r||m)c="display: block;";f&&(c+="left: "+f+";");l&&(c+="top: "+l+";");g&&(c+="width: "+g+";");h&&(c+="height: "+h+";");r&&(c+="min-height: "+r+";");m&&(c+="min-width: "+m+";");c&&(c="draw|"+a.localName+'[webodfhelper|styleid="'+b+'"] {'+c+"}",e.insertRule(c,e.cssRules.length))}function p(b){for(b=b.firstChild;b;){if(b.namespaceURI===s&&"binary-data"===b.localName)return"data:image/png;base64,"+b.textContent.replace(/[\r\n\s]/g,"");b=b.nextSibling}return""}
function n(b,a,e,c){function d(a){a&&(a='draw|image[webodfhelper|styleid="'+b+'"] {'+("background-image: url("+a+");")+"}",c.insertRule(a,c.cssRules.length))}function f(b){d(b.url)}e.setAttributeNS("urn:webodf:names:helper","styleid",b);var l=e.getAttributeNS(C,"href"),g;if(l)try{g=a.getPart(l),g.onchange=f,g.load()}catch(h){runtime.log("slight problem: "+String(h))}else l=p(e),d(l)}function g(b){var a=b.ownerDocument;J.getElementsByTagNameNS(b,H,"line-break").forEach(function(b){b.hasChildNodes()||
b.appendChild(a.createElement("br"))})}function e(b){var a=b.ownerDocument;J.getElementsByTagNameNS(b,H,"s").forEach(function(b){var e,c;J.removeAllChildNodes(b);b.appendChild(a.createTextNode(" "));c=parseInt(b.getAttributeNS(H,"c"),10);if(1<c)for(b.removeAttributeNS(H,"c"),e=1;e<c;e+=1)b.parentNode.insertBefore(b.cloneNode(!0),b)})}function b(b){J.getElementsByTagNameNS(b,H,"tab").forEach(function(b){b.textContent="\t"})}function r(b,a){function e(b,c){var l=g.documentElement.namespaceURI;"video/"===
c.substr(0,6)?(d=g.createElementNS(l,"video"),d.setAttribute("controls","controls"),f=g.createElementNS(l,"source"),b&&f.setAttribute("src",b),f.setAttribute("type",c),d.appendChild(f),a.parentNode.appendChild(d)):a.innerHtml="Unrecognised Plugin"}function c(b){e(b.url,b.mimetype)}var d,f,l,g=a.ownerDocument,h;if(l=a.getAttributeNS(C,"href"))try{h=b.getPart(l),h.onchange=c,h.load()}catch(r){runtime.log("slight problem: "+String(r))}else runtime.log("using MP4 data fallback"),l=p(a),e(l,"video/mp4")}
function l(b){var a=b.getElementsByTagName("head")[0],e,c;e=b.styleSheets.length;for(c=a.firstElementChild;c&&("style"!==c.localName||!c.hasAttribute("webodfcss"));)c=c.nextElementSibling;if(c)return e=parseInt(c.getAttribute("webodfcss"),10),c.setAttribute("webodfcss",e+1),c;"string"===String(typeof webodf_css)?e=webodf_css:(c="webodf.css",runtime.currentDirectory&&(c=runtime.currentDirectory(),0<c.length&&"/"!==c.substr(-1)&&(c+="/"),c+="../webodf.css"),e=runtime.readFileSync(c,"utf-8"));c=b.createElementNS(a.namespaceURI,
"style");c.setAttribute("media","screen, print, handheld, projection");c.setAttribute("type","text/css");c.setAttribute("webodfcss","1");c.appendChild(b.createTextNode(e));a.appendChild(c);return c}function y(b){var a=parseInt(b.getAttribute("webodfcss"),10);1===a?b.parentNode.removeChild(b):b.setAttribute("count",a-1)}function t(b){var a=b.getElementsByTagName("head")[0],e=b.createElementNS(a.namespaceURI,"style"),c="";e.setAttribute("type","text/css");e.setAttribute("media","screen, print, handheld, projection");
odf.Namespaces.forEachPrefix(function(b,a){c+="@namespace "+b+" url("+a+");\n"});c+="@namespace webodfhelper url(urn:webodf:names:helper);\n";e.appendChild(b.createTextNode(c));a.appendChild(e);return e}var z=odf.Namespaces.drawns,w=odf.Namespaces.fons,s=odf.Namespaces.officens,x=odf.Namespaces.stylens,u=odf.Namespaces.svgns,A=odf.Namespaces.tablens,H=odf.Namespaces.textns,C=odf.Namespaces.xlinkns,G=odf.Namespaces.presentationns,B=xmldom.XPath,J=core.DomUtils;odf.OdfCanvas=function(p,w){function D(b,
a,e){function c(b,a,e,d){ja.addToQueue(function(){n(b,a,e,d)})}var d,f;d=a.getElementsByTagNameNS(z,"image");for(a=0;a<d.length;a+=1)f=d.item(a),c("image"+String(a),b,f,e)}function Z(b,a){function e(b,a){ja.addToQueue(function(){r(b,a)})}var c,d,f;d=a.getElementsByTagNameNS(z,"plugin");for(c=0;c<d.length;c+=1)f=d.item(c),e(b,f)}function u(){var b;b=aa.firstChild;var a=fa.getZoomLevel();b&&(aa.style.WebkitTransformOrigin="0% 0%",aa.style.MozTransformOrigin="0% 0%",aa.style.msTransformOrigin="0% 0%",
aa.style.OTransformOrigin="0% 0%",aa.style.transformOrigin="0% 0%",O&&((b=O.getMinimumHeightForAnnotationPane())?aa.style.minHeight=b:aa.style.removeProperty("min-height")),p.style.width=Math.round(a*aa.offsetWidth)+"px",p.style.height=Math.round(a*aa.offsetHeight)+"px",p.style.display="inline-block")}function v(a,c){var d=ea.sheet;J.removeAllChildNodes(p);aa=N.createElementNS(p.namespaceURI,"div");aa.style.display="inline-block";aa.style.background="white";aa.style.setProperty("float","left","important");
aa.appendChild(c);p.appendChild(aa);ca=N.createElementNS(p.namespaceURI,"div");ca.id="annotationsPane";ga=N.createElementNS(p.namespaceURI,"div");ga.id="shadowContent";ga.style.position="absolute";ga.style.top=0;ga.style.left=0;a.getContentElement().appendChild(ga);var f=c.body,l,r=[],n;for(l=f.firstElementChild;l&&l!==f;)if(l.namespaceURI===z&&(r[r.length]=l),l.firstElementChild)l=l.firstElementChild;else{for(;l&&l!==f&&!l.nextElementSibling;)l=l.parentNode;l&&l.nextElementSibling&&(l=l.nextElementSibling)}for(n=
0;n<r.length;n+=1)l=r[n],q("frame"+String(n),l,d);r=B.getODFElementsWithXPath(f,".//*[*[@text:anchor-type='paragraph']]",odf.Namespaces.lookupNamespaceURI);for(l=0;l<r.length;l+=1)f=r[l],f.setAttributeNS&&f.setAttributeNS("urn:webodf:names:helper","containsparagraphanchor",!0);f=E;l=ga;var k,y,v,t,w=0,Q;n=a.rootElement.ownerDocument;if((r=c.body.firstElementChild)&&r.namespaceURI===s&&("presentation"===r.localName||"drawing"===r.localName))for(r=r.firstElementChild;r;){if(k=(k=r.getAttributeNS(z,
"master-page-name"))?f.getMasterPageElement(k):null){y=r.getAttributeNS("urn:webodf:names:helper","styleid");v=n.createElementNS(z,"draw:page");Q=k.firstElementChild;for(w=0;Q;)"true"!==Q.getAttributeNS(G,"placeholder")&&(t=Q.cloneNode(!0),v.appendChild(t)),Q=Q.nextElementSibling,w+=1;Q=t=w=void 0;for(var u=J.getElementsByTagNameNS(v,z,"frame"),w=0;w<u.length;w+=1)t=u[w],(Q=t.getAttributeNS(G,"class"))&&!/^(date-time|footer|header|page-number)$/.test(Q)&&t.parentNode.removeChild(t);t=J.getElementsByTagNameNS(v,
z,"*");for(w=0;w<t.length;w+=1)q(y+"_"+w,t[w],d);l.appendChild(v);w=String(l.getElementsByTagNameNS(z,"page").length);h(v,H,"page-number",w);h(v,G,"header",m(a,r,"header"));h(v,G,"footer",m(a,r,"footer"));q(y,v,d);v.setAttributeNS("urn:webodf:names:helper","page-style-name",r.getAttributeNS(z,"style-name"));v.setAttributeNS(z,"draw:master-page-name",k.getAttributeNS(x,"name"))}r=r.nextElementSibling}f=p.namespaceURI;r=J.getElementsByTagNameNS(c.body,A,"table-cell");for(l=0;l<r.length;l+=1)n=r[l],
n.hasAttributeNS(A,"number-columns-spanned")&&n.setAttributeNS(f,"colspan",n.getAttributeNS(A,"number-columns-spanned")),n.hasAttributeNS(A,"number-rows-spanned")&&n.setAttributeNS(f,"rowspan",n.getAttributeNS(A,"number-rows-spanned"));g(c.body);e(c.body);b(c.body);D(a,c.body,d);Z(a,c.body);aa.insertBefore(ga,aa.firstChild);fa.setZoomableElement(aa)}function C(b){U?(ca.parentNode||aa.appendChild(ca),O&&O.forgetAnnotations(),O=new gui.AnnotationViewManager(F,b.body,ca,W),b=J.getElementsByTagNameNS(b.body,
s,"annotation"),O.addAnnotations(b),u()):ca.parentNode&&(aa.removeChild(ca),O.forgetAnnotations(),u())}function ba(b){function e(){a(R);a(K);a(ea);J.removeAllChildNodes(p);p.style.display="inline-block";var f=$.rootElement;p.ownerDocument.importNode(f,!0);E.setOdfContainer($);c($,R);d($,E,K);v($,f);C(f);b||ja.addToQueue(function(){var b=[$];if(da.hasOwnProperty("statereadychange")){var a=da.statereadychange,e;for(e=0;e<a.length;e+=1)a[e].apply(null,b)}})}$.state===odf.OdfContainer.DONE?e():(runtime.log("WARNING: refreshOdf called but ODF was not DONE."),
ha=runtime.setTimeout(function qa(){$.state===odf.OdfContainer.DONE?e():(runtime.log("will be back later..."),ha=runtime.setTimeout(qa,500))},100))}function T(b){ja.clearQueue();J.removeAllChildNodes(p);p.appendChild(p.ownerDocument.createTextNode(runtime.tr("Loading")+b+"..."));p.removeAttribute("style");$=new odf.OdfContainer(b,function(b){$=b;ba(!1)})}runtime.assert(null!==p&&void 0!==p,"odf.OdfCanvas constructor needs DOM element");runtime.assert(null!==p.ownerDocument&&void 0!==p.ownerDocument,
"odf.OdfCanvas constructor needs DOM");var F=this,N=p.ownerDocument,$,E=new odf.Formatting,V,aa=null,ca=null,U=!1,W=!1,O=null,Y,R,K,ea,ga,da={},ha,ma,la=!1,ia=!1,ja=new f,fa=new gui.ZoomHelper,pa=w||new gui.SingleScrollViewport(p.parentNode);this.refreshCSS=function(){la=!0;ma.trigger()};this.refreshSize=function(){ma.trigger()};this.odfContainer=function(){return $};this.setOdfContainer=function(b,a){$=b;ba(!0===a)};this.load=this.load=T;this.save=function(b){$.save(b)};this.addListener=function(b,
a){switch(b){case "click":var e=p,c=b;e.addEventListener?e.addEventListener(c,a,!1):e.attachEvent?e.attachEvent("on"+c,a):e["on"+c]=a;break;default:e=da.hasOwnProperty(b)?da[b]:da[b]=[],a&&-1===e.indexOf(a)&&e.push(a)}};this.getFormatting=function(){return E};this.getAnnotationViewManager=function(){return O};this.refreshAnnotations=function(){C($.rootElement)};this.rerenderAnnotations=function(){O&&(ia=!0,ma.trigger())};this.getSizer=function(){return aa};this.enableAnnotations=function(b,a){b!==
U&&(U=b,W=a,$&&C($.rootElement))};this.addAnnotation=function(b){O&&(O.addAnnotations([b]),u())};this.forgetAnnotation=function(b){O&&(O.forgetAnnotation(b),u())};this.getZoomHelper=function(){return fa};this.setZoomLevel=function(b){fa.setZoomLevel(b)};this.getZoomLevel=function(){return fa.getZoomLevel()};this.fitToContainingElement=function(b,a){var e=fa.getZoomLevel(),c=p.offsetHeight/e,e=b/(p.offsetWidth/e);a/c<e&&(e=a/c);fa.setZoomLevel(e)};this.fitToWidth=function(b){var a=p.offsetWidth/fa.getZoomLevel();
fa.setZoomLevel(b/a)};this.fitSmart=function(b,a){var e,c;c=fa.getZoomLevel();e=p.offsetWidth/c;c=p.offsetHeight/c;e=b/e;void 0!==a&&a/c<e&&(e=a/c);fa.setZoomLevel(Math.min(1,e))};this.fitToHeight=function(b){var a=p.offsetHeight/fa.getZoomLevel();fa.setZoomLevel(b/a)};this.showFirstPage=function(){V.showFirstPage()};this.showNextPage=function(){V.showNextPage()};this.showPreviousPage=function(){V.showPreviousPage()};this.showPage=function(b){V.showPage(b);u()};this.getElement=function(){return p};
this.getViewport=function(){return pa};this.getStyleSheet=function(){return Y};this.addCssForFrameWithImage=function(b){var a=b.getAttributeNS(z,"name"),e=b.firstElementChild;q(a,b,ea.sheet);e&&n(a+"img",$,e,ea.sheet)};this.destroy=function(b){var a=N.getElementsByTagName("head")[0],e=[V.destroy,ma.destroy];runtime.clearTimeout(ha);ca&&ca.parentNode&&ca.parentNode.removeChild(ca);fa.destroy(function(){aa&&(p.removeChild(aa),aa=null)});y(Y);a.removeChild(R);a.removeChild(K);a.removeChild(ea);core.Async.destroyAll(e,
b)};Y=l(N);V=new k(t(N));R=t(N);K=t(N);ea=t(N);ma=core.Task.createRedrawTask(function(){la&&(d($,E,K),la=!1);ia&&(O&&O.rerenderAnnotations(),ia=!1);u()});fa.subscribe(gui.ZoomHelper.signalZoomChanged,u)}})();odf.StepUtils=function(){this.getContentBounds=function(f){var k=f.container(),a,d;runtime.assert(f.isStep(),"Step iterator must be on a step");k.nodeType===Node.TEXT_NODE&&0<f.offset()?a=f.offset():(k=f.leftNode())&&k.nodeType===Node.TEXT_NODE&&(a=k.length);k&&(k.nodeType===Node.TEXT_NODE?(runtime.assert(0<a,"Empty text node found"),d={container:k,startOffset:a-1,endOffset:a}):d={container:k,startOffset:0,endOffset:k.childNodes.length});return d}};ops.MemberProperties=function(){};
ops.Member=function(f,k){var a=new ops.MemberProperties;this.getMemberId=function(){return f};this.getProperties=function(){return a};this.setProperties=function(d){Object.keys(d).forEach(function(c){a[c]=d[c]})};this.removeProperties=function(d){Object.keys(d).forEach(function(c){"fullName"!==c&&"color"!==c&&"imageUrl"!==c&&a.hasOwnProperty(c)&&delete a[c]})};runtime.assert(Boolean(f),"No memberId was supplied!");k.fullName||(k.fullName=runtime.tr("Unknown Author"));k.color||(k.color="black");k.imageUrl||
(k.imageUrl="avatar-joe.png");a=k};ops.Document=function(){};ops.Document.prototype.getMemberIds=function(){};ops.Document.prototype.removeCursor=function(f){};ops.Document.prototype.getDocumentElement=function(){};ops.Document.prototype.getRootNode=function(){};ops.Document.prototype.getDOMDocument=function(){};ops.Document.prototype.cloneDocumentElement=function(){};ops.Document.prototype.setDocumentElement=function(f){};ops.Document.prototype.subscribe=function(f,k){};ops.Document.prototype.unsubscribe=function(f,k){};
ops.Document.prototype.getCanvas=function(){};ops.Document.prototype.createRootFilter=function(f){};ops.Document.prototype.createPositionIterator=function(f){};ops.Document.signalCursorAdded="cursor/added";ops.Document.signalCursorRemoved="cursor/removed";ops.Document.signalCursorMoved="cursor/moved";ops.Document.signalMemberAdded="member/added";ops.Document.signalMemberUpdated="member/updated";ops.Document.signalMemberRemoved="member/removed";ops.OdtCursor=function(f,k){var a=this,d={},c,m,h=new core.EventNotifier([ops.OdtCursor.signalCursorUpdated]);this.removeFromDocument=function(){m.remove()};this.subscribe=function(a,c){h.subscribe(a,c)};this.unsubscribe=function(a,c){h.unsubscribe(a,c)};this.getMemberId=function(){return f};this.getNode=function(){return m.getNode()};this.getAnchorNode=function(){return m.getAnchorNode()};this.getSelectedRange=function(){return m.getSelectedRange()};this.setSelectedRange=function(c,d){m.setSelectedRange(c,
d);h.emit(ops.OdtCursor.signalCursorUpdated,a)};this.hasForwardSelection=function(){return m.hasForwardSelection()};this.getDocument=function(){return k};this.getSelectionType=function(){return c};this.setSelectionType=function(a){d.hasOwnProperty(a)?c=a:runtime.log("Invalid selection type: "+a)};this.resetSelectionType=function(){a.setSelectionType(ops.OdtCursor.RangeSelection)};m=new core.Cursor(k.getDOMDocument(),f);d[ops.OdtCursor.RangeSelection]=!0;d[ops.OdtCursor.RegionSelection]=!0;a.resetSelectionType()};
ops.OdtCursor.RangeSelection="Range";ops.OdtCursor.RegionSelection="Region";ops.OdtCursor.signalCursorUpdated="cursorUpdated";(function(){var f=0;ops.StepsCache=function(k,a,d){function c(b,a){var e=this;this.nodeId=b;this.steps=-1;this.node=a;this.previousBookmark=this.nextBookmark=null;this.setIteratorPosition=function(b){b.setPositionBeforeElement(a);d(e.steps,b)}}function m(b,a,e){var c=this;this.nodeId=b;this.steps=a;this.node=e;this.previousBookmark=this.nextBookmark=null;this.setIteratorPosition=function(b){b.setUnfilteredPosition(e,0);d(c.steps,b)}}function h(b,a){var e="["+b.nodeId;a&&(e+=" => "+a.nodeId);return e+
"]"}function q(){for(var b=z,a,e,c,d=new core.LoopWatchDog(0,1E5),f={};b;){d.check();(a=b.previousBookmark)?runtime.assert(a.nextBookmark===b,"Broken bookmark link to previous @"+h(a,b)):(runtime.assert(b===z,"Broken bookmark link @"+h(b)),runtime.assert(void 0===w||z===z||z.steps<=w,"Base point is damaged @"+h(b)));(e=b.nextBookmark)&&runtime.assert(e.previousBookmark===b,"Broken bookmark link to next @"+h(b,e));if(void 0===w||b===z||b.steps<=w)runtime.assert(t.containsNode(k,b.node),"Disconnected node is being reported as undamaged @"+
h(b)),a&&(c=b.node.compareDocumentPosition(a.node),runtime.assert(0===c||0!==(c&x),"Bookmark order with previous does not reflect DOM order @"+h(a,b))),e&&t.containsNode(k,e.node)&&(c=b.node.compareDocumentPosition(e.node),runtime.assert(0===c||0!==(c&s),"Bookmark order with next does not reflect DOM order @"+h(b,e)));b=b.nextBookmark}Object.keys(l).forEach(function(b){var a=l[b];(void 0===w||b<=w)&&runtime.assert(a.steps<=b,"Bookmark step of "+a.steps+" exceeds cached step lookup for "+b+" @"+h(a));
runtime.assert(!1===f.hasOwnProperty(a.nodeId),"Bookmark "+h(a)+" appears twice in cached step lookup at steps "+f[a.nodeId]+" and "+b);f[a.nodeId]=b})}function p(b){var a="";b.nodeType===Node.ELEMENT_NODE&&(a=b.getAttributeNS(r,"nodeId")||"");return a}function n(b){var a=f.toString();b.setAttributeNS(r,"nodeId",a);f+=1;return a}function g(b){var e,c,d=new core.LoopWatchDog(0,1E4);void 0!==w&&b>w&&(b=w);for(e=Math.floor(b/a)*a;!c&&0<=e;)c=l[e],e-=a;for(c=c||z;c.nextBookmark&&c.nextBookmark.steps<=
b;)d.check(),c=c.nextBookmark;runtime.assert(-1===b||c.steps<=b,"Bookmark @"+h(c)+" at step "+c.steps+" exceeds requested step of "+b);return c}function e(b){b.previousBookmark&&(b.previousBookmark.nextBookmark=b.nextBookmark);b.nextBookmark&&(b.nextBookmark.previousBookmark=b.previousBookmark)}function b(b){for(var a,e=null;!e&&b&&b!==k;)(a=p(b))&&(e=y[a])&&e.node!==b&&(runtime.log("Cloned node detected. Creating new bookmark"),e=null,b.removeAttributeNS(r,"nodeId")),b=b.parentNode;return e}var r=
"urn:webodf:names:steps",l={},y={},t=core.DomUtils,z,w,s=Node.DOCUMENT_POSITION_FOLLOWING,x=Node.DOCUMENT_POSITION_PRECEDING,u;this.updateBookmark=function(b,d){var f,h=Math.ceil(b/a)*a,r,m,q;if(void 0!==w&&w<b){r=g(w);for(m=r.nextBookmark;m&&m.steps<=b;)f=m.nextBookmark,q=Math.ceil(m.steps/a)*a,l[q]===m&&delete l[q],t.containsNode(k,m.node)?m.steps=b+1:(e(m),delete y[m.nodeId]),m=f;w=b}else r=g(b);m=p(d)||n(d);f=y[m];f?f.node!==d&&(runtime.log("Cloned node detected. Creating new bookmark"),m=n(d),
f=y[m]=new c(m,d)):f=y[m]=new c(m,d);m=f;m.steps!==b&&(f=Math.ceil(m.steps/a)*a,f!==h&&l[f]===m&&delete l[f],m.steps=b);if(r!==m&&r.nextBookmark!==m){if(r.steps===m.steps)for(;0!==(m.node.compareDocumentPosition(r.node)&s)&&r!==z;)r=r.previousBookmark;r!==m&&r.nextBookmark!==m&&(e(m),f=r.nextBookmark,m.nextBookmark=r.nextBookmark,m.previousBookmark=r,r.nextBookmark=m,f&&(f.previousBookmark=m))}r=l[h];if(!r||m.steps>r.steps)l[h]=m;u()};this.setToClosestStep=function(b,a){var e;u();e=g(b);e.setIteratorPosition(a);
return e.steps};this.setToClosestDomPoint=function(a,e,c){var d,f;u();if(a===k&&0===e)d=z;else if(a===k&&e===k.childNodes.length)for(f in d=z,l)l.hasOwnProperty(f)&&(a=l[f],a.steps>d.steps&&(d=a));else if(d=b(a.childNodes.item(e)||a),!d)for(c.setUnfilteredPosition(a,e);!d&&c.previousNode();)d=b(c.getCurrentNode());d=d||z;void 0!==w&&d.steps>w&&(d=g(w));d.setIteratorPosition(c);return d.steps};this.damageCacheAfterStep=function(b){0>b&&(b=-1);void 0===w?w=b:b<w&&(w=b);u()};(function(){var b=p(k)||
n(k);z=new m(b,0,k);u=ops.StepsCache.ENABLE_CACHE_VERIFICATION?q:function(){}})()};ops.StepsCache.ENABLE_CACHE_VERIFICATION=!1;ops.StepsCache.Bookmark=function(){};ops.StepsCache.Bookmark.prototype.setIteratorPosition=function(f){}})();(function(){ops.OdtStepsTranslator=function(f,k,a,d){function c(b,a,e){var c=a.getCurrentNode();a.isBeforeNode()&&q.isParagraph(c)&&(e||(b+=1),h.updateBookmark(b,c))}function m(b,c){if(!c||a.acceptPosition(b)===n)return!0;for(;b.previousPosition();)if(a.acceptPosition(b)===n){if(c(g,b.container(),b.unfilteredDomOffset()))return!0;break}for(;b.nextPosition();)if(a.acceptPosition(b)===n){if(c(e,b.container(),b.unfilteredDomOffset()))return!0;break}return!1}var h,q=odf.OdfUtils,p=core.DomUtils,n=core.PositionFilter.FilterResult.FILTER_ACCEPT,
g=core.StepDirection.PREVIOUS,e=core.StepDirection.NEXT;this.convertStepsToDomPoint=function(b){var e,d;if(isNaN(b))throw new TypeError("Requested steps is not numeric ("+b+")");if(0>b)throw new RangeError("Requested steps is negative ("+b+")");for(e=h.setToClosestStep(b,k);e<b&&k.nextPosition();)(d=a.acceptPosition(k)===n)&&(e+=1),c(e,k,d);if(e!==b)throw new RangeError("Requested steps ("+b+") exceeds available steps ("+e+")");return{node:k.container(),offset:k.unfilteredDomOffset()}};this.convertDomPointToSteps=
function(b,e,d){var g;p.containsNode(f,b)||(e=0>p.comparePoints(f,0,b,e),b=f,e=e?0:f.childNodes.length);k.setUnfilteredPosition(b,e);m(k,d)||k.setUnfilteredPosition(b,e);d=k.container();e=k.unfilteredDomOffset();b=h.setToClosestDomPoint(d,e,k);if(0>p.comparePoints(k.container(),k.unfilteredDomOffset(),d,e))return 0<b?b-1:b;for(;(k.container()!==d||k.unfilteredDomOffset()!==e)&&k.nextPosition();)(g=a.acceptPosition(k)===n)&&(b+=1),c(b,k,g);return b+0};this.prime=function(){var b,e;for(b=h.setToClosestStep(0,
k);k.nextPosition();)(e=a.acceptPosition(k)===n)&&(b+=1),c(b,k,e)};this.handleStepsInserted=function(b){h.damageCacheAfterStep(b.position)};this.handleStepsRemoved=function(b){h.damageCacheAfterStep(b.position-1)};h=new ops.StepsCache(f,d,function(b,e){do{if(a.acceptPosition(e)===n){c(b,e,!0);break}c(b-1,e,!1)}while(e.nextPosition())})}})();ops.Operation=function(){};ops.Operation.prototype.init=function(f){};ops.Operation.prototype.execute=function(f){};ops.Operation.prototype.spec=function(){};ops.TextPositionFilter=function(){function f(a,c){for(;a&&c(a)!==m;)a=a.previousSibling;return a}function k(c,d,n,g){var e;if(d){if(a.isInlineRoot(d)&&a.isGroupingElement(n))return h;g=a.lookLeftForCharacter(d);if(1===g||2===g&&(a.scanRightForAnyCharacter(n)||a.scanRightForAnyCharacter(a.nextNode(c))))return m}else if(a.isGroupingElement(c)&&a.isInlineRoot(f(c.previousSibling,g)))return m;g=null===d&&a.isParagraph(c);e=a.lookRightForCharacter(n);if(g)return e?m:a.scanRightForAnyCharacter(n)?h:m;if(!e)return h;
d=d||a.previousNode(c);return a.scanLeftForAnyCharacter(d)?h:m}var a=odf.OdfUtils,d=Node.ELEMENT_NODE,c=Node.TEXT_NODE,m=core.PositionFilter.FilterResult.FILTER_ACCEPT,h=core.PositionFilter.FilterResult.FILTER_REJECT;this.acceptPosition=function(f){var p=f.container(),n=p.nodeType,g,e,b;if(n!==d&&n!==c)return h;if(n===c){n=f.unfilteredDomOffset();g=p.data;runtime.assert(n!==g.length,"Unexpected offset.");if(0<n){f=g[n-1];if(!a.isODFWhitespace(f))return m;if(1<n)if(f=g[n-2],!a.isODFWhitespace(f))b=
m;else{if(!a.isODFWhitespace(g.substr(0,n)))return h}else e=a.previousNode(p),a.scanLeftForNonSpace(e)&&(b=m);if(b===m)return a.isTrailingWhitespace(p,n)?h:m;f=g[n];return a.isODFWhitespace(f)?h:a.scanLeftForAnyCharacter(a.previousNode(p))?h:m}e=f.leftNode();b=p;p=p.parentNode;b=k(p,e,b,f.getNodeFilter())}else a.isGroupingElement(p)?(e=f.leftNode(),b=f.rightNode(),b=k(p,e,b,f.getNodeFilter())):b=h;return b}};ops.OdtDocument=function(f){function k(b){return new core.PositionIterator(b,B,Q,!1)}function a(){var b=f.odfContainer().getContentElement(),a=b&&b.localName;runtime.assert("text"===a,"Unsupported content element type '"+a+"' for OdtDocument");return b}function d(){return b.getDocumentElement().ownerDocument}function c(b){for(;b&&!(b.namespaceURI===odf.Namespaces.officens&&"text"===b.localName||b.namespaceURI===odf.Namespaces.officens&&"annotation"===b.localName);)b=b.parentNode;return b}function m(b){this.acceptPosition=
function(a){a=a.container();var e;e="string"===typeof b?t[b].getNode():b;return c(a)===c(e)?s:x}}function h(b,a,e,c){c=k(c);var d;1===e.length?d=e[0]:(d=new core.PositionFilterChain,e.forEach(d.addFilter));e=new core.StepIterator(d,c);e.setPosition(b,a);return e}function q(b){var e=k(a());b=H.convertStepsToDomPoint(b);e.setUnfilteredPosition(b.node,b.offset);return e}function p(b){return b===u}function n(a){var e=a.spec(),c=e.memberid,d=(new Date(e.timestamp)).toISOString(),e=f.odfContainer();a.isEdit&&
(c=b.getMember(c).getProperties().fullName,e.setMetadata({"dc:creator":c,"dc:date":d},null),c={setProperties:{"dc:creator":c,"dc:date":d},removedProperties:[]},C||(c.setProperties["meta:editing-cycles"]=e.incrementEditingCycles(),G||e.setMetadata(null,["meta:editing-duration","meta:document-statistic"])),C=a,b.emit(ops.OdtDocument.signalMetadataUpdated,c))}function g(b){var a,e=[],c,d=2;runtime.assert(b.isStep(),"positionIterator is not at a step");do{if(a=r.getContentBounds(b))if(a=a.container,l.isDowngradableSpaceElement(a)){for(c=
a.lastChild;a.firstChild;)e.push(a.firstChild),a.parentNode.insertBefore(a.firstChild,a);a.parentNode.removeChild(a);b.setPosition(c,c.nodeType===Node.TEXT_NODE?c.length:c.childNodes.length);b.roundToPreviousStep()}d-=1}while(0<d&&b.nextStep());e.forEach(y.normalizeTextNodes)}function e(b,a,e){b=b.childNodes.item(a)||b;return(b=l.getParagraphElement(b))&&y.containsNode(e,b)?b:e}var b=this,r,l=odf.OdfUtils,y=core.DomUtils,t={},z={},w=new core.EventNotifier([ops.Document.signalMemberAdded,ops.Document.signalMemberUpdated,
ops.Document.signalMemberRemoved,ops.Document.signalCursorAdded,ops.Document.signalCursorRemoved,ops.Document.signalCursorMoved,ops.OdtDocument.signalParagraphChanged,ops.OdtDocument.signalParagraphStyleModified,ops.OdtDocument.signalCommonStyleCreated,ops.OdtDocument.signalCommonStyleDeleted,ops.OdtDocument.signalTableAdded,ops.OdtDocument.signalOperationStart,ops.OdtDocument.signalOperationEnd,ops.OdtDocument.signalProcessingBatchStart,ops.OdtDocument.signalProcessingBatchEnd,ops.OdtDocument.signalUndoStackChanged,
ops.OdtDocument.signalStepsInserted,ops.OdtDocument.signalStepsRemoved,ops.OdtDocument.signalMetadataUpdated,ops.OdtDocument.signalAnnotationAdded]),s=core.PositionFilter.FilterResult.FILTER_ACCEPT,x=core.PositionFilter.FilterResult.FILTER_REJECT,u=core.StepDirection.NEXT,A,H,C,G=!1,B=NodeFilter.SHOW_ALL,J=new gui.BlacklistNamespaceNodeFilter(["urn:webodf:names:cursor","urn:webodf:names:editinfo"]),P=new gui.OdfTextBodyNodeFilter,Q=new core.NodeFilterChain([J,P]);this.createPositionIterator=k;this.getDocumentElement=
function(){return f.odfContainer().rootElement};this.cloneDocumentElement=function(){var a=b.getDocumentElement(),e=f.getAnnotationViewManager();e&&e.forgetAnnotations();a=a.cloneNode(!0);f.refreshAnnotations();b.fixCursorPositions();return a};this.setDocumentElement=function(b){var e=f.odfContainer();w.unsubscribe(ops.OdtDocument.signalStepsInserted,H.handleStepsInserted);w.unsubscribe(ops.OdtDocument.signalStepsRemoved,H.handleStepsRemoved);e.setRootElement(b);f.setOdfContainer(e,!0);f.refreshCSS();
b=a();H=new ops.OdtStepsTranslator(b,k(b),A,500);w.subscribe(ops.OdtDocument.signalStepsInserted,H.handleStepsInserted);w.subscribe(ops.OdtDocument.signalStepsRemoved,H.handleStepsRemoved)};this.getDOMDocument=d;this.getRootElement=c;this.createStepIterator=h;this.getIteratorAtPosition=q;this.convertCursorStepToDomPoint=function(b){return H.convertStepsToDomPoint(b)};this.convertDomPointToCursorStep=function(b,a,e){var c;e===u&&(c=p);return H.convertDomPointToSteps(b,a,c)};this.convertDomToCursorRange=
function(b){var a;a=H.convertDomPointToSteps(b.anchorNode,b.anchorOffset);b=b.anchorNode===b.focusNode&&b.anchorOffset===b.focusOffset?a:H.convertDomPointToSteps(b.focusNode,b.focusOffset);return{position:a,length:b-a}};this.convertCursorToDomRange=function(b,a){var e=d().createRange(),c,f;c=H.convertStepsToDomPoint(b);a?(f=H.convertStepsToDomPoint(b+a),0<a?(e.setStart(c.node,c.offset),e.setEnd(f.node,f.offset)):(e.setStart(f.node,f.offset),e.setEnd(c.node,c.offset))):e.setStart(c.node,c.offset);
return e};this.upgradeWhitespacesAtPosition=function(b){var a=q(b),a=new core.StepIterator(A,a),e,c=2;runtime.assert(a.isStep(),"positionIterator is not at a step (requested step: "+b+")");do{if(e=r.getContentBounds(a))if(b=e.container,e=e.startOffset,b.nodeType===Node.TEXT_NODE&&l.isSignificantWhitespace(b,e)){runtime.assert(" "===b.data[e],"upgradeWhitespaceToElement: textNode.data[offset] should be a literal space");var d=b.ownerDocument.createElementNS(odf.Namespaces.textns,"text:s"),f=b.parentNode,
g=b;d.appendChild(b.ownerDocument.createTextNode(" "));1===b.length?f.replaceChild(d,b):(b.deleteData(e,1),0<e&&(e<b.length&&b.splitText(e),g=b.nextSibling),f.insertBefore(d,g));b=d;a.setPosition(b,b.childNodes.length);a.roundToPreviousStep()}c-=1}while(0<c&&a.nextStep())};this.downgradeWhitespaces=g;this.downgradeWhitespacesAtPosition=function(b){b=q(b);b=new core.StepIterator(A,b);g(b)};this.getTextNodeAtStep=function(a,e){var c=q(a),f=c.container(),l,g=0,h=null;f.nodeType===Node.TEXT_NODE?(l=f,
g=c.unfilteredDomOffset(),0<l.length&&(0<g&&(l=l.splitText(g)),l.parentNode.insertBefore(d().createTextNode(""),l),l=l.previousSibling,g=0)):(l=d().createTextNode(""),g=0,f.insertBefore(l,c.rightNode()));if(e){if(t[e]&&b.getCursorPosition(e)===a){for(h=t[e].getNode();h.nextSibling&&"cursor"===h.nextSibling.localName;)h.parentNode.insertBefore(h.nextSibling,h);0<l.length&&l.nextSibling!==h&&(l=d().createTextNode(""),g=0);h.parentNode.insertBefore(l,h)}}else for(;l.nextSibling&&"cursor"===l.nextSibling.localName;)l.parentNode.insertBefore(l.nextSibling,
l);for(;l.previousSibling&&l.previousSibling.nodeType===Node.TEXT_NODE;)c=l.previousSibling,c.appendData(l.data),g=c.length,l=c,l.parentNode.removeChild(l.nextSibling);for(;l.nextSibling&&l.nextSibling.nodeType===Node.TEXT_NODE;)c=l.nextSibling,l.appendData(c.data),l.parentNode.removeChild(c);return{textNode:l,offset:g}};this.fixCursorPositions=function(){Object.keys(t).forEach(function(a){var d=t[a],f=c(d.getNode()),l=b.createRootFilter(f),g,r,m,n=!1;m=d.getSelectedRange();g=e(m.startContainer,m.startOffset,
f);r=h(m.startContainer,m.startOffset,[A,l],g);m.collapsed?f=r:(g=e(m.endContainer,m.endOffset,f),f=h(m.endContainer,m.endOffset,[A,l],g));r.isStep()&&f.isStep()?r.container()!==f.container()||r.offset()!==f.offset()||m.collapsed&&d.getAnchorNode()===d.getNode()||(n=!0,m.setStart(r.container(),r.offset()),m.collapse(!0)):(n=!0,runtime.assert(r.roundToClosestStep(),"No walkable step found for cursor owned by "+a),m.setStart(r.container(),r.offset()),runtime.assert(f.roundToClosestStep(),"No walkable step found for cursor owned by "+
a),m.setEnd(f.container(),f.offset()));n&&(d.setSelectedRange(m,d.hasForwardSelection()),b.emit(ops.Document.signalCursorMoved,d))})};this.getCursorPosition=function(b){return(b=t[b])?H.convertDomPointToSteps(b.getNode(),0):0};this.getCursorSelection=function(b){b=t[b];var a=0,e=0;b&&(a=H.convertDomPointToSteps(b.getNode(),0),e=H.convertDomPointToSteps(b.getAnchorNode(),0));return{position:e,length:a-e}};this.getPositionFilter=function(){return A};this.getOdfCanvas=function(){return f};this.getCanvas=
function(){return f};this.getRootNode=a;this.addMember=function(b){runtime.assert(void 0===z[b.getMemberId()],"This member already exists");z[b.getMemberId()]=b};this.getMember=function(b){return z.hasOwnProperty(b)?z[b]:null};this.removeMember=function(b){delete z[b]};this.getCursor=function(b){return t[b]};this.getMemberIds=function(){var b=[],a;for(a in t)t.hasOwnProperty(a)&&b.push(t[a].getMemberId());return b};this.addCursor=function(a){runtime.assert(Boolean(a),"OdtDocument::addCursor without cursor");
var e=a.getMemberId(),c=b.convertCursorToDomRange(0,0);runtime.assert("string"===typeof e,"OdtDocument::addCursor has cursor without memberid");runtime.assert(!t[e],"OdtDocument::addCursor is adding a duplicate cursor with memberid "+e);a.setSelectedRange(c,!0);t[e]=a};this.removeCursor=function(a){var e=t[a];return e?(e.removeFromDocument(),delete t[a],b.emit(ops.Document.signalCursorRemoved,a),!0):!1};this.moveCursor=function(a,e,c,d){a=t[a];e=b.convertCursorToDomRange(e,c);a&&(a.setSelectedRange(e,
0<=c),a.setSelectionType(d||ops.OdtCursor.RangeSelection))};this.getFormatting=function(){return f.getFormatting()};this.emit=function(b,a){w.emit(b,a)};this.subscribe=function(b,a){w.subscribe(b,a)};this.unsubscribe=function(b,a){w.unsubscribe(b,a)};this.createRootFilter=function(b){return new m(b)};this.close=function(b){b()};this.destroy=function(b){b()};(function(){var b=a();A=new ops.TextPositionFilter;r=new odf.StepUtils;H=new ops.OdtStepsTranslator(b,k(b),A,500);w.subscribe(ops.OdtDocument.signalStepsInserted,
H.handleStepsInserted);w.subscribe(ops.OdtDocument.signalStepsRemoved,H.handleStepsRemoved);w.subscribe(ops.OdtDocument.signalOperationEnd,n);w.subscribe(ops.OdtDocument.signalProcessingBatchEnd,core.Task.processTasks);f.getElement().classList.add("document-canvas")})()};ops.OdtDocument.signalParagraphChanged="paragraph/changed";ops.OdtDocument.signalTableAdded="table/added";ops.OdtDocument.signalCommonStyleCreated="style/created";ops.OdtDocument.signalCommonStyleDeleted="style/deleted";
ops.OdtDocument.signalParagraphStyleModified="paragraphstyle/modified";ops.OdtDocument.signalOperationStart="operation/start";ops.OdtDocument.signalOperationEnd="operation/end";ops.OdtDocument.signalProcessingBatchStart="router/batchstart";ops.OdtDocument.signalProcessingBatchEnd="router/batchend";ops.OdtDocument.signalUndoStackChanged="undo/changed";ops.OdtDocument.signalStepsInserted="steps/inserted";ops.OdtDocument.signalStepsRemoved="steps/removed";ops.OdtDocument.signalMetadataUpdated="metadata/updated";
ops.OdtDocument.signalAnnotationAdded="annotation/added";ops.OpAddAnnotation=function(){function f(a,c,d){var f=a.getTextNodeAtStep(d,k);f&&(a=f.textNode,d=a.parentNode,f.offset!==a.length&&a.splitText(f.offset),d.insertBefore(c,a.nextSibling),0===a.length&&d.removeChild(a))}var k,a,d,c,m,h;this.init=function(f){k=f.memberid;a=parseInt(f.timestamp,10);d=parseInt(f.position,10);c=void 0!==f.length?parseInt(f.length,10)||0:void 0;m=f.name};this.isEdit=!0;this.group=void 0;this.execute=function(q){var p=q.getCursor(k),n,g;h=q.getDOMDocument();var e=new Date(a),
b,r,l;b=h.createElementNS(odf.Namespaces.officens,"office:annotation");b.setAttributeNS(odf.Namespaces.officens,"office:name",m);n=h.createElementNS(odf.Namespaces.dcns,"dc:creator");n.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",k);n.textContent=q.getMember(k).getProperties().fullName;g=h.createElementNS(odf.Namespaces.dcns,"dc:date");g.appendChild(h.createTextNode(e.toISOString()));e=h.createElementNS(odf.Namespaces.textns,"text:list");r=h.createElementNS(odf.Namespaces.textns,
"text:list-item");l=h.createElementNS(odf.Namespaces.textns,"text:p");r.appendChild(l);e.appendChild(r);b.appendChild(n);b.appendChild(g);b.appendChild(e);void 0!==c&&(n=h.createElementNS(odf.Namespaces.officens,"office:annotation-end"),n.setAttributeNS(odf.Namespaces.officens,"office:name",m),b.annotationEndElement=n,f(q,n,d+c));f(q,b,d);q.emit(ops.OdtDocument.signalStepsInserted,{position:d});p&&(n=h.createRange(),g=b.getElementsByTagNameNS(odf.Namespaces.textns,"p")[0],n.selectNodeContents(g),
p.setSelectedRange(n,!1),p.setSelectionType(ops.OdtCursor.RangeSelection),q.emit(ops.Document.signalCursorMoved,p));q.getOdfCanvas().addAnnotation(b);q.fixCursorPositions();q.emit(ops.OdtDocument.signalAnnotationAdded,{memberId:k,annotation:b});return!0};this.spec=function(){return{optype:"AddAnnotation",memberid:k,timestamp:a,position:d,length:c,name:m}}};ops.OpAddCursor=function(){var f,k;this.init=function(a){f=a.memberid;k=a.timestamp};this.isEdit=!1;this.group=void 0;this.execute=function(a){var d=a.getCursor(f);if(d)return!1;d=new ops.OdtCursor(f,a);a.addCursor(d);a.emit(ops.Document.signalCursorAdded,d);return!0};this.spec=function(){return{optype:"AddCursor",memberid:f,timestamp:k}}};ops.OpAddMember=function(){var f,k,a;this.init=function(d){f=d.memberid;k=parseInt(d.timestamp,10);a=d.setProperties};this.isEdit=!1;this.group=void 0;this.execute=function(d){var c;if(d.getMember(f))return!1;c=new ops.Member(f,a);d.addMember(c);d.emit(ops.Document.signalMemberAdded,c);return!0};this.spec=function(){return{optype:"AddMember",memberid:f,timestamp:k,setProperties:a}}};ops.OpAddStyle=function(){var f,k,a,d,c,m,h=odf.Namespaces.stylens;this.init=function(h){f=h.memberid;k=h.timestamp;a=h.styleName;d=h.styleFamily;c="true"===h.isAutomaticStyle||!0===h.isAutomaticStyle;m=h.setProperties};this.isEdit=!0;this.group=void 0;this.execute=function(f){var k=f.getOdfCanvas().odfContainer(),n=f.getFormatting(),g=f.getDOMDocument().createElementNS(h,"style:style");if(!g)return!1;m&&n.updateStyle(g,m);g.setAttributeNS(h,"style:family",d);g.setAttributeNS(h,"style:name",a);c?
k.rootElement.automaticStyles.appendChild(g):k.rootElement.styles.appendChild(g);f.getOdfCanvas().refreshCSS();c||f.emit(ops.OdtDocument.signalCommonStyleCreated,{name:a,family:d});return!0};this.spec=function(){return{optype:"AddStyle",memberid:f,timestamp:k,styleName:a,styleFamily:d,isAutomaticStyle:c,setProperties:m}}};odf.ObjectNameGenerator=function(f,k){function a(b,a){var e={};this.generateName=function(){var c=a(),d=0,f;do f=b+d,d+=1;while(e[f]||c[f]);e[f]=!0;return f}}function d(){var b={};[f.rootElement.automaticStyles,f.rootElement.styles].forEach(function(a){for(a=a.firstElementChild;a;)a.namespaceURI===c&&"style"===a.localName&&(b[a.getAttributeNS(c,"name")]=!0),a=a.nextElementSibling});return b}var c=odf.Namespaces.stylens,m=odf.Namespaces.drawns,h=odf.Namespaces.xlinkns,q=(new core.Utils).hashString(k),
p=null,n=null,g=null,e={},b={};this.generateStyleName=function(){null===p&&(p=new a("auto"+q+"_",function(){return d()}));return p.generateName()};this.generateFrameName=function(){var b,c,d;if(null===n){c=f.rootElement.body.getElementsByTagNameNS(m,"frame");for(b=0;b<c.length;b+=1)d=c.item(b),e[d.getAttributeNS(m,"name")]=!0;n=new a("fr"+q+"_",function(){return e})}return n.generateName()};this.generateImageName=function(){var e,c,d;if(null===g){d=f.rootElement.body.getElementsByTagNameNS(m,"image");
for(e=0;e<d.length;e+=1)c=d.item(e),c=c.getAttributeNS(h,"href"),c=c.substring(9,c.lastIndexOf(".")),b[c]=!0;g=new a("img"+q+"_",function(){return b})}return g.generateName()}};odf.TextStyleApplicator=function(f,k,a){function d(a){function c(b,a){return"object"===typeof b&&"object"===typeof a?Object.keys(b).every(function(e){return c(b[e],a[e])}):b===a}var e={};this.isStyleApplied=function(b){b=k.getAppliedStylesForElement(b,e).styleProperties;return c(a,b)}}function c(c){var d={};this.applyStyleToContainer=function(e){var b;b=e.getAttributeNS(q,"style-name");var h=e.ownerDocument;b=b||"";if(!d.hasOwnProperty(b)){var l=b,m;m=b?k.createDerivedStyleObject(b,"text",c):c;h=
h.createElementNS(p,"style:style");k.updateStyle(h,m);h.setAttributeNS(p,"style:name",f.generateStyleName());h.setAttributeNS(p,"style:family","text");h.setAttributeNS("urn:webodf:names:scope","scope","document-content");a.appendChild(h);d[l]=h}b=d[b].getAttributeNS(p,"name");e.setAttributeNS(q,"text:style-name",b)}}function m(a,c){var e=a.ownerDocument,b=a.parentNode,d,f,m,k=new core.LoopWatchDog(1E4);f=[];f.push(a);for(m=a.nextSibling;m&&h.rangeContainsNode(c,m);)k.check(),f.push(m),m=m.nextSibling;
"span"!==b.localName||b.namespaceURI!==q?(d=e.createElementNS(q,"text:span"),b.insertBefore(d,a),e=!1):(a.previousSibling&&!h.rangeContainsNode(c,b.firstChild)?(d=b.cloneNode(!1),b.parentNode.insertBefore(d,b.nextSibling)):d=b,e=!0);f.forEach(function(b){b.parentNode!==d&&d.appendChild(b)});if(m&&e)for(f=d.cloneNode(!1),d.parentNode.insertBefore(f,d.nextSibling);m;)k.check(),e=m.nextSibling,f.appendChild(m),m=e;return d}var h=core.DomUtils,q=odf.Namespaces.textns,p=odf.Namespaces.stylens;this.applyStyle=
function(a,f,e){var b={},h,l,k,q;runtime.assert(e&&e.hasOwnProperty("style:text-properties"),"applyStyle without any text properties");b["style:text-properties"]=e["style:text-properties"];k=new c(b);q=new d(b);a.forEach(function(b){h=q.isStyleApplied(b);!1===h&&(l=m(b,f),k.applyStyleToContainer(l))})}};ops.OpApplyDirectStyling=function(){function f(a,c,d){var e=a.getOdfCanvas().odfContainer(),b=q.splitBoundaries(c),f=h.getTextNodes(c,!1);(new odf.TextStyleApplicator(new odf.ObjectNameGenerator(e,k),a.getFormatting(),e.rootElement.automaticStyles)).applyStyle(f,c,d);b.forEach(q.normalizeTextNodes)}var k,a,d,c,m,h=odf.OdfUtils,q=core.DomUtils;this.init=function(f){k=f.memberid;a=f.timestamp;d=parseInt(f.position,10);c=parseInt(f.length,10);m=f.setProperties};this.isEdit=!0;this.group=void 0;this.execute=
function(q){var n=q.convertCursorToDomRange(d,c),g=h.getParagraphElements(n);f(q,n,m);n.detach();q.getOdfCanvas().refreshCSS();q.fixCursorPositions();g.forEach(function(e){q.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:e,memberId:k,timeStamp:a})});q.getOdfCanvas().rerenderAnnotations();return!0};this.spec=function(){return{optype:"ApplyDirectStyling",memberid:k,timestamp:a,position:d,length:c,setProperties:m}}};ops.OpApplyHyperlink=function(){function f(a){for(;a;){if(q.isHyperlink(a))return!0;a=a.parentNode}return!1}var k,a,d,c,m,h=core.DomUtils,q=odf.OdfUtils;this.init=function(f){k=f.memberid;a=f.timestamp;d=f.position;c=f.length;m=f.hyperlink};this.isEdit=!0;this.group=void 0;this.execute=function(p){var n=p.getDOMDocument(),g=p.convertCursorToDomRange(d,c),e=h.splitBoundaries(g),b=[],r=q.getTextNodes(g,!1);if(0===r.length)return!1;r.forEach(function(a){var e=q.getParagraphElement(a);runtime.assert(!1===
f(a),"The given range should not contain any link.");var c=m,d=n.createElementNS(odf.Namespaces.textns,"text:a");d.setAttributeNS(odf.Namespaces.xlinkns,"xlink:type","simple");d.setAttributeNS(odf.Namespaces.xlinkns,"xlink:href",c);a.parentNode.insertBefore(d,a);d.appendChild(a);-1===b.indexOf(e)&&b.push(e)});e.forEach(h.normalizeTextNodes);g.detach();p.fixCursorPositions();p.getOdfCanvas().refreshSize();p.getOdfCanvas().rerenderAnnotations();b.forEach(function(b){p.emit(ops.OdtDocument.signalParagraphChanged,
{paragraphElement:b,memberId:k,timeStamp:a})});return!0};this.spec=function(){return{optype:"ApplyHyperlink",memberid:k,timestamp:a,position:d,length:c,hyperlink:m}}};ops.OpCreateList=function(){var f,k,a,d,c=odf.OdfUtils;this.init=function(c){f=c.memberid;k=c.timestamp;a=c.position;d=c.listType};this.isEdit=!0;this.group=void 0;this.execute=function(m){var h,q=m.getDOMDocument();h=m.convertCursorToDomRange(a,0);var p=m.getOdfCanvas().getStyleSheet().sheet,n=[],g=c.getTextNodes(h,!0);gui.ListController.setDefaultStyle(m,f);for(var e=gui.ListController.getStyles(m),b=q.querySelectorAll("list"),r=[],l=0;l<b.length;l++)r.push(b[l].attributes["counter-id"].nodeValue);
for(b=1;-1!=r.indexOf("X"+b+"-level1-1");)b++;r=q.createElementNS(odf.Namespaces.textns,"text:list");q=q.createElementNS(odf.Namespaces.textns,"text:list-item");r.setAttributeNS(odf.Namespaces.textns,"text:style-name","L"+String(e[d]));r.setAttributeNS("urn:webodf:names:helper","counter-id","X"+String(b)+"-level1-1");r.appendChild(q);0<g.length?(h=c.getParagraphElement(g[0]),h.parentNode.insertBefore(r,h),q.appendChild(h),-1===n.indexOf(h)&&n.push(h)):(h.startContainer.parentNode.insertBefore(r,h.startContainer),
h.startOffset=0,q.appendChild(h.startContainer));h='text|list[webodfhelper|counter-id="X'+String(b)+'-level1-1"] > text|list-item:first-child {';h+="   counter-reset: X"+String(b)+"-level1-1 1;";p.insertRule(h+"}",p.cssRules.length);h='text|list[webodfhelper|counter-id="X'+String(b)+'-level1-1"] > text|list-item:first-child > *:first-child:not(text|list)::before {';h+="   counter-increment: X"+String(b)+"-level1-1 0;";h+="}";p.insertRule(h,p.cssRules.length);h='text|list[webodfhelper|counter-id="X'+
String(b)+'-level1-1"] > text|list-item > :not(text|list):first-child::before';h+="{";h="number"===d?h+("   content:   counter(X"+String(b)+'-level1-1, decimal) ".";'):h+'   content: "\u2022";';h+="   counter-increment: X"+String(b)+"-level1-1;";h+="   text-align: left;";h+="   display: inline-block;";h+="   margin-left: 0.635cm;";h+="   padding-right: 0.2cm;";h+="}";p.insertRule(h,p.cssRules.length);m.fixCursorPositions();m.getOdfCanvas().refreshSize();m.getOdfCanvas().rerenderAnnotations();n.forEach(function(b){m.emit(ops.OdtDocument.signalParagraphChanged,
{paragraphElement:b,memberId:f,timeStamp:k})});p=m.getIteratorAtPosition(a);if(p=odf.OdfUtils.getParagraphElement(p.container()))m.getOdfCanvas().refreshSize(),m.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:p,timeStamp:void 0,memberId:f}),m.getOdfCanvas().rerenderAnnotations();return!0};this.spec=function(){return{optype:"CreateList",memberid:f,timestamp:k,position:a,listType:d}}};ops.OpInsertImage=function(){var f,k,a,d,c,m,h,q,p=odf.Namespaces.drawns,n=odf.Namespaces.svgns,g=odf.Namespaces.textns,e=odf.Namespaces.xlinkns,b=odf.OdfUtils;this.init=function(b){f=b.memberid;k=b.timestamp;a=b.position;d=b.filename;c=b.frameWidth;m=b.frameHeight;h=b.frameStyleName;q=b.frameName};this.isEdit=!0;this.group=void 0;this.execute=function(r){var l=r.getOdfCanvas(),y=r.getTextNodeAtStep(a,f),t,z;if(!y)return!1;t=y.textNode;z=b.getParagraphElement(t);var y=y.offset!==t.length?t.splitText(y.offset):
t.nextSibling,w=r.getDOMDocument(),s=w.createElementNS(p,"draw:image"),w=w.createElementNS(p,"draw:frame");s.setAttributeNS(e,"xlink:href",d);s.setAttributeNS(e,"xlink:type","simple");s.setAttributeNS(e,"xlink:show","embed");s.setAttributeNS(e,"xlink:actuate","onLoad");w.setAttributeNS(p,"draw:style-name",h);w.setAttributeNS(p,"draw:name",q);w.setAttributeNS(g,"text:anchor-type","as-char");w.setAttributeNS(n,"svg:width",c);w.setAttributeNS(n,"svg:height",m);w.appendChild(s);t.parentNode.insertBefore(w,
y);r.emit(ops.OdtDocument.signalStepsInserted,{position:a});0===t.length&&t.parentNode.removeChild(t);l.addCssForFrameWithImage(w);l.refreshCSS();r.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:z,memberId:f,timeStamp:k});l.rerenderAnnotations();return!0};this.spec=function(){return{optype:"InsertImage",memberid:f,timestamp:k,filename:d,position:a,frameWidth:c,frameHeight:m,frameStyleName:h,frameName:q}}};ops.OpInsertTable=function(){function f(a,b){var f;if(1===n.length)f=n[0];else if(3===n.length)switch(a){case 0:f=n[0];break;case d-1:f=n[2];break;default:f=n[1]}else f=n[a];if(1===f.length)return f[0];if(3===f.length)switch(b){case 0:return f[0];case c-1:return f[2];default:return f[1]}return f[b]}var k,a,d,c,m,h,q,p,n,g=odf.OdfUtils;this.init=function(e){k=e.memberid;a=e.timestamp;m=e.position;d=e.initialRows;c=e.initialColumns;h=e.tableName;q=e.tableStyleName;p=e.tableColumnStyleName;n=e.tableCellStyleMatrix};
this.isEdit=!0;this.group=void 0;this.execute=function(e){var b=e.getTextNodeAtStep(m),r=e.getRootNode();if(b){var l=e.getDOMDocument(),n=l.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table"),t=l.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table-column"),z,w,s,x;q&&n.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:style-name",q);h&&n.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:name",h);t.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0",
"table:number-columns-repeated",c);p&&t.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:style-name",p);n.appendChild(t);for(s=0;s<d;s+=1){t=l.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table-row");for(x=0;x<c;x+=1)z=l.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table-cell"),(w=f(s,x))&&z.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:style-name",w),w=l.createElementNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0",
"text:p"),z.appendChild(w),t.appendChild(z);n.appendChild(t)}b=g.getParagraphElement(b.textNode);r.insertBefore(n,b.nextSibling);e.emit(ops.OdtDocument.signalStepsInserted,{position:m});e.getOdfCanvas().refreshSize();e.emit(ops.OdtDocument.signalTableAdded,{tableElement:n,memberId:k,timeStamp:a});e.getOdfCanvas().rerenderAnnotations();return!0}return!1};this.spec=function(){return{optype:"InsertTable",memberid:k,timestamp:a,position:m,initialRows:d,initialColumns:c,tableName:h,tableStyleName:q,tableColumnStyleName:p,
tableCellStyleMatrix:n}}};ops.OpInsertText=function(){var f,k,a,d,c,m=odf.OdfUtils;this.init=function(h){f=h.memberid;k=h.timestamp;a=h.position;c=h.text;d="true"===h.moveCursor||!0===h.moveCursor};this.isEdit=!0;this.group=void 0;this.execute=function(h){var q,p,n,g=null,e=h.getDOMDocument(),b,r=0,l,y=h.getCursor(f),t;h.upgradeWhitespacesAtPosition(a);if(q=h.getTextNodeAtStep(a)){p=q.textNode;g=p.nextSibling;n=p.parentNode;b=m.getParagraphElement(p);for(t=0;t<c.length;t+=1)if("\t"===c[t]||"\t"!==c[t]&&m.isODFWhitespace(c[t])&&
(0===t||t===c.length-1||"\t"!==c[t-1]&&m.isODFWhitespace(c[t-1])))0===r?(q.offset!==p.length&&(g=p.splitText(q.offset)),0<t&&p.appendData(c.substring(0,t))):r<t&&(r=c.substring(r,t),n.insertBefore(e.createTextNode(r),g)),r=t+1,"\t"===c[t]?(l=e.createElementNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","text:tab"),l.appendChild(e.createTextNode("\t"))):(" "!==c[t]&&runtime.log("WARN: InsertText operation contains non-tab, non-space whitespace character (character code "+c.charCodeAt(t)+")"),
l=e.createElementNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","text:s"),l.appendChild(e.createTextNode(" "))),n.insertBefore(l,g);0===r?p.insertData(q.offset,c):r<c.length&&(q=c.substring(r),n.insertBefore(e.createTextNode(q),g));n=p.parentNode;g=p.nextSibling;n.removeChild(p);n.insertBefore(p,g);0===p.length&&p.parentNode.removeChild(p);h.emit(ops.OdtDocument.signalStepsInserted,{position:a});y&&d&&(h.moveCursor(f,a+c.length,0),h.emit(ops.Document.signalCursorMoved,y));h.downgradeWhitespacesAtPosition(a);
h.downgradeWhitespacesAtPosition(a+c.length);h.getOdfCanvas().refreshSize();h.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:b,memberId:f,timeStamp:k});h.getOdfCanvas().rerenderAnnotations();return!0}return!1};this.spec=function(){return{optype:"InsertText",memberid:f,timestamp:k,position:a,text:c,moveCursor:d}}};odf.CollapsingRules=function(f){function k(a){return d.isODFNode(a)||"br"===a.localName&&d.isLineBreak(a.parentNode)||a.nodeType===Node.TEXT_NODE&&d.isODFNode(a.parentNode)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}function a(m){var h;m.nodeType===Node.TEXT_NODE?(h=m.parentNode,h.removeChild(m)):h=c.removeUnwantedNodes(m,k);return h&&!d.isParagraph(h)&&h!==f&&d.hasNoODFContent(h)?a(h):h}var d=odf.OdfUtils,c=core.DomUtils;this.mergeChildrenIntoParent=a};ops.OpMergeParagraph=function(){function f(b){return odf.OdfUtils.isInlineRoot(b)?NodeFilter.FILTER_SKIP:g.isGroupingElement(b)&&g.hasNoODFContent(b)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}function k(b){if(b.nodeType===Node.TEXT_NODE){if(0===b.length)return runtime.log("WARN: Empty text node found during merge operation"),!0;if(g.isODFWhitespace(b.data)&&!1===g.isSignificantWhitespace(b,0))return!0;b="#text"}else b=(b.prefix?b.prefix+":":"")+b.localName;runtime.log("WARN: Unexpected text element found near paragraph boundary ["+
b+"]");return!1}function a(b){b.collapsed||(e.splitBoundaries(b),b=g.getTextElements(b,!1,!0).filter(k),b.forEach(function(b){b.parentNode.removeChild(b)}))}function d(b,a,e){b=b.convertCursorStepToDomPoint(a);var c=g.getParagraphElement(b.node,b.offset);runtime.assert(Boolean(c),"Paragraph not found at step "+a);e&&e.setPosition(b.node,b.offset);return c}var c,m,h,q,p,n,g=odf.OdfUtils,e=core.DomUtils,b=odf.Namespaces.textns;this.init=function(b){c=b.memberid;m=b.timestamp;h=b.moveCursor;q=b.paragraphStyleName;
p=parseInt(b.sourceStartPosition,10);n=parseInt(b.destinationStartPosition,10)};this.isEdit=!0;this.group=void 0;this.execute=function(g){var l,k,t=g.getCursor(c);l=g.getRootNode();var z=new odf.CollapsingRules(l),w=g.createStepIterator(l,0,[g.getPositionFilter()],l),s;runtime.assert(n<p,"Destination paragraph ("+n+") must be before source paragraph ("+p+")");k=d(g,n);l=d(g,p,w);w.previousStep();runtime.assert(e.containsNode(k,w.container()),"Destination paragraph must be adjacent to the source paragraph");
s=k.ownerDocument.createRange();w.setPosition(k,k.childNodes.length);w.roundToPreviousStep();s.setStart(w.container(),w.offset());s.setEnd(k,k.childNodes.length);a(s);s=k.childNodes.length;var x=l.ownerDocument.createRange();w.setPosition(l,0);w.roundToNextStep();x.setStart(l,0);x.setEnd(w.container(),w.offset());a(x);for(x=l.firstChild;x;)"editinfo"===x.localName?l.removeChild(x):(k.appendChild(x),e.removeUnwantedNodes(x,f)),x=l.firstChild;runtime.assert(0===l.childNodes.length,"Source paragraph should be empty before it is removed");
z.mergeChildrenIntoParent(l);g.emit(ops.OdtDocument.signalStepsRemoved,{position:p-1});w.setPosition(k,s);w.roundToClosestStep();w.previousStep()||w.roundToNextStep();g.downgradeWhitespaces(w);q?k.setAttributeNS(b,"text:style-name",q):k.removeAttributeNS(b,"style-name");t&&h&&(g.moveCursor(c,p-1,0),g.emit(ops.Document.signalCursorMoved,t));g.fixCursorPositions();g.getOdfCanvas().refreshSize();g.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:k,memberId:c,timeStamp:m});g.getOdfCanvas().rerenderAnnotations();
return!0};this.spec=function(){return{optype:"MergeParagraph",memberid:c,timestamp:m,moveCursor:h,paragraphStyleName:q,sourceStartPosition:p,destinationStartPosition:n}}};ops.OpMoveCursor=function(){var f,k,a,d,c;this.init=function(m){f=m.memberid;k=m.timestamp;a=m.position;d=m.length||0;c=m.selectionType||ops.OdtCursor.RangeSelection};this.isEdit=!1;this.group=void 0;this.execute=function(m){var h=m.getCursor(f),k;if(!h)return!1;k=m.convertCursorToDomRange(a,d);h.setSelectedRange(k,0<=d);h.setSelectionType(c);m.emit(ops.Document.signalCursorMoved,h);return!0};this.spec=function(){return{optype:"MoveCursor",memberid:f,timestamp:k,position:a,length:d,selectionType:c}}};ops.OpRemoveAnnotation=function(){var f,k,a,d,c=core.DomUtils;this.init=function(c){f=c.memberid;k=c.timestamp;a=parseInt(c.position,10);d=parseInt(c.length,10)};this.isEdit=!0;this.group=void 0;this.execute=function(d){function f(a){p.parentNode.insertBefore(a,p)}for(var k=d.getIteratorAtPosition(a).container(),p;k.namespaceURI!==odf.Namespaces.officens||"annotation"!==k.localName;)k=k.parentNode;if(null===k)return!1;p=k;k=p.annotationEndElement;d.getOdfCanvas().forgetAnnotation(p);c.getElementsByTagNameNS(p,
"urn:webodf:names:cursor","cursor").forEach(f);c.getElementsByTagNameNS(p,"urn:webodf:names:cursor","anchor").forEach(f);p.parentNode.removeChild(p);k&&k.parentNode.removeChild(k);d.emit(ops.OdtDocument.signalStepsRemoved,{position:0<a?a-1:a});d.getOdfCanvas().rerenderAnnotations();d.fixCursorPositions();return!0};this.spec=function(){return{optype:"RemoveAnnotation",memberid:f,timestamp:k,position:a,length:d}}};ops.OpRemoveBlob=function(){var f,k,a;this.init=function(d){f=d.memberid;k=d.timestamp;a=d.filename};this.isEdit=!0;this.group=void 0;this.execute=function(d){d.getOdfCanvas().odfContainer().removeBlob(a);return!0};this.spec=function(){return{optype:"RemoveBlob",memberid:f,timestamp:k,filename:a}}};ops.OpRemoveCursor=function(){var f,k;this.init=function(a){f=a.memberid;k=a.timestamp};this.isEdit=!1;this.group=void 0;this.execute=function(a){return a.removeCursor(f)?!0:!1};this.spec=function(){return{optype:"RemoveCursor",memberid:f,timestamp:k}}};ops.OpRemoveHyperlink=function(){var f,k,a,d,c=core.DomUtils,m=odf.OdfUtils;this.init=function(c){f=c.memberid;k=c.timestamp;a=c.position;d=c.length};this.isEdit=!0;this.group=void 0;this.execute=function(h){var q=h.convertCursorToDomRange(a,d),p=m.getHyperlinkElements(q);runtime.assert(1===p.length,"The given range should only contain a single link.");p=c.mergeIntoParent(p[0]);q.detach();h.fixCursorPositions();h.getOdfCanvas().refreshSize();h.getOdfCanvas().rerenderAnnotations();h.emit(ops.OdtDocument.signalParagraphChanged,
{paragraphElement:m.getParagraphElement(p),memberId:f,timeStamp:k});return!0};this.spec=function(){return{optype:"RemoveHyperlink",memberid:f,timestamp:k,position:a,length:d}}};ops.OpRemoveMember=function(){var f,k;this.init=function(a){f=a.memberid;k=parseInt(a.timestamp,10)};this.isEdit=!1;this.group=void 0;this.execute=function(a){if(!a.getMember(f))return!1;a.removeMember(f);a.emit(ops.Document.signalMemberRemoved,f);return!0};this.spec=function(){return{optype:"RemoveMember",memberid:f,timestamp:k}}};ops.OpRemoveStyle=function(){var f,k,a,d;this.init=function(c){f=c.memberid;k=c.timestamp;a=c.styleName;d=c.styleFamily};this.isEdit=!0;this.group=void 0;this.execute=function(c){var f=c.getFormatting().getStyleElement(a,d);if(!f)return!1;f.parentNode.removeChild(f);c.getOdfCanvas().refreshCSS();c.emit(ops.OdtDocument.signalCommonStyleDeleted,{name:a,family:d});return!0};this.spec=function(){return{optype:"RemoveStyle",memberid:f,timestamp:k,styleName:a,styleFamily:d}}};ops.OpRemoveText=function(){var f,k,a,d,c=odf.OdfUtils,m=core.DomUtils;this.init=function(c){runtime.assert(0<=c.length,"OpRemoveText only supports positive lengths");f=c.memberid;k=c.timestamp;a=parseInt(c.position,10);d=parseInt(c.length,10)};this.isEdit=!0;this.group=void 0;this.execute=function(h){var q,p,n,g=h.getCursor(f),e=new odf.CollapsingRules(h.getRootNode());h.upgradeWhitespacesAtPosition(a);h.upgradeWhitespacesAtPosition(a+d);q=h.convertCursorToDomRange(a,d);m.splitBoundaries(q);p=c.getTextElements(q,
!1,!0);n=c.getParagraphElement(q.startContainer,q.startOffset);runtime.assert(void 0!==n,"Attempting to remove text outside a paragraph element");q.detach();p.forEach(function(b){b.parentNode?(runtime.assert(m.containsNode(n,b),"RemoveText only supports removing elements within the same paragraph"),e.mergeChildrenIntoParent(b)):runtime.log("WARN: text element has already been removed from it's container")});h.emit(ops.OdtDocument.signalStepsRemoved,{position:a});h.downgradeWhitespacesAtPosition(a);
h.fixCursorPositions();h.getOdfCanvas().refreshSize();h.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:n,memberId:f,timeStamp:k});g&&(g.resetSelectionType(),h.emit(ops.Document.signalCursorMoved,g));h.getOdfCanvas().rerenderAnnotations();return!0};this.spec=function(){return{optype:"RemoveText",memberid:f,timestamp:k,position:a,length:d}}};ops.OpSetBlob=function(){var f,k,a,d,c;this.init=function(m){f=m.memberid;k=m.timestamp;a=m.filename;d=m.mimetype;c=m.content};this.isEdit=!0;this.group=void 0;this.execute=function(f){f.getOdfCanvas().odfContainer().setBlob(a,d,c);return!0};this.spec=function(){return{optype:"SetBlob",memberid:f,timestamp:k,filename:a,mimetype:d,content:c}}};ops.OpSetParagraphStyle=function(){function f(a,c,d){var f=[a.getPositionFilter()],g=d.container();d=d.unfilteredDomOffset();return!1===a.createStepIterator(g,d,f,c).previousStep()}var k,a,d,c,m=odf.OdfUtils;this.init=function(f){k=f.memberid;a=f.timestamp;d=f.position;c=f.styleName};this.isEdit=!0;this.group=void 0;this.execute=function(h){var q,p;q=h.getIteratorAtPosition(d);return(p=m.getParagraphElement(q.container()))?(runtime.assert(f(h,p,q),"SetParagraphStyle position should be the first position in the paragraph"),
c?p.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","text:style-name",c):p.removeAttributeNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","style-name"),h.getOdfCanvas().refreshSize(),h.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:p,timeStamp:a,memberId:k}),h.getOdfCanvas().rerenderAnnotations(),!0):!1};this.spec=function(){return{optype:"SetParagraphStyle",memberid:k,timestamp:a,position:d,styleName:c}}};ops.OpSplitParagraph=function(){var f,k,a,d,c,m,h=odf.OdfUtils,q=odf.Namespaces.textns;this.init=function(h){f=h.memberid;k=h.timestamp;d=h.position;a=h.sourceParagraphPosition;m=h.paragraphStyleName;c="true"===h.moveCursor||!0===h.moveCursor};this.isEdit=!0;this.group=void 0;this.execute=function(a){var n,g,e,b,r,l,y,t=a.getCursor(f);a.upgradeWhitespacesAtPosition(d);n=a.getTextNodeAtStep(d);if(!n)return!1;g=h.getParagraphElement(n.textNode);if(!g)return!1;if(h.isListItem(g.parentNode)){if(2===g.children.length&&
3===g.childNodes.length)return a=g.parentNode,a.parentNode.parentNode.insertBefore(g,a.parentNode.nextSibling),a.parentNode.removeChild(a),!1;e=g.parentNode}else e=g;0===n.offset?(y=n.textNode.previousSibling,l=null):(y=n.textNode,l=n.offset>=n.textNode.length?null:n.textNode.splitText(n.offset));for(b=n.textNode;b!==e;){b=b.parentNode;r=b.cloneNode(!1);l&&r.appendChild(l);if(y)for(;y&&y.nextSibling;)r.appendChild(y.nextSibling);else for(;b.firstChild;)r.appendChild(b.firstChild);b.parentNode.insertBefore(r,
b.nextSibling);y=b;l=r}h.isListItem(l)&&(l=l.childNodes.item(0));m?l.setAttributeNS(q,"text:style-name",m):l.removeAttributeNS(q,"style-name");0===n.textNode.length&&n.textNode.parentNode.removeChild(n.textNode);a.emit(ops.OdtDocument.signalStepsInserted,{position:d});t&&c&&(a.moveCursor(f,d+1,0),a.emit(ops.Document.signalCursorMoved,t));a.fixCursorPositions();a.getOdfCanvas().refreshSize();a.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:g,memberId:f,timeStamp:k});a.emit(ops.OdtDocument.signalParagraphChanged,
{paragraphElement:l,memberId:f,timeStamp:k});a.getOdfCanvas().rerenderAnnotations();return!0};this.spec=function(){return{optype:"SplitParagraph",memberid:f,timestamp:k,position:d,sourceParagraphPosition:a,paragraphStyleName:m,moveCursor:c}}};ops.OpUpdateMember=function(){function f(a){var c="//dc:creator[@editinfo:memberid='"+k+"']";a=xmldom.XPath.getODFElementsWithXPath(a.getRootNode(),c,function(a){return"editinfo"===a?"urn:webodf:names:editinfo":odf.Namespaces.lookupNamespaceURI(a)});for(c=0;c<a.length;c+=1)a[c].textContent=d.fullName}var k,a,d,c;this.init=function(f){k=f.memberid;a=parseInt(f.timestamp,10);d=f.setProperties;c=f.removedProperties};this.isEdit=!1;this.group=void 0;this.execute=function(a){var h=a.getMember(k);if(!h)return!1;
c&&h.removeProperties(c);d&&(h.setProperties(d),d.fullName&&f(a));a.emit(ops.Document.signalMemberUpdated,h);return!0};this.spec=function(){return{optype:"UpdateMember",memberid:k,timestamp:a,setProperties:d,removedProperties:c}}};ops.OpUpdateMetadata=function(){var f,k,a,d;this.init=function(c){f=c.memberid;k=parseInt(c.timestamp,10);a=c.setProperties;d=c.removedProperties};this.isEdit=!0;this.group=void 0;this.execute=function(c){var f=c.getOdfCanvas().odfContainer(),h=null;d&&(h=d.attributes.split(","));f.setMetadata(a,h);c.emit(ops.OdtDocument.signalMetadataUpdated,{setProperties:null!==a?a:{},removedProperties:null!==h?h:[]});return!0};this.spec=function(){return{optype:"UpdateMetadata",memberid:f,timestamp:k,setProperties:a,
removedProperties:d}}};ops.OpUpdateParagraphStyle=function(){function f(a,c){var d,f,e=c?c.split(","):[];for(d=0;d<e.length;d+=1)f=e[d].split(":"),a.removeAttributeNS(odf.Namespaces.lookupNamespaceURI(f[0]),f[1])}var k,a,d,c,m,h=odf.Namespaces.stylens;this.init=function(f){k=f.memberid;a=f.timestamp;d=f.styleName;c=f.setProperties;m=f.removedProperties};this.isEdit=!0;this.group=void 0;this.execute=function(a){var k=a.getFormatting(),n,g,e;return(n=""!==d?k.getStyleElement(d,"paragraph"):k.getDefaultStyleElement("paragraph"))?
(g=n.getElementsByTagNameNS(h,"paragraph-properties").item(0),e=n.getElementsByTagNameNS(h,"text-properties").item(0),c&&k.updateStyle(n,c),m&&(k=m["style:paragraph-properties"],g&&k&&(f(g,k.attributes),0===g.attributes.length&&n.removeChild(g)),k=m["style:text-properties"],e&&k&&(f(e,k.attributes),0===e.attributes.length&&n.removeChild(e)),f(n,m.attributes)),a.getOdfCanvas().refreshCSS(),a.emit(ops.OdtDocument.signalParagraphStyleModified,d),a.getOdfCanvas().rerenderAnnotations(),!0):!1};this.spec=
function(){return{optype:"UpdateParagraphStyle",memberid:k,timestamp:a,styleName:d,setProperties:c,removedProperties:m}}};ops.OperationFactory=function(){function f(a){return function(d){return new a}}var k;this.register=function(a,d){k[a]=d};this.create=function(a){var d=null,c=k[a.optype];c&&(d=c(a),d.init(a));return d};k={AddMember:f(ops.OpAddMember),UpdateMember:f(ops.OpUpdateMember),RemoveMember:f(ops.OpRemoveMember),AddCursor:f(ops.OpAddCursor),ApplyDirectStyling:f(ops.OpApplyDirectStyling),SetBlob:f(ops.OpSetBlob),RemoveBlob:f(ops.OpRemoveBlob),InsertImage:f(ops.OpInsertImage),InsertTable:f(ops.OpInsertTable),
InsertText:f(ops.OpInsertText),RemoveText:f(ops.OpRemoveText),MergeParagraph:f(ops.OpMergeParagraph),SplitParagraph:f(ops.OpSplitParagraph),SetParagraphStyle:f(ops.OpSetParagraphStyle),UpdateParagraphStyle:f(ops.OpUpdateParagraphStyle),AddStyle:f(ops.OpAddStyle),RemoveStyle:f(ops.OpRemoveStyle),MoveCursor:f(ops.OpMoveCursor),RemoveCursor:f(ops.OpRemoveCursor),AddAnnotation:f(ops.OpAddAnnotation),RemoveAnnotation:f(ops.OpRemoveAnnotation),UpdateMetadata:f(ops.OpUpdateMetadata),ApplyHyperlink:f(ops.OpApplyHyperlink),
CreateList:f(ops.OpCreateList),RemoveHyperlink:f(ops.OpRemoveHyperlink)}};ops.OperationRouter=function(){};ops.OperationRouter.prototype.setOperationFactory=function(f){};ops.OperationRouter.prototype.setPlaybackFunction=function(f){};ops.OperationRouter.prototype.push=function(f){};ops.OperationRouter.prototype.close=function(f){};ops.OperationRouter.prototype.subscribe=function(f,k){};ops.OperationRouter.prototype.unsubscribe=function(f,k){};ops.OperationRouter.prototype.hasLocalUnsyncedOps=function(){};ops.OperationRouter.prototype.hasSessionHostConnection=function(){};
ops.OperationRouter.signalProcessingBatchStart="router/batchstart";ops.OperationRouter.signalProcessingBatchEnd="router/batchend";ops.TrivialOperationRouter=function(){var f=new core.EventNotifier([ops.OperationRouter.signalProcessingBatchStart,ops.OperationRouter.signalProcessingBatchEnd]),k,a,d=0;this.setOperationFactory=function(a){k=a};this.setPlaybackFunction=function(c){a=c};this.push=function(c){d+=1;f.emit(ops.OperationRouter.signalProcessingBatchStart,{});c.forEach(function(c){c=c.spec();c.timestamp=Date.now();c=k.create(c);c.group="g"+d;a(c)});f.emit(ops.OperationRouter.signalProcessingBatchEnd,{})};this.close=function(a){a()};
this.subscribe=function(a,d){f.subscribe(a,d)};this.unsubscribe=function(a,d){f.unsubscribe(a,d)};this.hasLocalUnsyncedOps=function(){return!1};this.hasSessionHostConnection=function(){return!0}};ops.Session=function(f){function k(a){c.emit(ops.OdtDocument.signalProcessingBatchStart,a)}function a(a){c.emit(ops.OdtDocument.signalProcessingBatchEnd,a)}var d=new ops.OperationFactory,c=new ops.OdtDocument(f),m=null;this.setOperationFactory=function(a){d=a;m&&m.setOperationFactory(d)};this.setOperationRouter=function(f){m&&(m.unsubscribe(ops.OperationRouter.signalProcessingBatchStart,k),m.unsubscribe(ops.OperationRouter.signalProcessingBatchEnd,a));m=f;m.subscribe(ops.OperationRouter.signalProcessingBatchStart,
k);m.subscribe(ops.OperationRouter.signalProcessingBatchEnd,a);f.setPlaybackFunction(function(a){c.emit(ops.OdtDocument.signalOperationStart,a);return a.execute(c)?(c.emit(ops.OdtDocument.signalOperationEnd,a),!0):!1});f.setOperationFactory(d)};this.getOperationFactory=function(){return d};this.getOdtDocument=function(){return c};this.enqueue=function(a){m.push(a)};this.close=function(a){m.close(function(d){d?a(d):c.close(a)})};this.destroy=function(a){c.destroy(a)};this.setOperationRouter(new ops.TrivialOperationRouter);
gui.ListController.setDefaultStyle(this.getOdtDocument(),void 0)};gui.AnnotationController=function(f,k,a){function d(){var b=q.getCursor(a),b=b&&b.getNode(),e=!1;b&&(e=!g.isWithinAnnotation(b,q.getRootNode()));e!==p&&(p=e,n.emit(gui.AnnotationController.annotatableChanged,p))}function c(b){b.getMemberId()===a&&d()}function m(b){b===a&&d()}function h(b){b.getMemberId()===a&&d()}var q=f.getOdtDocument(),p=!1,n=new core.EventNotifier([gui.AnnotationController.annotatableChanged]),g=odf.OdfUtils,e=core.StepDirection.NEXT;this.isAnnotatable=function(){return p};this.addAnnotation=
function(){var b=new ops.OpAddAnnotation,e=q.getCursorSelection(a),c=e.length,e=e.position;p&&(0===c?c=void 0:(e=0<=c?e:e+c,c=Math.abs(c)),b.init({memberid:a,position:e,length:c,name:a+Date.now()}),f.enqueue([b]))};this.removeAnnotation=function(b){var c,d;c=q.getMember(a).getProperties().fullName;if(!0!==k.getState(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN)||c===g.getAnnotationCreator(b))c=q.convertDomPointToCursorStep(b,0,e),d=q.convertDomPointToCursorStep(b,b.childNodes.length),b=
new ops.OpRemoveAnnotation,b.init({memberid:a,position:c,length:d-c}),d=new ops.OpMoveCursor,d.init({memberid:a,position:0<c?c-1:c,length:0}),f.enqueue([b,d])};this.subscribe=function(b,a){n.subscribe(b,a)};this.unsubscribe=function(b,a){n.unsubscribe(b,a)};this.destroy=function(b){q.unsubscribe(ops.Document.signalCursorAdded,c);q.unsubscribe(ops.Document.signalCursorRemoved,m);q.unsubscribe(ops.Document.signalCursorMoved,h);b()};k.registerConstraint(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN);
q.subscribe(ops.Document.signalCursorAdded,c);q.subscribe(ops.Document.signalCursorRemoved,m);q.subscribe(ops.Document.signalCursorMoved,h);d()};gui.AnnotationController.annotatableChanged="annotatable/changed";gui.Avatar=function(f,k){var a=this,d,c,m;this.setColor=function(a){c.style.borderColor=a};this.setImageUrl=function(d){a.isVisible()?c.src=d:m=d};this.isVisible=function(){return"block"===d.style.display};this.show=function(){m&&(c.src=m,m=void 0);d.style.display="block"};this.hide=function(){d.style.display="none"};this.markAsFocussed=function(a){a?d.classList.add("active"):d.classList.remove("active")};this.destroy=function(a){f.removeChild(d);a()};(function(){var a=f.ownerDocument;d=a.createElement("div");
c=a.createElement("img");d.appendChild(c);d.style.display=k?"block":"none";d.className="handle";f.appendChild(d)})()};gui.StepInfo=function(){};gui.StepInfo.VisualDirection={LEFT_TO_RIGHT:0,RIGHT_TO_LEFT:1};gui.StepInfo.prototype.container=function(){};gui.StepInfo.prototype.offset=function(){};gui.VisualStepScanner=function(){};gui.VisualStepScanner.prototype.process=function(f,k,a){};gui.GuiStepUtils=function(){function f(c){c=a.getContentBounds(c);var f,h=null;if(c)if(c.container.nodeType===Node.TEXT_NODE)f=c.container.ownerDocument.createRange(),f.setStart(c.container,c.startOffset),f.setEnd(c.container,c.endOffset),(h=0<f.getClientRects().length?f.getBoundingClientRect():null)&&" "===c.container.data.substring(c.startOffset,c.endOffset)&&1>=h.width&&(h=null),f.detach();else if(k.isCharacterElement(c.container)||k.isCharacterFrame(c.container))h=d.getBoundingClientRect(c.container);
return h}var k=odf.OdfUtils,a=new odf.StepUtils,d=core.DomUtils,c=core.StepDirection.NEXT,m=gui.StepInfo.VisualDirection.LEFT_TO_RIGHT,h=gui.StepInfo.VisualDirection.RIGHT_TO_LEFT;this.getContentRect=f;this.moveToFilteredStep=function(a,d,k){function g(b,a){a.process(w,l,y)&&(b=!0,!t&&a.token&&(t=a.token));return b}var e=d===c,b,r,l,y,t,z=a.snapshot();b=!1;var w;do b=f(a),w={token:a.snapshot(),container:a.container,offset:a.offset,direction:d,visualDirection:d===c?m:h},r=a.nextStep()?f(a):null,a.restore(w.token),
e?(l=b,y=r):(l=r,y=b),b=k.reduce(g,!1);while(!b&&a.advanceStep(d));b||k.forEach(function(b){!t&&b.token&&(t=b.token)});a.restore(t||z);return Boolean(t)}};gui.Caret=function(f,k,a,d){function c(){g.style.opacity="0"===g.style.opacity?"1":"0";x.trigger()}function m(){l.selectNodeContents(r);return l.getBoundingClientRect()}function h(){Object.keys(C).forEach(function(b){G[b]=C[b]})}function q(){if(!1===C.isShown||f.getSelectionType()!==ops.OdtCursor.RangeSelection||!d&&!f.getSelectedRange().collapsed)C.visibility="hidden",g.style.visibility="hidden",x.cancel();else if(C.visibility="visible",g.style.visibility="visible",!1===C.isFocused)g.style.opacity=
"1",x.cancel();else{if(u||G.visibility!==C.visibility)g.style.opacity="1",x.cancel();x.trigger()}if(H||A){var a;a=f.getNode();var c,l,r=t.getBoundingClientRect(y.getSizer()),q=!1,p=0;a.removeAttributeNS("urn:webodf:names:cursor","caret-sizer-active");if(0<a.getClientRects().length)l=m(),p=l.left-t.getBoundingClientRect(a).left,q=!0;else if(w.setPosition(a,0),l=z.getContentRect(w),!l&&w.nextStep()&&(c=z.getContentRect(w))&&(l=c,q=!0),l||(a.setAttributeNS("urn:webodf:names:cursor","caret-sizer-active",
"true"),l=m(),q=!0),!l)for(runtime.log("WARN: No suitable client rectangle found for visual caret for "+f.getMemberId());a;){if(0<a.getClientRects().length){l=t.getBoundingClientRect(a);q=!0;break}a=a.parentNode}l=t.translateRect(l,r,y.getZoomLevel());a={top:l.top,height:l.height,right:q?l.left:l.right,width:t.adaptRangeDifferenceToZoomLevel(p,y.getZoomLevel())};8>a.height&&(a={top:a.top-(8-a.height)/2,height:8,right:a.right});n.style.height=a.height+"px";n.style.top=a.top+"px";n.style.left=a.right-
a.width+"px";n.style.width=a.width?a.width+"px":"";b&&(a=runtime.getWindow().getComputedStyle(f.getNode(),null),a.font?b.style.font=a.font:(b.style.fontStyle=a.fontStyle,b.style.fontVariant=a.fontVariant,b.style.fontWeight=a.fontWeight,b.style.fontSize=a.fontSize,b.style.lineHeight=a.lineHeight,b.style.fontFamily=a.fontFamily))}C.isShown&&A&&k.scrollIntoView(g.getBoundingClientRect());G.isFocused!==C.isFocused&&e.markAsFocussed(C.isFocused);h();H=A=u=!1}function p(b){n.parentNode.removeChild(n);r.parentNode.removeChild(r);
b()}var n,g,e,b,r,l,y=f.getDocument().getCanvas(),t=core.DomUtils,z=new gui.GuiStepUtils,w,s,x,u=!1,A=!1,H=!1,C={isFocused:!1,isShown:!0,visibility:"hidden"},G={isFocused:!C.isFocused,isShown:!C.isShown,visibility:"hidden"};this.handleUpdate=function(){H=!0;s.trigger()};this.refreshCursorBlinking=function(){u=!0;s.trigger()};this.setFocus=function(){C.isFocused=!0;s.trigger()};this.removeFocus=function(){C.isFocused=!1;s.trigger()};this.show=function(){C.isShown=!0;s.trigger()};this.hide=function(){C.isShown=
!1;s.trigger()};this.setAvatarImageUrl=function(b){e.setImageUrl(b)};this.setColor=function(b){g.style.borderColor=b;e.setColor(b)};this.getCursor=function(){return f};this.getFocusElement=function(){return g};this.toggleHandleVisibility=function(){e.isVisible()?e.hide():e.show()};this.showHandle=function(){e.show()};this.hideHandle=function(){e.hide()};this.setOverlayElement=function(a){b=a;n.appendChild(a);H=!0;s.trigger()};this.ensureVisible=function(){A=!0;s.trigger()};this.getBoundingClientRect=
function(){return t.getBoundingClientRect(n)};this.destroy=function(b){core.Async.destroyAll([s.destroy,x.destroy,e.destroy,p],b)};(function(){var b=f.getDocument(),d=[b.createRootFilter(f.getMemberId()),b.getPositionFilter()],h=b.getDOMDocument();l=h.createRange();r=h.createElement("span");r.className="webodf-caretSizer";r.textContent="|";f.getNode().appendChild(r);n=h.createElement("div");n.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",f.getMemberId());n.className="webodf-caretOverlay";
g=h.createElement("div");g.className="caret";n.appendChild(g);e=new gui.Avatar(n,a);y.getSizer().appendChild(n);w=b.createStepIterator(f.getNode(),0,d,b.getRootNode());s=core.Task.createRedrawTask(q);x=core.Task.createTimeoutTask(c,500);s.triggerImmediate()})()};odf.TextSerializer=function(){function f(d){var c="",m=k.filter?k.filter.acceptNode(d):NodeFilter.FILTER_ACCEPT,h=d.nodeType,q;if((m===NodeFilter.FILTER_ACCEPT||m===NodeFilter.FILTER_SKIP)&&a.isTextContentContainingNode(d))for(q=d.firstChild;q;)c+=f(q),q=q.nextSibling;m===NodeFilter.FILTER_ACCEPT&&(h===Node.ELEMENT_NODE&&a.isParagraph(d)?c+="\n":h===Node.TEXT_NODE&&d.textContent&&(c+=d.textContent));return c}var k=this,a=odf.OdfUtils;this.filter=null;this.writeToString=function(a){if(!a)return"";
a=f(a);"\n"===a[a.length-1]&&(a=a.substr(0,a.length-1));return a}};gui.MimeDataExporter=function(){var f;this.exportRangeToDataTransfer=function(k,a){var d;d=a.startContainer.ownerDocument.createElement("span");d.appendChild(a.cloneContents());d=f.writeToString(d);try{k.setData("text/plain",d)}catch(c){k.setData("Text",d)}};f=new odf.TextSerializer;f.filter=new odf.OdfNodeFilter};gui.Clipboard=function(f){this.setDataFromRange=function(k,a){var d,c=k.clipboardData;d=runtime.getWindow();!c&&d&&(c=d.clipboardData);c?(d=!0,f.exportRangeToDataTransfer(c,a),k.preventDefault()):d=!1;return d}};gui.SessionContext=function(f,k){var a=f.getOdtDocument(),d=odf.OdfUtils;this.isLocalCursorWithinOwnAnnotation=function(){var c=a.getCursor(k),f;if(!c)return!1;f=c&&c.getNode();c=a.getMember(k).getProperties().fullName;return(f=d.getParentAnnotation(f,a.getRootNode()))&&d.getAnnotationCreator(f)===c?!0:!1}};gui.StyleSummary=function(f){function k(a,d){var k=a+"|"+d,p;c.hasOwnProperty(k)||(p=[],f.forEach(function(c){c=(c=c.styleProperties[a])&&c[d];-1===p.indexOf(c)&&p.push(c)}),c[k]=p);return c[k]}function a(a,c,d){return function(){var f=k(a,c);return d.length>=f.length&&f.every(function(a){return-1!==d.indexOf(a)})}}function d(a,c){var d=k(a,c);return 1===d.length?d[0]:void 0}var c={};this.getPropertyValues=k;this.getCommonValue=d;this.isBold=a("style:text-properties","fo:font-weight",["bold"]);this.isItalic=
a("style:text-properties","fo:font-style",["italic"]);this.hasUnderline=a("style:text-properties","style:text-underline-style",["solid"]);this.hasStrikeThrough=a("style:text-properties","style:text-line-through-style",["solid"]);this.fontSize=function(){var a=d("style:text-properties","fo:font-size");return a&&parseFloat(a)};this.fontName=function(){return d("style:text-properties","style:font-name")};this.isAlignedLeft=a("style:paragraph-properties","fo:text-align",["left","start"]);this.isAlignedCenter=
a("style:paragraph-properties","fo:text-align",["center"]);this.isAlignedRight=a("style:paragraph-properties","fo:text-align",["right","end"]);this.isAlignedJustified=a("style:paragraph-properties","fo:text-align",["justify"]);this.text={isBold:this.isBold,isItalic:this.isItalic,hasUnderline:this.hasUnderline,hasStrikeThrough:this.hasStrikeThrough,fontSize:this.fontSize,fontName:this.fontName};this.paragraph={isAlignedLeft:this.isAlignedLeft,isAlignedCenter:this.isAlignedCenter,isAlignedRight:this.isAlignedRight,
isAlignedJustified:this.isAlignedJustified}};gui.DirectFormattingController=function(f,k,a,d,c,m,h){function q(){return V.value().styleSummary}function p(){return V.value().enabledFeatures}function n(b){var a;b.collapsed?(a=b.startContainer,a.hasChildNodes()&&b.startOffset<a.childNodes.length&&(a=a.childNodes.item(b.startOffset)),b=[a]):b=ba.getTextElements(b,!0,!1);return b}function g(){var b=v.getCursor(d),e=b&&b.getSelectedRange(),c=[],c=[],f=!0,l={directTextStyling:!0,directParagraphStyling:!0};e&&(c=n(e),0===c.length&&(c=[e.startContainer,
e.endContainer],f=!1),c=v.getFormatting().getAppliedStyles(c));void 0!==c[0]&&$&&(c[0].styleProperties=I.mergeObjects(c[0].styleProperties,$));!0===k.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)&&(l.directTextStyling=l.directParagraphStyling=a.isLocalCursorWithinOwnAnnotation());l.directTextStyling&&(l.directTextStyling=f&&void 0!==b&&b.getSelectionType()===ops.OdtCursor.RangeSelection);return{enabledFeatures:l,appliedStyles:c,styleSummary:new gui.StyleSummary(c)}}function e(b,a){var e={};Object.keys(b).forEach(function(c){var d=
b[c](),f=a[c]();d!==f&&(e[c]=f)});return e}function b(){var b,a;a=E.styleSummary;var c=V.value(),d=c.styleSummary,f=E.enabledFeatures,l=c.enabledFeatures;b=e(a.text,d.text);a=e(a.paragraph,d.paragraph);f=!(l.directTextStyling===f.directTextStyling&&l.directParagraphStyling===f.directParagraphStyling);E=c;f&&T.emit(gui.DirectFormattingController.enabledChanged,l);0<Object.keys(b).length&&T.emit(gui.DirectFormattingController.textStylingChanged,b);0<Object.keys(a).length&&T.emit(gui.DirectFormattingController.paragraphStylingChanged,
a)}function r(){V.reset();b()}function l(b){("string"===typeof b?b:b.getMemberId())===d&&V.reset()}function y(){V.reset()}function t(b){var a=v.getCursor(d);b=b.paragraphElement;a&&ba.getParagraphElement(a.getNode())===b&&V.reset()}function z(b,a){a(!b());return!0}function w(b){if(p().directTextStyling){var a=v.getCursorSelection(d),e={"style:text-properties":b};0!==a.length?(b=new ops.OpApplyDirectStyling,b.init({memberid:d,position:a.position,length:a.length,setProperties:e}),f.enqueue([b])):($=
I.mergeObjects($||{},e),V.reset())}}function s(b,a){var e={};e[b]=a;w(e)}function x(b){b=b.spec();$&&b.memberid===d&&"SplitParagraph"!==b.optype&&($=null,V.reset())}function u(b){s("fo:font-weight",b?"bold":"normal")}function A(b){s("fo:font-style",b?"italic":"normal")}function H(b){s("style:text-underline-style",b?"solid":"none")}function C(b){s("style:text-line-through-style",b?"solid":"none")}function G(b){if(p().directParagraphStyling){var a=v.getCursor(d).getSelectedRange(),a=ba.getParagraphElements(a),
e=v.getFormatting(),l=[],g={},h;a.forEach(function(a){var f=v.convertDomPointToCursorStep(a,0,N),m=a.getAttributeNS(odf.Namespaces.textns,"style-name"),k;a=m?g.hasOwnProperty(m)?g[m]:void 0:h;a||(a=c.generateStyleName(),m?(g[m]=a,k=e.createDerivedStyleObject(m,"paragraph",{})):(h=a,k={}),k=b(k),m=new ops.OpAddStyle,m.init({memberid:d,styleName:a.toString(),styleFamily:"paragraph",isAutomaticStyle:!0,setProperties:k}),l.push(m));m=new ops.OpSetParagraphStyle;m.init({memberid:d,styleName:a.toString(),
position:f});l.push(m)});f.enqueue(l)}}function B(b){G(function(a){return I.mergeObjects(a,b)})}function J(b){B({"style:paragraph-properties":{"fo:text-align":b}})}function P(b,a){var e=v.getFormatting().getDefaultTabStopDistance(),c=a["style:paragraph-properties"],d;c&&(c=c["fo:margin-left"],d=ba.parseLength(c));return I.mergeObjects(a,{"style:paragraph-properties":{"fo:margin-left":d&&d.unit===e.unit?d.value+b*e.value+d.unit:b*e.value+e.unit}})}function Q(b,a){var e=n(b),e=0===e.length?[b.startContainer]:
e,e=v.getFormatting().getAppliedStyles(e),c=0<e.length?e[0].styleProperties:void 0,d=v.getFormatting().getAppliedStylesForElement(a).styleProperties;if(!c||"text"!==c["style:family"]||!c["style:text-properties"])return!1;if(!d||!d["style:text-properties"])return!0;c=c["style:text-properties"];d=d["style:text-properties"];return!Object.keys(c).every(function(b){return c[b]===d[b]})}function D(){}function Z(){return!1}var S=this,v=f.getOdtDocument(),I=new core.Utils,ba=odf.OdfUtils,T=new core.EventNotifier([gui.DirectFormattingController.enabledChanged,
gui.DirectFormattingController.textStylingChanged,gui.DirectFormattingController.paragraphStylingChanged]),F=odf.Namespaces.textns,N=core.StepDirection.NEXT,$=null,E,V;this.enabledFeatures=p;this.formatTextSelection=w;this.createCursorStyleOp=function(b,a,e){var c=null,f=$;e&&(f=(e=V.value().appliedStyles[0])&&e.styleProperties);f&&f["style:text-properties"]&&(c=new ops.OpApplyDirectStyling,c.init({memberid:d,position:b,length:a,setProperties:{"style:text-properties":f["style:text-properties"]}}),
$=null,V.reset());return c};this.setBold=u;this.setItalic=A;this.setHasUnderline=H;this.setHasStrikethrough=C;this.setFontSize=function(b){s("fo:font-size",b+"pt")};this.setFontName=function(b){s("style:font-name",b)};this.getAppliedStyles=function(){return V.value().appliedStyles};this.toggleBold=z.bind(S,function(){return q().isBold()},u);this.toggleItalic=z.bind(S,function(){return q().isItalic()},A);this.toggleUnderline=z.bind(S,function(){return q().hasUnderline()},H);this.toggleStrikethrough=
z.bind(S,function(){return q().hasStrikeThrough()},C);this.isBold=function(){return q().isBold()};this.isItalic=function(){return q().isItalic()};this.hasUnderline=function(){return q().hasUnderline()};this.hasStrikeThrough=function(){return q().hasStrikeThrough()};this.fontSize=function(){return q().fontSize()};this.fontName=function(){return q().fontName()};this.isAlignedLeft=function(){return q().isAlignedLeft()};this.isAlignedCenter=function(){return q().isAlignedCenter()};this.isAlignedRight=
function(){return q().isAlignedRight()};this.isAlignedJustified=function(){return q().isAlignedJustified()};this.alignParagraphLeft=function(){J("left");return!0};this.alignParagraphCenter=function(){J("center");return!0};this.alignParagraphRight=function(){J("right");return!0};this.alignParagraphJustified=function(){J("justify");return!0};this.indent=function(){G(P.bind(null,1));return!0};this.outdent=function(){G(P.bind(null,-1));return!0};this.createParagraphStyleOps=function(b){if(!p().directParagraphStyling)return[];
var a=v.getCursor(d),e=a.getSelectedRange(),f=[],l,g;a.hasForwardSelection()?(l=a.getAnchorNode(),g=a.getNode()):(l=a.getNode(),g=a.getAnchorNode());a=ba.getParagraphElement(g);runtime.assert(Boolean(a),"DirectFormattingController: Cursor outside paragraph");var h=a,m=[v.getPositionFilter(),v.createRootFilter(d)];if(!1!==v.createStepIterator(e.endContainer,e.endOffset,m,h).nextStep())return f;g!==l&&(a=ba.getParagraphElement(l));if(!$&&!Q(e,a))return f;e=(e=V.value().appliedStyles[0])&&e.styleProperties;
if(!e)return f;if(a=a.getAttributeNS(F,"style-name"))e={"style:text-properties":e["style:text-properties"]},e=v.getFormatting().createDerivedStyleObject(a,"paragraph",e);l=c.generateStyleName();a=new ops.OpAddStyle;a.init({memberid:d,styleName:l,styleFamily:"paragraph",isAutomaticStyle:!0,setProperties:e});f.push(a);a=new ops.OpSetParagraphStyle;a.init({memberid:d,styleName:l,position:b});f.push(a);return f};this.subscribe=function(b,a){T.subscribe(b,a)};this.unsubscribe=function(b,a){T.unsubscribe(b,
a)};this.destroy=function(a){v.unsubscribe(ops.Document.signalCursorAdded,l);v.unsubscribe(ops.Document.signalCursorRemoved,l);v.unsubscribe(ops.Document.signalCursorMoved,l);v.unsubscribe(ops.OdtDocument.signalParagraphStyleModified,y);v.unsubscribe(ops.OdtDocument.signalParagraphChanged,t);v.unsubscribe(ops.OdtDocument.signalOperationEnd,x);v.unsubscribe(ops.OdtDocument.signalProcessingBatchEnd,b);k.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,r);a()};(function(){v.subscribe(ops.Document.signalCursorAdded,
l);v.subscribe(ops.Document.signalCursorRemoved,l);v.subscribe(ops.Document.signalCursorMoved,l);v.subscribe(ops.OdtDocument.signalParagraphStyleModified,y);v.subscribe(ops.OdtDocument.signalParagraphChanged,t);v.subscribe(ops.OdtDocument.signalOperationEnd,x);v.subscribe(ops.OdtDocument.signalProcessingBatchEnd,b);k.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,r);V=new core.LazyProperty(g);E=V.value();m||(S.formatTextSelection=D,S.setBold=D,S.setItalic=D,S.setHasUnderline=D,S.setHasStrikethrough=
D,S.setFontSize=D,S.setFontName=D,S.toggleBold=Z,S.toggleItalic=Z,S.toggleUnderline=Z,S.toggleStrikethrough=Z);h||(S.alignParagraphCenter=D,S.alignParagraphJustified=D,S.alignParagraphLeft=D,S.alignParagraphRight=D,S.createParagraphStyleOps=function(){return[]},S.indent=D,S.outdent=D)})()};gui.DirectFormattingController.enabledChanged="enabled/changed";gui.DirectFormattingController.textStylingChanged="textStyling/changed";gui.DirectFormattingController.paragraphStylingChanged="paragraphStyling/changed";
gui.DirectFormattingController.SelectionInfo=function(){};gui.KeyboardHandler=function(){function f(a,d){d||(d=k.None);switch(a){case gui.KeyboardHandler.KeyCode.LeftMeta:case gui.KeyboardHandler.KeyCode.RightMeta:case gui.KeyboardHandler.KeyCode.MetaInMozilla:d|=k.Meta;break;case gui.KeyboardHandler.KeyCode.Ctrl:d|=k.Ctrl;break;case gui.KeyboardHandler.KeyCode.Alt:d|=k.Alt;break;case gui.KeyboardHandler.KeyCode.Shift:d|=k.Shift}return a+":"+d}var k=gui.KeyboardHandler.Modifier,a=null,d={};this.setDefault=function(c){a=c};this.bind=function(a,m,h,k){a=f(a,
m);runtime.assert(k||!1===d.hasOwnProperty(a),"tried to overwrite the callback handler of key combo: "+a);d[a]=h};this.unbind=function(a,m){var h=f(a,m);delete d[h]};this.reset=function(){a=null;d={}};this.handleEvent=function(c){var m=c.keyCode,h=k.None;c.metaKey&&(h|=k.Meta);c.ctrlKey&&(h|=k.Ctrl);c.altKey&&(h|=k.Alt);c.shiftKey&&(h|=k.Shift);m=f(m,h);m=d[m];h=!1;m?h=m():null!==a&&(h=a(c));h&&(c.preventDefault?c.preventDefault():c.returnValue=!1)}};
gui.KeyboardHandler.Modifier={None:0,Meta:1,Ctrl:2,Alt:4,CtrlAlt:6,Shift:8,MetaShift:9,CtrlShift:10,AltShift:12};gui.KeyboardHandler.KeyCode={Backspace:8,Tab:9,Clear:12,Enter:13,Shift:16,Ctrl:17,Alt:18,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,Delete:46,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,LeftMeta:91,RightMeta:93,MetaInMozilla:224};gui.HyperlinkClickHandler=function(f,k,a){function d(){var b=f();runtime.assert(Boolean(b.classList),"Document container has no classList element");b.classList.remove("webodf-inactiveLinks")}function c(){var b=f();runtime.assert(Boolean(b.classList),"Document container has no classList element");b.classList.add("webodf-inactiveLinks")}function m(){e.removeEventListener("focus",c,!1);r.forEach(function(b){k.unbind(b.keyCode,b.modifier);a.unbind(b.keyCode,b.modifier)});r.length=0}function h(b){m();
if(b!==q.None){e.addEventListener("focus",c,!1);switch(b){case q.Ctrl:r.push({keyCode:p.Ctrl,modifier:q.None});break;case q.Meta:r.push({keyCode:p.LeftMeta,modifier:q.None}),r.push({keyCode:p.RightMeta,modifier:q.None}),r.push({keyCode:p.MetaInMozilla,modifier:q.None})}r.forEach(function(b){k.bind(b.keyCode,b.modifier,d);a.bind(b.keyCode,b.modifier,c)})}}var q=gui.KeyboardHandler.Modifier,p=gui.KeyboardHandler.KeyCode,n=xmldom.XPath,g=odf.OdfUtils,e=runtime.getWindow(),b=q.None,r=[];runtime.assert(null!==
e,"Expected to be run in an environment which has a global window, like a browser.");this.handleClick=function(a){var c=a.target||a.srcElement,d,h;a.ctrlKey?d=q.Ctrl:a.metaKey&&(d=q.Meta);if(b===q.None||b===d){a:{for(;null!==c;){if(g.isHyperlink(c))break a;if(g.isParagraph(c))break;c=c.parentNode}c=null}c&&(c=g.getHyperlinkTarget(c),""!==c&&("#"===c[0]?(c=c.substring(1),d=f(),h=n.getODFElementsWithXPath(d,"//text:bookmark-start[@text:name='"+c+"']",odf.Namespaces.lookupNamespaceURI),0===h.length&&
(h=n.getODFElementsWithXPath(d,"//text:bookmark[@text:name='"+c+"']",odf.Namespaces.lookupNamespaceURI)),0<h.length&&h[0].scrollIntoView(!0)):/^\s*(javascript|data):/.test(c)?runtime.log("WARN:","potentially malicious URL ignored"):e.open(c),a.preventDefault?a.preventDefault():a.returnValue=!1))}};this.setModifier=function(a){b!==a&&(runtime.assert(a===q.None||a===q.Ctrl||a===q.Meta,"Unsupported KeyboardHandler.Modifier value: "+a),b=a,b!==q.None?c():d(),h(b))};this.getModifier=function(){return b};
this.destroy=function(b){c();m();b()}};gui.EventManager=function(f){function k(b){function a(b,e,c){var d,f=!1;d="on"+e;b.attachEvent&&(b.attachEvent(d,c),f=!0);!f&&b.addEventListener&&(b.addEventListener(e,c,!1),f=!0);f&&!x[e]||!b.hasOwnProperty(d)||(b[d]=c)}function e(b,a,c){var d="on"+a;b.detachEvent&&b.detachEvent(d,c);b.removeEventListener&&b.removeEventListener(a,c,!1);b[d]===c&&(b[d]=null)}function c(a){if(-1===f.indexOf(a)){f.push(a);if(d.filters.every(function(b){return b(a)}))try{g.emit(b,a)}catch(e){runtime.log("Error occurred while processing "+
b+":\n"+e.message+"\n"+e.stack)}runtime.setTimeout(function(){f.splice(f.indexOf(a),1)},0)}}var d=this,f=[],g=new core.EventNotifier([b]);this.filters=[];this.subscribe=function(a){g.subscribe(b,a)};this.unsubscribe=function(a){g.unsubscribe(b,a)};this.destroy=function(){e(s,b,c);e(C,b,c);e(G,b,c)};u[b]&&a(s,b,c);a(C,b,c);a(G,b,c)}function a(b,a,e){function c(a){e(a,d,function(a){a.type=b;f.emit(b,a)})}var d={},f=new core.EventNotifier([b]);this.subscribe=function(a){f.subscribe(b,a)};this.unsubscribe=
function(a){f.unsubscribe(b,a)};this.destroy=function(){a.forEach(function(b){B.unsubscribe(b,c)})};(function(){a.forEach(function(b){B.subscribe(b,c)})})()}function d(b){runtime.clearTimeout(b);delete J[b]}function c(b,a){var e=runtime.setTimeout(function(){b();d(e)},a);J[e]=!0;return e}function m(b,a,e){var f=b.touches.length,g=b.touches[0],l=a.timer;"touchmove"===b.type||"touchend"===b.type?l&&d(l):"touchstart"===b.type&&(1!==f?runtime.clearTimeout(l):l=c(function(){e({clientX:g.clientX,clientY:g.clientY,
pageX:g.pageX,pageY:g.pageY,target:b.target||b.srcElement||null,detail:1})},400));a.timer=l}function h(b,a,e){var c=b.touches[0],d=b.target||b.srcElement||null,f=a.target;1!==b.touches.length||"touchend"===b.type?f=null:"touchstart"===b.type&&"webodf-draggable"===d.getAttribute("class")?f=d:"touchmove"===b.type&&f&&(b.preventDefault(),b.stopPropagation(),e({clientX:c.clientX,clientY:c.clientY,pageX:c.pageX,pageY:c.pageY,target:f,detail:1}));a.target=f}function q(b,a,e){var c=b.target||b.srcElement||
null,d=a.dragging;"drag"===b.type?d=!0:"touchend"===b.type&&d&&(d=!1,b=b.changedTouches[0],e({clientX:b.clientX,clientY:b.clientY,pageX:b.pageX,pageY:b.pageY,target:c,detail:1}));a.dragging=d}function p(){G.classList.add("webodf-touchEnabled");B.unsubscribe("touchstart",p)}function n(b){var a=b.scrollX,e=b.scrollY;this.restore=function(){b.scrollX===a&&b.scrollY===e||b.scrollTo(a,e)}}function g(b){var a=b.scrollTop,e=b.scrollLeft;this.restore=function(){if(b.scrollTop!==a||b.scrollLeft!==e)b.scrollTop=
a,b.scrollLeft=e}}function e(b,a){var e=H[b]||A[b]||null;!e&&a&&(e=H[b]=new k(b));return e}function b(b,a){e(b,!0).subscribe(a)}function r(b,a){var c=e(b,!1);c&&c.unsubscribe(a)}function l(){return f.getDOMDocument().activeElement===C}function y(){l()&&C.blur();C.setAttribute("disabled","true")}function t(){C.removeAttribute("disabled")}function z(b){for(var a=[];b;)(b.scrollWidth>b.clientWidth||b.scrollHeight>b.clientHeight)&&a.push(new g(b)),b=b.parentNode;a.push(new n(s));return a}function w(){var b;
l()||(b=z(C),t(),C.focus(),b.forEach(function(b){b.restore()}))}var s=runtime.getWindow(),x={beforecut:!0,beforepaste:!0,longpress:!0,drag:!0,dragstop:!0},u={mousedown:!0,mouseup:!0,focus:!0},A={},H={},C,G=f.getCanvas().getElement(),B=this,J={};this.addFilter=function(b,a){e(b,!0).filters.push(a)};this.removeFilter=function(b,a){var c=e(b,!0),d=c.filters.indexOf(a);-1!==d&&c.filters.splice(d,1)};this.subscribe=b;this.unsubscribe=r;this.hasFocus=l;this.focus=w;this.getEventTrap=function(){return C};
this.setEditing=function(b){var a=l();a&&C.blur();b?C.removeAttribute("readOnly"):C.setAttribute("readOnly","true");a&&w()};this.destroy=function(b){r("touchstart",p);Object.keys(J).forEach(function(b){d(parseInt(b,10))});J.length=0;Object.keys(A).forEach(function(b){A[b].destroy()});A={};r("mousedown",y);r("mouseup",t);r("contextmenu",t);Object.keys(H).forEach(function(b){H[b].destroy()});H={};C.parentNode.removeChild(C);b()};(function(){var e=f.getOdfCanvas().getSizer(),c=e.ownerDocument;runtime.assert(Boolean(s),
"EventManager requires a window object to operate correctly");C=c.createElement("textarea");C.id="eventTrap";C.setAttribute("tabindex","-1");C.setAttribute("readOnly","true");C.setAttribute("rows","1");e.appendChild(C);b("mousedown",y);b("mouseup",t);b("contextmenu",t);A.longpress=new a("longpress",["touchstart","touchmove","touchend"],m);A.drag=new a("drag",["touchstart","touchmove","touchend"],h);A.dragstop=new a("dragstop",["drag","touchend"],q);b("touchstart",p)})()};gui.IOSSafariSupport=function(f){function k(){a.innerHeight!==a.outerHeight&&(d.style.display="none",runtime.requestAnimationFrame(function(){d.style.display="block"}))}var a=runtime.getWindow(),d=f.getEventTrap();this.destroy=function(a){f.unsubscribe("focus",k);d.removeAttribute("autocapitalize");d.style.WebkitTransform="";a()};f.subscribe("focus",k);d.setAttribute("autocapitalize","off");d.style.WebkitTransform="translateX(-10000px)"};gui.HyperlinkController=function(f,k,a,d){function c(){var c=!0;!0===k.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)&&(c=a.isLocalCursorWithinOwnAnnotation());c!==n&&(n=c,p.emit(gui.HyperlinkController.enabledChanged,n))}function m(a){a.getMemberId()===d&&c()}var h=odf.OdfUtils,q=f.getOdtDocument(),p=new core.EventNotifier([gui.HyperlinkController.enabledChanged]),n=!1;this.isEnabled=function(){return n};this.subscribe=function(a,e){p.subscribe(a,e)};this.unsubscribe=function(a,e){p.unsubscribe(a,
e)};this.addHyperlink=function(a,e){if(n){var b=q.getCursorSelection(d),c=new ops.OpApplyHyperlink,l=[];if(0===b.length||e)e=e||a,c=new ops.OpInsertText,c.init({memberid:d,position:b.position,text:e}),b.length=e.length,l.push(c);c=new ops.OpApplyHyperlink;c.init({memberid:d,position:b.position,length:b.length,hyperlink:a});l.push(c);f.enqueue(l)}};this.removeHyperlinks=function(){if(n){var a=q.createPositionIterator(q.getRootNode()),e=q.getCursor(d).getSelectedRange(),b=h.getHyperlinkElements(e),
c=e.collapsed&&1===b.length,l=q.getDOMDocument().createRange(),m=[],k,p;0!==b.length&&(b.forEach(function(b){l.selectNodeContents(b);k=q.convertDomToCursorRange({anchorNode:l.startContainer,anchorOffset:l.startOffset,focusNode:l.endContainer,focusOffset:l.endOffset});p=new ops.OpRemoveHyperlink;p.init({memberid:d,position:k.position,length:k.length});m.push(p)}),c||(c=b[0],-1===e.comparePoint(c,0)&&(l.setStart(c,0),l.setEnd(e.startContainer,e.startOffset),k=q.convertDomToCursorRange({anchorNode:l.startContainer,
anchorOffset:l.startOffset,focusNode:l.endContainer,focusOffset:l.endOffset}),0<k.length&&(p=new ops.OpApplyHyperlink,p.init({memberid:d,position:k.position,length:k.length,hyperlink:h.getHyperlinkTarget(c)}),m.push(p))),b=b[b.length-1],a.moveToEndOfNode(b),a=a.unfilteredDomOffset(),1===e.comparePoint(b,a)&&(l.setStart(e.endContainer,e.endOffset),l.setEnd(b,a),k=q.convertDomToCursorRange({anchorNode:l.startContainer,anchorOffset:l.startOffset,focusNode:l.endContainer,focusOffset:l.endOffset}),0<k.length&&
(p=new ops.OpApplyHyperlink,p.init({memberid:d,position:k.position,length:k.length,hyperlink:h.getHyperlinkTarget(b)}),m.push(p)))),f.enqueue(m),l.detach())}};this.destroy=function(a){q.unsubscribe(ops.Document.signalCursorMoved,m);k.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,c);a()};q.subscribe(ops.Document.signalCursorMoved,m);k.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,c);c()};gui.HyperlinkController.enabledChanged="enabled/changed";gui.ListController=function(f,k,a,d,c){function m(){var e=!0;!0===a.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)&&(e=d.isLocalCursorWithinOwnAnnotation());e!==g&&(g=e,n.emit(gui.ListController.enabledChanged,g))}function h(a){a.getMemberId()===c&&m()}var q=odf.OdfUtils,p=f.getOdtDocument(),n=new core.EventNotifier([gui.ListController.enabledChanged]),g=!1;gui.ListController.session=f;gui.ListController.memberid=c;this.isEnabled=function(){return g};this.subscribe=function(a,b){n.subscribe(a,b)};
this.unsubscribe=function(a,b){n.unsubscribe(a,b)};this.addList=function(a){if(g){var b=p.getCursorSelection(c),d=p.getCursor(c);q.getParagraphElement(d.getNode()).getAttributeNS(odf.Namespaces.textns,"style-name");var d=[],l=new ops.OpCreateList;l.init({memberid:c,length:b.length,position:b.position,listType:a});d.push(l);f.enqueue(d);k.focus()}};this.removeList=function(){};this.destroy=function(e){p.unsubscribe(ops.Document.signalCursorMoved,h);a.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,
m);e()};p.subscribe(ops.Document.signalCursorMoved,h);a.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,m);m()};gui.ListController.enabledChanged="enabled/changed";
gui.ListController.getStyles=function(f){f=(new odf.StyleTree(f.getOdfCanvas().odfContainer().rootElement.styles,f.getOdfCanvas().odfContainer().rootElement.automaticStyles)).getStyleTree().list;var k={},a=0,d;for(d in f){var a=Number(d.substr(1)),c=f[d].element.firstChild.nodeName,c=c.substr(c.lastIndexOf("-")+1);if(!k[c]||k[c]<a)k[c]=a}k.currentNumber=a;return k};
gui.ListController.setDefaultStyle=function(f,k){var a=f.getDOMDocument(),d,c;void 0===k&&(k="localuser");c=gui.ListController.getStyles(f);if(!c.bullet){d="L"+String(Number(c.currentNumber)+1);var m=a.createElementNS(odf.Namespaces.textns,"text:list-style");m.setAttributeNS(odf.Namespaces.stylens,"style:name",d);var h=a.createElementNS(odf.Namespaces.textns,"text:list-level-style-bullet");h.setAttributeNS(odf.Namespaces.textns,"text:bullet-char","\u2022");h.setAttributeNS(odf.Namespaces.textns,"text:level",
"1");h.setAttributeNS(odf.Namespaces.textns,"text:style-name","Bullet_20_Symbols");m.appendChild(h);var q=a.createElementNS(odf.Namespaces.stylens,"style:list-level-properties");q.setAttributeNS(odf.Namespaces.textns,"text:list-level-position-and-space-mode","label-alignment");h.appendChild(q);h=a.createElementNS(odf.Namespaces.stylens,"style:list-level-label-alignment");h.setAttributeNS(odf.Namespaces.fons,"fo:margin-left","1.27cm");h.setAttributeNS(odf.Namespaces.fons,"fo:text-indent","-0.635cm");
h.setAttributeNS(odf.Namespaces.textns,"text:label-followed-by","listtab");h.setAttributeNS(odf.Namespaces.textns,"text:list-tab-stop-position","1.27cm");q.appendChild(h);f.getOdfCanvas().odfContainer().rootElement.automaticStyles.appendChild(m);gui.ListController.session&&(m={},m["style:list-style-name"]=d,m["style:list-parent-name"]="Standard",d=new ops.OpAddStyle,d.init({memberid:k,styleName:"P1",styleFamily:"paragraph",isAutomaticStyle:!0,setProperties:m}),gui.ListController.session.enqueue([d]));
c.currentNumber=Number(c.currentNumber)+1}c.number||(d="L"+String(Number(c.currentNumber)+1),m=a.createElementNS(odf.Namespaces.textns,"text:list-style"),m.setAttributeNS(odf.Namespaces.stylens,"style:name",d),h=a.createElementNS(odf.Namespaces.textns,"text:list-level-style-number"),h.setAttributeNS(odf.Namespaces.stylens,"style:num-format","1"),h.setAttributeNS(odf.Namespaces.stylens,"style:num-suffix","."),h.setAttributeNS(odf.Namespaces.textns,"text:level","1"),h.setAttributeNS(odf.Namespaces.textns,
"text:style-name","Numbering_20_Symbols"),m.appendChild(h),q=a.createElementNS(odf.Namespaces.stylens,"style:list-level-properties"),q.setAttributeNS(odf.Namespaces.textns,"text:list-level-position-and-space-mode","label-alignment"),h.appendChild(q),h=a.createElementNS(odf.Namespaces.stylens,"style:list-level-label-alignment"),h.setAttributeNS(odf.Namespaces.fons,"fo:margin-left","1.27cm"),h.setAttributeNS(odf.Namespaces.fons,"fo:text-indent","-0.635cm"),h.setAttributeNS(odf.Namespaces.textns,"text:label-followed-by",
"listtab"),h.setAttributeNS(odf.Namespaces.textns,"text:list-tab-stop-position","1.27cm"),q.appendChild(h),f.getOdfCanvas().odfContainer().rootElement.automaticStyles.appendChild(m),gui.ListController.session&&(m={},m["style:list-style-name"]=d,m["style:list-parent-name"]="Standard",d=new ops.OpAddStyle,d.init({memberid:k,styleName:"P1",styleFamily:"paragraph",isAutomaticStyle:!0,setProperties:m}),gui.ListController.session.enqueue([d])));gui.ListController.getStyles(f)};gui.ImageController=function(f,k,a,d,c){function m(){var e=!0;!0===k.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)&&(e=a.isLocalCursorWithinOwnAnnotation());e!==r&&(r=e,b.emit(gui.ImageController.enabledChanged,r))}function h(b){b.getMemberId()===d&&m()}var q={"image/gif":".gif","image/jpeg":".jpg","image/png":".png"},p=odf.Namespaces.textns,n=f.getOdtDocument(),g=odf.OdfUtils,e=n.getFormatting(),b=new core.EventNotifier([gui.HyperlinkController.enabledChanged]),r=!1;this.isEnabled=function(){return r};
this.subscribe=function(a,e){b.subscribe(a,e)};this.unsubscribe=function(a,e){b.unsubscribe(a,e)};this.insertImage=function(b,a,h,m){if(r){runtime.assert(0<h&&0<m,"Both width and height of the image should be greater than 0px.");m={width:h,height:m};if(h=g.getParagraphElement(n.getCursor(d).getNode()).getAttributeNS(p,"style-name")){h=e.getContentSize(h,"paragraph");var k=1,s=1;m.width>h.width&&(k=h.width/m.width);m.height>h.height&&(s=h.height/m.height);h=Math.min(k,s);m={width:m.width*h,height:m.height*
h}}h=m.width/37.8+"cm";m=m.height/37.8+"cm";var x=n.getOdfCanvas().odfContainer().rootElement.styles,k=b.toLowerCase(),s=q.hasOwnProperty(k)?q[k]:null,u,k=[];runtime.assert(null!==s,"Image type is not supported: "+b);s="Pictures/"+c.generateImageName()+s;u=new ops.OpSetBlob;u.init({memberid:d,filename:s,mimetype:b,content:a});k.push(u);e.getStyleElement("Graphics","graphic",[x])||(b=new ops.OpAddStyle,b.init({memberid:d,styleName:"Graphics",styleFamily:"graphic",isAutomaticStyle:!1,setProperties:{"style:graphic-properties":{"text:anchor-type":"paragraph",
"svg:x":"0cm","svg:y":"0cm","style:wrap":"dynamic","style:number-wrapped-paragraphs":"no-limit","style:wrap-contour":"false","style:vertical-pos":"top","style:vertical-rel":"paragraph","style:horizontal-pos":"center","style:horizontal-rel":"paragraph"}}}),k.push(b));b=c.generateStyleName();a=new ops.OpAddStyle;a.init({memberid:d,styleName:b,styleFamily:"graphic",isAutomaticStyle:!0,setProperties:{"style:parent-style-name":"Graphics","style:graphic-properties":{"style:vertical-pos":"top","style:vertical-rel":"baseline",
"style:horizontal-pos":"center","style:horizontal-rel":"paragraph","fo:background-color":"transparent","style:background-transparency":"100%","style:shadow":"none","style:mirror":"none","fo:clip":"rect(0cm, 0cm, 0cm, 0cm)","draw:luminance":"0%","draw:contrast":"0%","draw:red":"0%","draw:green":"0%","draw:blue":"0%","draw:gamma":"100%","draw:color-inversion":"false","draw:image-opacity":"100%","draw:color-mode":"standard"}}});k.push(a);u=new ops.OpInsertImage;u.init({memberid:d,position:n.getCursorPosition(d),
filename:s,frameWidth:h,frameHeight:m,frameStyleName:b,frameName:c.generateFrameName()});k.push(u);f.enqueue(k)}};this.destroy=function(b){n.unsubscribe(ops.Document.signalCursorMoved,h);k.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,m);b()};n.subscribe(ops.Document.signalCursorMoved,h);k.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,m);m()};gui.ImageController.enabledChanged="enabled/changed";gui.ImageSelector=function(f){function k(){var a=f.getSizer(),m=c.createElement("div");m.id="imageSelector";m.style.borderWidth="1px";a.appendChild(m);d.forEach(function(a){var d=c.createElement("div");d.className=a;m.appendChild(d)});return m}var a=odf.Namespaces.svgns,d="topLeft topRight bottomRight bottomLeft topMiddle rightMiddle bottomMiddle leftMiddle".split(" "),c=f.getElement().ownerDocument,m=!1;this.select=function(d){var q,p,n=c.getElementById("imageSelector");n||(n=k());m=!0;q=n.parentNode;
p=d.getBoundingClientRect();var g=q.getBoundingClientRect(),e=f.getZoomLevel();q=(p.left-g.left)/e-1;p=(p.top-g.top)/e-1;n.style.display="block";n.style.left=q+"px";n.style.top=p+"px";n.style.width=d.getAttributeNS(a,"width");n.style.height=d.getAttributeNS(a,"height")};this.clearSelection=function(){var a;m&&(a=c.getElementById("imageSelector"))&&(a.style.display="none");m=!1};this.isSelectorElement=function(a){var d=c.getElementById("imageSelector");return d?a===d||a.parentNode===d:!1}};(function(){function f(f){function a(a){h=a.which&&String.fromCharCode(a.which)===m;m=void 0;return!1===h}function d(){h=!1}function c(a){m=a.data;h=!1}var m,h=!1;this.destroy=function(h){f.unsubscribe("textInput",d);f.unsubscribe("compositionend",c);f.removeFilter("keypress",a);h()};f.subscribe("textInput",d);f.subscribe("compositionend",c);f.addFilter("keypress",a)}gui.InputMethodEditor=function(k,a){function d(a){b&&(a?b.getNode().setAttributeNS(e,"composing","true"):(b.getNode().removeAttributeNS(e,
"composing"),y.textContent=""))}function c(){z&&(z=!1,d(!1),s.emit(gui.InputMethodEditor.signalCompositionEnd,{data:w}),w="")}function m(){C||(C=!0,c(),b&&b.getSelectedRange().collapsed?r.value="":r.value=u.writeToString(b.getSelectedRange().cloneContents()),r.setSelectionRange(0,r.value.length),C=!1)}function h(){a.hasFocus()&&t.trigger()}function q(){x=void 0;t.cancel();d(!0);z||s.emit(gui.InputMethodEditor.signalCompositionStart,{data:""})}function p(b){b=x=b.data;z=!0;w+=b;t.trigger()}function n(b){b.data!==
x&&(b=b.data,z=!0,w+=b,t.trigger());x=void 0}function g(){y.textContent=r.value}var e="urn:webodf:names:cursor",b=null,r=a.getEventTrap(),l=r.ownerDocument,y,t,z=!1,w="",s=new core.EventNotifier([gui.InputMethodEditor.signalCompositionStart,gui.InputMethodEditor.signalCompositionEnd]),x,u,A=[],H,C=!1;this.subscribe=s.subscribe;this.unsubscribe=s.unsubscribe;this.registerCursor=function(e){e.getMemberId()===k&&(b=e,b.getNode().appendChild(y),e.subscribe(ops.OdtCursor.signalCursorUpdated,h),a.subscribe("input",
g),a.subscribe("compositionupdate",g))};this.removeCursor=function(e){b&&e===k&&(b.getNode().removeChild(y),b.unsubscribe(ops.OdtCursor.signalCursorUpdated,h),a.unsubscribe("input",g),a.unsubscribe("compositionupdate",g),b=null)};this.destroy=function(b){a.unsubscribe("compositionstart",q);a.unsubscribe("compositionend",p);a.unsubscribe("textInput",n);a.unsubscribe("keypress",c);a.unsubscribe("focus",m);core.Async.destroyAll(H,b)};(function(){u=new odf.TextSerializer;u.filter=new odf.OdfNodeFilter;
a.subscribe("compositionstart",q);a.subscribe("compositionend",p);a.subscribe("textInput",n);a.subscribe("keypress",c);a.subscribe("focus",m);A.push(new f(a));H=A.map(function(b){return b.destroy});y=l.createElement("span");y.setAttribute("id","composer");t=core.Task.createTimeoutTask(m,1);H.push(t.destroy)})()};gui.InputMethodEditor.signalCompositionStart="input/compositionstart";gui.InputMethodEditor.signalCompositionEnd="input/compositionend"})();gui.MetadataController=function(f,k){function a(a){m.emit(gui.MetadataController.signalMetadataChanged,a)}function d(a){var c=-1===h.indexOf(a);c||runtime.log("Setting "+a+" is restricted.");return c}var c=f.getOdtDocument(),m=new core.EventNotifier([gui.MetadataController.signalMetadataChanged]),h=["dc:creator","dc:date","meta:editing-cycles","meta:editing-duration","meta:document-statistic"];this.setMetadata=function(a,c){var h={},g="",e;a&&Object.keys(a).filter(d).forEach(function(b){h[b]=a[b]});
c&&(g=c.filter(d).join(","));if(0<g.length||0<Object.keys(h).length)e=new ops.OpUpdateMetadata,e.init({memberid:k,setProperties:h,removedProperties:0<g.length?{attributes:g}:null}),f.enqueue([e])};this.getMetadata=function(a){var d;runtime.assert("string"===typeof a,"Property must be a string");d=a.split(":");runtime.assert(2===d.length,"Property must be a namespace-prefixed string");a=odf.Namespaces.lookupNamespaceURI(d[0]);runtime.assert(Boolean(a),"Prefix must be for an ODF namespace.");return c.getOdfCanvas().odfContainer().getMetadata(a,
d[1])};this.subscribe=function(a,c){m.subscribe(a,c)};this.unsubscribe=function(a,c){m.unsubscribe(a,c)};this.destroy=function(d){c.unsubscribe(ops.OdtDocument.signalMetadataUpdated,a);d()};c.subscribe(ops.OdtDocument.signalMetadataUpdated,a)};gui.MetadataController.signalMetadataChanged="metadata/changed";gui.PasteController=function(f,k,a,d){function c(){q=!0===k.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)?a.isLocalCursorWithinOwnAnnotation():!0}function m(a){a.getMemberId()===d&&c()}var h=f.getOdtDocument(),q=!1,p=odf.Namespaces.textns,n=core.StepDirection.NEXT,g=odf.OdfUtils;this.isEnabled=function(){return q};this.paste=function(a){if(q){var b=h.getCursorPosition(d),c=h.getCursor(d).getNode(),c=g.getParagraphElement(c),l=c.getAttributeNS(p,"style-name")||"",m=b,k=[],z=h.convertDomPointToCursorStep(c,
0,n);a.replace(/\r/g,"").split("\n").forEach(function(b){var a=new ops.OpInsertText,e=new ops.OpSplitParagraph;a.init({memberid:d,position:m,text:b,moveCursor:!0});k.push(a);m+=b.length;e.init({memberid:d,position:m,paragraphStyleName:l,sourceParagraphPosition:z,moveCursor:!0});k.push(e);z=m+=1});k.pop();f.enqueue(k)}};this.destroy=function(a){h.unsubscribe(ops.Document.signalCursorMoved,m);k.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,c);a()};h.subscribe(ops.Document.signalCursorMoved,m);
k.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,c);c()};gui.ClosestXOffsetScanner=function(f){function k(a){return null!==a&&void 0!==c?Math.abs(a-f)>c:!1}function a(a){null!==a&&!1===k(a)&&(c=Math.abs(a-f))}var d=this,c,m=gui.StepInfo.VisualDirection.LEFT_TO_RIGHT;this.token=void 0;this.process=function(c,f,p){var n,g;c.visualDirection===m?(n=f&&f.right,g=p&&p.left):(n=f&&f.left,g=p&&p.right);if(k(n)||k(g))return!0;if(f||p)a(n),a(g),d.token=c.token;return!1}};gui.LineBoundaryScanner=function(){var f=this,k=null;this.token=void 0;this.process=function(a,d,c){var m;if(m=c)if(k){var h=k;m=Math.min(h.bottom-h.top,c.bottom-c.top);var q=Math.max(h.top,c.top),h=Math.min(h.bottom,c.bottom)-q;m=0.4>=(0<m?h/m:0)}else m=!1;!d||c&&!m||(f.token=a.token);if(m)return!0;k=(a=k)&&d?{left:Math.min(a.left,d.left),right:Math.max(a.right,d.right),top:Math.min(a.top,d.top),bottom:Math.min(a.bottom,d.bottom)}:a||d;return!1}};gui.ParagraphBoundaryScanner=function(){var f=this,k=!1,a,d=odf.OdfUtils;this.token=void 0;this.process=function(c){var m=d.getParagraphElement(c.container());k||(a=m,k=!0);if(a!==m)return!0;f.token=c.token;return!1}};odf.WordBoundaryFilter=function(f,k){function a(b,a,e){for(var c=null,d=f.getRootNode(),g;b!==d&&null!==b&&null===c;)g=0>a?b.previousSibling:b.nextSibling,e(g)===NodeFilter.FILTER_ACCEPT&&(c=g),b=b.parentNode;return c}function d(b,a){var e;return null===b?r.NO_NEIGHBOUR:h.isCharacterElement(b)?r.SPACE_CHAR:b.nodeType===c||h.isTextSpan(b)||h.isHyperlink(b)?(e=b.textContent.charAt(a()),p.test(e)?r.SPACE_CHAR:q.test(e)?r.PUNCTUATION_CHAR:r.WORD_CHAR):r.OTHER}var c=Node.TEXT_NODE,m=Node.ELEMENT_NODE,
h=odf.OdfUtils,q=/[!-#%-*,-\/:-;?-@\[-\]_{}\u00a1\u00ab\u00b7\u00bb\u00bf;\u00b7\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0700-\u070d\u07f7-\u07f9\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u169b-\u169c\u16eb-\u16ed\u1735-\u1736\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u1944-\u1945\u19de-\u19df\u1a1e-\u1a1f\u1b5a-\u1b60\u1c3b-\u1c3f\u1c7e-\u1c7f\u2000-\u206e\u207d-\u207e\u208d-\u208e\u3008-\u3009\u2768-\u2775\u27c5-\u27c6\u27e6-\u27ef\u2983-\u2998\u29d8-\u29db\u29fc-\u29fd\u2cf9-\u2cfc\u2cfe-\u2cff\u2e00-\u2e7e\u3000-\u303f\u30a0\u30fb\ua60d-\ua60f\ua673\ua67e\ua874-\ua877\ua8ce-\ua8cf\ua92e-\ua92f\ua95f\uaa5c-\uaa5f\ufd3e-\ufd3f\ufe10-\ufe19\ufe30-\ufe52\ufe54-\ufe61\ufe63\ufe68\ufe6a-\ufe6b\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|\ud800[\udd00-\udd01\udf9f\udfd0]|\ud802[\udd1f\udd3f\ude50-\ude58]|\ud809[\udc00-\udc7e]/,
p=/\s/,n=core.PositionFilter.FilterResult.FILTER_ACCEPT,g=core.PositionFilter.FilterResult.FILTER_REJECT,e=odf.WordBoundaryFilter.IncludeWhitespace.TRAILING,b=odf.WordBoundaryFilter.IncludeWhitespace.LEADING,r={NO_NEIGHBOUR:0,SPACE_CHAR:1,PUNCTUATION_CHAR:2,WORD_CHAR:3,OTHER:4};this.acceptPosition=function(c){var f=c.container(),h=c.leftNode(),q=c.rightNode(),p=c.unfilteredDomOffset,s=function(){return c.unfilteredDomOffset()-1};f.nodeType===m&&(null===q&&(q=a(f,1,c.getNodeFilter())),null===h&&(h=
a(f,-1,c.getNodeFilter())));f!==q&&(p=function(){return 0});f!==h&&null!==h&&(s=function(){return h.textContent.length-1});f=d(h,s);q=d(q,p);return f===r.WORD_CHAR&&q===r.WORD_CHAR||f===r.PUNCTUATION_CHAR&&q===r.PUNCTUATION_CHAR||k===e&&f!==r.NO_NEIGHBOUR&&q===r.SPACE_CHAR||k===b&&f===r.SPACE_CHAR&&q!==r.NO_NEIGHBOUR?g:n}};odf.WordBoundaryFilter.IncludeWhitespace={None:0,TRAILING:1,LEADING:2};gui.SelectionController=function(f,k){function a(b){var a=b.spec();if(b.isEdit||a.memberid===k)H=void 0,C.cancel()}function d(){var b=t.getCursor(k).getNode();return t.createStepIterator(b,0,[s,u],t.getRootElement(b))}function c(b,a,e){e=new odf.WordBoundaryFilter(t,e);var c=t.getRootElement(b)||t.getRootNode(),d=t.createRootFilter(c);return t.createStepIterator(b,a,[s,d,e],c)}function m(b,a){return a?{anchorNode:b.startContainer,anchorOffset:b.startOffset,focusNode:b.endContainer,focusOffset:b.endOffset}:
{anchorNode:b.endContainer,anchorOffset:b.endOffset,focusNode:b.startContainer,focusOffset:b.startOffset}}function h(b,a,e){var c=new ops.OpMoveCursor;c.init({memberid:k,position:b,length:a||0,selectionType:e});return c}function q(b,a,e){var c;c=t.getCursor(k);c=m(c.getSelectedRange(),c.hasForwardSelection());c.focusNode=b;c.focusOffset=a;e||(c.anchorNode=c.focusNode,c.anchorOffset=c.focusOffset);b=t.convertDomToCursorRange(c);f.enqueue([h(b.position,b.length)])}function p(b){var a;a=c(b.startContainer,
b.startOffset,G);a.roundToPreviousStep()&&b.setStart(a.container(),a.offset());a=c(b.endContainer,b.endOffset,B);a.roundToNextStep()&&b.setEnd(a.container(),a.offset())}function n(b){var a=w.getParagraphElements(b),e=a[0],a=a[a.length-1];e&&b.setStart(e,0);a&&(w.isParagraph(b.endContainer)&&0===b.endOffset?b.setEndBefore(a):b.setEnd(a,a.childNodes.length))}function g(b,a,e,c){var d,f;c?(d=e.startContainer,f=e.startOffset):(d=e.endContainer,f=e.endOffset);z.containsNode(b,d)||(f=0>z.comparePoints(b,
0,d,f)?0:b.childNodes.length,d=b);b=t.createStepIterator(d,f,a,w.getParagraphElement(d)||b);b.roundToClosestStep()||runtime.assert(!1,"No step found in requested range");c?e.setStart(b.container(),b.offset()):e.setEnd(b.container(),b.offset())}function e(b,a){var e=d();e.advanceStep(b)&&q(e.container(),e.offset(),a)}function b(b,a){var e,c=H,f=[new gui.LineBoundaryScanner,new gui.ParagraphBoundaryScanner];void 0===c&&A&&(c=A());isNaN(c)||(e=d(),x.moveToFilteredStep(e,b,f)&&e.advanceStep(b)&&(f=[new gui.ClosestXOffsetScanner(c),
new gui.LineBoundaryScanner,new gui.ParagraphBoundaryScanner],x.moveToFilteredStep(e,b,f)&&(q(e.container(),e.offset(),a),H=c,C.restart())))}function r(b,a){var e=d(),c=[new gui.LineBoundaryScanner,new gui.ParagraphBoundaryScanner];x.moveToFilteredStep(e,b,c)&&q(e.container(),e.offset(),a)}function l(b,a){var e=t.getCursor(k),e=m(e.getSelectedRange(),e.hasForwardSelection()),e=c(e.focusNode,e.focusOffset,G);e.advanceStep(b)&&q(e.container(),e.offset(),a)}function y(b,a,e){var c=!1,d=t.getCursor(k),
d=m(d.getSelectedRange(),d.hasForwardSelection()),c=t.getRootElement(d.focusNode);runtime.assert(Boolean(c),"SelectionController: Cursor outside root");d=t.createStepIterator(d.focusNode,d.focusOffset,[s,u],c);d.roundToClosestStep();d.advanceStep(b)&&(e=e(d.container()))&&(b===J?(d.setPosition(e,0),c=d.roundToNextStep()):(d.setPosition(e,e.childNodes.length),c=d.roundToPreviousStep()),c&&q(d.container(),d.offset(),a))}var t=f.getOdtDocument(),z=core.DomUtils,w=odf.OdfUtils,s=t.getPositionFilter(),
x=new gui.GuiStepUtils,u=t.createRootFilter(k),A=null,H,C,G=odf.WordBoundaryFilter.IncludeWhitespace.TRAILING,B=odf.WordBoundaryFilter.IncludeWhitespace.LEADING,J=core.StepDirection.PREVIOUS,P=core.StepDirection.NEXT;this.selectionToRange=function(b){var a=0<=z.comparePoints(b.anchorNode,b.anchorOffset,b.focusNode,b.focusOffset),e=b.focusNode.ownerDocument.createRange();a?(e.setStart(b.anchorNode,b.anchorOffset),e.setEnd(b.focusNode,b.focusOffset)):(e.setStart(b.focusNode,b.focusOffset),e.setEnd(b.anchorNode,
b.anchorOffset));return{range:e,hasForwardSelection:a}};this.rangeToSelection=m;this.selectImage=function(b){var a=t.getRootElement(b),e=t.createRootFilter(a),a=t.createStepIterator(b,0,[e,t.getPositionFilter()],a),c;a.roundToPreviousStep()||runtime.assert(!1,"No walkable position before frame");e=a.container();c=a.offset();a.setPosition(b,b.childNodes.length);a.roundToNextStep()||runtime.assert(!1,"No walkable position after frame");b=t.convertDomToCursorRange({anchorNode:e,anchorOffset:c,focusNode:a.container(),
focusOffset:a.offset()});b=h(b.position,b.length,ops.OdtCursor.RegionSelection);f.enqueue([b])};this.expandToWordBoundaries=p;this.expandToParagraphBoundaries=n;this.selectRange=function(b,a,e){var c=t.getOdfCanvas().getElement(),d,l=[s];d=z.containsNode(c,b.startContainer);c=z.containsNode(c,b.endContainer);if(d||c)if(d&&c&&(2===e?p(b):3<=e&&n(b)),(e=a?t.getRootElement(b.startContainer):t.getRootElement(b.endContainer))||(e=t.getRootNode()),l.push(t.createRootFilter(e)),g(e,l,b,!0),g(e,l,b,!1),b=
m(b,a),a=t.convertDomToCursorRange(b),b=t.getCursorSelection(k),a.position!==b.position||a.length!==b.length)b=h(a.position,a.length,ops.OdtCursor.RangeSelection),f.enqueue([b])};this.moveCursorToLeft=function(){e(J,!1);return!0};this.moveCursorToRight=function(){e(P,!1);return!0};this.extendSelectionToLeft=function(){e(J,!0);return!0};this.extendSelectionToRight=function(){e(P,!0);return!0};this.setCaretXPositionLocator=function(b){A=b};this.moveCursorUp=function(){b(J,!1);return!0};this.moveCursorDown=
function(){b(P,!1);return!0};this.extendSelectionUp=function(){b(J,!0);return!0};this.extendSelectionDown=function(){b(P,!0);return!0};this.moveCursorBeforeWord=function(){l(J,!1);return!0};this.moveCursorPastWord=function(){l(P,!1);return!0};this.extendSelectionBeforeWord=function(){l(J,!0);return!0};this.extendSelectionPastWord=function(){l(P,!0);return!0};this.moveCursorToLineStart=function(){r(J,!1);return!0};this.moveCursorToLineEnd=function(){r(P,!1);return!0};this.extendSelectionToLineStart=
function(){r(J,!0);return!0};this.extendSelectionToLineEnd=function(){r(P,!0);return!0};this.extendSelectionToParagraphStart=function(){y(J,!0,w.getParagraphElement);return!0};this.extendSelectionToParagraphEnd=function(){y(P,!0,w.getParagraphElement);return!0};this.moveCursorToParagraphStart=function(){y(J,!1,w.getParagraphElement);return!0};this.moveCursorToParagraphEnd=function(){y(P,!1,w.getParagraphElement);return!0};this.moveCursorToDocumentStart=function(){y(J,!1,t.getRootElement);return!0};
this.moveCursorToDocumentEnd=function(){y(P,!1,t.getRootElement);return!0};this.extendSelectionToDocumentStart=function(){y(J,!0,t.getRootElement);return!0};this.extendSelectionToDocumentEnd=function(){y(P,!0,t.getRootElement);return!0};this.extendSelectionToEntireDocument=function(){var b=t.getCursor(k),b=t.getRootElement(b.getNode()),a,e,c;runtime.assert(Boolean(b),"SelectionController: Cursor outside root");c=t.createStepIterator(b,0,[s,u],b);c.roundToClosestStep();a=c.container();e=c.offset();
c.setPosition(b,b.childNodes.length);c.roundToClosestStep();b=t.convertDomToCursorRange({anchorNode:a,anchorOffset:e,focusNode:c.container(),focusOffset:c.offset()});f.enqueue([h(b.position,b.length)]);return!0};this.destroy=function(b){t.unsubscribe(ops.OdtDocument.signalOperationStart,a);core.Async.destroyAll([C.destroy],b)};(function(){C=core.Task.createTimeoutTask(function(){H=void 0},2E3);t.subscribe(ops.OdtDocument.signalOperationStart,a)})()};gui.TextController=function(f,k,a,d,c,m){function h(){y=!0===k.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)?a.isLocalCursorWithinOwnAnnotation():!0}function q(b){b.getMemberId()===d&&h()}function p(a,e,c){var d=[b.getPositionFilter()];c&&d.push(b.createRootFilter(a.startContainer));c=b.createStepIterator(a.startContainer,a.startOffset,d,e);c.roundToClosestStep()||runtime.assert(!1,"No walkable step found in paragraph element at range start");e=b.convertDomPointToCursorStep(c.container(),c.offset());
a.collapsed?a=e:(c.setPosition(a.endContainer,a.endOffset),c.roundToClosestStep()||runtime.assert(!1,"No walkable step found in paragraph element at range end"),a=b.convertDomPointToCursorStep(c.container(),c.offset()));return{position:e,length:a-e}}function n(b){var a,e,c,f=r.getParagraphElements(b),g=b.cloneRange(),h=[];a=f[0];1<f.length&&(r.hasNoODFContent(a)&&(a=f[f.length-1]),e=a.getAttributeNS(odf.Namespaces.textns,"style-name")||"");f.forEach(function(a,f){var m,k;g.setStart(a,0);g.collapse(!0);
m=p(g,a,!1).position;0<f&&(k=new ops.OpMergeParagraph,k.init({memberid:d,paragraphStyleName:e,destinationStartPosition:c,sourceStartPosition:m,moveCursor:1===f}),h.unshift(k));c=m;g.selectNodeContents(a);if(m=l.rangeIntersection(g,b))m=p(m,a,!0),0<m.length&&(k=new ops.OpRemoveText,k.init({memberid:d,position:m.position,length:m.length}),h.unshift(k))});return h}function g(b){0>b.length&&(b.position+=b.length,b.length=-b.length);return b}function e(a){if(!y)return!1;var e,c=b.getCursor(d).getSelectedRange().cloneRange(),
l=g(b.getCursorSelection(d)),h;if(0===l.length){l=void 0;e=b.getCursor(d).getNode();h=b.getRootElement(e);var m=[b.getPositionFilter(),b.createRootFilter(h)];h=b.createStepIterator(e,0,m,h);h.roundToClosestStep()&&(a?h.nextStep():h.previousStep())&&(l=g(b.convertDomToCursorRange({anchorNode:e,anchorOffset:0,focusNode:h.container(),focusOffset:h.offset()})),a?(c.setStart(e,0),c.setEnd(h.container(),h.offset())):(c.setStart(h.container(),h.offset()),c.setEnd(e,0)))}l&&f.enqueue(n(c));return void 0!==
l}var b=f.getOdtDocument(),r=odf.OdfUtils,l=core.DomUtils,y=!1,t=odf.Namespaces.textns,z=core.StepDirection.NEXT;this.isEnabled=function(){return y};this.enqueueParagraphSplittingOps=function(){if(!y)return!1;var a=b.getCursor(d),e=a.getSelectedRange(),c=g(b.getCursorSelection(d)),h=[],a=r.getParagraphElement(a.getNode()),l=a.getAttributeNS(t,"style-name")||"";0<c.length&&(h=h.concat(n(e)));e=new ops.OpSplitParagraph;e.init({memberid:d,position:c.position,paragraphStyleName:l,sourceParagraphPosition:b.convertDomPointToCursorStep(a,
0,z),moveCursor:!0});h.push(e);m&&(c=m(c.position+1),h=h.concat(c));f.enqueue(h);return!0};this.removeTextByBackspaceKey=function(){return e(!1)};this.removeTextByDeleteKey=function(){return e(!0)};this.removeCurrentSelection=function(){if(!y)return!1;var a=b.getCursor(d).getSelectedRange();f.enqueue(n(a));return!0};this.insertText=function(a){if(y){var e=b.getCursor(d).getSelectedRange(),h=g(b.getCursorSelection(d)),l=[],m=!1;0<h.length&&(l=l.concat(n(e)),m=!0);e=new ops.OpInsertText;e.init({memberid:d,
position:h.position,text:a,moveCursor:!0});l.push(e);c&&(a=c(h.position,a.length,m))&&l.push(a);f.enqueue(l)}};this.destroy=function(a){b.unsubscribe(ops.Document.signalCursorMoved,q);k.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,h);a()};b.subscribe(ops.Document.signalCursorMoved,q);k.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,h);h()};gui.UndoManager=function(){};gui.UndoManager.prototype.subscribe=function(f,k){};gui.UndoManager.prototype.unsubscribe=function(f,k){};gui.UndoManager.prototype.setDocument=function(f){};gui.UndoManager.prototype.setInitialState=function(){};gui.UndoManager.prototype.initialize=function(){};gui.UndoManager.prototype.purgeInitialState=function(){};gui.UndoManager.prototype.setPlaybackFunction=function(f){};gui.UndoManager.prototype.hasUndoStates=function(){};
gui.UndoManager.prototype.hasRedoStates=function(){};gui.UndoManager.prototype.moveForward=function(f){};gui.UndoManager.prototype.moveBackward=function(f){};gui.UndoManager.prototype.onOperationExecuted=function(f){};gui.UndoManager.prototype.isDocumentModified=function(){};gui.UndoManager.prototype.setDocumentModified=function(f){};gui.UndoManager.signalUndoStackChanged="undoStackChanged";gui.UndoManager.signalUndoStateCreated="undoStateCreated";gui.UndoManager.signalUndoStateModified="undoStateModified";
gui.UndoManager.signalDocumentModifiedChanged="documentModifiedChanged";gui.SessionControllerOptions=function(){this.annotationsEnabled=this.directParagraphStylingEnabled=this.directTextStylingEnabled=!1};
(function(){var f=core.PositionFilter.FilterResult.FILTER_ACCEPT;gui.SessionController=function(k,a,d,c){function m(b){return b.target||b.srcElement||null}function h(b,a){var e=v.getDOMDocument(),c=null;e.caretRangeFromPoint?(e=e.caretRangeFromPoint(b,a),c={container:e.startContainer,offset:e.startOffset}):e.caretPositionFromPoint&&(e=e.caretPositionFromPoint(b,a))&&e.offsetNode&&(c={container:e.offsetNode,offset:e.offset});return c}function q(b){var e=v.getCursor(a).getSelectedRange();e.collapsed?
b.preventDefault():$.setDataFromRange(b,e)?ha.removeCurrentSelection():runtime.log("Cut operation failed")}function p(){return!1!==v.getCursor(a).getSelectedRange().collapsed}function n(b){var e=v.getCursor(a).getSelectedRange();e.collapsed?b.preventDefault():$.setDataFromRange(b,e)||runtime.log("Copy operation failed")}function g(b){var a;S.clipboardData&&S.clipboardData.getData?a=S.clipboardData.getData("Text"):b.clipboardData&&b.clipboardData.getData&&(a=b.clipboardData.getData("text/plain"));
a&&(ha.removeCurrentSelection(),pa.paste(a));b.preventDefault?b.preventDefault():b.returnValue=!1}function e(){return!1}function b(b){if(R)R.onOperationExecuted(b)}function r(b){v.emit(ops.OdtDocument.signalUndoStackChanged,b)}function l(){var b;return R?(b=K.hasFocus(),R.moveBackward(1),b&&K.focus(),!0):!1}function y(){var b;return R?(b=K.hasFocus(),R.moveForward(1),b&&K.focus(),!0):!1}function t(b){var e=v.getCursor(a).getSelectedRange(),c=m(b).getAttribute("end");e&&c&&(b=h(b.clientX,b.clientY))&&
(ia.setUnfilteredPosition(b.container,b.offset),O.acceptPosition(ia)===f&&(e=e.cloneRange(),"left"===c?e.setStart(ia.container(),ia.unfilteredDomOffset()):e.setEnd(ia.container(),ia.unfilteredDomOffset()),d.setSelectedRange(e,"right"===c),v.emit(ops.Document.signalCursorMoved,d)))}function z(){X.selectRange(d.getSelectedRange(),d.hasForwardSelection(),1)}function w(){var b=S.getSelection(),a=0<b.rangeCount&&X.selectionToRange(b);ca&&a&&(W=!0,la.clearSelection(),ia.setUnfilteredPosition(b.focusNode,
b.focusOffset),O.acceptPosition(ia)===f&&(2===na?X.expandToWordBoundaries(a.range):3<=na&&X.expandToParagraphBoundaries(a.range),d.setSelectedRange(a.range,a.hasForwardSelection),v.emit(ops.Document.signalCursorMoved,d)))}function s(b){var e=m(b),c=v.getCursor(a);if(ca=null!==e&&T.containsNode(v.getOdfCanvas().getElement(),e))W=!1,e=v.getRootElement(e)||v.getRootNode(),O=v.createRootFilter(e),na=0===b.button?b.detail:0,c&&b.shiftKey?S.getSelection().collapse(c.getAnchorNode(),0):(b=S.getSelection(),
e=c.getSelectedRange(),b.extend?c.hasForwardSelection()?(b.collapse(e.startContainer,e.startOffset),b.extend(e.endContainer,e.endOffset)):(b.collapse(e.endContainer,e.endOffset),b.extend(e.startContainer,e.startOffset)):(b.removeAllRanges(),b.addRange(e.cloneRange()))),1<na&&w()}function x(b){var a=v.getRootElement(b),e=v.createRootFilter(a),a=v.createStepIterator(b,0,[e,v.getPositionFilter()],a);a.setPosition(b,b.childNodes.length);return a.roundToNextStep()?{container:a.container(),offset:a.offset()}:
null}function u(b){var a;a=(a=S.getSelection())?{anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}:null;var e=S.getSelection().isCollapsed,c,d;a.anchorNode||a.focusNode||!(c=h(b.clientX,b.clientY))||(a.anchorNode=c.container,a.anchorOffset=c.offset,a.focusNode=a.anchorNode,a.focusOffset=a.anchorOffset);if(F.isImage(a.focusNode)&&0===a.focusOffset&&F.isCharacterFrame(a.focusNode.parentNode)){if(d=a.focusNode.parentNode,c=d.getBoundingClientRect(),
b.clientX>c.left&&(c=x(d)))a.focusNode=c.container,a.focusOffset=c.offset,e&&(a.anchorNode=a.focusNode,a.anchorOffset=a.focusOffset)}else F.isImage(a.focusNode.firstChild)&&1===a.focusOffset&&F.isCharacterFrame(a.focusNode)&&(c=x(a.focusNode))&&(a.anchorNode=a.focusNode=c.container,a.anchorOffset=a.focusOffset=c.offset);a.anchorNode&&a.focusNode&&(a=X.selectionToRange(a),X.selectRange(a.range,a.hasForwardSelection,0===b.button?b.detail:0));K.focus()}function A(b){var a;if(a=h(b.clientX,b.clientY))b=
a.container,a=a.offset,b={anchorNode:b,anchorOffset:a,focusNode:b,focusOffset:a},b=X.selectionToRange(b),X.selectRange(b.range,b.hasForwardSelection,2),K.focus()}function H(b){var a=m(b),e,c,f;ja.processRequests();ca&&(F.isImage(a)&&F.isCharacterFrame(a.parentNode)&&S.getSelection().isCollapsed?(X.selectImage(a.parentNode),K.focus()):la.isSelectorElement(a)?K.focus():W?(a=d.getSelectedRange(),c=a.collapsed,F.isImage(a.endContainer)&&0===a.endOffset&&F.isCharacterFrame(a.endContainer.parentNode)&&
(f=a.endContainer.parentNode,f=x(f))&&(a.setEnd(f.container,f.offset),c&&a.collapse(!1)),X.selectRange(a,d.hasForwardSelection(),0===b.button?b.detail:0),K.focus()):ua?u(b):(e=T.cloneEvent(b),Y=runtime.setTimeout(function(){u(e)},0)),na=0,W=ca=!1)}function C(b){var e=v.getCursor(a).getSelectedRange();e.collapsed||N.exportRangeToDataTransfer(b.dataTransfer,e)}function G(){ca&&K.focus();na=0;W=ca=!1}function B(b){H(b)}function J(b){var a=m(b),e=null;"annotationRemoveButton"===a.className?(runtime.assert(ea,
"Remove buttons are displayed on annotations while annotation editing is disabled in the controller."),e=a.parentNode.getElementsByTagNameNS(odf.Namespaces.officens,"annotation").item(0),ga.removeAnnotation(e),K.focus()):"webodf-draggable"!==a.getAttribute("class")&&H(b)}function P(b){(b=b.data)&&(-1===b.indexOf("\n")?ha.insertText(b):pa.paste(b))}function Q(b){return function(){b();return!0}}function D(b){return function(e){return v.getCursor(a).getSelectionType()===ops.OdtCursor.RangeSelection?
b(e):!0}}function Z(a){K.unsubscribe("keydown",E.handleEvent);K.unsubscribe("keypress",V.handleEvent);K.unsubscribe("keyup",aa.handleEvent);K.unsubscribe("copy",n);K.unsubscribe("mousedown",s);K.unsubscribe("mousemove",ja.trigger);K.unsubscribe("mouseup",J);K.unsubscribe("contextmenu",B);K.unsubscribe("dragstart",C);K.unsubscribe("dragend",G);K.unsubscribe("click",oa.handleClick);K.unsubscribe("longpress",A);K.unsubscribe("drag",t);K.unsubscribe("dragstop",z);v.unsubscribe(ops.OdtDocument.signalOperationEnd,
fa.trigger);v.unsubscribe(ops.Document.signalCursorAdded,ka.registerCursor);v.unsubscribe(ops.Document.signalCursorRemoved,ka.removeCursor);v.unsubscribe(ops.OdtDocument.signalOperationEnd,b);a()}var S=runtime.getWindow(),v=k.getOdtDocument(),I=new gui.SessionConstraints,ba=new gui.SessionContext(k,a),T=core.DomUtils,F=odf.OdfUtils,N=new gui.MimeDataExporter,$=new gui.Clipboard(N),E=new gui.KeyboardHandler,V=new gui.KeyboardHandler,aa=new gui.KeyboardHandler,ca=!1,U=new odf.ObjectNameGenerator(v.getOdfCanvas().odfContainer(),
a),W=!1,O=null,Y,R=null,K=new gui.EventManager(v),ea=c.annotationsEnabled,ga=new gui.AnnotationController(k,I,a),da=new gui.DirectFormattingController(k,I,ba,a,U,c.directTextStylingEnabled,c.directParagraphStylingEnabled),ha=new gui.TextController(k,I,ba,a,da.createCursorStyleOp,da.createParagraphStyleOps),ma=new gui.ImageController(k,I,ba,a,U),la=new gui.ImageSelector(v.getOdfCanvas()),ia=v.createPositionIterator(v.getRootNode()),ja,fa,pa=new gui.PasteController(k,I,ba,a),ka=new gui.InputMethodEditor(a,
K),na=0,oa=new gui.HyperlinkClickHandler(v.getOdfCanvas().getElement,E,aa),qa=new gui.HyperlinkController(k,I,ba,a),va=new gui.ListController(k,K,I,ba,a),X=new gui.SelectionController(k,a),ta=new gui.MetadataController(k,a),L=gui.KeyboardHandler.Modifier,M=gui.KeyboardHandler.KeyCode,ra=-1!==S.navigator.appVersion.toLowerCase().indexOf("mac"),ua=-1!==["iPad","iPod","iPhone"].indexOf(S.navigator.platform),sa;runtime.assert(null!==S,"Expected to be run in an environment which has a global window, like a browser.");
this.undo=l;this.redo=y;this.insertLocalCursor=function(){runtime.assert(void 0===k.getOdtDocument().getCursor(a),"Inserting local cursor a second time.");var b=new ops.OpAddCursor;b.init({memberid:a});k.enqueue([b]);K.focus()};this.removeLocalCursor=function(){runtime.assert(void 0!==k.getOdtDocument().getCursor(a),"Removing local cursor without inserting before.");var b=new ops.OpRemoveCursor;b.init({memberid:a});k.enqueue([b])};this.startEditing=function(){ka.subscribe(gui.InputMethodEditor.signalCompositionStart,
ha.removeCurrentSelection);ka.subscribe(gui.InputMethodEditor.signalCompositionEnd,P);K.subscribe("beforecut",p);K.subscribe("cut",q);K.subscribe("beforepaste",e);K.subscribe("paste",g);R&&R.initialize();K.setEditing(!0);oa.setModifier(ra?L.Meta:L.Ctrl);E.bind(M.Backspace,L.None,Q(ha.removeTextByBackspaceKey),!0);E.bind(M.Delete,L.None,ha.removeTextByDeleteKey);E.bind(M.Tab,L.None,D(function(){ha.insertText("\t");return!0}));ra?(E.bind(M.Clear,L.None,ha.removeCurrentSelection),E.bind(M.B,L.Meta,D(da.toggleBold)),
E.bind(M.I,L.Meta,D(da.toggleItalic)),E.bind(M.U,L.Meta,D(da.toggleUnderline)),E.bind(M.L,L.MetaShift,D(da.alignParagraphLeft)),E.bind(M.E,L.MetaShift,D(da.alignParagraphCenter)),E.bind(M.R,L.MetaShift,D(da.alignParagraphRight)),E.bind(M.J,L.MetaShift,D(da.alignParagraphJustified)),ea&&E.bind(M.C,L.MetaShift,ga.addAnnotation),E.bind(M.Z,L.Meta,l),E.bind(M.Z,L.MetaShift,y)):(E.bind(M.B,L.Ctrl,D(da.toggleBold)),E.bind(M.I,L.Ctrl,D(da.toggleItalic)),E.bind(M.U,L.Ctrl,D(da.toggleUnderline)),E.bind(M.L,
L.CtrlShift,D(da.alignParagraphLeft)),E.bind(M.E,L.CtrlShift,D(da.alignParagraphCenter)),E.bind(M.R,L.CtrlShift,D(da.alignParagraphRight)),E.bind(M.J,L.CtrlShift,D(da.alignParagraphJustified)),ea&&E.bind(M.C,L.CtrlAlt,ga.addAnnotation),E.bind(M.Z,L.Ctrl,l),E.bind(M.Z,L.CtrlShift,y));V.setDefault(D(function(b){var a;a=null===b.which||void 0===b.which?String.fromCharCode(b.keyCode):0!==b.which&&0!==b.charCode?String.fromCharCode(b.which):null;return!a||b.altKey||b.ctrlKey||b.metaKey?!1:(ha.insertText(a),
!0)}));V.bind(M.Enter,L.None,D(ha.enqueueParagraphSplittingOps))};this.endEditing=function(){ka.unsubscribe(gui.InputMethodEditor.signalCompositionStart,ha.removeCurrentSelection);ka.unsubscribe(gui.InputMethodEditor.signalCompositionEnd,P);K.unsubscribe("cut",q);K.unsubscribe("beforecut",p);K.unsubscribe("paste",g);K.unsubscribe("beforepaste",e);K.setEditing(!1);oa.setModifier(L.None);E.bind(M.Backspace,L.None,function(){return!0},!0);E.unbind(M.Delete,L.None);E.unbind(M.Tab,L.None);ra?(E.unbind(M.Clear,
L.None),E.unbind(M.B,L.Meta),E.unbind(M.I,L.Meta),E.unbind(M.U,L.Meta),E.unbind(M.L,L.MetaShift),E.unbind(M.E,L.MetaShift),E.unbind(M.R,L.MetaShift),E.unbind(M.J,L.MetaShift),ea&&E.unbind(M.C,L.MetaShift),E.unbind(M.Z,L.Meta),E.unbind(M.Z,L.MetaShift)):(E.unbind(M.B,L.Ctrl),E.unbind(M.I,L.Ctrl),E.unbind(M.U,L.Ctrl),E.unbind(M.L,L.CtrlShift),E.unbind(M.E,L.CtrlShift),E.unbind(M.R,L.CtrlShift),E.unbind(M.J,L.CtrlShift),ea&&E.unbind(M.C,L.CtrlAlt),E.unbind(M.Z,L.Ctrl),E.unbind(M.Z,L.CtrlShift));V.setDefault(null);
V.unbind(M.Enter,L.None)};this.getInputMemberId=function(){return a};this.getSession=function(){return k};this.getSessionConstraints=function(){return I};this.setUndoManager=function(b){R&&R.unsubscribe(gui.UndoManager.signalUndoStackChanged,r);if(R=b)R.setDocument(v),R.setPlaybackFunction(k.enqueue),R.subscribe(gui.UndoManager.signalUndoStackChanged,r)};this.getUndoManager=function(){return R};this.getMetadataController=function(){return ta};this.getAnnotationController=function(){return ga};this.getDirectFormattingController=
function(){return da};this.getHyperlinkClickHandler=function(){return oa};this.getHyperlinkController=function(){return qa};this.getListController=function(){return va};this.getImageController=function(){return ma};this.getSelectionController=function(){return X};this.getTextController=function(){return ha};this.getEventManager=function(){return K};this.getKeyboardHandlers=function(){return{keydown:E,keypress:V}};this.destroy=function(b){var a=[ja.destroy,fa.destroy,da.destroy,ka.destroy,K.destroy,
oa.destroy,qa.destroy,ta.destroy,X.destroy,ha.destroy,Z];sa&&a.unshift(sa.destroy);runtime.clearTimeout(Y);core.Async.destroyAll(a,b)};ja=core.Task.createRedrawTask(w);fa=core.Task.createRedrawTask(function(){var b=v.getCursor(a);if(b&&b.getSelectionType()===ops.OdtCursor.RegionSelection&&(b=F.getImageElements(b.getSelectedRange())[0])){la.select(b.parentNode);return}la.clearSelection()});E.bind(M.Left,L.None,D(X.moveCursorToLeft));E.bind(M.Right,L.None,D(X.moveCursorToRight));E.bind(M.Up,L.None,
D(X.moveCursorUp));E.bind(M.Down,L.None,D(X.moveCursorDown));E.bind(M.Left,L.Shift,D(X.extendSelectionToLeft));E.bind(M.Right,L.Shift,D(X.extendSelectionToRight));E.bind(M.Up,L.Shift,D(X.extendSelectionUp));E.bind(M.Down,L.Shift,D(X.extendSelectionDown));E.bind(M.Home,L.None,D(X.moveCursorToLineStart));E.bind(M.End,L.None,D(X.moveCursorToLineEnd));E.bind(M.Home,L.Ctrl,D(X.moveCursorToDocumentStart));E.bind(M.End,L.Ctrl,D(X.moveCursorToDocumentEnd));E.bind(M.Home,L.Shift,D(X.extendSelectionToLineStart));
E.bind(M.End,L.Shift,D(X.extendSelectionToLineEnd));E.bind(M.Up,L.CtrlShift,D(X.extendSelectionToParagraphStart));E.bind(M.Down,L.CtrlShift,D(X.extendSelectionToParagraphEnd));E.bind(M.Home,L.CtrlShift,D(X.extendSelectionToDocumentStart));E.bind(M.End,L.CtrlShift,D(X.extendSelectionToDocumentEnd));ra?(E.bind(M.Left,L.Alt,D(X.moveCursorBeforeWord)),E.bind(M.Right,L.Alt,D(X.moveCursorPastWord)),E.bind(M.Left,L.Meta,D(X.moveCursorToLineStart)),E.bind(M.Right,L.Meta,D(X.moveCursorToLineEnd)),E.bind(M.Home,
L.Meta,D(X.moveCursorToDocumentStart)),E.bind(M.End,L.Meta,D(X.moveCursorToDocumentEnd)),E.bind(M.Left,L.AltShift,D(X.extendSelectionBeforeWord)),E.bind(M.Right,L.AltShift,D(X.extendSelectionPastWord)),E.bind(M.Left,L.MetaShift,D(X.extendSelectionToLineStart)),E.bind(M.Right,L.MetaShift,D(X.extendSelectionToLineEnd)),E.bind(M.Up,L.AltShift,D(X.extendSelectionToParagraphStart)),E.bind(M.Down,L.AltShift,D(X.extendSelectionToParagraphEnd)),E.bind(M.Up,L.MetaShift,D(X.extendSelectionToDocumentStart)),
E.bind(M.Down,L.MetaShift,D(X.extendSelectionToDocumentEnd)),E.bind(M.A,L.Meta,D(X.extendSelectionToEntireDocument))):(E.bind(M.Left,L.Ctrl,D(X.moveCursorBeforeWord)),E.bind(M.Right,L.Ctrl,D(X.moveCursorPastWord)),E.bind(M.Left,L.CtrlShift,D(X.extendSelectionBeforeWord)),E.bind(M.Right,L.CtrlShift,D(X.extendSelectionPastWord)),E.bind(M.A,L.Ctrl,D(X.extendSelectionToEntireDocument)));ua&&(sa=new gui.IOSSafariSupport(K));K.subscribe("keydown",E.handleEvent);K.subscribe("keypress",V.handleEvent);K.subscribe("keyup",
aa.handleEvent);K.subscribe("copy",n);K.subscribe("mousedown",s);K.subscribe("mousemove",ja.trigger);K.subscribe("mouseup",J);K.subscribe("contextmenu",B);K.subscribe("dragstart",C);K.subscribe("dragend",G);K.subscribe("click",oa.handleClick);K.subscribe("longpress",A);K.subscribe("drag",t);K.subscribe("dragstop",z);v.subscribe(ops.OdtDocument.signalOperationEnd,fa.trigger);v.subscribe(ops.Document.signalCursorAdded,ka.registerCursor);v.subscribe(ops.Document.signalCursorRemoved,ka.removeCursor);
v.subscribe(ops.OdtDocument.signalOperationEnd,b)}})();gui.CaretManager=function(f,k){function a(a){return m.hasOwnProperty(a)?m[a]:null}function d(){return Object.keys(m).map(function(a){return m[a]})}function c(a){var c=m[a];c&&(delete m[a],a===f.getInputMemberId()?(q.unsubscribe(ops.OdtDocument.signalProcessingBatchEnd,c.ensureVisible),q.unsubscribe(ops.Document.signalCursorMoved,c.refreshCursorBlinking),p.unsubscribe("compositionupdate",c.handleUpdate),p.unsubscribe("compositionend",c.handleUpdate),p.unsubscribe("focus",c.setFocus),p.unsubscribe("blur",
c.removeFocus),h.removeEventListener("focus",c.show,!1),h.removeEventListener("blur",c.hide,!1)):q.unsubscribe(ops.OdtDocument.signalProcessingBatchEnd,c.handleUpdate),c.destroy(function(){}))}var m={},h=runtime.getWindow(),q=f.getSession().getOdtDocument(),p=f.getEventManager();this.registerCursor=function(a,c,e){var b=a.getMemberId();a=new gui.Caret(a,k,c,e);m[b]=a;b===f.getInputMemberId()?(runtime.log("Starting to track input on new cursor of "+b),q.subscribe(ops.OdtDocument.signalProcessingBatchEnd,
a.ensureVisible),q.subscribe(ops.Document.signalCursorMoved,a.refreshCursorBlinking),p.subscribe("compositionupdate",a.handleUpdate),p.subscribe("compositionend",a.handleUpdate),p.subscribe("focus",a.setFocus),p.subscribe("blur",a.removeFocus),h.addEventListener("focus",a.show,!1),h.addEventListener("blur",a.hide,!1),a.setOverlayElement(p.getEventTrap())):q.subscribe(ops.OdtDocument.signalProcessingBatchEnd,a.handleUpdate);return a};this.getCaret=a;this.getCarets=d;this.destroy=function(a){var g=
d().map(function(a){return a.destroy});f.getSelectionController().setCaretXPositionLocator(null);q.unsubscribe(ops.Document.signalCursorRemoved,c);m={};core.Async.destroyAll(g,a)};f.getSelectionController().setCaretXPositionLocator(function(){var c=a(f.getInputMemberId()),d;c&&(d=c.getBoundingClientRect());return d?d.right:void 0});q.subscribe(ops.Document.signalCursorRemoved,c)};gui.EditInfoHandle=function(f){var k=[],a,d=f.ownerDocument,c=d.documentElement.namespaceURI;this.setEdits=function(f){k=f;var h,q,p,n;core.DomUtils.removeAllChildNodes(a);for(f=0;f<k.length;f+=1)h=d.createElementNS(c,"div"),h.className="editInfo",q=d.createElementNS(c,"span"),q.className="editInfoColor",q.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",k[f].memberid),p=d.createElementNS(c,"span"),p.className="editInfoAuthor",p.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",
k[f].memberid),n=d.createElementNS(c,"span"),n.className="editInfoTime",n.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",k[f].memberid),n.appendChild(d.createTextNode(k[f].time.toString())),h.appendChild(q),h.appendChild(p),h.appendChild(n),a.appendChild(h)};this.show=function(){a.style.display="block"};this.hide=function(){a.style.display="none"};this.destroy=function(c){f.removeChild(a);c()};a=d.createElementNS(c,"div");a.setAttribute("class","editInfoHandle");a.style.display="none";
f.appendChild(a)};ops.EditInfo=function(f,k){function a(){var a=[],d;for(d in c)c.hasOwnProperty(d)&&a.push({memberid:d,time:c[d].time});a.sort(function(a,c){return a.time-c.time});return a}var d,c={};this.getNode=function(){return d};this.getOdtDocument=function(){return k};this.getEdits=function(){return c};this.getSortedEdits=function(){return a()};this.addEdit=function(a,d){c[a]={time:d}};this.clearEdits=function(){c={}};this.destroy=function(a){f.parentNode&&f.removeChild(d);a()};d=k.getDOMDocument().createElementNS("urn:webodf:names:editinfo",
"editinfo");f.insertBefore(d,f.firstChild)};gui.EditInfoMarker=function(f,k){function a(a,e){return runtime.setTimeout(function(){h.style.opacity=a},e)}var d=this,c,m,h,q,p,n;this.addEdit=function(c,e){var b=Date.now()-e;f.addEdit(c,e);m.setEdits(f.getSortedEdits());h.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",c);runtime.clearTimeout(p);runtime.clearTimeout(n);1E4>b?(q=a(1,0),p=a(0.5,1E4-b),n=a(0.2,2E4-b)):1E4<=b&&2E4>b?(q=a(0.5,0),n=a(0.2,2E4-b)):q=a(0.2,0)};this.getEdits=function(){return f.getEdits()};this.clearEdits=
function(){f.clearEdits();m.setEdits([]);h.hasAttributeNS("urn:webodf:names:editinfo","editinfo:memberid")&&h.removeAttributeNS("urn:webodf:names:editinfo","editinfo:memberid")};this.getEditInfo=function(){return f};this.show=function(){h.style.display="block"};this.hide=function(){d.hideHandle();h.style.display="none"};this.showHandle=function(){m.show()};this.hideHandle=function(){m.hide()};this.destroy=function(a){runtime.clearTimeout(q);runtime.clearTimeout(p);runtime.clearTimeout(n);c.removeChild(h);
m.destroy(function(e){e?a(e):f.destroy(a)})};(function(){var a=f.getOdtDocument().getDOMDocument();h=a.createElementNS(a.documentElement.namespaceURI,"div");h.setAttribute("class","editInfoMarker");h.onmouseover=function(){d.showHandle()};h.onmouseout=function(){d.hideHandle()};c=f.getNode();c.appendChild(h);m=new gui.EditInfoHandle(c);k||d.hide()})()};gui.HyperlinkTooltipView=function(f,k){var a=core.DomUtils,d=odf.OdfUtils,c=runtime.getWindow(),m,h,q;runtime.assert(null!==c,"Expected to be run in an environment which has a global window, like a browser.");this.showTooltip=function(p){var n=p.target||p.srcElement,g=f.getSizer(),e=f.getZoomLevel(),b;a:{for(;n;){if(d.isHyperlink(n))break a;if(d.isParagraph(n)||d.isInlineRoot(n))break;n=n.parentNode}n=null}if(n){a.containsNode(g,q)||g.appendChild(q);b=h;var r;switch(k()){case gui.KeyboardHandler.Modifier.Ctrl:r=
runtime.tr("Ctrl-click to follow link");break;case gui.KeyboardHandler.Modifier.Meta:r=runtime.tr("\u2318-click to follow link");break;default:r=""}b.textContent=r;m.textContent=d.getHyperlinkTarget(n);q.style.display="block";b=c.innerWidth-q.offsetWidth-15;n=p.clientX>b?b:p.clientX+15;b=c.innerHeight-q.offsetHeight-10;p=p.clientY>b?b:p.clientY+10;g=g.getBoundingClientRect();n=(n-g.left)/e;p=(p-g.top)/e;q.style.left=n+"px";q.style.top=p+"px"}};this.hideTooltip=function(){q.style.display="none"};this.destroy=
function(a){q.parentNode&&q.parentNode.removeChild(q);a()};(function(){var a=f.getElement().ownerDocument;m=a.createElement("span");h=a.createElement("span");m.className="webodf-hyperlinkTooltipLink";h.className="webodf-hyperlinkTooltipText";q=a.createElement("div");q.className="webodf-hyperlinkTooltip";q.appendChild(m);q.appendChild(h);f.getElement().appendChild(q)})()};gui.OdfFieldView=function(f){function k(){var a=odf.OdfSchema.getFields().map(function(a){return a.replace(":","|")}),d=a.join(",\n")+"\n{ background-color: #D0D0D0; }\n",a=a.map(function(a){return a+":empty::after"}).join(",\n")+"\n{ content:' '; white-space: pre; }\n";return d+"\n"+a}var a,d=f.getElement().ownerDocument;this.showFieldHighlight=function(){a.appendChild(d.createTextNode(k()))};this.hideFieldHighlight=function(){for(var c=a.sheet,d=c.cssRules;d.length;)c.deleteRule(d.length-1)};this.destroy=
function(c){a.parentNode&&a.parentNode.removeChild(a);c()};a=function(){var a=d.getElementsByTagName("head").item(0),f=d.createElement("style"),h="";f.type="text/css";f.media="screen, print, handheld, projection";odf.Namespaces.forEachPrefix(function(a,c){h+="@namespace "+a+" url("+c+");\n"});f.appendChild(d.createTextNode(h));a.appendChild(f);return f}()};gui.ShadowCursor=function(f){var k=f.getDOMDocument().createRange(),a=!0;this.removeFromDocument=function(){};this.getMemberId=function(){return gui.ShadowCursor.ShadowCursorMemberId};this.getSelectedRange=function(){return k};this.setSelectedRange=function(d,c){k=d;a=!1!==c};this.hasForwardSelection=function(){return a};this.getDocument=function(){return f};this.getSelectionType=function(){return ops.OdtCursor.RangeSelection};k.setStart(f.getRootNode(),0)};gui.ShadowCursor.ShadowCursorMemberId="";gui.SelectionView=function(f){};gui.SelectionView.prototype.rerender=function(){};gui.SelectionView.prototype.show=function(){};gui.SelectionView.prototype.hide=function(){};gui.SelectionView.prototype.destroy=function(f){};gui.SelectionViewManager=function(f){function k(){return Object.keys(a).map(function(d){return a[d]})}var a={};this.getSelectionView=function(d){return a.hasOwnProperty(d)?a[d]:null};this.getSelectionViews=k;this.removeSelectionView=function(d){a.hasOwnProperty(d)&&(a[d].destroy(function(){}),delete a[d])};this.hideSelectionView=function(d){a.hasOwnProperty(d)&&a[d].hide()};this.showSelectionView=function(d){a.hasOwnProperty(d)&&a[d].show()};this.rerenderSelectionViews=function(){Object.keys(a).forEach(function(d){a[d].rerender()})};
this.registerCursor=function(d,c){var m=d.getMemberId(),h=new f(d);c?h.show():h.hide();return a[m]=h};this.destroy=function(a){function c(h,k){k?a(k):h<f.length?f[h].destroy(function(a){c(h+1,a)}):a()}var f=k();c(0,void 0)}};gui.SessionViewOptions=function(){this.caretBlinksOnRangeSelect=this.caretAvatarsInitiallyVisible=this.editInfoMarkersInitiallyVisible=!0};
(function(){gui.SessionView=function(f,k,a,d,c,m){function h(b){b.memberId===k&&H.getViewport().scrollIntoView(b.annotation.getBoundingClientRect())}function q(){var b=document.getElementsByTagName("head").item(0),a=document.createElement("style");a.type="text/css";a.media="screen, print, handheld, projection";b.appendChild(a);return a}function p(b,a,e){function c(a,e,d){e=a+'[editinfo|memberid="'+b+'"]'+d+e;a:{var f=w.firstChild;for(a=a+'[editinfo|memberid="'+b+'"]'+d+"{";f;){if(f.nodeType===Node.TEXT_NODE&&
0===f.data.indexOf(a)){a=f;break a}f=f.nextSibling}a=null}a?a.data=e:w.appendChild(document.createTextNode(e))}c("div.editInfoMarker","{ background-color: "+e+"; }","");c("span.editInfoColor","{ background-color: "+e+"; }","");c("span.editInfoAuthor",'{ content: "'+a+'"; }',":before");c("dc|creator","{ background-color: "+e+"; }","");c(".webodf-selectionOverlay","{ fill: "+e+"; stroke: "+e+";}","");b===k&&(c(".webodf-touchEnabled .webodf-selectionOverlay","{ display: block; }"," > .webodf-draggable"),
b=gui.ShadowCursor.ShadowCursorMemberId,c(".webodf-selectionOverlay","{ fill: "+e+"; stroke: "+e+";}",""),c(".webodf-touchEnabled .webodf-selectionOverlay","{ display: block; }"," > .webodf-draggable"))}function n(b){var a,e;for(e in u)u.hasOwnProperty(e)&&(a=u[e],b?a.show():a.hide())}function g(b){c.getCarets().forEach(function(a){b?a.showHandle():a.hideHandle()})}function e(b){var a=b.getMemberId();b=b.getProperties();p(a,b.fullName,b.color)}function b(b){var e=b.getMemberId(),d=a.getOdtDocument().getMember(e).getProperties();
c.registerCursor(b,B,J);m.registerCursor(b,!0);if(b=c.getCaret(e))b.setAvatarImageUrl(d.imageUrl),b.setColor(d.color);runtime.log("+++ View here +++ eagerly created an Caret for '"+e+"'! +++")}function r(b){b=b.getMemberId();var a=m.getSelectionView(k),e=m.getSelectionView(gui.ShadowCursor.ShadowCursorMemberId),d=c.getCaret(k);b===k?(e.hide(),a&&a.show(),d&&d.show()):b===gui.ShadowCursor.ShadowCursorMemberId&&(e.show(),a&&a.hide(),d&&d.hide())}function l(b){m.removeSelectionView(b)}function y(b){var e=
b.paragraphElement,c=b.memberId;b=b.timeStamp;var d,f="",l=e.getElementsByTagNameNS(x,"editinfo").item(0);l?(f=l.getAttributeNS(x,"id"),d=u[f]):(f=Math.random().toString(),d=new ops.EditInfo(e,a.getOdtDocument()),d=new gui.EditInfoMarker(d,G),l=e.getElementsByTagNameNS(x,"editinfo").item(0),l.setAttributeNS(x,"id",f),u[f]=d);d.addEdit(c,new Date(b));C.trigger()}function t(){var b;s.hasChildNodes()&&core.DomUtils.removeAllChildNodes(s);!0===d.getState(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN)&&
(b=a.getOdtDocument().getMember(k))&&(b=b.getProperties().fullName,s.appendChild(document.createTextNode(".annotationWrapper:not([creator = '"+b+"']) .annotationRemoveButton { display: none; }")))}function z(a){var c=Object.keys(u).map(function(b){return u[b]});A.unsubscribe(ops.Document.signalMemberAdded,e);A.unsubscribe(ops.Document.signalMemberUpdated,e);A.unsubscribe(ops.Document.signalCursorAdded,b);A.unsubscribe(ops.Document.signalCursorRemoved,l);A.unsubscribe(ops.OdtDocument.signalParagraphChanged,
y);A.unsubscribe(ops.Document.signalCursorMoved,r);A.unsubscribe(ops.OdtDocument.signalParagraphChanged,m.rerenderSelectionViews);A.unsubscribe(ops.OdtDocument.signalTableAdded,m.rerenderSelectionViews);A.unsubscribe(ops.OdtDocument.signalParagraphStyleModified,m.rerenderSelectionViews);d.unsubscribe(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN,t);A.unsubscribe(ops.Document.signalMemberAdded,t);A.unsubscribe(ops.Document.signalMemberUpdated,t);w.parentNode.removeChild(w);s.parentNode.removeChild(s);
(function Z(b,e){e?a(e):b<c.length?c[b].destroy(function(a){Z(b+1,a)}):a()})(0,void 0)}var w,s,x="urn:webodf:names:editinfo",u={},A,H,C,G=void 0!==f.editInfoMarkersInitiallyVisible?Boolean(f.editInfoMarkersInitiallyVisible):!0,B=void 0!==f.caretAvatarsInitiallyVisible?Boolean(f.caretAvatarsInitiallyVisible):!0,J=void 0!==f.caretBlinksOnRangeSelect?Boolean(f.caretBlinksOnRangeSelect):!0;this.showEditInfoMarkers=function(){G||(G=!0,n(G))};this.hideEditInfoMarkers=function(){G&&(G=!1,n(G))};this.showCaretAvatars=
function(){B||(B=!0,g(B))};this.hideCaretAvatars=function(){B&&(B=!1,g(B))};this.getSession=function(){return a};this.getCaret=function(b){return c.getCaret(b)};this.destroy=function(b){var a=[C.destroy,z];A.unsubscribe(ops.OdtDocument.signalAnnotationAdded,h);core.Async.destroyAll(a,b)};A=a.getOdtDocument();H=A.getOdfCanvas();A.subscribe(ops.OdtDocument.signalAnnotationAdded,h);A.subscribe(ops.Document.signalMemberAdded,e);A.subscribe(ops.Document.signalMemberUpdated,e);A.subscribe(ops.Document.signalCursorAdded,
b);A.subscribe(ops.Document.signalCursorRemoved,l);A.subscribe(ops.OdtDocument.signalParagraphChanged,y);A.subscribe(ops.Document.signalCursorMoved,r);A.subscribe(ops.OdtDocument.signalParagraphChanged,m.rerenderSelectionViews);A.subscribe(ops.OdtDocument.signalTableAdded,m.rerenderSelectionViews);A.subscribe(ops.OdtDocument.signalParagraphStyleModified,m.rerenderSelectionViews);d.subscribe(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN,t);A.subscribe(ops.Document.signalMemberAdded,t);A.subscribe(ops.Document.signalMemberUpdated,
t);w=q();w.appendChild(document.createTextNode("@namespace editinfo url(urn:webodf:names:editinfo);"));w.appendChild(document.createTextNode("@namespace dc url(http://purl.org/dc/elements/1.1/);"));s=q();t();C=core.Task.createRedrawTask(function(){var b=H.getAnnotationViewManager();b&&(b.rehighlightAnnotations(),A.fixCursorPositions())})}})();gui.SvgSelectionView=function(f){function k(){var a=b.getRootNode();r!==a&&(r=a,l=b.getCanvas().getSizer(),l.appendChild(t),t.setAttribute("class","webodf-selectionOverlay"),w.setAttribute("class","webodf-draggable"),s.setAttribute("class","webodf-draggable"),w.setAttribute("end","left"),s.setAttribute("end","right"),w.setAttribute("r",8),s.setAttribute("r",8),t.appendChild(z),t.appendChild(w),t.appendChild(s))}function a(b){b=b.getBoundingClientRect();return Boolean(b&&0!==b.height)}function d(b){var e=
x.getTextElements(b,!0,!1),c=b.cloneRange(),d=b.cloneRange();b=b.cloneRange();if(!e.length)return null;var f;a:{f=0;var l=e[f],g=c.startContainer===l?c.startOffset:0,h=g;c.setStart(l,g);for(c.setEnd(l,h);!a(c);){if(l.nodeType===Node.ELEMENT_NODE&&h<l.childNodes.length)h=l.childNodes.length;else if(l.nodeType===Node.TEXT_NODE&&h<l.length)h+=1;else if(e[f])l=e[f],f+=1,g=h=0;else{f=!1;break a}c.setStart(l,g);c.setEnd(l,h)}f=!0}if(!f)return null;a:{f=e.length-1;l=e[f];h=g=d.endContainer===l?d.endOffset:
l.nodeType===Node.TEXT_NODE?l.length:l.childNodes.length;d.setStart(l,g);for(d.setEnd(l,h);!a(d);){if(l.nodeType===Node.ELEMENT_NODE&&0<g)g=0;else if(l.nodeType===Node.TEXT_NODE&&0<g)g-=1;else if(e[f])l=e[f],f-=1,g=h=l.length||l.childNodes.length;else{e=!1;break a}d.setStart(l,g);d.setEnd(l,h)}e=!0}if(!e)return null;b.setStart(c.startContainer,c.startOffset);b.setEnd(d.endContainer,d.endOffset);return{firstRange:c,lastRange:d,fillerRange:b}}function c(b,a){var e={};e.top=Math.min(b.top,a.top);e.left=
Math.min(b.left,a.left);e.right=Math.max(b.right,a.right);e.bottom=Math.max(b.bottom,a.bottom);e.width=e.right-e.left;e.height=e.bottom-e.top;return e}function m(b,a){a&&0<a.width&&0<a.height&&(b=b?c(b,a):a);return b}function h(a){function e(b){C.setUnfilteredPosition(b,0);return t.acceptNode(b)===G&&s.acceptPosition(C)===G?G:B}function c(b){var a=null;e(b)===G&&(a=u.getBoundingClientRect(b));return a}var d=a.commonAncestorContainer,f=a.startContainer,l=a.endContainer,g=a.startOffset,h=a.endOffset,
k,n,r=null,q,p=y.createRange(),s,t=new odf.OdfNodeFilter,w;if(f===d||l===d)return p=a.cloneRange(),r=p.getBoundingClientRect(),p.detach(),r;for(a=f;a.parentNode!==d;)a=a.parentNode;for(n=l;n.parentNode!==d;)n=n.parentNode;s=b.createRootFilter(f);for(d=a.nextSibling;d&&d!==n;)q=c(d),r=m(r,q),d=d.nextSibling;if(x.isParagraph(a))r=m(r,u.getBoundingClientRect(a));else if(a.nodeType===Node.TEXT_NODE)d=a,p.setStart(d,g),p.setEnd(d,d===n?h:d.length),q=p.getBoundingClientRect(),r=m(r,q);else for(w=y.createTreeWalker(a,
NodeFilter.SHOW_TEXT,e,!1),d=w.currentNode=f;d&&d!==l;)p.setStart(d,g),p.setEnd(d,d.length),q=p.getBoundingClientRect(),r=m(r,q),k=d,g=0,d=w.nextNode();k||(k=f);if(x.isParagraph(n))r=m(r,u.getBoundingClientRect(n));else if(n.nodeType===Node.TEXT_NODE)d=n,p.setStart(d,d===a?g:0),p.setEnd(d,h),q=p.getBoundingClientRect(),r=m(r,q);else for(w=y.createTreeWalker(n,NodeFilter.SHOW_TEXT,e,!1),d=w.currentNode=l;d&&d!==k;)if(p.setStart(d,0),p.setEnd(d,h),q=p.getBoundingClientRect(),r=m(r,q),d=w.previousNode())h=
d.length;return r}function q(b,a){var e=b.getBoundingClientRect(),c={width:0};c.top=e.top;c.bottom=e.bottom;c.height=e.height;c.left=c.right=a?e.right:e.left;return c}function p(){var b=f.getSelectedRange(),a;if(a=H&&f.getSelectionType()===ops.OdtCursor.RangeSelection&&!b.collapsed){k();var e=u.getBoundingClientRect(l),g=A.getZoomLevel(),b=d(b),m,r,n,p,y,x;if(b){a=b.firstRange;m=b.lastRange;r=b.fillerRange;n=u.translateRect(q(a,!1),e,g);y=u.translateRect(q(m,!0),e,g);p=(p=h(r))?u.translateRect(p,
e,g):c(n,y);x=p.left;p=n.left+Math.max(0,p.width-(n.left-p.left));e=Math.min(n.top,y.top);g=y.top+y.height;x=[{x:n.left,y:e+n.height},{x:n.left,y:e},{x:p,y:e},{x:p,y:g-y.height},{x:y.right,y:g-y.height},{x:y.right,y:g},{x:x,y:g},{x:x,y:e+n.height},{x:n.left,y:e+n.height}];p="";var C;for(C=0;C<x.length;C+=1)p+=x[C].x+","+x[C].y+" ";z.setAttribute("points",p);w.setAttribute("cx",n.left);w.setAttribute("cy",e+n.height/2);s.setAttribute("cx",y.right);s.setAttribute("cy",g-y.height/2);a.detach();m.detach();
r.detach()}a=Boolean(b)}t.style.display=a?"block":"none"}function n(b){H&&b===f&&J.trigger()}function g(b){b=8/b;w.setAttribute("r",b);s.setAttribute("r",b)}function e(b){l.removeChild(t);l.classList.remove("webodf-virtualSelections");f.getDocument().unsubscribe(ops.Document.signalCursorMoved,n);A.unsubscribe(gui.ZoomHelper.signalZoomChanged,g);b()}var b=f.getDocument(),r,l,y=b.getDOMDocument(),t=y.createElementNS("http://www.w3.org/2000/svg","svg"),z=y.createElementNS("http://www.w3.org/2000/svg",
"polygon"),w=y.createElementNS("http://www.w3.org/2000/svg","circle"),s=y.createElementNS("http://www.w3.org/2000/svg","circle"),x=odf.OdfUtils,u=core.DomUtils,A=b.getCanvas().getZoomHelper(),H=!0,C=f.getDocument().createPositionIterator(b.getRootNode()),G=NodeFilter.FILTER_ACCEPT,B=NodeFilter.FILTER_REJECT,J;this.rerender=function(){H&&J.trigger()};this.show=function(){H=!0;J.trigger()};this.hide=function(){H=!1;J.trigger()};this.destroy=function(b){core.Async.destroyAll([J.destroy,e],b)};(function(){var b=
f.getMemberId();J=core.Task.createRedrawTask(p);k();t.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",b);l.classList.add("webodf-virtualSelections");f.getDocument().subscribe(ops.Document.signalCursorMoved,n);A.subscribe(gui.ZoomHelper.signalZoomChanged,g);g(A.getZoomLevel())})()};gui.UndoStateRules=function(){function f(a,d){var f=a.length;this.previous=function(){for(f-=1;0<=f;f-=1)if(d(a[f]))return a[f];return null}}function k(a){a=a.spec();var d;a.hasOwnProperty("position")&&(d=a.position);return d}function a(a){return a.isEdit}function d(a,d,f){if(!f)return f=k(a)-k(d),0===f||1===Math.abs(f);a=k(a);d=k(d);f=k(f);return a-d===d-f}this.isEditOperation=a;this.isPartOfOperationSet=function(c,m){var h=void 0!==c.group,k;if(!c.isEdit||0===m.length)return!0;k=m[m.length-1];if(h&&
c.group===k.group)return!0;a:switch(c.spec().optype){case "RemoveText":case "InsertText":k=!0;break a;default:k=!1}if(k&&m.some(a)){if(h){var p;h=c.spec().optype;k=new f(m,a);var n=k.previous(),g=null,e,b;runtime.assert(Boolean(n),"No edit operations found in state");b=n.group;runtime.assert(void 0!==b,"Operation has no group");for(e=1;n&&n.group===b;){if(h===n.spec().optype){p=n;break}n=k.previous()}if(p){for(n=k.previous();n;){if(n.group!==b){if(2===e)break;b=n.group;e+=1}if(h===n.spec().optype){g=
n;break}n=k.previous()}p=d(c,p,g)}else p=!1;return p}p=c.spec().optype;h=new f(m,a);k=h.previous();runtime.assert(Boolean(k),"No edit operations found in state");p=p===k.spec().optype?d(c,k,h.previous()):!1;return p}return!1}};(function(){function f(a,c){this.mainId=void 0!==a?a:-1;this.subId=void 0!==c?c:-1}function k(d,c,k){function h(a,e){return a+(d.isEditOperation(e)?1:0)}var q,p,n;this.addOperation=function(a){d.isEditOperation(a)&&(n+=1);p.push(a)};this.isNextStateId=function(a){return a.mainId===q&&a.subId===n};this.getNextStateId=function(){return new f(q,n)};this.getOperations=function(){return p};q=a+=1;p=c||[];n=c&&k?c.reduce(h,0):0}var a=0;gui.TrivialUndoManager=function(a){function c(){return!0!==u.isNextStateId(x)}
function m(b){b=b.getOperations();0<b.length&&(B=!0,w(b),B=!1)}function h(){C.emit(gui.UndoManager.signalUndoStackChanged,{undoAvailable:r.hasUndoStates(),redoAvailable:r.hasRedoStates()})}function q(b){var a=c();b!==a&&C.emit(gui.UndoManager.signalDocumentModifiedChanged,a)}function p(){u!==z&&u!==A[A.length-1]&&A.push(u)}function n(b){var a=b.previousSibling||b.nextSibling;b.parentNode.removeChild(b);y.normalizeTextNodes(a)}function g(b){return Object.keys(b).map(function(a){return b[a]})}function e(b){function a(b){var l=
b.spec();if(d[l.memberid])switch(l.optype){case "AddCursor":e[l.memberid]||(e[l.memberid]=b,delete d[l.memberid],f-=1);break;case "MoveCursor":c[l.memberid]||(c[l.memberid]=b)}}var e={},c={},d={},f,l;l=b.pop();s.getMemberIds().forEach(function(b){d[b]=!0});for(f=Object.keys(d).length;l&&0<f;)l=l.getOperations(),l.reverse(),l.forEach(a),l=b.pop();return new k(G,g(e).concat(g(c)))}function b(){var b=c(),a=t=s.cloneDocumentElement();y.getElementsByTagNameNS(a,l,"cursor").forEach(n);y.getElementsByTagNameNS(a,
l,"anchor").forEach(n);p();u=z=e([z].concat(A));A.length=0;H.length=0;b||(x=u.getNextStateId());h();q(b)}var r=this,l="urn:webodf:names:cursor",y=core.DomUtils,t,z,w,s,x,u,A=[],H=[],C=new core.EventNotifier([gui.UndoManager.signalUndoStackChanged,gui.UndoManager.signalUndoStateCreated,gui.UndoManager.signalUndoStateModified,gui.UndoManager.signalDocumentModifiedChanged,gui.TrivialUndoManager.signalDocumentRootReplaced]),G=a||new gui.UndoStateRules,B=!1;this.subscribe=function(b,a){C.subscribe(b,a)};
this.unsubscribe=function(b,a){C.unsubscribe(b,a)};this.isDocumentModified=c;this.setDocumentModified=function(b){c()!==b&&(x=b?new f:u.getNextStateId(),C.emit(gui.UndoManager.signalDocumentModifiedChanged,b))};this.hasUndoStates=function(){return 0<A.length};this.hasRedoStates=function(){return 0<H.length};this.setDocument=function(b){s=b};this.purgeInitialState=function(){var b=c();A.length=0;H.length=0;u=z=new k(G);x=u.getNextStateId();t=null;h();q(b)};this.setInitialState=b;this.initialize=function(){t||
b()};this.setPlaybackFunction=function(b){w=b};this.onOperationExecuted=function(b){if(!B){var a=c();G.isEditOperation(b)&&(u===z||0<H.length)||!G.isPartOfOperationSet(b,u.getOperations())?(H.length=0,p(),u=new k(G,[b],!0),A.push(u),C.emit(gui.UndoManager.signalUndoStateCreated,{operations:u.getOperations()}),h()):(u.addOperation(b),C.emit(gui.UndoManager.signalUndoStateModified,{operations:u.getOperations()}));q(a)}};this.moveForward=function(b){for(var a=0,e=c(),d;b&&H.length;)d=H.pop(),A.push(d),
m(d),b-=1,a+=1;a&&(u=A[A.length-1],h(),q(e));return a};this.moveBackward=function(b){for(var a=0,e=c();b&&A.length;)H.push(A.pop()),b-=1,a+=1;a&&(s.getMemberIds().forEach(function(b){s.removeCursor(b)}),s.setDocumentElement(t.cloneNode(!0)),C.emit(gui.TrivialUndoManager.signalDocumentRootReplaced,{}),m(z),A.forEach(m),u=A[A.length-1]||z,h(),q(e));return a};u=z=new k(G);x=u.getNextStateId()};gui.TrivialUndoManager.signalDocumentRootReplaced="documentRootReplaced"})();odf.GraphicProperties=function(f,k,a){var d=this,c=odf.Namespaces.stylens,m=odf.Namespaces.svgns;this.verticalPos=function(){return d.data.value("verticalPos")};this.verticalRel=function(){return d.data.value("verticalRel")};this.horizontalPos=function(){return d.data.value("horizontalPos")};this.horizontalRel=function(){return d.data.value("horizontalRel")};this.strokeWidth=function(){return d.data.value("strokeWidth")};d.data=new odf.LazyStyleProperties(void 0===a?void 0:a.data,{verticalPos:function(){var a=
f.getAttributeNS(c,"vertical-pos");return""===a?void 0:a},verticalRel:function(){var a=f.getAttributeNS(c,"vertical-rel");return""===a?void 0:a},horizontalPos:function(){var a=f.getAttributeNS(c,"horizontal-pos");return""===a?void 0:a},horizontalRel:function(){var a=f.getAttributeNS(c,"horizontal-rel");return""===a?void 0:a},strokeWidth:function(){var a=f.getAttributeNS(m,"stroke-width");return k.parseLength(a)}})};
odf.ComputedGraphicProperties=function(){var f;this.setGraphicProperties=function(k){f=k};this.verticalPos=function(){return f&&f.verticalPos()||"from-top"};this.verticalRel=function(){return f&&f.verticalRel()||"page"};this.horizontalPos=function(){return f&&f.horizontalPos()||"from-left"};this.horizontalRel=function(){return f&&f.horizontalRel()||"page"}};odf.PageLayoutProperties=function(f,k,a){var d=this,c=odf.Namespaces.fons;this.pageHeight=function(){return d.data.value("pageHeight")||1123};this.pageWidth=function(){return d.data.value("pageWidth")||794};d.data=new odf.LazyStyleProperties(void 0===a?void 0:a.data,{pageHeight:function(){var a;f&&(a=f.getAttributeNS(c,"page-height"),a=k.parseLength(a));return a},pageWidth:function(){var a;f&&(a=f.getAttributeNS(c,"page-width"),a=k.parseLength(a));return a}})};
odf.PageLayout=function(f,k,a){var d=null;f&&(d=k.getPropertiesElement("page-layout-properties",f));this.pageLayout=new odf.PageLayoutProperties(d,k,a&&a.pageLayout)};odf.PageLayoutCache=function(){};odf.PageLayoutCache.prototype.getPageLayout=function(f){};odf.PageLayoutCache.prototype.getDefaultPageLayout=function(){};odf.ParagraphProperties=function(f,k,a){var d=this,c=odf.Namespaces.fons;this.marginTop=function(){return d.data.value("marginTop")};d.data=new odf.LazyStyleProperties(void 0===a?void 0:a.data,{marginTop:function(){var d=f.getAttributeNS(c,"margin-top");return k.parsePositiveLengthOrPercent(d,"marginTop",a&&a.data)}})};
odf.ComputedParagraphProperties=function(){var f={},k=[];this.setStyleChain=function(a){k=a;f={}};this.marginTop=function(){var a,d;if(f.hasOwnProperty("marginTop"))a=f.marginTop;else{for(d=0;void 0===a&&d<k.length;d+=1)a=k[d].marginTop();f.marginTop=a}return a||0}};odf.TextProperties=function(f,k,a){var d=this,c=odf.Namespaces.fons;this.fontSize=function(){return d.data.value("fontSize")};d.data=new odf.LazyStyleProperties(void 0===a?void 0:a.data,{fontSize:function(){var d=f.getAttributeNS(c,"font-size");return k.parsePositiveLengthOrPercent(d,"fontSize",a&&a.data)}})};
odf.ComputedTextProperties=function(){var f={},k=[];this.setStyleChain=function(a){k=a;f={}};this.fontSize=function(){var a,d;if(f.hasOwnProperty("fontSize"))a=f.fontSize;else{for(d=0;void 0===a&&d<k.length;d+=1)a=k[d].fontSize();f.fontSize=a}return a||12}};odf.MasterPage=function(f,k){var a;f?(a=f.getAttributeNS(odf.Namespaces.stylens,"page-layout-name"),this.pageLayout=k.getPageLayout(a)):this.pageLayout=k.getDefaultPageLayout()};odf.MasterPageCache=function(){};odf.MasterPageCache.prototype.getMasterPage=function(f){};
odf.StylePileEntry=function(f,k,a,d){this.masterPage=function(){var c=f.getAttributeNS(odf.Namespaces.stylens,"master-page-name"),d=null;c&&(d=a.getMasterPage(c));return d};(function(a){var m=f.getAttributeNS(odf.Namespaces.stylens,"family"),h=null;if("graphic"===m||"chart"===m)a.graphic=void 0===d?void 0:d.graphic,h=k.getPropertiesElement("graphic-properties",f,h),null!==h&&(a.graphic=new odf.GraphicProperties(h,k,a.graphic));if("paragraph"===m||"table-cell"===m||"graphic"===m||"presentation"===
m||"chart"===m)a.paragraph=void 0===d?void 0:d.paragraph,h=k.getPropertiesElement("paragraph-properties",f,h),null!==h&&(a.paragraph=new odf.ParagraphProperties(h,k,a.paragraph));if("text"===m||"paragraph"===m||"table-cell"===m||"graphic"===m||"presentation"===m||"chart"===m)a.text=void 0===d?void 0:d.text,h=k.getPropertiesElement("text-properties",f,h),null!==h&&(a.text=new odf.TextProperties(h,k,a.text))})(this)};
odf.StylePile=function(f,k){function a(a,e){var b,c;a.hasAttributeNS(d,"parent-style-name")&&(c=a.getAttributeNS(d,"parent-style-name"),-1===e.indexOf(c)&&(b=n(c,e)));return new odf.StylePileEntry(a,f,k,b)}var d=odf.Namespaces.stylens,c={},m={},h,q={},p={},n;n=function(d,e){var b=q[d],f;!b&&(f=c[d])&&(e.push(d),b=a(f,e),q[d]=b);return b};this.getStyle=function(d){var e=p[d]||q[d],b,f=[];e||(b=m[d],b||(b=c[d])&&f.push(d),b&&(e=a(b,f)));return e};this.addCommonStyle=function(a){var e;a.hasAttributeNS(d,
"name")&&(e=a.getAttributeNS(d,"name"),c.hasOwnProperty(e)||(c[e]=a))};this.addAutomaticStyle=function(a){var e;a.hasAttributeNS(d,"name")&&(e=a.getAttributeNS(d,"name"),m.hasOwnProperty(e)||(m[e]=a))};this.setDefaultStyle=function(c){void 0===h&&(h=a(c,[]))};this.getDefaultStyle=function(){return h}};odf.ComputedGraphicStyle=function(){this.text=new odf.ComputedTextProperties;this.paragraph=new odf.ComputedParagraphProperties;this.graphic=new odf.ComputedGraphicProperties};
odf.ComputedParagraphStyle=function(){this.text=new odf.ComputedTextProperties;this.paragraph=new odf.ComputedParagraphProperties};odf.ComputedTextStyle=function(){this.text=new odf.ComputedTextProperties};
odf.StyleCache=function(f){function k(b,a,e,c){a=e.getAttributeNS(a,"class-names");var d;if(a)for(a=a.split(" "),d=0;d<a.length;d+=1)if(e=a[d])c.push(b),c.push(e)}function a(b,a){var e=t.getStyleName("paragraph",b);void 0!==e&&(a.push("paragraph"),a.push(e));b.namespaceURI!==l||"h"!==b.localName&&"p"!==b.localName||k("paragraph",l,b,a);return a}function d(b,a,e){var c=[],d,f,l,g;for(d=0;d<b.length;d+=2)l=b[d],g=b[d+1],l=q[l],g=l.getStyle(g),void 0!==g&&(g=g[a],void 0!==g&&g!==f&&(c.push(g),f=g));
l=q[e];if(g=l.getDefaultStyle())g=g[a],void 0!==g&&g!==f&&c.push(g);return c}function c(b,e){var d=t.getStyleName("text",b),g=b.parentNode;void 0!==d&&(e.push("text"),e.push(d));"span"===b.localName&&b.namespaceURI===l&&k("text",l,b,e);if(!g||g===f)return e;g.namespaceURI!==l||"p"!==g.localName&&"h"!==g.localName?c(g,e):a(g,e);return e}function m(b){b=b.getAttributeNS(y,"family");return q[b]}var h=this,q,p,n,g,e,b,r,l=odf.Namespaces.textns,y=odf.Namespaces.stylens,t=new odf.StyleInfo,z=new odf.StyleParseUtils,
w,s,x,u,A,H;this.getComputedGraphicStyle=function(b){var a=[];b=t.getStyleName("graphic",b);void 0!==b&&(a.push("graphic"),a.push(b));b=a.join("/");var e=g[b];runtime.assert(0===a.length%2,"Invalid style chain.");void 0===e&&(e=new odf.ComputedGraphicStyle,e.graphic.setGraphicProperties(d(a,"graphic","graphic")[0]),e.text.setStyleChain(d(a,"text","graphic")),e.paragraph.setStyleChain(d(a,"paragraph","graphic")),g[b]=e);return e};this.getComputedParagraphStyle=function(b){b=a(b,[]);var e=b.join("/"),
c=n[e];runtime.assert(0===b.length%2,"Invalid style chain.");void 0===c&&(c=new odf.ComputedParagraphStyle,c.text.setStyleChain(d(b,"text","paragraph")),c.paragraph.setStyleChain(d(b,"paragraph","paragraph")),n[e]=c);return c};this.getComputedTextStyle=function(b){b=c(b,[]);var a=b.join("/"),e=p[a];runtime.assert(0===b.length%2,"Invalid style chain.");void 0===e&&(e=new odf.ComputedTextStyle,e.text.setStyleChain(d(b,"text","text")),p[a]=e);return e};this.getPageLayout=function(b){var a=H[b];a||((a=
A[b])?(a=new odf.PageLayout(a,z,u),H[b]=a):a=u);return a};this.getDefaultPageLayout=function(){return u};this.getMasterPage=function(b){var a=s[b];void 0===a&&((a=w[b])?(a=new odf.MasterPage(a,h),s[b]=a):a=null);return a};this.getDefaultMasterPage=function(){return x};this.update=function(){var a,c,d=null,l=null;p={};n={};g={};w={};s={};H={};A={};e=new odf.StylePile(z,h);b=new odf.StylePile(z,h);r=new odf.StylePile(z,h);q={text:e,paragraph:b,graphic:r};for(a=f.styles.firstElementChild;a;)a.namespaceURI===
y&&((c=m(a))?"style"===a.localName?c.addCommonStyle(a):"default-style"===a.localName&&c.setDefaultStyle(a):"default-page-layout"===a.localName&&(d=a)),a=a.nextElementSibling;u=new odf.PageLayout(d,z);for(a=f.automaticStyles.firstElementChild;a;)a.namespaceURI===y&&((c=m(a))&&"style"===a.localName?c.addAutomaticStyle(a):"page-layout"===a.localName&&(A[a.getAttributeNS(y,"name")]=a)),a=a.nextElementSibling;for(a=f.masterStyles.firstElementChild;a;)a.namespaceURI===y&&"master-page"===a.localName&&(l=
l||a,c=a,d=c.getAttributeNS(y,"name"),0<d.length&&!w.hasOwnProperty(d)&&(w[d]=c)),a=a.nextElementSibling;x=new odf.MasterPage(l,h)}};ops.OperationTransformMatrix=function(){function f(a){a.position+=a.length;a.length*=-1}function k(a){var b=0>a.length;b&&f(a);return b}function a(a,b){function c(f){a[f]===b&&d.push(f)}var d=[];a&&["style:parent-style-name","style:next-style-name"].forEach(c);return d}function d(a,b){function c(d){a[d]===b&&delete a[d]}a&&["style:parent-style-name","style:next-style-name"].forEach(c)}function c(a){var b={};Object.keys(a).forEach(function(d){b[d]="object"===typeof a[d]?c(a[d]):a[d]});return b}function m(a,
b,c,d){var f,g=!1,h=!1,k,m=[];d&&d.attributes&&(m=d.attributes.split(","));a&&(c||0<m.length)&&Object.keys(a).forEach(function(b){var d=a[b],f;"object"!==typeof d&&(c&&(f=c[b]),void 0!==f?(delete a[b],h=!0,f===d&&(delete c[b],g=!0)):-1!==m.indexOf(b)&&(delete a[b],h=!0))});if(b&&b.attributes&&(c||0<m.length)){k=b.attributes.split(",");for(d=0;d<k.length;d+=1)if(f=k[d],c&&void 0!==c[f]||m&&-1!==m.indexOf(f))k.splice(d,1),d-=1,h=!0;0<k.length?b.attributes=k.join(","):delete b.attributes}return{majorChanged:g,
minorChanged:h}}function h(a){for(var b in a)if(a.hasOwnProperty(b))return!0;return!1}function q(a){for(var b in a)if(a.hasOwnProperty(b)&&("attributes"!==b||0<a.attributes.length))return!0;return!1}function p(a,b,c,d,f){var g=a?a[f]:null,k=b?b[f]:null,n=c?c[f]:null,p=d?d[f]:null,x;x=m(g,k,n,p);g&&!h(g)&&delete a[f];k&&!q(k)&&delete b[f];n&&!h(n)&&delete c[f];p&&!q(p)&&delete d[f];return x}function n(a,b){return{opSpecsA:[a],opSpecsB:[b]}}var g;g={AddAnnotation:{AddAnnotation:function(a,b,c){var d;
a.position<b.position?(d=a,c=b):b.position<a.position?(d=b,c=a):(d=c?a:b,c=c?b:a);c.position<d.position+d.length&&(d.length+=2);c.position+=2;return{opSpecsA:[a],opSpecsB:[b]}},AddCursor:n,AddMember:n,AddStyle:n,ApplyDirectStyling:function(a,b){a.position<=b.position?b.position+=2:a.position<=b.position+b.length&&(b.length+=2);return{opSpecsA:[a],opSpecsB:[b]}},InsertText:function(a,b){b.position<=a.position?a.position+=b.text.length:(void 0!==a.length&&b.position<=a.position+a.length&&(a.length+=
b.text.length),b.position+=2);return{opSpecsA:[a],opSpecsB:[b]}},MergeParagraph:function(a,b){b.sourceStartPosition<=a.position?a.position-=1:(void 0!==a.length&&b.sourceStartPosition<=a.position+a.length&&(a.length-=1),b.sourceStartPosition+=2,a.position<b.destinationStartPosition&&(b.destinationStartPosition+=2));return{opSpecsA:[a],opSpecsB:[b]}},MoveCursor:function(a,b){var c=k(b);a.position<b.position?b.position+=2:a.position<b.position+b.length&&(b.length+=2);c&&f(b);return{opSpecsA:[a],opSpecsB:[b]}},
RemoveAnnotation:function(a,b){a.position<b.position?(b.position<a.position+a.length&&(a.length-=b.length+2),b.position+=2):a.position-=b.length+2;return{opSpecsA:[a],opSpecsB:[b]}},RemoveCursor:n,RemoveMember:n,RemoveStyle:n,RemoveText:function(a,b){var c=b.position,d=b.position+b.length,f,g=[a],h=[b];a.position<=b.position?b.position+=2:a.position<d&&(b.length=a.position-b.position,f={optype:"RemoveText",memberid:b.memberid,timestamp:b.timestamp,position:a.position+2,length:d-a.position},h.unshift(f));
b.position+b.length<=a.position?(a.position-=b.length,void 0!==a.length&&f&&(a.length=f.length>=a.length?0:a.length-f.length)):void 0!==a.length&&(f=a.position+a.length,d<=f?a.length-=b.length:c<f&&(a.length=c-a.position));return{opSpecsA:g,opSpecsB:h}},SetParagraphStyle:function(a,b){a.position<b.position&&(b.position+=2);return{opSpecsA:[a],opSpecsB:[b]}},SplitParagraph:function(a,b){a.position<b.sourceParagraphPosition&&(b.sourceParagraphPosition+=2);b.position<=a.position?a.position+=1:(void 0!==
a.length&&b.position<=a.position+a.length&&(a.length+=1),b.position+=2);return{opSpecsA:[a],opSpecsB:[b]}},UpdateMember:n,UpdateMetadata:n,UpdateParagraphStyle:n},AddCursor:{AddCursor:n,AddMember:n,AddStyle:n,ApplyDirectStyling:n,InsertText:n,MergeParagraph:n,MoveCursor:n,RemoveAnnotation:n,RemoveCursor:n,RemoveMember:n,RemoveStyle:n,RemoveText:n,SetParagraphStyle:n,SplitParagraph:n,UpdateMember:n,UpdateMetadata:n,UpdateParagraphStyle:n},AddMember:{AddStyle:n,ApplyDirectStyling:n,InsertText:n,MergeParagraph:n,
MoveCursor:n,RemoveAnnotation:n,RemoveCursor:n,RemoveStyle:n,RemoveText:n,SetParagraphStyle:n,SplitParagraph:n,UpdateMetadata:n,UpdateParagraphStyle:n},AddStyle:{AddStyle:n,ApplyDirectStyling:n,InsertText:n,MergeParagraph:n,MoveCursor:n,RemoveAnnotation:n,RemoveCursor:n,RemoveMember:n,RemoveStyle:function(e,b){var c,f=[e],g=[b];e.styleFamily===b.styleFamily&&(c=a(e.setProperties,b.styleName),0<c.length&&(c={optype:"UpdateParagraphStyle",memberid:b.memberid,timestamp:b.timestamp,styleName:e.styleName,
removedProperties:{attributes:c.join(",")}},g.unshift(c)),d(e.setProperties,b.styleName));return{opSpecsA:f,opSpecsB:g}},RemoveText:n,SetParagraphStyle:n,SplitParagraph:n,UpdateMember:n,UpdateMetadata:n,UpdateParagraphStyle:n},ApplyDirectStyling:{ApplyDirectStyling:function(a,b,d){var f,g,k,m,n,q,x,u;m=[a];k=[b];if(!(a.position+a.length<=b.position||a.position>=b.position+b.length)){f=d?a:b;g=d?b:a;if(a.position!==b.position||a.length!==b.length)q=c(f),x=c(g);b=p(g.setProperties,null,f.setProperties,
null,"style:text-properties");if(b.majorChanged||b.minorChanged)k=[],a=[],m=f.position+f.length,n=g.position+g.length,g.position<f.position?b.minorChanged&&(u=c(x),u.length=f.position-g.position,a.push(u),g.position=f.position,g.length=n-g.position):f.position<g.position&&b.majorChanged&&(u=c(q),u.length=g.position-f.position,k.push(u),f.position=g.position,f.length=m-f.position),n>m?b.minorChanged&&(q=x,q.position=m,q.length=n-m,a.push(q),g.length=m-g.position):m>n&&b.majorChanged&&(q.position=n,
q.length=m-n,k.push(q),f.length=n-f.position),f.setProperties&&h(f.setProperties)&&k.push(f),g.setProperties&&h(g.setProperties)&&a.push(g),d?(m=k,k=a):m=a}return{opSpecsA:m,opSpecsB:k}},InsertText:function(a,b){b.position<=a.position?a.position+=b.text.length:b.position<=a.position+a.length&&(a.length+=b.text.length);return{opSpecsA:[a],opSpecsB:[b]}},MergeParagraph:function(a,b){var c=a.position,d=a.position+a.length;c>=b.sourceStartPosition&&(c-=1);d>=b.sourceStartPosition&&(d-=1);a.position=c;
a.length=d-c;return{opSpecsA:[a],opSpecsB:[b]}},MoveCursor:n,RemoveAnnotation:function(a,b){var c=a.position,d=a.position+a.length,f=b.position+b.length,g=[a],h=[b];b.position<=c&&d<=f?g=[]:(f<c&&(c-=b.length+2),f<d&&(d-=b.length+2),a.position=c,a.length=d-c);return{opSpecsA:g,opSpecsB:h}},RemoveCursor:n,RemoveMember:n,RemoveStyle:n,RemoveText:function(a,b){var c=a.position+a.length,d=b.position+b.length,f=[a],g=[b];d<=a.position?a.position-=b.length:b.position<c&&(a.position<b.position?a.length=
d<c?a.length-b.length:b.position-a.position:(a.position=b.position,d<c?a.length=c-d:f=[]));return{opSpecsA:f,opSpecsB:g}},SetParagraphStyle:n,SplitParagraph:function(a,b){b.position<a.position?a.position+=1:b.position<a.position+a.length&&(a.length+=1);return{opSpecsA:[a],opSpecsB:[b]}},UpdateMember:n,UpdateMetadata:n,UpdateParagraphStyle:n},InsertText:{InsertText:function(a,b,c){a.position<b.position?b.position+=a.text.length:a.position>b.position?a.position+=b.text.length:c?b.position+=a.text.length:
a.position+=b.text.length;return{opSpecsA:[a],opSpecsB:[b]}},MergeParagraph:function(a,b){a.position>=b.sourceStartPosition?a.position-=1:(a.position<b.sourceStartPosition&&(b.sourceStartPosition+=a.text.length),a.position<b.destinationStartPosition&&(b.destinationStartPosition+=a.text.length));return{opSpecsA:[a],opSpecsB:[b]}},MoveCursor:function(a,b){var c=k(b);a.position<b.position?b.position+=a.text.length:a.position<b.position+b.length&&(b.length+=a.text.length);c&&f(b);return{opSpecsA:[a],
opSpecsB:[b]}},RemoveAnnotation:function(a,b){var c=a.position,d=b.position+b.length,f=[a],g=[b];b.position<=c&&c<=d?(f=[],b.length+=a.text.length):d<a.position?a.position-=b.length+2:b.position+=a.text.length;return{opSpecsA:f,opSpecsB:g}},RemoveCursor:n,RemoveMember:n,RemoveStyle:n,RemoveText:function(a,b){var c;c=b.position+b.length;var d=[a],f=[b];c<=a.position?a.position-=b.length:a.position<=b.position?b.position+=a.text.length:(b.length=a.position-b.position,c={optype:"RemoveText",memberid:b.memberid,
timestamp:b.timestamp,position:a.position+a.text.length,length:c-a.position},f.unshift(c),a.position=b.position);return{opSpecsA:d,opSpecsB:f}},SetParagraphStyle:function(a,b){b.position>a.position&&(b.position+=a.text.length);return{opSpecsA:[a],opSpecsB:[b]}},SplitParagraph:function(a,b){a.position<b.sourceParagraphPosition&&(b.sourceParagraphPosition+=a.text.length);a.position<=b.position?b.position+=a.text.length:a.position+=1;return{opSpecsA:[a],opSpecsB:[b]}},UpdateMember:n,UpdateMetadata:n,
UpdateParagraphStyle:n},MergeParagraph:{MergeParagraph:function(a,b,c){var d=[a],f=[b],g;a.destinationStartPosition===b.destinationStartPosition?(d=[],f=[],a.moveCursor&&(g={optype:"MoveCursor",memberid:a.memberid,timestamp:a.timestamp,position:a.sourceStartPosition-1},d.push(g)),b.moveCursor&&(g={optype:"MoveCursor",memberid:b.memberid,timestamp:b.timestamp,position:b.sourceStartPosition-1},f.push(g)),a=c?a:b,a={optype:"SetParagraphStyle",memberid:a.memberid,timestamp:a.timestamp,position:a.destinationStartPosition,
styleName:a.paragraphStyleName},c?d.push(a):f.push(a)):b.sourceStartPosition===a.destinationStartPosition?(a.destinationStartPosition=b.destinationStartPosition,a.sourceStartPosition-=1,a.paragraphStyleName=b.paragraphStyleName):a.sourceStartPosition===b.destinationStartPosition?(b.destinationStartPosition=a.destinationStartPosition,b.sourceStartPosition-=1,b.paragraphStyleName=a.paragraphStyleName):a.destinationStartPosition<b.destinationStartPosition?(b.destinationStartPosition-=1,b.sourceStartPosition-=
1):(a.destinationStartPosition-=1,a.sourceStartPosition-=1);return{opSpecsA:d,opSpecsB:f}},MoveCursor:function(a,b){var c=b.position,d=b.position+b.length,f=Math.min(c,d),c=Math.max(c,d);f>=a.sourceStartPosition&&(f-=1);c>=a.sourceStartPosition&&(c-=1);0<=b.length?(b.position=f,b.length=c-f):(b.position=c,b.length=f-c);return{opSpecsA:[a],opSpecsB:[b]}},RemoveAnnotation:function(a,b){var c=b.position+b.length,d=[a],f=[b];b.position<=a.destinationStartPosition&&a.sourceStartPosition<=c?(d=[],b.length-=
1):a.sourceStartPosition<b.position?b.position-=1:(c<a.destinationStartPosition&&(a.destinationStartPosition-=b.length+2),c<a.sourceStartPosition&&(a.sourceStartPosition-=b.length+2));return{opSpecsA:d,opSpecsB:f}},RemoveCursor:n,RemoveMember:n,RemoveStyle:n,RemoveText:function(a,b){b.position>=a.sourceStartPosition?b.position-=1:(b.position<a.destinationStartPosition&&(a.destinationStartPosition-=b.length),b.position<a.sourceStartPosition&&(a.sourceStartPosition-=b.length));return{opSpecsA:[a],opSpecsB:[b]}},
SetParagraphStyle:function(a,b){var c=[a],d=[b];if(b.position>a.sourceStartPosition)b.position-=1;else if(b.position===a.destinationStartPosition||b.position===a.sourceStartPosition)b.position=a.destinationStartPosition,a.paragraphStyleName=b.styleName;return{opSpecsA:c,opSpecsB:d}},SplitParagraph:function(a,b){var c,d=[a],f=[b];b.position<a.destinationStartPosition?(a.destinationStartPosition+=1,a.sourceStartPosition+=1):b.position>=a.destinationStartPosition&&b.position<a.sourceStartPosition?(b.paragraphStyleName=
a.paragraphStyleName,c={optype:"SetParagraphStyle",memberid:a.memberid,timestamp:a.timestamp,position:a.destinationStartPosition,styleName:a.paragraphStyleName},d.push(c),b.position===a.sourceStartPosition-1&&a.moveCursor&&(c={optype:"MoveCursor",memberid:a.memberid,timestamp:a.timestamp,position:b.position,length:0},d.push(c)),a.destinationStartPosition=b.position+1,a.sourceStartPosition+=1):b.position>=a.sourceStartPosition&&(b.position-=1,b.sourceParagraphPosition-=1);return{opSpecsA:d,opSpecsB:f}},
UpdateMember:n,UpdateMetadata:n,UpdateParagraphStyle:n},MoveCursor:{MoveCursor:n,RemoveAnnotation:function(a,b){var c=k(a),d=a.position+a.length,g=b.position+b.length;b.position<=a.position&&d<=g?(a.position=b.position-1,a.length=0):(g<a.position?a.position-=b.length+2:g<d&&(a.length-=b.length+2),c&&f(a));return{opSpecsA:[a],opSpecsB:[b]}},RemoveCursor:function(a,b){return{opSpecsA:a.memberid===b.memberid?[]:[a],opSpecsB:[b]}},RemoveMember:n,RemoveStyle:n,RemoveText:function(a,b){var c=k(a),d=a.position+
a.length,g=b.position+b.length;g<=a.position?a.position-=b.length:b.position<d&&(a.position<b.position?a.length=g<d?a.length-b.length:b.position-a.position:(a.position=b.position,a.length=g<d?d-g:0));c&&f(a);return{opSpecsA:[a],opSpecsB:[b]}},SetParagraphStyle:n,SplitParagraph:function(a,b){var c=k(a);b.position<a.position?a.position+=1:b.position<a.position+a.length&&(a.length+=1);c&&f(a);return{opSpecsA:[a],opSpecsB:[b]}},UpdateMember:n,UpdateMetadata:n,UpdateParagraphStyle:n},RemoveAnnotation:{RemoveAnnotation:function(a,
b){var c=[a],d=[b];a.position===b.position&&a.length===b.length?(c=[],d=[]):a.position<b.position?b.position-=a.length+2:a.position-=b.length+2;return{opSpecsA:c,opSpecsB:d}},RemoveCursor:n,RemoveMember:n,RemoveStyle:n,RemoveText:function(a,b){var c=a.position+a.length,d=b.position+b.length,f=[a],g=[b];a.position<=b.position&&d<=c?(g=[],a.length-=b.length):d<a.position?a.position-=b.length:b.position<a.position?(a.position=b.position+1,b.length-=a.length+2):b.position-=a.length+2;return{opSpecsA:f,
opSpecsB:g}},SetParagraphStyle:function(a,b){var c=b.position,d=a.position+a.length,f=[a],g=[b];a.position<=c&&c<=d?g=[]:d<c&&(b.position-=a.length+2);return{opSpecsA:f,opSpecsB:g}},SplitParagraph:function(a,b){var c=b.position,d=a.position+a.length,f=[a],g=[b];a.position<=c&&c<=d?(g=[],a.length+=1):(d<b.sourceParagraphPosition&&(b.sourceParagraphPosition-=a.length+2),d<c?b.position-=a.length+2:a.position+=1);return{opSpecsA:f,opSpecsB:g}},UpdateMember:n,UpdateMetadata:n,UpdateParagraphStyle:n},RemoveCursor:{RemoveCursor:function(a,
b){var c=a.memberid===b.memberid;return{opSpecsA:c?[]:[a],opSpecsB:c?[]:[b]}},RemoveMember:n,RemoveStyle:n,RemoveText:n,SetParagraphStyle:n,SplitParagraph:n,UpdateMember:n,UpdateMetadata:n,UpdateParagraphStyle:n},RemoveMember:{RemoveStyle:n,RemoveText:n,SetParagraphStyle:n,SplitParagraph:n,UpdateMetadata:n,UpdateParagraphStyle:n},RemoveStyle:{RemoveStyle:function(a,b){var c=a.styleName===b.styleName&&a.styleFamily===b.styleFamily;return{opSpecsA:c?[]:[a],opSpecsB:c?[]:[b]}},RemoveText:n,SetParagraphStyle:function(a,
b){var c,d=[a],f=[b];"paragraph"===a.styleFamily&&a.styleName===b.styleName&&(c={optype:"SetParagraphStyle",memberid:a.memberid,timestamp:a.timestamp,position:b.position,styleName:""},d.unshift(c),b.styleName="");return{opSpecsA:d,opSpecsB:f}},SplitParagraph:n,UpdateMember:n,UpdateMetadata:n,UpdateParagraphStyle:function(c,b){var f,g=[c],h=[b];"paragraph"===c.styleFamily&&(f=a(b.setProperties,c.styleName),0<f.length&&(f={optype:"UpdateParagraphStyle",memberid:c.memberid,timestamp:c.timestamp,styleName:b.styleName,
removedProperties:{attributes:f.join(",")}},g.unshift(f)),c.styleName===b.styleName?h=[]:d(b.setProperties,c.styleName));return{opSpecsA:g,opSpecsB:h}}},RemoveText:{RemoveText:function(a,b){var c=a.position+a.length,d=b.position+b.length,f=[a],g=[b];d<=a.position?a.position-=b.length:c<=b.position?b.position-=a.length:b.position<c&&(a.position<b.position?(a.length=d<c?a.length-b.length:b.position-a.position,c<d?(b.position=a.position,b.length=d-c):g=[]):(c<d?b.length-=a.length:b.position<a.position?
b.length=a.position-b.position:g=[],d<c?(a.position=b.position,a.length=c-d):f=[]));return{opSpecsA:f,opSpecsB:g}},SetParagraphStyle:function(a,b){a.position<b.position&&(b.position-=a.length);return{opSpecsA:[a],opSpecsB:[b]}},SplitParagraph:function(a,b){var c=a.position+a.length,d=[a],f=[b];b.position<=a.position?a.position+=1:b.position<c&&(a.length=b.position-a.position,c={optype:"RemoveText",memberid:a.memberid,timestamp:a.timestamp,position:b.position+1,length:c-b.position},d.unshift(c));a.position+
a.length<=b.position?b.position-=a.length:a.position<b.position&&(b.position=a.position);a.position+a.length<b.sourceParagraphPosition&&(b.sourceParagraphPosition-=a.length);return{opSpecsA:d,opSpecsB:f}},UpdateMember:n,UpdateMetadata:n,UpdateParagraphStyle:n},SetParagraphStyle:{SetParagraphStyle:function(a,b,c){a.position===b.position&&(c?b.styleName=a.styleName:a.styleName=b.styleName);return{opSpecsA:[a],opSpecsB:[b]}},SplitParagraph:function(a,b){var d=[a],f=[b],g;a.position>b.position?a.position+=
1:a.position===b.sourceParagraphPosition&&(b.paragraphStyleName=a.styleName,g=c(a),g.position=b.position+1,d.push(g));return{opSpecsA:d,opSpecsB:f}},UpdateMember:n,UpdateMetadata:n,UpdateParagraphStyle:n},SplitParagraph:{SplitParagraph:function(a,b,c){var d,f;a.position<b.position?d=!0:b.position<a.position?f=!0:a.position===b.position&&(c?d=!0:f=!0);d?(b.position+=1,b.sourceParagraphPosition=a.position<b.sourceParagraphPosition?b.sourceParagraphPosition+1:a.position+1):f&&(a.position+=1,a.sourceParagraphPosition=
b.position<b.sourceParagraphPosition?a.sourceParagraphPosition+1:b.position+1);return{opSpecsA:[a],opSpecsB:[b]}},UpdateMember:n,UpdateMetadata:n,UpdateParagraphStyle:n},UpdateMember:{UpdateMetadata:n,UpdateParagraphStyle:n},UpdateMetadata:{UpdateMetadata:function(a,b,c){var d,f=[a],g=[b];d=c?a:b;a=c?b:a;m(a.setProperties||null,a.removedProperties||null,d.setProperties||null,d.removedProperties||null);d.setProperties&&h(d.setProperties)||d.removedProperties&&q(d.removedProperties)||(c?f=[]:g=[]);
a.setProperties&&h(a.setProperties)||a.removedProperties&&q(a.removedProperties)||(c?g=[]:f=[]);return{opSpecsA:f,opSpecsB:g}},UpdateParagraphStyle:n},UpdateParagraphStyle:{UpdateParagraphStyle:function(a,b,c){var d,f=[a],g=[b];a.styleName===b.styleName&&(d=c?a:b,a=c?b:a,p(a.setProperties,a.removedProperties,d.setProperties,d.removedProperties,"style:paragraph-properties"),p(a.setProperties,a.removedProperties,d.setProperties,d.removedProperties,"style:text-properties"),m(a.setProperties||null,a.removedProperties||
null,d.setProperties||null,d.removedProperties||null),d.setProperties&&h(d.setProperties)||d.removedProperties&&q(d.removedProperties)||(c?f=[]:g=[]),a.setProperties&&h(a.setProperties)||a.removedProperties&&q(a.removedProperties)||(c?g=[]:f=[]));return{opSpecsA:f,opSpecsB:g}}}};this.passUnchanged=n;this.extendTransformations=function(a){Object.keys(a).forEach(function(b){var c=a[b],d,f=g.hasOwnProperty(b);runtime.log((f?"Extending":"Adding")+" map for optypeA: "+b);f||(g[b]={});d=g[b];Object.keys(c).forEach(function(a){var e=
d.hasOwnProperty(a);runtime.assert(b<=a,"Wrong order:"+b+", "+a);runtime.log("  "+(e?"Overwriting":"Adding")+" entry for optypeB: "+a);d[a]=c[a]})})};this.transformOpspecVsOpspec=function(a,b){var c=a.optype<=b.optype,d;runtime.log("Crosstransforming:");runtime.log(runtime.toJson(a));runtime.log(runtime.toJson(b));c||(d=a,a=b,b=d);(d=(d=g[a.optype])&&d[b.optype])?(d=d(a,b,!c),c||null===d||(d={opSpecsA:d.opSpecsB,opSpecsB:d.opSpecsA})):d=null;runtime.log("result:");d?(runtime.log(runtime.toJson(d.opSpecsA)),
runtime.log(runtime.toJson(d.opSpecsB))):runtime.log("null");return d}};ops.OperationTransformer=function(){function f(a,d){for(var c,m,h=[],q=[];0<a.length&&d;){c=a.shift();c=k.transformOpspecVsOpspec(c,d);if(!c)return null;h=h.concat(c.opSpecsA);if(0===c.opSpecsB.length){h=h.concat(a);d=null;break}for(;1<c.opSpecsB.length;){m=f(a,c.opSpecsB.shift());if(!m)return null;q=q.concat(m.opSpecsB);a=m.opSpecsA}d=c.opSpecsB.pop()}d&&q.push(d);return{opSpecsA:h,opSpecsB:q}}var k=new ops.OperationTransformMatrix;this.getOperationTransformMatrix=function(){return k};this.transform=
function(a,d){for(var c,k=[];0<d.length;){c=f(a,d.shift());if(!c)return null;a=c.opSpecsA;k=k.concat(c.opSpecsB)}return{opSpecsA:a,opSpecsB:k}}};var webodf_css='@namespace draw url(urn:oasis:names:tc:opendocument:xmlns:drawing:1.0);@namespace fo url(urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0);@namespace office url(urn:oasis:names:tc:opendocument:xmlns:office:1.0);@namespace presentation url(urn:oasis:names:tc:opendocument:xmlns:presentation:1.0);@namespace style url(urn:oasis:names:tc:opendocument:xmlns:style:1.0);@namespace svg url(urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0);@namespace table url(urn:oasis:names:tc:opendocument:xmlns:table:1.0);@namespace text url(urn:oasis:names:tc:opendocument:xmlns:text:1.0);@namespace webodfhelper url(urn:webodf:names:helper);@namespace cursor url(urn:webodf:names:cursor);@namespace editinfo url(urn:webodf:names:editinfo);@namespace annotation url(urn:webodf:names:annotation);@namespace dc url(http://purl.org/dc/elements/1.1/);@namespace svgns url(http://www.w3.org/2000/svg);office|document > *, office|document-content > * {display: none;}office|body, office|document {display: inline-block;position: relative;}text|p, text|h {display: block;padding: 0;margin: 0;line-height: normal;position: relative;}text|p::after, text|h::after {content: "\\200B";white-space: pre;}*[webodfhelper|containsparagraphanchor] {position: relative;}text|s {white-space: pre;}text|tab {display: inline;white-space: pre;}text|tracked-changes {display: none;}office|binary-data {display: none;}office|text {display: block;text-align: left;overflow: visible;word-wrap: break-word;}office|text::selection {background: transparent;}.webodf-virtualSelections *::selection {background: transparent;}.webodf-virtualSelections *::-moz-selection {background: transparent;}office|text * draw|text-box {display: block;border: 1px solid #d3d3d3;}office|text draw|frame {z-index: 1;}office|spreadsheet {display: block;border-collapse: collapse;empty-cells: show;font-family: sans-serif;font-size: 10pt;text-align: left;page-break-inside: avoid;overflow: hidden;}office|presentation {display: inline-block;text-align: left;}#shadowContent {display: inline-block;text-align: left;}draw|page {display: block;position: relative;overflow: hidden;}presentation|notes, presentation|footer-decl, presentation|date-time-decl {display: none;}@media print {draw|page {border: 1pt solid black;page-break-inside: avoid;}presentation|notes {}}office|spreadsheet text|p {border: 0px;padding: 1px;margin: 0px;}office|spreadsheet table|table {margin: 3px;}office|spreadsheet table|table:after {}office|spreadsheet table|table-row {counter-increment: row;}office|spreadsheet table|table-row:before {width: 3em;background: #cccccc;border: 1px solid black;text-align: center;content: counter(row);display: table-cell;}office|spreadsheet table|table-cell {border: 1px solid #cccccc;}table|table {display: table;}draw|frame table|table {width: 100%;height: 100%;background: white;}table|table-header-rows {display: table-header-group;}table|table-row {display: table-row;}table|table-column {display: table-column;}table|table-cell {width: 0.889in;display: table-cell;word-break: break-all;}draw|frame {display: block;}draw|image {display: block;width: 100%;height: 100%;top: 0px;left: 0px;background-repeat: no-repeat;background-size: 100% 100%;-moz-background-size: 100% 100%;}draw|frame > draw|image:nth-of-type(n+2) {display: none;}text|list:before {display: none;content:"";}text|list {display: block;}text|list-item {display: block;}text|number {display:none;}text|a {color: blue;text-decoration: underline;cursor: pointer;}.webodf-inactiveLinks text|a {cursor: text;}text|note-citation {vertical-align: super;font-size: smaller;}text|note-body {display: none;}text|note:hover text|note-citation {background: #dddddd;}text|note:hover text|note-body {display: block;left:1em;max-width: 80%;position: absolute;background: #ffffaa;}text|bibliography-source {display: none;}svg|title, svg|desc {display: none;}video {width: 100%;height: 100%}cursor|anchor {display: none;}cursor|cursor {display: none;}.webodf-caretOverlay {position: absolute;top: 5%;height: 1em;z-index: 10;padding-left: 1px;pointer-events: none;}.webodf-caretOverlay .caret {position: absolute;border-left: 2px solid black;top: 0;bottom: 0;right: 0;}.webodf-caretOverlay .handle {position: absolute;margin-top: 5px;padding-top: 3px;margin-left: auto;margin-right: auto;width: 64px;height: 68px;border-radius: 5px;opacity: 0.3;text-align: center;background-color: black;box-shadow: 0px 0px 5px rgb(90, 90, 90);border: 1px solid black;top: -85px;right: -32px;}.webodf-caretOverlay .handle > img {box-shadow: 0px 0px 5px rgb(90, 90, 90) inset;background-color: rgb(200, 200, 200);border-radius: 5px;border: 2px solid;height: 60px;width: 60px;display: block;margin: auto;}.webodf-caretOverlay .handle.active {opacity: 0.8;}.webodf-caretOverlay .handle:after {content: " ";position: absolute;width: 0px;height: 0px;border-style: solid;border-width: 8.7px 5px 0 5px;border-color: black transparent transparent transparent;top: 100%;left: 43%;}.webodf-caretSizer {display: inline-block;width: 0;visibility: hidden;}#eventTrap {display: block;position: absolute;bottom: 0;left: 0;outline: none;opacity: 0;color: rgba(255, 255, 255, 0);pointer-events: none;white-space: pre;overflow: hidden;}cursor|cursor > #composer {text-decoration: underline;}cursor|cursor[cursor|caret-sizer-active="true"],cursor|cursor[cursor|composing="true"] {display: inline;}editinfo|editinfo {display: inline-block;}.editInfoMarker {position: absolute;width: 10px;height: 100%;left: -20px;opacity: 0.8;top: 0;border-radius: 5px;background-color: transparent;box-shadow: 0px 0px 5px rgba(50, 50, 50, 0.75);}.editInfoMarker:hover {box-shadow: 0px 0px 8px rgba(0, 0, 0, 1);}.editInfoHandle {position: absolute;background-color: black;padding: 5px;border-radius: 5px;opacity: 0.8;box-shadow: 0px 0px 5px rgba(50, 50, 50, 0.75);bottom: 100%;margin-bottom: 10px;z-index: 3;left: -25px;}.editInfoHandle:after {content: " ";position: absolute;width: 0px;height: 0px;border-style: solid;border-width: 8.7px 5px 0 5px;border-color: black transparent transparent transparent;top: 100%;left: 5px;}.editInfo {font-family: sans-serif;font-weight: normal;font-style: normal;text-decoration: none;color: white;width: 100%;height: 12pt;}.editInfoColor {float: left;width: 10pt;height: 10pt;border: 1px solid white;}.editInfoAuthor {float: left;margin-left: 5pt;font-size: 10pt;text-align: left;height: 12pt;line-height: 12pt;}.editInfoTime {float: right;margin-left: 30pt;font-size: 8pt;font-style: italic;color: yellow;height: 12pt;line-height: 12pt;}.annotationWrapper {display: inline;position: relative;}.annotationRemoveButton:before {content: "\u00d7";color: white;padding: 5px;line-height: 1em;}.annotationRemoveButton {width: 20px;height: 20px;border-radius: 10px;background-color: black;box-shadow: 0px 0px 5px rgba(50, 50, 50, 0.75);position: absolute;top: -10px;left: -10px;z-index: 3;text-align: center;font-family: sans-serif;font-style: normal;font-weight: normal;text-decoration: none;font-size: 15px;}.annotationRemoveButton:hover {cursor: pointer;box-shadow: 0px 0px 5px rgba(0, 0, 0, 1);}.annotationNote {width: 4cm;position: absolute;display: inline;z-index: 10;top: 0;}.annotationNote > office|annotation {display: block;text-align: left;}.annotationConnector {position: absolute;display: inline;top: 0;z-index: 2;border-top: 1px dashed brown;}.annotationConnector.angular {-moz-transform-origin: left top;-webkit-transform-origin: left top;-ms-transform-origin: left top;transform-origin: left top;}.annotationConnector.horizontal {left: 0;}.annotationConnector.horizontal:before {content: "";display: inline;position: absolute;width: 0px;height: 0px;border-style: solid;border-width: 8.7px 5px 0 5px;border-color: brown transparent transparent transparent;top: -1px;left: -5px;}office|annotation {width: 100%;height: 100%;display: none;background: rgb(198, 238, 184);background: -moz-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: -webkit-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: -o-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: -ms-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: linear-gradient(180deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);box-shadow: 0 3px 4px -3px #ccc;}office|annotation > dc|creator {display: block;font-size: 10pt;font-weight: normal;font-style: normal;font-family: sans-serif;color: white;background-color: brown;padding: 4px;}office|annotation > dc|date {display: block;font-size: 10pt;font-weight: normal;font-style: normal;font-family: sans-serif;border: 4px solid transparent;color: black;}office|annotation > text|list {display: block;padding: 5px;}office|annotation text|p {font-size: 10pt;color: black;font-weight: normal;font-style: normal;text-decoration: none;font-family: sans-serif;}#annotationsPane {background-color: #EAEAEA;width: 4cm;height: 100%;display: none;position: absolute;outline: 1px solid #ccc;}.webodf-annotationHighlight {background-color: yellow;position: relative;}.webodf-selectionOverlay {position: absolute;pointer-events: none;top: 0;left: 0;top: 0;left: 0;width: 100%;height: 100%;z-index: 15;}.webodf-selectionOverlay > polygon {fill-opacity: 0.3;stroke-opacity: 0.8;stroke-width: 1;fill-rule: evenodd;}.webodf-selectionOverlay > .webodf-draggable {fill-opacity: 0.8;stroke-opacity: 0;stroke-width: 8;pointer-events: all;display: none;-moz-transform-origin: center center;-webkit-transform-origin: center center;-ms-transform-origin: center center;transform-origin: center center;}#imageSelector {display: none;position: absolute;border-style: solid;border-color: black;}#imageSelector > div {width: 5px;height: 5px;display: block;position: absolute;border: 1px solid black;background-color: #ffffff;}#imageSelector > .topLeft {top: -4px;left: -4px;}#imageSelector > .topRight {top: -4px;right: -4px;}#imageSelector > .bottomRight {right: -4px;bottom: -4px;}#imageSelector > .bottomLeft {bottom: -4px;left: -4px;}#imageSelector > .topMiddle {top: -4px;left: 50%;margin-left: -2.5px;}#imageSelector > .rightMiddle {top: 50%;right: -4px;margin-top: -2.5px;}#imageSelector > .bottomMiddle {bottom: -4px;left: 50%;margin-left: -2.5px;}#imageSelector > .leftMiddle {top: 50%;left: -4px;margin-top: -2.5px;}div.webodf-customScrollbars::-webkit-scrollbar{width: 8px;height: 8px;background-color: transparent;}div.webodf-customScrollbars::-webkit-scrollbar-track{background-color: transparent;}div.webodf-customScrollbars::-webkit-scrollbar-thumb{background-color: #444;border-radius: 4px;}.webodf-hyperlinkTooltip {display: none;color: white;background-color: black;border-radius: 5px;box-shadow: 2px 2px 5px gray;padding: 3px;position: absolute;max-width: 210px;text-align: left;word-break: break-all;z-index: 16;}.webodf-hyperlinkTooltipText {display: block;font-weight: bold;}';
